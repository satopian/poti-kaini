# POTI-board改二 デフォルトテーマ「MONO」

スキンの解説と履歴です。  
Skinnyのタグは[本家](http://skinny.sx68.net/tag/taglist.html)を見ていただくとして、Skinnyの設定項目と変数名の解説を行います。

## テーマ開発用にSkinny.phpの設定を変更する

### 配布用に設定を変更したもの

変更したほうが開発によさそう。  

- `$skConf['CACHE']['FLG'] = true;` - スキンキャッシュの利用「しない(false)」でないとwindows上ではキャッシュが更新されないことがあるようです。
- `$skConf['DISP']['ERRORS'] = false;` - エラーの画面出力。「する(true)」のほうがバグ探しに便利です。
- `$skConf['DISP']['TAB_DELETE'] = 1;` - 出力時にタブコード '\t' を取り除く。オフ(0)のほうがソースチェックしやすいかもしれません。chromeの検証ツールを使えばほぼ問題はないと思います。
- `$skConf['DISP']['RET_DELETE'] = 1;` - 出力時に連続した改行 '\n' を取り除く。オフ(0)でソースチェックがしやすいかも。これもchromeの検証ツールなら問題ないかと。

### デフォルトのままだが変更すると開発に便利そうなもの

- `$skConf['ERRORLOG']['FLG'] = false;` - エラーログを出力。デフォルトでfalseですが、trueにしておくとエラー探しが便利かもしれません

## 変数

### main.htmlで使っているもの

- echo(title) - 掲示板のタイトルです。
- echo(charset) - 文字コード。通常はUTF-8です。
- echo(skindir) - テーマ(テンプレート)のディレクトリを指します。テーマ(テンプレート)フォルダにcssや.jsファイル、画像などがある場合に使用します。
- def(notres) - 「レス表示モードでない場合」です。
- def(resno) - 「レス表示モードの場合」です。
- def(resname) - 「投稿者名をコピー」で使います。
- echo(rooturl) - 掲示板の設置URLです。ツイッターカードなどで使います。
- echo(self) - スクリプト自身の名前です。通常はpotiboard.phpです。
- echo(self2) - 入口の名前です。なにも変更していなければindex.htmlとなっています。
- def(applet) - 「お絵かきアプレットを使用する場合」です。
- def(paint2) - 「お絵かき機能を使用する お絵かきのみ」(define('USE_PAINT', '2');)の設定の場合です。
- echo(pdefw) - デフォルトのお絵かきサイズ幅です。
- echo(pdefh) - デフォルトのお絵かきサイズ高さです。
- def(anime) - 動画記録を使用するかどうかです。
- echo(animechk) - 動画記録をデフォルトで使用するかどうかです。
- def(form) - 通常投稿フォームを使用するかどうかです。
- echo(maxbyte) - 投稿できる最大ファイルサイズです。
- echo(usename) - 名前が必要な場合のマークです。
- echo(usesub) - タイトルが必要な場合のマークです。
- echo(resub) - 返信時のタイトルです。
- echo(usecom) - コメントが必要な場合のマークです。
- def(upfile) - ファイルアップロードを使うかどうかです。
- echo(maxw) - 画像の縮小表示を開始する幅です。
- echo(maxh) - 画像の縮小表示を開始する高さです。
- echo(maxkb) - 1ファイルの最大投稿データ容量です。
- each(oya) - スレッドです。
- echo(oya/no) - 親記事の番号です。
- echo(oya/sub) - 親記事のタイトルです。
- echo(oya/name) - 親記事を書いた人の名前です。
- echo(oya/trip) - 親記事を書いた人のトリップです。
- echo(oya/now) - 親記事の投稿時刻です。
- echo(oya/id) - 親記事を書いた人のIDです。
- echo(oya/url) - 親記事を書いた人のURLです。
- echo(oya/updatemark) - コメントの修正などをするとつくマークです。
- def(oya/src) - 親記事に画像があるかのチェックです。
- echo(oya/src) - 親記事の画像URLです。
- echo(oya/srcname) - 親記事の画像タイトルです。
- echo(oya/size) - 親記事の画像サイズです。
- def(oya/thumb) - サムネイル表示チェックです。
- def(oya/pch) - 動画があるかのチェックです。
- echo(oya/pch) - 親記事の動画です。
- echo(oya/imgsrc) - 親記事の画像です。
- def(oya/continue) - 続きから描くを使えるかのチェックです。
- echo(oya/tab) - tabindexに使います。
- echo(oya/srcname) - 画像ファイル名です。
- echo(oya/com) - 親記事のコメントです。
- def(oya/limit) - 「もうすぐ消える記事」のチェックです。
- def(oya/skipres) - レスが省略されているかのチェックです。
- each(oya/res) - スレッドのレスです。
- def(oya/res/src) - レスに画像があるかのチェックです。
- 以下、oya/res/... はスレッドの中でのものになりますので省略します。
- def(sharebutton) - SNSシェアボタンを付けるかどうかのチェックです。
- def(resform) - スレッドにレスフォームを付けるかどうかのチェックです。
- def(prev) - 前ページがあるかのチェックです。
- echo(prev) - 前ページのURLです。
- def(next) - 次ページがあるかのチェックです。
- echo(next) - 次ページのURLです。
- def(userdel) - ユーザー削除権限のチェックです。
- echo(ver),echo(verlot) - potiboardのバージョンです。
- echo(tver) - スキンのバージョンです。template_ini.phpを参照します。

### paint.htmlで使っているもの

- def(paint_mode) - お絵かきモードの時のチェックです。
- def(continue_mode) - 続きを描く時のモードのチェックです。
- def(type_neo) - 動画再生のときにneoのpchでもCheerpJが起動する事があるため、ファイルの中身を確認する処理です。Java版ならFalseになります。
- echo(w),echo(h) - アプレットスクリプトの幅と高さです。
- echo(picw),echo(pich) - キャンバスの幅と高さです。
- 以下アプレットスクリプト内の説明は今は省略させてください…
- def(pch_mode) - 動画再生モードかどうかです。
- def(passflag) - 続きからか描くのpassの設定です。（互換性のために残してあるところでパスワード入力欄を出す消すの切り替えに使われていました。今は常にtrueなので不要）
- def(newpost_nopassword) - 新規投稿なら削除キーがなくても続きを描く事ができます。のチェックです。
- `<SIIHELP>` - 特殊タグ。siihelp.phpを呼び出します。→2.6.0で廃止

もとは配列でeachだったが改二では結合された文字列

`<% def(palettes) %>`  
`<% echo(palettes) %>`  
`<% /def %>`

`<% def(dynp) %>`  
`<% echo(dynp) %>`  
`<% /def %>`

### catalog.htmlで使っているもの

- <% each(y) %><% each(y/x) %><% def(y/x/no) %>…　呪文です。tableタグを使用してカタログ表示をしていたころの名残があるためとてもややこしいです。デフォルトスキンではcssのflexboxを使ってカタログモードを表現しています。でも頑張って説明する。
- <% each(y) %><% each(y/x) %> - まとめて「y * x の回数だけ繰り返す」ということです。分離すればtableタグに使えますがさらにややこしくなるのでオススメしません。
- echo(y/x/no),echo(y/x/sub)... - 他のnoやsubとだいたい同じです。記事の番号やタイトルが返ってきます。

### other.htmlで使っているもの

- def(post_mode) - 新規投稿モードのチェックです。
- def(admin) - 管理者モードのチェックです。
- def(pictmp) - 投稿されずに残っている画像のチェックです。
- def(admin_in) - 管理モードへ入るための認証画面チェックです。
- def(admin_del) - 管理者削除モードのチェックです。
- echo(pass) - 管理パスです。
- echo(del/no) - 削除する記事の番号です。以下del/... は省略
- echo(del/chk) - 削除する画像のmd5です。
- echo(all) - 全画像合計サイズです。
- def(err_mode) - エラー画面のチェックです。
- echo(mes) - どのようなエラーが出るかのメッセージです。

### その他

- 下記のような書き方をする事でHTMLに影響を与えないコメントは書くことが出来ます。ただし「展開処理に渡された結果何もしない」という処理を経ているので、コメントとして使えば使うほどページの展開速度は遅くなっていくのでご注意ください。また、複数行にまたがって書くことはできないようです。
- \<% こんな風にタグ括弧内にコメントを書けますよ %>
- 複数行の場合、 `<% def(n) %> ～ <% /def %>`をコメントとして使用しています。("n"単独の変数は使用しないためhtmlに書き出されないのを応用)

## 改から改二へのテーマ(テンプレート)の置換
実は変数が同じなので、ほどんど置換が可能。[メモ](./memo.txt) にまとめています。

## 注意点

- <% echo(var) %>はvarが存在しないとエラーを吐きます。変数が存在しない可能性がある場合は、必ず<% def(var) %> ~ <% /def %>で囲ってください。
- スキンフォルダ内の.htaccessファイルは、テンプレートのhtmlファイルに直接アクセスできないようにするためのものです。セキュリティ向上のために同梱しています。スキン作成の際はコピーしてお使いください。

---

## 履歴

### [2020/07/14] v1.7.0

- 検索機能対応

### [2020/06/09] v1.6.15

- neoの新機能「ブラウザバック時に警告」対応

### [2020/06/08] v1.6.14

- neoが強力にキャッシュされるchrome83対策

### [2020/06/03] v1.6.13

- キャンバスサイズが大きい時にiPadやスマホで横スクロールができないの修正
- レス画像があるときに画像より名前が下に来るの修正

### [2020/06/03] v1.6.12

- 管理モードの削除画面からログがアップデートできないの修正

### [2020/06/02] v1.6.11

- scriptの位置修正（高速化）

### [2020/05/30] v1.6.10

- iOSのラベル対策

### [2020/05/28] v1.6.9

- コードの軽いミス修正

### [2020/05/28] v1.6.8

- Paint画面の戻るリンクを直接ジャンプに

### [2020/05/28] v1.6.7

- Paint画面のリンクを「戻る」のみに

### [2020/05/23] v1.6.6

- `<section>`と`<article>`の見直し
  - 表示がおかしくなったらスーパーリロード(ctrl+F5)お願いします。

### [2020/05/23] v1.6.5

- `</span>`のミス修正

### [2020/05/22] v1.6.4

- フォームのメール欄の位置修正

### [2020/05/22] v1.6.3

- mail欄復活

### [2020/05/22] v1.6.2

- SNS連携のミス修正

### [2020/05/22] v1.6.1

- Skinny → Skinny.php に表記変更

### [2020/05/22] v1.6.0

- `<SIIHELP>` 廃止に対応

### [2020/05/21] v1.5.5

- カタログモードでCheerpJの説明が残っていたの削除

### [2020/05/20] v1.5.4

- Paint画面でのピンチインが機能していなかったので修正

### [2020/05/20]

- スキン→テーマ(テンプレート)

### [2020/05/19]

- メモ更新

### [2020/05/19] v1.5.3

- 画像のリンクを別タブで開くように

### [2020/05/19] v1.5.2

- ライトボックス廃止

### [2020/05/19] v1.5.1

- パレットマトリックスとグラデーションがうまく動いていなかったのを修正。

### [2020/05/19] v1.5.0

- Firefoxでもしぃペインター起動可能に＆cheerpJのインストール不要に

### [2020/05/18] v1.4.8

- しぃペインターPro封印

### [2020/05/18] v1.4.7

- エラー対応

### [2020/05/18] v1.4.6

- しぃペインターを使わない際にはCheerpJの説明が出ないように変更
- スキン側cookieの有効期限をmax-ageに

### [2020/05/18] v1.4.5

- エラー画面の「リロード」を「戻る」に
- css切り替え部分の軽微なエラー軽減

### [2020/05/18] v1.4.4

- ユーザー削除の画像だけ消す復活

### [2020/05/18] v1.4.3

- 管理画面に画像のmd5表示

### [2020/05/18] v1.4.2

- ミス修正

### [2020/05/18] v1.4.1

- デフォルトのog.img追加

### [2020/05/17] v1.4.0

- スキンにカラーモード機能搭載
- それに伴ってcssフォルダ作成

### [2020/05/17] v1.3.4

- セキュリティ対策。
- 削除画面のユーザビリティ向上。

### [2020/05/17] v1.3.3

- セキュリティ対策。

### [2020/05/17] v1.3.2

- 動かなくなっていたので修正。

### [2020/05/17] v1.3.1

- スタイルシート、ndef整理。

### [2020/05/17] v1.3.0

- 「投稿者名をコピー」に対応。

### [2020/05/17] v1.2.2

- $addinfo 対応。`<li></li>`タグのみ入れてください。

### [2020/05/17] v1.2.1

- しぃペインターで続きを描く場合に通常版かpro版かの設定追加

### [2020/05/17] v1.2.0

- しぃペインター対応
- キャンバスサイズを選択式に
- カタログモードで表示する記事の数のデフォルト数変更
- .htaccess設定変更

### [2020/05/16] v1.1.0

- poti2.2.0の経過日数でミニレスフォームを閉じる、に対応

### [2020/05/16] v1.0.10

- `[BACK][NEXT]`調整
- selectの縦位置調整

### [2020/05/15] v1.0.9

- elsedef整理

### [2020/05/15] v1.0.8

- スマホ時の横幅を広く
- wondercatstudioへのリンクを削除
- レッツPHPへのリンク変更

### [2020/05/15] v1.0.7

- hrのスタイルが不安定なのを解消

### [2020/05/15] v1.0.6

- HTMLのコメントをHTMLとして正しく
- 「その他」（コメントに関して）追加

### [2020/05/15] v1.0.5

- readme整理
- Skinnyのバージョンを削除

### [2020/05/15] v1.0.4

- 一番下へボタン、一番上へボタン追加
- デザイン調整

### [2020/05/15] v1.0.3

- スレッドタイトルの背景など

### [2020/05/14] v1.0.0

- 初版