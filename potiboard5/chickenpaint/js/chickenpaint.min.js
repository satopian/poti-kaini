/*
    litaChix
    https://github.com/satopian/ChickenPaint_Be
    by satopian
    Customized from ChickenPaint by Nicholas Sherlock.
    GNU GENERAL PUBLIC LICENSE
    Version 3, 29 June 2007
    <http://www.gnu.org/licenses/>
*/
/*
    ChickenPaint

    ChickenPaint is a translation of ChibiPaint from Java to JavaScript
    by Nicholas Sherlock / Chicken Smoothie.

    ChibiPaint is Copyright (c) 2006-2008 Marc Schefer

    ChickenPaint is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    ChickenPaint is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with ChickenPaint. If not, see <http://www.gnu.org/licenses/>.
*/
!function(){function Ja(b){return b&&b.__esModule?b.default:b}function wa(b){for(var c in wa.DEFAULTS)wa.DEFAULTS.hasOwnProperty(c)&&(this[c]=wa.DEFAULTS[c]);for(c in b)b.hasOwnProperty(c)&&(this[c]=b[c])}function Ba(b,c,d,a){this.left=b;this.top=c;this.right=d;this.bottom=a}function Uc(b,c){this.width=0|b;this.height=0|c}function Vc(b,c){var d=document.createElement("canvas");return d.width=b,d.height=c,d}function ie(b,c){return document.createElement("canvas").getContext("2d").createImageData(b,
c)}function J(b,c){"number"==typeof b?(Uc.call(this,b,c),this.imageData=ie(this.width,this.height)):(Uc.call(this,b.width,b.height),this.imageData=b);this.data=this.imageData.data}function Se(b,c,d,a){var h,q=0,f=[0,0,0,0];var e=0;for(h=0;h<a&&h<d;h++){for(var k=0;k<J.BYTES_PER_PIXEL;k++)f[k]+=b[e++];q++}h=0;for(k=0;k<d;k++){if(k+a<d){e=(k+a)*J.BYTES_PER_PIXEL;for(var l=0;l<J.BYTES_PER_PIXEL;l++)f[l]+=b[e++];q++}for(e=0;e<J.BYTES_PER_PIXEL;e++)c[h++]=Math.round(f[e]/q);if(k-a>=0){e=(k-a)*J.BYTES_PER_PIXEL;
for(l=0;l<J.BYTES_PER_PIXEL;l++)f[l]-=b[e++];q--}}}function Te(b,c){if(0==(c%=4))return b;let d=Vc(0,0),a=d.getContext("2d");switch(c%2==0?(d.width=b.width,d.height=b.height):(d.width=b.height,d.height=b.width),c){case 1:a.rotate(Math.PI/2);a.drawImage(b,0,-b.height);break;case 2:a.rotate(Math.PI);a.drawImage(b,-b.width,-b.height);break;case 3:a.rotate(-Math.PI/2);a.drawImage(b,-b.width,0);break;default:return b}return d}function $a(b="",c=0){db.call(this,b);this.layers=[];this.expanded=!0;this.blendMode=
c}function Yf(b,c){return b+c}function Pa(b,c,d){Uc.call(this,b,c);this.createBitmap(b,c,d)}function Ue(b,c,d,a){var h,q=0,f=0;for(h=0;h<a&&h<d;h++)f+=b[h],q++;h=0;for(let e=0;e<d;e++)e+a<d&&(f+=b[e+a],q++),c[h++]=Math.round(f/q),e-a>=0&&(f-=b[e-a],q--)}function Q(){}function db(b){this.name=b||"";this.parent=null;this.lockAlpha=!1;this.alpha=100;this.visible=!0;this.blendMode=Q.LM_NORMAL;this.mask=null;this.maskVisible=this.maskLinked=!0;this.maskThumbnail=null;this.useLegacyMultiply=!1}function Fa(b,
c,d){db.call(this,d);b>0&&c>0?this.image=new J(b,c):this.image=null;this.clip=!1;this.imageThumbnail=null}function td(b,c,d){d?(this.isGroup=d instanceof $a,this.image=d.image,this.mask=d.getEffectiveMask(),this.layer=d,this.blendMode=d.blendMode,this.alpha=d.alpha,this.visible=d.visible):(this.isGroup=!0,this.image=null,this.mask=null,this.layer=null,this.blendMode=Q.LM_PASSTHROUGH,this.alpha=100,this.visible=!0);this.dirtyRect=new Ba(0,0,b,c);this.layers=[];this.parent=null;this.clip=!1}function je(b,
c,d,a){function h(){return l.length>0?l.pop():new J(c,d)}function q(m){if(0==m.layers.length)return null;if(1==m.layers.length&&(null==m.mask||null==m.layers[0].mask)){let p=m.layers[0];return p.alpha=Math.round(m.alpha*p.alpha/100),m.blendMode!=Q.LM_PASSTHROUGH&&(p.blendMode=m.blendMode),p.mask=m.mask||p.mask,m.layer&&g.set(m.layer,p),p}return m.blendMode==Q.LM_PASSTHROUGH&&100==m.alpha&&null==m.mask?m.layers:(m.image=h(),m)}function f(m){let p=new td(c,d,m);return g.set(m,p),p}function e(m,p){m&&
(m.dirtyRect.union(p),e(m.parent,p))}let k,l=[],g=new Map;this.invalidateLayerRect=function(m,p){e(g.get(m),p)};this.buildTree=function(){if(!k){if(k=function n(p){if(0==p.getEffectiveAlpha())return null;let t=f(p);for(var u=0;u<p.layers.length;u++){let A=p.layers[u];var v=p.layers[u+1];if(A instanceof Fa&&v&&v.clip){v=new td(c,d,null);v.blendMode=A.blendMode;v.alpha=100;v.clip=!0;v.addChildren(f(A));for(u+=1;u<p.layers.length;u++)if(p.layers[u].clip)p.layers[u].getEffectiveAlpha()>0&&v.addChildren(f(p.layers[u]));
else break;A.getEffectiveAlpha()>0&&t.addChildren(q(v));--u}else A instanceof $a?t.addChildren(n(A)):A.getEffectiveAlpha()>0&&t.addChildren(f(A))}return q(t)}(b)){if(Array.isArray(k)||a&&(k.alpha<100||k.mask)){let p=k;(k=new td(c,d)).blendMode=Array.isArray(p)?Q.LM_NORMAL:p.blendMode;k.alpha=100;k.image=h();k.addChildren(p)}}else(k=new td(c,d,{image:h(),blendMode:Q.LM_NORMAL,alpha:100,getEffectiveMask:()=>null,visible:!0})).image.clearAll(0);l=[]}};this.resetTree=function(){k&&(!function n(p){if(p.isGroup)for(let t of(p.image&&
l.push(p.image),p.layers))n(t)}(k),k=null,g.clear())};this.layerPropertyChanged=function(m,p){let n=g.get(m);n&&n.visible==m.visible&&n.alpha==m.alpha&&null==n.mask==(null==m.getEffectiveMask())&&n.blendMode==Q.LM_PASSTHROUGH==(m.blendMode==Q.LM_PASSTHROUGH)&&"clip"!==p?(n.blendMode=m.blendMode,e(n,new Ba(0,0,c,d))):this.resetTree()};this.blendTree=function(){return function n(p){if(!p||!p.isGroup)return p;let t=p.dirtyRect;var u=!0,v=!0;if(p.blendMode==Q.LM_PASSTHROUGH&&p.parent&&t.union(p.parent.dirtyRect),
t.isEmpty())return p;if(p.blendMode==Q.LM_PASSTHROUGH&&p.parent){u=!1;var A=p.image;var D=p.parent.image;t.getWidth()==A.width&&t.getHeight()==A.height?A.copyPixelsFrom(D):Q.replaceOntoFusionWithOpaqueLayer(A,D,100,t)}for(A=0;A<p.layers.length;A++){var y=n(p.layers[A]);if(u){u=p.image;D=y.image;var E=y.alpha,x=t;y=y.mask;if(100!=E||y||x.getWidth()!=u.width||x.getHeight()!=u.height){let G="replaceOntoFusionWith";100==E?G+="OpaqueLayer":G+="TransparentLayer";y&&(G+="Masked");Q[G](u,D,E,x,y)}else u.copyPixelsFrom(D);
!0;u=!1}else v=v&&p.image.hasAlphaInRect(t),Q.fuseImageOntoImage(p.image,v,y.image,y.alpha,y.blendMode,t,y.mask)}p.clip&&(v=p.layers[0],v.alpha<100?v.mask?Q.replaceAlphaOntoFusionWithTransparentLayerMasked(p.image,v.image,v.alpha,t,v.mask):Q.replaceAlphaOntoFusionWithTransparentLayer(p.image,v.image,v.alpha,t):v.mask?Q.replaceAlphaOntoFusionWithOpaqueLayerMasked(p.image,v.image,100,t,v.mask):Q.replaceAlphaOntoFusionWithOpaqueLayer(p.image,v.image,100,t));return p.dirtyRect.makeEmpty(),p}(k)}}function Zf(){function b(g){if(null!=
h&&g.curSize==q&&g.curSqueeze==f&&g.curAngle==e&&g.tip==k)return h;switch(g.tip){case wa.TIP_ROUND_AIRBRUSH:!function(m,p){if(p.curSize<1){var n=p.curSize/2;m[0]=0|Math.min(255,Math.PI*n*n*255)}else{n=p.curSize;var t=n/2,u=p.curSize/2*(p.curSize/2),v=1+10*p.curSqueeze,A=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var D=0;for(let x=0;x<n;x++)for(let G=0;G<n;G++){var y=G+.5-t;let I=x+.5-t;var E=(y*A-I*p)*v;y=I*A+y*p;E=E*E+y*y;E<=u?m[D++]=~~(255*(1-E/u)):m[D++]=0}}}(c,g);break;case wa.TIP_ROUND_AA:!function(m,
p){if(p.curSize<1){var n=p.curSize/2;m[0]=0|Math.min(255,Math.PI*n*n*255)}else{var t=p.curSize;n=Math.ceil(t);var u=n/2,v=t/2;v*=v;var A=Math.pow((t-2)/2,2);t=Math.pow((t+2)/2,2);var D=1+10*p.curSqueeze,y=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var E=0;for(let B=0;B<n;B++)for(let N=0;N<n;N++){var x=N+.5-u,G=B+.5-u,I=(x*y-G*p)*D;x=G*y+x*p;I=I*I+x*x;if(I<=A)m[E++]=255;else if(I>t)m[E++]=0;else{I=0;for(x=0;x<4;x++)for(G=0;G<4;G++){var O=N+.25*G-u;let P=B+.25*x-u,L=(O*y-P*p)*D;O=P*y+O*p;L*L+O*O<=
v&&(I+=1)}m[E++]=Math.min(16*I,255)}}}}(c,g);break;case wa.TIP_ROUND_PIXEL:!function(m,p){let n=Math.max(p.curSize,1),t=n/2,u=p.curSize/2*(p.curSize/2),v=1+10*p.curSqueeze,A=Math.cos(p.curAngle);p=Math.sin(p.curAngle);let D=0;for(let E=0;E<n;E++)for(let x=0;x<n;x++){var y=x+.5-t;let G=E+.5-t,I=(y*A-G*p)*v;y=G*A+y*p;I*I+y*y<=u?m[D++]=255:m[D++]=0}}(c,g);break;case wa.TIP_SQUARE_AA:!function(m,p){if(p.curSize<1){var n=p.curSize/2;m[0]=0|Math.min(255,Math.PI*n*n*255)}else{n=p.curSize;var t=n/2,u=p.curSize*
Math.sin(Math.PI/4),v=u/2/(1+10*p.curSqueeze);u/=2;var A=v-1,D=u-1,y=v+1,E=u+1,x=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var G=0;for(let O=0;O<n;O++)for(let B=0;B<n;B++){var I=B+.5-t;let N=O+.5-t,P=Math.abs(I*x-N*p);I=Math.abs(N*x+I*p);if(P<=A&&I<=D)m[G++]=255;else if(P>y||I>E)m[G++]=0;else{let L=0;for(let ia=0;ia<4;ia++)for(let V=0;V<4;V++)P=Math.abs((I=B+(V+.5)*.25-t)*x-(N=O+(ia+.5)*.25-t)*p),I=Math.abs(N*x+I*p),P<=v&&I<=u&&L++;m[G++]=Math.min(16*L,255)}}}}(c,g);break;case wa.TIP_SQUARE_PIXEL:!function(m,
p){if(p.curSize<2)m[0]=255;else{var n=p.curSize,t=n/2,u=p.curSize*Math.sin(Math.PI/4),v=u/2/(1+10*p.curSqueeze);u/=2;var A=Math.cos(p.curAngle);p=Math.sin(p.curAngle);var D=0;for(let y=0;y<n;y++)for(let E=0;E<n;E++){let x=E+.5-t,G=y+.5-t,I=Math.abs(G*A+x*p);Math.abs(x*A-G*p)<=v&&I<=u?m[D++]=255:m[D++]=0}}}(c,g)}return h=c,q=g.curSize,k=g.tip,f=g.curSqueeze,e=g.curAngle,c}let c=new Uint8Array(160801),d=new Uint8Array(161604),a=[new Float32Array(402),new Float32Array(402)],h=null,q,f,e,k,l=this;this.getDab=
function(g,m,p){let n={alpha:p.curAlpha,width:Math.ceil(p.curSize),height:Math.ceil(p.curSize)},t=p.isAA&&p.tip!=wa.TIP_ROUND_PIXEL;t&&(n.width++,n.height++);g=g-n.width/2+.5;m=m-n.height/2+.5;let u=Math.floor(g),v=Math.floor(m);return t?n.brush=function(A,D,y){var E=b(A);let x=A.curSize;A=Math.ceil(A.curSize)+1;let G=(1-D)*(1-y),I=D*(1-y),O=D*y,B=(1-D)*y,N=0;D=0;y=a[0];let P=a[1];y.fill(0);for(let ia=0;ia<x;ia++){var L=0;for(P[0]=0;L<x;L++,N++,D++){let V=E[N];d[D]=y[L]+V*G+.5|0;y[L+1]+=V*I;P[L]+=
V*B;P[L+1]=V*O}d[D++]=y[L]+.5|0;L=y;y=P;P=L}for(E=0;E<A;E++,D++)d[D]=y[E]+.5|0;return d}(p,g-u,m-v):n.brush=b(p),n.x=u,n.y=v,p.texture>0&&null!=this.texture&&(n.brush==c&&(d.set(c),n.brush=d),!function(A,D){D=Math.floor(255*D);let y=l.texture,E=A.x%y.width,x=A.y%y.height,G=0,I,O;E<0&&(E+=y.width);x<0&&(x+=y.height);for(let B=0;B<A.height;B++){I=x*y.width+E;O=x*y.width+y.width;for(let N=0;N<A.width;N++)A.brush[G]=~~(A.brush[G]*(y.data[I]*D/255^255)/255),G++,++I==O&&(I-=y.width);++x==y.height&&(x=0)}}(n,
p.texture)),n};this.setTexture=function(g){this.texture=g}}function ke(b,c,d){this.bmp=b;this.x=c;this.y=d}function Fd(b){if(0==b.saturation)return b.value<<16|b.value<<8|b.value;var c=b.hue/60;c-=Math.floor(c);var d=b.saturation/255,a=~~(b.value*(1-d)),h=~~(b.value*(1-d*c));c=~~(b.value*(1-d*(1-c)));switch(~~(b.hue/60)){case 0:return b.value<<16|c<<8|a;case 1:return h<<16|b.value<<8|a;case 2:return a<<16|b.value<<8|c;case 3:return a<<16|h<<8|b.value;case 4:return c<<16|a<<8|b.value;case 5:return b.value<<
16|a<<8|h;default:return 0}}function jb(b){this.value=this.saturation=this.hue=this.rgb=0;this.setRgb(b||0)}function $f(){var b,c=!1;this.nextGaussian=function(){if(c)return c=!1,b;do var d=(a=2*Math.random()-1)*a+(h=2*Math.random()-1)*h;while(d>=1||0==d);var a,h;d=Math.sqrt(-2*Math.log(d)/d);return b=h*d,c=!0,a*d}}function qb(){this.setToIdentity()}function rc(b,c,d){this.r=b;this.g=c;this.b=d}function Ve(b){let c=0;for(let d=0;d<b.length;d++)c+=b[d];return c/b.length}function We(b,c){let d=b.data;
if(c.left>0)for(var a=c.top;a<c.bottom;a++){var h=a*b.width,q=h;h=d[h+c.left];for(var f=0;f<c.left;f++,q++)d[q]=h}if(c.right<b.width)for(a=c.top;a<c.bottom;a++)for(q=a*b.width+c.right,h=d[q-1],f=c.right;f<b.width;f++,q++)d[q]=h;a=0;for(q=0;q<c.top;q++)for(h=c.top*b.width,f=0;f<b.width;f++,h++,a++)d[a]=d[h];a=c.bottom*b.width;for(q=c.bottom;q<b.width;q++)for(h=(c.bottom-1)*b.width,f=0;f<b.width;f++,h++,a++)d[a]=d[h]}function Gd(b,c){return b+c}function Xe(b){return b?b.width*b.height*4:0}function dc(b,
c){function d(C){mb=!1;(wc.size>0||nb.size>0)&&(C?e():kb||setTimeout(e,1E3))}function a(){W.emitEvent("changeSelection",[])}function h(C){W.emitEvent("updateRegion",[C])}function q(){W.emitEvent("changeStructure");Ca.resetTree();u();h(W.getBounds())}function f(C,M,X){W.emitEvent("changeLayer",[C]);X||(Ca.layerPropertyChanged(C,M),h(W.getBounds()))}function e(){for(let C of wc)C.rebuildImageThumbnail(),W.emitEvent("changeLayerImageThumb",[C]);for(let C of nb)C.rebuildMaskThumbnail(),W.emitEvent("changeLayerMaskThumb",
[C]);wc.clear();kb&&(clearTimeout(kb),kb=null)}function k(C,M,X,Y){Array.isArray(C)||(C=[C]);C.forEach(aa=>Ca.invalidateLayerRect(aa,M));let ca=!1;if(X)for(let aa of(sa.union(M),C))aa instanceof Fa&&(wc.add(aa),ca=!0);Y&&(w.union(M),C.forEach(aa=>{nb.add(aa);Ga&&Ga.layer==aa&&Ga.invalidateRect(M)}),ca=!0);ca&&(kb&&(clearTimeout(kb),kb=null),mb||(kb=setTimeout(e,1E3)));h(M)}function l(C,M){k(C,M,!la,la)}function g(){return la?ba.mask:ba.image}function m(){if(!U.isEmpty()){if(la){var C=ba.mask;lb.brushMode==
wa.BRUSH_MODE_ERASE?Z[wa.BRUSH_MODE_PAINT].mergeOntoMask(C,ea,4278190080):Z[lb.brushMode].mergeOntoMask(C,ea,255&Mb)}else{C=ba.image;let M=ba.getLockAlpha();lb.brushMode==wa.BRUSH_MODE_ERASE&&M?Z[wa.BRUSH_MODE_PAINT].mergeOntoImage(C,ha,16777215):Z[lb.brushMode].mergeOntoImage(C,ha,Mb);M&&C.copyAlphaFrom(ha,U)}U.makeEmpty()}}function p(){ba instanceof Fa&&!sa.isEmpty()&&(ha.copyBitmapRect(ba.image,sa.left,sa.top,sa),sa.makeEmpty())}function n(){ba.mask&&!w.isEmpty()&&(ea.copyBitmapRect(ba.mask,w.left,
w.top,w),w.makeEmpty())}function t(){la?n():p()}function u(){let C=W.getBounds();sa.set(C);w.set(C)}function v(C){W.setHasUnsavedChanges(!0);Fb.length>0&&(Fb=[]);0!==hb.length&&hb[hb.length-1].merge(C)?hb[hb.length-1].noChange()&&hb.pop():(hb.length>=30&&hb.shift(),W.compactUndo(),hb.push(C))}function A(C,M){C||M||(C=!la,M=la);let X=pa.clone(),Y=C?ha.copyRectXOR(ba.image,X):null,ca=M?ea.copyRectXOR(ba.mask,X):null;this.layer=ba;pa.makeEmpty();this.redo=this.undo=function(){Y&&this.layer.image.setRectXOR(Y,
X);ca&&this.layer.mask.setRectXOR(ca,X);k(this.layer,X,null!=Y,null!=ca)};this.getMemoryUsed=function(aa,va){return(Y?Y.length:0)+(ca?ca.length:0)}}function D(C){let M=C.maskLinked,X=C.maskVisible;this.undo=function(){C.setMask(null);C.maskLinked=M;C.maskVisible=X;q();W.setActiveLayer(C,!1)};this.redo=function(){let Y=new Pa(W.width,W.height,8);Y.clearAll(255);C.maskLinked=!0;C.maskVisible=!0;C.setMask(Y);q();W.setActiveLayer(C,!0)};this.redo()}function y(C,M){let X=C.mask,Y,ca=!1;Y=M&&C instanceof
Fa?C.image.clone():null;ca=ba==C&&la;this.undo=function(){C.setMask(X);Y&&(C.image.copyPixelsFrom(Y),k(C,C.image.getBounds(),!0,!1));ca&&W.setActiveLayer(C,!0);q()};this.redo=function(){Y&&(Q.multiplyAlphaByMask(C.image,100,C.mask),k(C,W.getBounds(),!0,!1));ca&&W.setActiveLayer(C,!1);C.setMask(null);q()};this.redo()}function E(C,M,X){let Y=X instanceof Fa&&X.clip,ca=C.layers[M],aa=ca instanceof Fa&&ca.clip,va=la;this.undo=function(){C.removeLayer(X);let Ma=C.layers[M-1]||C.layers[0]||C;ca instanceof
Fa&&(ca.clip=aa);X instanceof Fa&&(X.clip=Y);q();W.setActiveLayer(Ma,va)};this.redo=function(){C.insertLayer(M,X);aa&&(X instanceof Fa?X.clip=!0:ca.clip=!1);q();W.setActiveLayer(X,!1)};this.redo()}function x(C){let M=C.clone(),X=la;this.undo=function(){M.parent.removeLayer(M);q();W.setActiveLayer(C,X)};this.redo=function(){let Y=C.name;Y.endsWith(" Copy")||(Y+=" Copy");M.name=Y;C.parent.insertLayer(C.parent.indexOf(C)+1,M);q();W.setActiveLayer(M,!1)};this.redo()}function G(C){let M=C.parent,X=M.indexOf(C),
Y=la,ca=0;if(C instanceof Fa&&!C.clip)for(let aa=X+1;aa<M.layers.length;aa++)if(M.layers[aa]instanceof Fa&&M.layers[aa].clip)ca++;else break;this.undo=function(){M.insertLayer(X,C);for(let aa=0;aa<ca;aa++)M.layers[aa+X+1].clip=!0;q();W.setActiveLayer(C,Y)};this.redo=function(){var aa;for(aa=0;aa<ca;aa++)M.layers[aa+X+1].clip=!1;M.removeLayerAtIndex(X);aa=0==M.layers.length?C.parent:M.layers[Math.max(X-1,0)];q();W.setActiveLayer(aa,!1)};this.getMemoryUsed=function(aa,va){return aa?0:C.getMemoryUsed()};
this.redo()}function I(C){let M=C.parent.indexOf(C),X=la,Y=new Fa(W.width,W.height,"");this.undo=function(){C.parent.setLayerAtIndex(M,C);q();W.setActiveLayer(C,X)};this.redo=function(){C.parent.setLayerAtIndex(M,Y);q();W.setActiveLayer(Y,!1)};this.getMemoryUsed=function(aa,va){return aa?0:C.getMemoryUsed()};var ca=new je(C,W.width,W.height,!1);ca.buildTree();ca=ca.blendTree();Y.name=C.name;Y.alpha=ca.alpha;Y.image=ca.image;Y.blendMode=ca.blendMode;Y.mask=ca.mask;Y.blendMode==Q.LM_PASSTHROUGH&&(Y.blendMode=
Q.LM_NORMAL);this.redo()}function O(C){let M=C.parent,X=M.layers[M.indexOf(C)-1],Y=new Fa(W.width,W.height,""),ca=la;this.undo=function(){let aa=M.indexOf(Y);M.removeLayerAtIndex(aa);M.insertLayer(aa,C);M.insertLayer(aa,X);q();W.setActiveLayer(C,ca)};this.redo=function(){if(X.clip||!C.clip)Y.copyFrom(X),C.getEffectiveAlpha()>0&&(Y.mask?Q.multiplyAlphaByMask(Y.image,Y.alpha,Y.mask):Q.multiplyAlphaBy(Y.image,Y.alpha),Q.fuseImageOntoImage(Y.image,!0,C.image,C.alpha,C.blendMode,C.getBounds(),C.mask));
else{var aa=new $a;aa.layers=[X,C];aa.parent=null;aa.name="Temporary Group";aa=new je(aa,W.width,W.height,!1);aa.buildTree();Y.image=aa.blendTree().image}Y.name=X.name;Y.alpha=100;Y.blendMode=X.blendMode;Y.mask=null;aa=M.indexOf(X);M.removeLayerAtIndex(aa);M.removeLayerAtIndex(aa);M.insertLayer(aa,Y);q();W.setActiveLayer(Y,!1)};this.getMemoryUsed=function(aa,va){return aa?0:C.getMemoryUsed()+Y.getMemoryUsed()};this.redo()}function B(C=!1){let M=W.getActiveLayer(),X=da.layers.slice(0),Y=new Fa(W.width,
W.height,"");this.undo=function(){da.layers=X.slice(0);q();W.setActiveLayer(M,!1)};this.redo=function(){let ca=W.fusionLayers();Y.copyImageFrom(ca);Y.setName(W.getDefaultLayerName(!1));C?da.layers=X.slice(0):da.clearLayers();da.addLayer(Y);q();W.setActiveLayer(Y,!1)};this.getMemoryUsed=function(ca,aa){return X.map(va=>va.getMemoryUsed()).reduce(Gd,0)};this.redo()}function N(C,M=Q.LM_NORMAL){if(!la){var X=W.getActiveLayer(),Y=da.layers.slice(0),ca=new Fa(W.width,W.height,"");this.undo=function(){da.layers=
Y.slice(0);q();W.setActiveLayer(X,!1)};this.redo=function(){var aa=W.fusionLayers();ca.copyImageFrom(aa);ca.setName(W.getDefaultLayerName(!1));ca.setBlendMode(M);da.layers=Y.slice(0);da.addLayer(ca);q();W.setActiveLayer(ca,!1);aa=W.getSelectionAutoSelect();let va=g();va&&(t(),pa=aa.clone(),C(va,aa),l(ba,aa))};this.redo()}}function P(C,M,X){let Y=C.parent,ca=C.parent.indexOf(C),aa=la,va=Y.layers[Y.indexOf(C)+1],Ma=M.layers[X],ab=C instanceof Fa&&C.clip,Yb=!!ab&&C.getClippingBase(),Ub=0,Pb=0;if(C instanceof
Fa&&!C.clip)for(var Kb=ca+1;Kb<Y.layers.length;Kb++)if(Y.layers[Kb]instanceof Fa&&Y.layers[Kb].clip)Ub++;else break;else if(C instanceof $a)for(Kb=X;Kb<M.layers.length;Kb++)if(M.layers[Kb]instanceof Fa&&M.layers[Kb].clip)Pb++;else break;this.undo=function(){C.parent.removeLayer(C);var vb=va?Y.indexOf(va):Y.layers.length;Y.insertLayer(vb,C);C instanceof Fa&&(C.clip=ab);for(vb=0;vb<Ub;vb++)Y.layers[vb+ca+1].clip=!0;for(vb=0;vb<Pb;vb++)M.layers[vb+X].clip=!0;q();W.setActiveLayer(C,aa)};this.redo=function(){for(var vb=
0;vb<Ub;vb++)Y.layers[vb+ca+1].clip=!1;C.parent.removeLayer(C);vb=Ma?M.indexOf(Ma):M.layers.length;M.insertLayer(vb,C);for(var Vb=0;Vb<Pb;Vb++)M.layers[Vb+vb+1].clip=!1;C instanceof Fa&&(C.clip&&C.getClippingBase()!=Yb&&(C.clip=!1),Ma instanceof Fa&&Ma.clip&&(C.clip=!0));for(Vb=0;Vb<Pb;Vb++)M.layers[Vb+vb+1].clip=!1;q();W.setActiveLayer(C,!1)};this.redo()}function L(C,M){let X=C.substring(0,1).toUpperCase()+C.substring(1),Y=function(ca,aa){Array.isArray(ca)||(ca=[ca]);this.layers=ca;this.from=this.layers.map(va=>
va["get"+X]());this.to=aa;this.redo()};return Y.prototype=Object.create(Zb.prototype),Y.prototype.constructor=Y,Y.prototype.undo=function(){this.layers.forEach((ca,aa)=>ca["set"+X](this.from[aa]));this.layers.forEach(ca=>f(ca,C,!M))},Y.prototype.redo=function(){this.layers.forEach(ca=>ca["set"+X](this.to));this.layers.forEach(ca=>f(ca,C,!M))},Y.prototype.merge=function(ca){var aa;if(aa=ca instanceof Y)a:{aa=this.layers;var va=ca.layers;if(aa.length!=va.length)aa=!1;else{for(let Ma=0;Ma<aa.length;Ma++)if(aa[Ma]!=
va[Ma]){aa=!1;break a}aa=!0}}return!!aa&&(this.to=ca.to,!0)},Y.prototype.noChange=function(){for(let ca=0;ca<this.from.length;ca++)if(this.from[ca]!=this.to)return!1;return!0},Y}function ia(C,M){C=C.clone();M=M.clone();this.undo=function(){W.setSelection(C);h(W.getBounds())};this.redo=function(){W.setSelection(M);h(W.getBounds())};this.noChange=function(){return C.equals(M)}}function V(C,M,X){let Y=M?C.mask:C.image,ca=Y.cloneRect(X);X=X.clone();this.undo=function(){Y.copyBitmapRect(ca,X.left,X.top,
ca.getBounds());W.setActiveLayer(C,M);W.setSelection(X);k(C,X,!M,M)};this.redo=function(){M?Y.clearRect(X,0):Y.clearRect(X,16777215);ob=new ke(ca,X.left,X.top);W.setActiveLayer(C,M);W.emptySelection();k(C,X,!M,M)};this.getMemoryUsed=function(aa,va){return ca==va?0:ca.getMemorySize()};this.redo()}function ma(C){let M=W.getSelection(),X=la,Y=new Fa(W.width,W.height,W.getDefaultLayerName(!1)),ca=ba,aa=ca.parent;this.undo=function(){aa.removeLayer(Y);W.setSelection(M);q();W.setActiveLayer(ca,X)};this.redo=
function(){var va=aa.indexOf(ca);let Ma=C.bmp.getBounds(),ab,Yb;(aa.insertLayer(va+1,Y),Ma.isInside(W.getBounds())?(ab=C.x,Yb=C.y):(ab=(W.width-C.bmp.width)/2|0,Yb=(W.height-C.bmp.height)/2|0),C.bmp instanceof Pa)?(va=new J(C.bmp.width,C.bmp.height),va.copyPixelsFromGreyscale(C.bmp),Y.image.copyBitmapRect(va,ab,Yb,Ma)):Y.image.copyBitmapRect(C.bmp,ab,Yb,Ma);W.emptySelection();q();W.setActiveLayer(Y,!1)};this.getMemoryUsed=function(va,Ma){return C.bmp==Ma?0:C.bmp.getMemorySize()};this.redo()}b|=0;
c|=0;let da=new $a("Root",Q.LM_NORMAL),Ca=new je(da,b,c,!0),ha=new J(b,c),sa=new Ba(0,0,b,c),ea=new Pa(b,c,8),w=new Ba(0,0,b,c),H=new Pa(b,c,32),U=new Ba(0,0,0,0),na=new Zf,W=this,Z=[],ba=da,la=!1,Ga=null,pa=new Ba(0,0,0,0),ya=!1,rb=new Ba(0,0,0,0),bb=null,Qb=new $f,Ia=null,ob=null,hb=[],Fb=[],lb=null,wb=0,sc=0,Lb=0,yb=!1,mb=!1,nb=new Set,wc=new Set,kb=null,Mb=0,oc="smooth";this.texture=null;this.getLayersRoot=function(){return da};this.getSelectionAutoSelect=function(){return rb.isEmpty()?this.getBounds():
this.getSelection()};this.getSelection=function(){return rb.clone()};this.setHasUnsavedChanges=function(C){C!=ya&&(ya=C,this.emitEvent("unsavedChanges",[C]))};this.getHasUnsavedChanges=function(){return ya};this.isAddLayerMaskAllowed=function(){return!ba.mask};this.addLayerMask=function(){this.isAddLayerMaskAllowed()&&v(new D(ba))};this.isRemoveLayerMaskAllowed=function(){return null!==ba.mask};this.removeLayerMask=function(){this.isRemoveLayerMaskAllowed()&&v(new y(ba,!1))};this.isApplyLayerMaskAllowed=
function(){return null!==ba.mask&&ba instanceof Fa};this.applyLayerMask=function(C){this.isApplyLayerMaskAllowed()&&v(new y(ba,!0))};this.addLayer=function(C){let M,X;if(ba instanceof $a&&ba.expanded?(M=ba,X=ba.layers.length):X=(M=ba.parent).layers.indexOf(ba)+1,"group"===C){for(;M.layers[X]instanceof Fa&&M.layers[X].clip;)X++;C=new $a(this.getDefaultLayerName(!0),Q.LM_PASSTHROUGH)}else(C=new Fa(this.width,this.height,this.getDefaultLayerName(!1))).image.clearAll(16777215);return v(new E(M,X,C)),
C};this.addLayerObject=function(C,M){C.addLayer(M);C==da&&1==da.layers.length&&(ba=M);q()};this.addLayerGroupObject=function(C,M,X){let Y=[];for(let ca=0;ca<X;ca++)Y.unshift(C.layers.pop());Y.forEach(ca=>M.addLayer(ca));this.addLayerObject(C,M)};this.isRemoveLayerAllowed=function(){return ba instanceof Fa?da.getLinearizedLayerList(!1).some(C=>C instanceof Fa&&C!=ba):ba instanceof $a&&da.getLinearizedLayerList(!1).some(C=>C instanceof Fa&&!C.hasAncestor(ba))};this.removeLayer=function(){return!!this.isRemoveLayerAllowed()&&
(v(new G(ba)),!0)};this.duplicateLayer=function(){v(new x(ba))};this.isMergeDownAllowed=function(){let C=ba.parent.indexOf(ba);return C>0&&ba instanceof Fa&&ba.parent.layers[C-1]instanceof Fa};this.mergeDown=function(){this.isMergeDownAllowed()&&v(new O(ba))};this.isMergeGroupAllowed=function(){return ba instanceof $a&&ba.getEffectiveAlpha()>0};this.mergeGroup=function(){this.isMergeGroupAllowed()&&v(new I(ba))};this.isMergeAllLayersAllowed=function(){return da.getLinearizedLayerList(!1).length>1};
this.mergeAllLayers=function(C=!1){this.isMergeAllLayersAllowed()&&v(new B(C))};this.relocateLayer=function(C,M,X){C&&M&&C!=M&&!M.hasAncestor(C)&&v(new P(C,M,X))};this.setLayerVisibility=function(C,M){let X=[];if(C.ancestorsAreVisible())C.visible!=M&&v(new ec(C,M));else{for(;null!=C;C=C.parent)C.visible||X.push(C);v(new ec(X,!0))}};this.expandLayerGroup=function(C,M){C.expanded!=M&&(C.expanded=M,!M&&ba.hasAncestor(C)&&this.setActiveLayer(C,!1),f(C,"expanded",!0))};this.setLayerAlpha=function(C){ba.getAlpha()!=
C&&v(new Hc(ba,C))};this.setLayerMaskLinked=function(C){ba.maskLinked!=C&&v(new xc(ba,C))};this.setLayerMaskVisible=function(C,M){C.maskVisible!=M&&v(new ac(C,M))};this.setLayerBlendMode=function(C){ba.getBlendMode()!=C&&(C!=Q.LM_PASSTHROUGH||ba instanceof $a)&&v(new Wc(ba,C))};this.setLayerName=function(C,M){C.getName()!=M&&v(new fc(C,M))};this.paintDab=function(C,M,X,Y=!1){if(lb){lb.applyPressure(X,Y);lb.scattering>0&&(C+=Qb.nextGaussian()*lb.curScattering/4,M+=Qb.nextGaussian()*lb.curScattering/
4);X=Z[lb.brushMode];C=na.getDab(C,M,lb);var ca=new Ba(0,0,C.width,C.height);M=new Ba(0,0,C.width,C.height);if(M.translate(C.x,C.y),W.getBounds().clipSourceDest(ca,M),!M.isEmpty()){pa.union(M);Y=la?ba.mask:ba.image;var aa=yb&&!la?bb:Y,va=la?null:W.getSelection();if(!va||va.isEmpty())X.paintDab(Y,M,aa,lb,ca,C,Mb);else{ca=M.getIntersection(va,!0);if(!ca||ca.isEmpty()||(ca.left=Math.max(0,ca.left),ca.top=Math.max(0,ca.top),ca.right=Math.min(Y.width,ca.right),ca.bottom=Math.min(Y.height,ca.bottom),ca.isEmpty()))return;
va=new Ba(ca.left-C.x,ca.top-C.y,ca.left-C.x+ca.getWidth(),ca.top-C.y+ca.getHeight());X.paintDab(Y,ca,aa,lb,va,C,Mb)}!la&&X.noMergePhase&&ba.getLockAlpha()&&Y.copyAlphaFrom(ha,M);X.wantsOutputAsInput&&(m(),yb&&!la&&W.fusionLayers());l(ba,M)}}};this.getDefaultLayerName=function(C){let M=C?"Group ":"Layer ";C=C?/^Group [0-9]+$/:/^Layer [0-9]+$/;let X=0,Y=da.getLinearizedLayerList(!1);for(let ca=0;ca<Y.length;ca++){let aa=Y[ca];C.test(aa.name)&&(X=Math.max(X,parseInt(aa.name.substring(M.length),10)))}return M+
(X+1)};this.addBackgroundLayer=function(){let C=new Fa(W.width,W.height,this.getDefaultLayerName(!1));C.image.clearAll(4294967295);this.addLayerObject(this.getLayersRoot(),C)};this.addDefaultLayer=function(){let C=new Fa(W.width,W.height,this.getDefaultLayerName(!1));C.image.clearAll(16777215);this.addLayerObject(this.getLayersRoot(),C);this.setActiveLayer(C,!1)};this.fusionLayers=function(){m();Ca.buildTree();return bb=Ca.blendTree().image};this.upgradeMultiplyLayers=function(C){let M=this.getLayersRoot().getLinearizedLayerList(!1,
[]),X=-1;for(var Y=0;Y<M.length;Y++){var ca=M[Y];if(!(ca instanceof Fa)||ca.mask||ca.blendMode>Q.LM_LAST_CHIBIPAINT)throw Error("Bad layer type during multiply upgrade");ca.blendMode===Q.LM_MULTIPLY&&(X=Y)}if(-1!==X){Y=new J(this.width,this.height);let aa=ca=!0,va=this.getBounds();Y.clearAll(va,16777215);for(let Ma=0;Ma<=X;Ma++){let ab=M[Ma];aa||(ca=ca&&Y.hasAlphaInRect(va));ab.blendMode===Q.LM_MULTIPLY&&("bake"===C?!ca&&ab.getEffectiveAlpha()>0&&(100===ab.alpha?Q.upgradeMultiplyOfOpaqueLayer(Y,ab.image,
100,va):Q.upgradeMultiplyOfTransparentLayer(Y,ab.image,ab.alpha,va),ab.setBlendMode(Q.LM_MULTIPLY2)):ca&&ab.setBlendMode(Q.LM_MULTIPLY2));ab.getEffectiveAlpha()>0&&(aa=!1,Q.fuseImageOntoImage(Y,ca,ab.image,ab.alpha,ab.blendMode,va,null))}}};this.isCreateClippingMaskAllowed=function(){var C=ba.parent.indexOf(ba);C=ba.parent.layers[C-1];return ba instanceof Fa&&!ba.clip&&C instanceof Fa};this.createClippingMask=function(){this.isCreateClippingMaskAllowed()&&v(new qa(ba,!0))};this.isReleaseClippingMaskAllowed=
function(){return ba instanceof Fa&&ba.clip};this.releaseClippingMask=function(){this.isReleaseClippingMaskAllowed()&&v(new qa(ba,!1))};this.setActiveLayer=function(C,M){if(C){let X=(M=C.mask&&M)!=la;if(ba!=C||X){let Y=ba;ba=C;la=M;u();this.emitEvent("changeActiveLayer",[Y,C,la]);X&&this.emitEvent("editModeChanged",[la?dc.EDITING_MODE_MASK:dc.EDITING_MODE_IMAGE]);Ga&&Ga.layer==Y&&(M?Ga.setLayer(C):this.closeMaskView())}}};this.closeMaskView=function(){Ga.close();Ga=null};this.toggleMaskView=function(){return null!=
Ga&&Ga.isOpen()?this.closeMaskView():Ga=ba.mask?new ag(ba,m):null,Ga};this.selectTopmostVisibleLayer=function(){let C=da.getLinearizedLayerList(!1);for(var M=C.length-1;M>=0;M--)if(C[M]instanceof Fa&&C[M].getEffectiveAlpha()>0)return void this.setActiveLayer(C[M],!1);for(M=C.length-1;M>=0;M--)if(C[M]instanceof Fa)return void this.setActiveLayer(C[M],!1);this.setActiveLayer(C[C.length-1],!1)};this.getActiveLayer=function(){return ba};this.isEditingMask=function(){return la};this.isActiveLayerDrawable=
function(){return la&&ba.mask||!la&&ba instanceof Fa};this.getUndoMemoryUsed=function(){let C=0;for(let M of Fb)C+=M.getMemoryUsed(!0,null);for(let M of hb)C+=M.getMemoryUsed(!1,null);return C};this.isUndoAllowed=function(){return hb.length>0};this.isRedoAllowed=function(){return Fb.length>0};this.undo=function(){if(this.isUndoAllowed()){this.setHasUnsavedChanges(!0);var C=hb.pop();C.undo();Fb.push(C)}};this.redo=function(){if(this.isRedoAllowed()){this.setHasUnsavedChanges(!0);var C=Fb.pop();C.redo();
hb.push(C)}};this.performIdleTasks=function(){t();m();Ca.buildTree()};this.compactUndo=function(){hb.length>0&&hb[hb.length-1].compact()};this.clearHistory=function(){hb=[];Fb=[]};this.colorPicker=function(C,M){return la&&ba.mask?jb.greyToRGB(ba.mask.getPixel(~~C,~~M)):16777215&bb.getPixel(~~C,~~M)};this.setSelection=function(C){rb.set(C);rb.roundNearest();rb.clipTo(this.getBounds())};this.emptySelection=function(){rb.makeEmpty()};this.floodFill=function(C,M,X=0,Y=255,ca=!0){ca=!la&&ca?this.fusionLayers():
null;let aa=g();aa&&(t(),pa=this.getBounds(),aa.floodFillWithBorder(~~C,~~M,4278190080|Mb,X,Y,ca),v(new A),l(ba,this.getBounds()))};this.gradientFill=function(C,M,X,Y,ca){let aa=this.getSelectionAutoSelect(),va=g();va&&(t(),pa=aa.clone(),va.gradient(aa,C,M,X,Y,ca,!1),this.getLayerLockAlpha()&&va instanceof J&&va.copyAlphaFrom(ha,aa),v(new A),l(ba,aa))};this.fill=function(C,M){let X=this.getSelectionAutoSelect(),Y=g(),ca=this.texture;if(Y){t();pa=X.clone();if(ca&&!M){M=ca.width;let ab=ca.height,Yb=
X.right-X.left,Ub=X.bottom-X.top;for(let Pb=0;Pb<Ub;Pb++)for(let Kb=0;Kb<Yb;Kb++){var aa,va,Ma;let vb=X.left+Kb,Vb=X.top+Pb,Ic=1-ca.data[Vb%ab*M+vb%M]/255,Nb=(255&((aa=C)>>24&255)*(va=Ic)+((Ma=Y.getPixel(vb,Vb))>>24&255)*(1-va))<<24|(255&(aa>>16&255)*va+(Ma>>16&255)*(1-va))<<16|(255&(aa>>8&255)*va+(Ma>>8&255)*(1-va))<<8|255&(255&aa)*va+(255&Ma)*(1-va);Y.setPixel(vb,Vb,Nb)}}else Y.clearRect(X,C);v(new A);l(ba,X)}};this.clear=function(C=!0){la?this.fill(0,C):this.fill(16777215,C)};this.flip=function(C){let M=
this.getSelection(),X=M.isEmpty();var Y=X&&ba instanceof Fa&&ba.mask&&ba.maskLinked;let ca=(!la||Y)&&ba instanceof Fa;Y=(la||Y)&&ba.mask;C=C?"copyRegionHFlip":"copyRegionVFlip";(ca||Y)&&(X&&(M=this.getBounds()),pa=M.clone(),ca&&(p(),ba.image[C](M,ha)),Y&&(n(),ba.mask[C](M,ea)),v(new A(ca,Y)),k(ba,M,ca,Y))};this.hFlip=function(){this.flip(!0)};this.vFlip=function(){this.flip(!1)};this.monochromaticNoise=function(){let C=this.getSelectionAutoSelect(),M=g();M&&(t(),pa=C.clone(),M.fillWithNoise(C,Mb),
v(new A),l(ba,C))};this.isColorNoiseAllowed=function(){return!this.isEditingMask()&&this.isActiveLayerDrawable()};this.isNotEditingMask=function(){return!this.isEditingMask()};this.isNotEditingMaskAndDrawable=function(){return!this.isEditingMask()&&this.isActiveLayerDrawable()};this.colorNoise=function(){if(this.isColorNoiseAllowed()){let C=this.getSelectionAutoSelect();t();pa=C.clone();ba.image.fillWithColorNoise(C);v(new A(!0,!1));k(ba,C,!0,!1)}};this.invert=function(){let C=this.getSelectionAutoSelect(),
M=g();M&&(t(),pa=C.clone(),M.invert(C),v(new A),l(ba,C))};this.brightnessToOpacity=function(){if(!la){var C=this.getSelectionAutoSelect(),M=g();M&&(t(),pa=C.clone(),M.brightnessToOpacity(C,Mb),v(new A),l(ba,C))}};this.boxBlur=function(C,M,X,Y=!1){if(Y)return void v(new N(function(aa,va){for(let Ma=0;Ma<X;Ma++)aa.boxBlur(va,C,M)}));Y=this.getSelectionAutoSelect();let ca=g();if(ca){t();pa=Y.clone();for(let aa=0;aa<X;aa++)ca.boxBlur(Y,C,M);v(new A);l(ba,Y)}};this.chromaticAberration=function(C,M,X=!1){if(!la){if(X)return void v(new N(function(ca,
aa){ca.chromaticAberration(aa,C,M)}));X=this.getSelectionAutoSelect();var Y=g();Y&&(t(),pa=X.clone(),Y.chromaticAberration(X,C,M),v(new A),l(ba,X))}};this.edge=function(C,M){if(!la){var X=this.getSelectionAutoSelect(),Y=g();Y&&(t(),pa=X.clone(),Y.edge(X,C,Mb,M),v(new A),l(ba,X))}};this.convertToDrawingColor=function(){if(!la){var C=this.getSelectionAutoSelect(),M=g();M&&(t(),pa=C.clone(),M.convertToDrawingColor(C,Mb),v(new A),l(ba,C))}};this.monoHalftone=function(C,M=!1){if(M)return void v(new N(function(Y,
ca){Y.monoHalftone(ca,C,Mb,.85)}));M=this.getSelectionAutoSelect();let X=g();X&&(t(),pa=M.clone(),X.monoHalftone(M,C,Mb,.85),v(new A),l(ba,M))};this.colorHalftone=function(C,M=!1){if(!la){if(M)return void v(new N(function(Y,ca){Y.colorHalftone(ca,C,.85)},Q.LM_MULTIPLY2));M=this.getSelectionAutoSelect();var X=g();X&&(t(),pa=M.clone(),X.colorHalftone(M,C,.85),v(new A),l(ba,M))}};this.mosaic=function(C,M=!1){if(M)return void v(new N(function(Y,ca){Y.mosaic(ca,C)}));M=this.getSelectionAutoSelect();let X=
g();X&&(t(),pa=M.clone(),X.mosaic(M,C),v(new A),l(ba,M))};this.rectangleSelection=function(C){C=C.clone();C.clipTo(this.getBounds());v(new ia(this.getSelection(),C));this.setSelection(C)};this.move=function(C,M,X){if(M|=0,0!=(C|=0)||0!=M){var Y=hb.length>0?hb[hb.length-1]:null;!X&&Y instanceof tc&&Y.layer==this.getActiveLayer()?(Y.amend(C,M),Fb=[],this.setHasUnsavedChanges(!0)):(C=new tc(C,M,X),v(C),C.redo())}};this.setTransformInterpolation=function(C){oc=C;Ia instanceof Rb&&Ia.setInterpolation(C)};
this.transformAffineAbort=function(){Ia instanceof Rb&&(Ia.undo(),Ia=null,d(!0))};this.transformAffineBegin=function(){if(Ia instanceof Rb)return{transform:Ia.getTransform(),rect:Ia.getInitialTransformRect(),selection:Ia.getInitialSelectionRect()};let C=new qb,M;return(M=new Rb(C,oc)).getInitialTransformRect().isEmpty()?null:(Ia=M,mb=!0,{transform:C,rect:M.getInitialTransformRect(),selection:M.getInitialSelectionRect()})};this.transformAffineFinish=function(){Ia instanceof Rb&&(v(Ia),Ia=null,d(!0))};
this.transformAffineAmend=function(C){Ia instanceof Rb&&Ia.amend(C)};this.isCopySelectionAllowed=this.isCutSelectionAllowed=function(){return!this.getSelection().isEmpty()&&null!==g()};this.cutSelection=function(){this.isCutSelectionAllowed()&&v(new V(ba,la,this.getSelection()))};this.copySelection=function(){if(this.isCopySelectionAllowed()){let C=W.getSelection();ob=new ke(g().cloneRect(C),C.left,C.top)}};this.isCopySelectionMergedAllowed=function(){return!this.getSelection().isEmpty()};this.copySelectionMerged=
function(){if(this.isCopySelectionMergedAllowed()){let C=W.getSelection();ob=new ke(this.fusionLayers().cloneRect(C),C.left,C.top)}};this.isPasteClipboardAllowed=function(){return!this.isClipboardEmpty()};this.pasteClipboard=function(){this.isPasteClipboardAllowed()&&v(new ma(ob))};this.getClipboard=function(){return ob};this.setClipboard=function(C){ob=C};this.isClipboardEmpty=function(){return null==ob};this.setSampleAllLayers=function(C){yb=C};this.getLayerLockAlpha=function(){return this.getActiveLayer().getLockAlpha()};
this.setLayerLockAlpha=function(C){ba.getLockAlpha()!=C&&v(new $b(ba,C))};this.setForegroundColor=function(C){Mb=C};this.setBrush=function(C){lb=C};this.setBrushTexture=function(C){na.setTexture(C);this.texture=C};this.beginStroke=function(C,M,X){return null!==lb&&!!this.isActiveLayerDrawable()&&(t(),pa.makeEmpty(),H.clearAll(0),U.makeEmpty(),wb=C,sc=M,Lb=X,mb=!0,Z[lb.brushMode].beginStroke(),this.paintDab(C,M,X,!0),!0)};this.continueStroke=function(C,M,X){if(null!=lb){var Y=C-wb,ca=M-sc,aa=Math.sqrt(Y*
Y+ca*ca),va=Math.max(lb.minSpacing,lb.curSize*lb.spacing);if(aa>=va){Y/=aa;ca/=aa;let Ma=(X-Lb)/aa,ab=va;for(;ab<=aa;)this.paintDab(wb+Y*ab,sc+ca*ab,Lb+Ma*ab),ab+=va;wb=C;sc=M;Lb=X}}};this.endStroke=function(){null!=lb&&(m(),Z[lb.brushMode].endStroke(),pa.clipTo(this.getBounds()),pa.isEmpty()||(v(new A),t()),d(!1))};this.hasAlpha=function(){return bb.hasAlpha()};this.getFlatPNG=function(C){return this.fusionLayers(),bb.getAsPNG(C)};this.getFlatPNGBuffer=function(C){return this.fusionLayers(),bb.getAsPNGBuffer(C)};
A.prototype=Object.create(Zb.prototype);A.prototype.constructor=A;D.prototype=Object.create(Zb.prototype);D.prototype.constructor=D;y.prototype=Object.create(Zb.prototype);y.prototype.constructor=y;E.prototype=Object.create(Zb.prototype);E.prototype.constructor=E;x.prototype=Object.create(Zb.prototype);x.prototype.constructor=x;G.prototype=Object.create(Zb.prototype);G.prototype.constructor=G;I.prototype=Object.create(Zb.prototype);I.prototype.constructor=I;O.prototype=Object.create(Zb.prototype);
O.prototype.constructor=O;B.prototype=Object.create(Zb.prototype);B.prototype.constructor=B;N.prototype=Object.create(Zb.prototype);N.prototype.constructor=N;P.prototype=Object.create(Zb.prototype);P.prototype.constructor=P;let Hc=L("alpha",!0),Wc=L("blendMode",!0),ec=L("visible",!0),qa=L("clip",!0),ac=L("maskVisible",!0),fc=L("name",!1),$b=L("lockAlpha",!1),xc=L("maskLinked",!1);ia.prototype=Object.create(Zb.prototype);ia.prototype.constructor=ia;class La extends Zb{undo(){let C=[];this.dstRect.isEmpty()||
C.push(this.dstRect);this.erasesSourceRect&&(C.push(this.srcRect),C=Ba.union(C));this.movingLayers.forEach(M=>{this.hasFullUndo?C.forEach(X=>{M.moveImage&&M.layer.image.copyBitmapRect(M.imageUndo,X.left,X.top,X);M.moveMask&&M.layer.mask.copyBitmapRect(M.maskUndo,X.left,X.top,X)}):(M.moveImage&&M.imageRect.forEach((X,Y)=>{M.layer.image.copyBitmapRect(X,Y.left,Y.top,X.getBounds())}),M.moveMask&&M.maskRect.forEach((X,Y)=>{M.layer.mask.copyBitmapRect(X,Y.left,Y.top,X.getBounds())}))});k(this.movingLayers.map(M=>
M.layer),C.reduce((M,X)=>M.getUnion(X),new Ba(0,0,0,0)),!0,!0);this.dstRect.makeEmpty();W.setSelection(this.fromSelection);W.setActiveLayer(this.layer,this.fromMaskMode);a()}getMemoryUsed(C,M){return this.movingLayers.map(function(X){return[X.imageUndo,X.maskUndo,X.imageRect,X.maskRect].map(Y=>Y?Y.getMemorySize():0).reduce(Gd,0)}).reduce(Gd,0)}buildFullUndo(){this.hasFullUndo||(this.movingLayers.forEach(function(C){C.moveImage&&(C.imageUndo=C.layer.image.clone());C.moveMask&&(C.maskUndo=C.layer.mask.clone());
C.imageRect.clear();C.maskRect.clear()}),this.hasFullUndo=!0)}compact(){if(this.hasFullUndo){let C=[];this.dstRect.isEmpty()||C.push(this.dstRect);this.erasesSourceRect&&(C.push(this.srcRect),C=Ba.union(C));this.movingLayers.forEach(M=>{M.imageRect.clear();M.maskRect.clear();C.forEach(X=>{M.moveImage&&M.imageRect.set(X,M.imageUndo.cloneRect(X));M.moveMask&&M.maskRect.set(X,M.maskUndo.cloneRect(X))});M.imageUndo=null;M.maskUndo=null});this.hasFullUndo=!1}}constructor(){super();this.layer=ba;this.fromSelection=
W.getSelection();this.fromMaskMode=la;this.movingWholeLayer=this.fromSelection.isEmpty();this.movingImage=!la||this.movingWholeLayer&&this.layer.maskLinked;this.movingMask=la||this.movingWholeLayer&&this.layer.maskLinked;this.erasesSourceRect=this.hasFullUndo=!1;this.dstRect=new Ba(0,0,0,0);this.movingLayers=[{layer:this.layer,moveImage:this.layer instanceof Fa&&this.movingImage,moveMask:null!==this.layer.mask&&this.movingMask,imageRect:new Map,maskRect:new Map}];this.layer instanceof $a&&this.movingImage&&
this.movingWholeLayer&&(this.movingLayers=this.movingLayers.concat(this.layer.getLinearizedLayerList(!1).map(Y=>({layer:Y,moveImage:Y instanceof Fa,moveMask:null!==Y.mask&&Y.maskLinked,imageRect:new Map,maskRect:new Map}))));let C=new Ba(0,0,0,0);if(this.movingWholeLayer){this.srcRect=W.getBounds();for(var M=0;M<this.movingLayers.length&&!C.equals(this.srcRect);M++){var X=this.movingLayers[M];X.moveMask&&C.union(X.layer.mask.getValueBounds(this.srcRect,255));X.moveImage&&C.union(X.layer.image.getNonTransparentBounds(this.srcRect))}}else for(this.srcRect=
this.fromSelection.clone(),M=0;M<this.movingLayers.length&&!C.equals(this.srcRect);M++)X=this.movingLayers[M],X.moveMask&&C.union(X.layer.mask.getValueBounds(this.srcRect,0)),X.moveImage&&C.union(X.layer.image.getNonTransparentBounds(this.srcRect));this.srcRect=C}}class Rb extends La{buildFullUndo(){if(!this.hasFullUndo){super.buildFullUndo();this.movingLayers.forEach(X=>{if(X.moveImage){var Y=Vc(this.srcRect.getWidth(),this.srcRect.getHeight());Y.getContext("2d").putImageData(X.layer.image.getImageData(),
-this.srcRect.left,-this.srcRect.top,this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),this.srcRect.getHeight());X.imageSourceCanvas=Y}X.moveMask&&(Y=Vc(this.srcRect.getWidth(),this.srcRect.getHeight()),Y.getContext("2d").putImageData(X.layer.mask.getImageData(this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),this.srcRect.getHeight()),0,0),X.maskSourceCanvas=Y)});this.composeCanvas=Vc(W.width,W.height);this.composeCanvasContext=this.composeCanvas.getContext("2d",{willReadFrequently:!0});
let C="smooth"===this.interpolation,M=this.composeCanvasContext;M&&(M.imageSmoothingEnabled=C);this.junk=this.composeCanvasContext.getImageData(0,0,1,1)}}redo(){this.buildFullUndo();var C=this.dstRect.clone();let M=this.srcRect.toPoints();this.affineTransform.transformPoints(M);this.dstRect.set(Ba.createBoundingBox(M).roundContain().clipTo(W.getBounds()));let X=Ba.subtract(this.dstRect,this.srcRect),Y=Ba.subtract(C.isEmpty()?this.srcRect:this.srcRect.getIntersection(C),this.dstRect),ca=this.srcRect.getIntersection(this.dstRect),
aa=Ba.subtract(C,[this.dstRect,this.srcRect]);C=this.srcRect.getUnion(this.dstRect).getUnion(C);(this.movingLayers.forEach(va=>{if(Y.forEach(Ma=>{va.moveImage&&va.layer.image.clearRect(Ma,16777215);va.moveMask&&(this.movingWholeLayer?va.layer.mask.clearRect(Ma,255):va.layer.mask.clearRect(Ma,0))}),!this.dstRect.isEmpty()){if(va.moveImage){let Ma=va.imageUndo.getImageData();X.forEach(ab=>{this.composeCanvasContext.putImageData(Ma,0,0,ab.left,ab.top,ab.getWidth(),ab.getHeight())});this.composeCanvasContext.clearRect(ca.left,
ca.top,ca.getWidth(),ca.getHeight());this.composeCanvasContext.save();this.composeCanvasContext.setTransform(this.affineTransform.m[0],this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]);this.composeCanvasContext.drawImage(va.imageSourceCanvas,this.srcRect.left,this.srcRect.top);this.composeCanvasContext.restore();va.layer.image.copyBitmapRect(new J(this.composeCanvasContext.getImageData(this.dstRect.left,this.dstRect.top,
this.dstRect.getWidth(),this.dstRect.getHeight())),this.dstRect.left,this.dstRect.top,new Ba(0,0,this.dstRect.getWidth(),this.dstRect.getHeight()))}va.moveMask&&(X.forEach(Ma=>{this.composeCanvasContext.putImageData(va.layer.mask.getImageData(Ma.left,Ma.top,Ma.getWidth(),Ma.getHeight()),Ma.left,Ma.top)}),this.movingWholeLayer?this.composeCanvasContext.fillStyle="#FFF":this.composeCanvasContext.fillStyle="#000",this.composeCanvasContext.fillRect(ca.left,ca.top,ca.getWidth(),ca.getHeight()),this.composeCanvasContext.save(),
this.composeCanvasContext.setTransform(this.affineTransform.m[0],this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]),this.composeCanvasContext.drawImage(va.maskSourceCanvas,this.srcRect.left,this.srcRect.top),this.composeCanvasContext.restore(),va.layer.mask.pasteImageData(this.composeCanvasContext.getImageData(this.dstRect.left,this.dstRect.top,this.dstRect.getWidth(),this.dstRect.getHeight()),this.dstRect.left,this.dstRect.top))}aa.forEach(Ma=>
{va.moveImage&&va.layer.image.copyBitmapRect(va.imageUndo,Ma.left,Ma.top,Ma);va.moveMask&&va.layer.mask.copyBitmapRect(va.maskUndo,Ma.left,Ma.top,Ma)})}),k(this.movingLayers.map(va=>va.layer),C,!0,!0),this.fromSelection.isEmpty())||(C=this.fromSelection.toPoints(),this.affineTransform.transformPoints(C),(C=Ba.createBoundingBox(C)).roundNearest(),W.setSelection(C),a());W.setActiveLayer(this.layer,this.fromMaskMode)}amend(C){this.hasFullUndo||this.undo();this.affineTransform=C.clone();this.redo()}setInterpolation(C){if(C!=
this.interpolation){this.interpolation=C;C="smooth"===this.interpolation;let M=this.composeCanvasContext;M&&(M.imageSmoothingEnabled=C);this.undo();this.redo()}}compact(){super.compact();this.composeCanvasContext=this.composeCanvas=null;this.movingLayers.forEach(C=>C.imageSourceCanvas=null)}getMemoryUsed(C,M){C=super.getMemoryUsed(C,M);return C+=Xe(this.composeCanvas),C+=this.movingLayers.map(X=>Xe(X.imageSourceCanvas)).reduce(Gd,0)}getTransform(){return this.affineTransform.clone()}getInitialTransformRect(){return this.srcRect.clone()}getInitialSelectionRect(){return this.fromSelection.clone()}constructor(C,
M){super();this.erasesSourceRect=!0;this.affineTransform=C.clone();this.interpolation=M||"smooth";this.composeCanvasContext=this.composeCanvas=null}}class tc extends La{redo(){var C=this.dstRect.clone();let M,X,Y=C.clone(),ca=null;(this.buildFullUndo(),this.dstRect.set(this.srcRect),this.dstRect.translate(this.offsetX,this.offsetY),M=this.dstRect.clone(),this.dstRect.clipTo(W.getBounds()),this.erasesSourceRect?(ca=C.isEmpty()?this.srcRect:this.srcRect.getIntersection(C),Y.union(ca),X=C.subtract(this.srcRect)):
X=[C],this.movingLayers.forEach(aa=>{ca&&(aa.moveImage&&aa.layer.image.clearRect(ca,16777215),aa.moveMask&&aa.layer.mask.clearRect(ca,255*!!this.movingWholeLayer));X.forEach(function(va){aa.moveImage&&aa.layer.image.copyBitmapRect(aa.imageUndo,va.left,va.top,va);aa.moveMask&&aa.layer.mask.copyBitmapRect(aa.maskUndo,va.left,va.top,va)});aa.moveImage&&Q.normalFuseImageOntoImageAtPosition(aa.layer.image,aa.imageUndo,M.left,M.top,this.srcRect);aa.moveMask&&aa.layer.mask.copyBitmapRect(aa.maskUndo,M.left,
M.top,this.srcRect)}),Y.union(this.dstRect),k(this.movingLayers.map(aa=>aa.layer),Y,!0,!0),this.fromSelection.isEmpty())||(C=this.fromSelection.clone(),C.translate(this.offsetX,this.offsetY),W.setSelection(C),a())}amend(C,M){this.hasFullUndo||this.undo();this.offsetX+=C;this.offsetY+=M;this.redo()}constructor(C,M,X){super();this.offsetX=C;this.offsetY=M;this.erasesSourceRect=!X}}V.prototype=Object.create(Zb.prototype);V.prototype.constructor=V;ma.prototype=Object.create(Zb.prototype);ma.prototype.constructor=
ma;Z=[fd,bg,cg,dg,ud,eg,fg,gg].map(C=>new C(H,U));this.width=b;this.height=c}function gb(b,c,d){this.data=b;this.eof=!1;this.start=void 0===c?0:c;this.end=void 0===d?b.length:d;this.pos=this.start}function le(b){this.version=b.readU32BE();this.width=b.readU32BE();this.height=b.readU32BE();this.layersNb=b.readU32BE()}function Hd(b){let c=[,,,,];for(let d=0;d<c.length;d++)c[d]=String.fromCharCode(b.readByte());if(this.chunkType=c.join(""),this.chunkSize=b.readU32BE(),b.eof)throw"Truncated chunk";}function Ye(b){return{major:b>>
16&65535,minor:65535&b}}function me(b,c){let d=new gb(new Uint8Array(Hd.HEADER_LENGTH+c));return d.writeString(b),d.writeU32BE(c),d}function Ze(b,c={}){async function d(m){let p;var n=g;if(null!==n&&0!==n.length)if(null===m||0===m.length)m=n;else{var t=new Uint8Array(n.length+m.length);m=(t.set(n,0),t.set(m,n.length),t)}for(g=m;g;){if(e<g.length)g=g.subarray(e),e=0;else{e-=g.length;g=null;break}switch(a){case 0:if(g.length<Hd.HEADER_LENGTH)break;if(l=new Hd(p=new gb(g)),g=g.subarray(p.pos),k)if(l.chunkType==
"ZEND")a=45;else{l.chunkType=="LAYR"?(a=2,f=new hg(l,k.width,k.height)):l.chunkType=="GRUP"?(a=3,f=new ig(l,k.width,k.height)):(console.log("Unknown chunk type '"+l.chunkType+"', attempting to skip..."),e=l.chunkSize);continue}else if(l.chunkType=="HEAD"){a=1;continue}else a=5;break;case 1:if(g.length<l.chunkSize)break;if(Ye((k=new le(p=new gb(g))).version).major>0){a=5;break}q=(h=new dc(k.width,k.height)).getLayersRoot();e=l.chunkSize;a=0;continue;case 2:if(g=f.decode(g),f.done){h.addLayerObject(q,
f.layer);a=0;await Id();continue}break;case 3:if(g=f.decode(g),f.done){h.addLayerGroupObject(q,f.layer,f.childLayers);a=0;await Id();continue}}break}}let a=0,h=null,q=null,f,e=0,k=null,l=null,g=null;return(new Promise(function(m){if(b instanceof ArrayBuffer)m(b);else{let p=new FileReader;p.onload=function(){m(this.result)};p.readAsArrayBuffer(b)}})).then(m=>new Promise(async function(p,n){try{let y=new Uint8Array(m);a:{var t=y;for(let x=0;x<8;x++)if(t[x]!="CHIBIOEK".charCodeAt(x)){var u=!1;break a}u=
!0}if(!u)return void n("This doesn't appear to be a ChibiPaint layers file, is it damaged?");var v=y.subarray(8);var A=v.subarray;var D=(((15&v[0])!=8||v[0]>>4>7||(v[0]<<8|v[1])%31)&&Wb(6,"invalid zlib data"),(v[1]>>5&1)==1&&Wb(6,"invalid zlib data: "+(32&v[1]?"need":"unexpected")+" dictionary"),(v[1]>>3&4)+2);let E=$e(A.call(v,D,-4),{i:2},void 0,void 0);await d(E);45==a?(!1!==c.upgradeMultiplyLayers&&k.version<10&&h.upgradeMultiplyLayers(c.upgradeMultiplyLayers),h.selectTopmostVisibleLayer(),p(h)):
n("Fatal error decoding ChibiFile structure.")}catch(y){n("Fatal error decompressing/decoding ChibiFile: "+y)}}))}function gd(){}function vd(b){function c(q,f){null===f?h.emitEvent("loadingProgress",[1,"Loading your "+q.friendly+"..."]):h.emitEvent("loadingProgress",[f,"Loading your "+q.friendly+" ("+Math.round(100*f)+"%)..."])}var d=[],a={},h=this;b.loadChibiFileUrl&&(""+b.loadChibiFileUrl).length>0?d.push({url:b.loadChibiFileUrl,friendly:"drawing layers",name:"layers",required:!0}):b.loadImageUrl&&
(""+b.loadImageUrl).length>0&&d.push({url:b.loadImageUrl,friendly:"drawing",name:"flat",required:!0});b.loadSwatchesUrl&&d.push({url:b.loadSwatchesUrl,friendly:"color swatches",name:"swatches",required:!1,noProgress:!0});this.load=function(){function q(){f.required?h.emitEvent("loadingFailure",["Failed to load your "+f.friendly+", please try again later."]):h.load()}if(0==d.length)return void h.emitEvent("loadingComplete",[a]);var f=d.shift(),e=new XMLHttpRequest;e.addEventListener("progress",function(k){c(f,
k.lengthComputable&&!f.noProgress?k.loaded/k.total:null)},!1);e.addEventListener("load",function(k){if(200==this.status){let l=this.response;h.emitEvent("loadingProgress",[1,"Starting litaChix..."]);setTimeout(function(){(function(g,m){switch(g.name){case "flat":return new Promise(function(p,n){let t=new Blob([m],{type:"image/png"}),u=window.URL.createObjectURL(t);if(u){let v=new Image;v.onload=function(){let A=new dc(this.width,this.height),D=new Fa(0,0,"Layer 1");D.image=J.createFromImage(v);A.addLayerObject(A.getLayersRoot(),
D);v=null;window.URL.revokeObjectURL(u);p(A)};v.src=u}else n(null)});case "swatches":return(g=(new gd).read(m))?Promise.resolve(g):Promise.reject(null);case "layers":return Ze(m);default:return Promise.reject("Unexpected resource type '"+g.name+"'")}})(f,l).then(function(g){a[f.name]=g;h.load()},function(){h.emitEvent("loadingFailure",["Failed to read your "+f.friendly])})},0)}else q()},!1);e.addEventListener("error",q);c(f,f.noProgress?null:0);e.open("GET",f.url,!0);e.responseType="arraybuffer";
e.send()}}function Bc(b){if(b>2147483647)throw RangeError('The value "'+b+'" is invalid for option "size"');b=new Uint8Array(b);return Object.setPrototypeOf(b,oa.prototype),b}function oa(b,c,d){if("number"==typeof b){if("string"==typeof c)throw TypeError('The "string" argument must be of type string. Received type number');return ne(b)}return af(b,c,d)}function af(b,c,d){if("string"==typeof b){var a=c;if(("string"!=typeof a||""===a)&&(a="utf8"),!oa.isEncoding(a))throw TypeError("Unknown encoding: "+
a);c=0|bf(b,a);d=Bc(c);b=d.write(b,a);return b!==c&&(d=d.slice(0,b)),d}if(ArrayBuffer.isView(b))return yc(b,Uint8Array)?(b=new Uint8Array(b),cf(b.buffer,b.byteOffset,b.byteLength)):oe(b);if(null==b)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b);if(yc(b,ArrayBuffer)||b&&yc(b.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(yc(b,SharedArrayBuffer)||b&&yc(b.buffer,SharedArrayBuffer)))return cf(b,c,d);if("number"==
typeof b)throw TypeError('The "value" argument must not be of type number. Received type number');a=b.valueOf&&b.valueOf();if(null!=a&&a!==b)return oa.from(a,c,d);if(oa.isBuffer(b)){a=0|pe(b.length);var h=Bc(a);a=(0===h.length||b.copy(h,0,0,a),h)}else void 0!==b.length?((a="number"!=typeof b.length)||(a=b.length,a=a!=a),a=a?Bc(0):oe(b)):a="Buffer"===b.type&&Array.isArray(b.data)?oe(b.data):void 0;if(a)return a;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof b[Symbol.toPrimitive])return oa.from(b[Symbol.toPrimitive]("string"),
c,d);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b);}function df(b){if("number"!=typeof b)throw TypeError('"size" argument must be of type number');if(b<0)throw RangeError('The value "'+b+'" is invalid for option "size"');}function ne(b){return df(b),Bc(b<0?0:0|pe(b))}function oe(b){for(var c=b.length<0?0:0|pe(b.length),d=Bc(c),a=0;a<c;a+=1)d[a]=255&b[a];return d}function cf(b,c,d){var a;if(c<0||b.byteLength<
c)throw RangeError('"offset" is outside of buffer bounds');if(b.byteLength<c+(d||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(a=void 0===c&&void 0===d?new Uint8Array(b):void 0===d?new Uint8Array(b,c):new Uint8Array(b,c,d),oa.prototype),a}function pe(b){if(b>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|b}function bf(b,c){if(oa.isBuffer(b))return b.length;if(ArrayBuffer.isView(b)||yc(b,ArrayBuffer))return b.byteLength;
if("string"!=typeof b)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof b);var d=b.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===d)return 0;for(var h=!1;;)switch(c){case "ascii":case "latin1":case "binary":return d;case "utf8":case "utf-8":return qe(b).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*d;case "hex":return d>>>1;case "base64":return ef(b).length;default:if(h)return a?-1:qe(b).length;c=
(""+c).toLowerCase();h=!0}}function jg(b,c,d){var a,h,q=!1;if((void 0===c||c<0)&&(c=0),c>this.length||((void 0===d||d>this.length)&&(d=this.length),d<=0||(d>>>=0)<=(c>>>=0)))return"";for(b||="utf8";;)switch(b){case "hex":return function(f,e,k){var l=f.length;(!e||e<0)&&(e=0);(!k||k<0||k>l)&&(k=l);for(l="";e<k;++e)l+=kg[f[e]];return l}(this,c,d);case "utf8":case "utf-8":return ff(this,c,d);case "ascii":return function(f,e,k){var l="";for(k=Math.min(f.length,k);e<k;++e)l+=String.fromCharCode(127&f[e]);
return l}(this,c,d);case "latin1":case "binary":return function(f,e,k){var l="";for(k=Math.min(f.length,k);e<k;++e)l+=String.fromCharCode(f[e]);return l}(this,c,d);case "base64":return a=c,h=d,0===a&&h===this.length?gf(this):gf(this.slice(a,h));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return function(f,e,k){f=f.slice(e,k);e="";for(k=0;k<f.length-1;k+=2)e+=String.fromCharCode(f[k]+256*f[k+1]);return e}(this,c,d);default:if(q)throw TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase();
q=!0}}function Xc(b,c,d){var a=b[c];b[c]=b[d];b[d]=a}function hf(b,c,d,a,h){var q;if(0===b.length)return-1;if("string"==typeof d?(a=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),(q=d*=1)!=q&&(d=h?0:b.length-1),d<0&&(d=b.length+d),d>=b.length){if(h)return-1;d=b.length-1}else if(d<0)if(h)d=0;else return-1;if("string"==typeof c&&(c=oa.from(c,a)),oa.isBuffer(c))return 0===c.length?-1:jf(b,c,d,a,h);if("number"==typeof c)return(c&=255,"function"==typeof Uint8Array.prototype.indexOf)?h?
Uint8Array.prototype.indexOf.call(b,c,d):Uint8Array.prototype.lastIndexOf.call(b,c,d):jf(b,[c],d,a,h);throw TypeError("val must be string, number or Buffer");}function jf(b,c,d,a,h){function q(l,g){return 1===f?l[g]:l.readUInt16BE(g*f)}var f=1,e=b.length,k=c.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(b.length<2||c.length<2)return-1;f=2;e/=2;k/=2;d/=2}if(h)for(a=-1;d<e;d++)if(q(b,d)===q(c,-1===a?0:d-a)){if(-1===a&&(a=d),d-a+1===k)return a*
f}else-1!==a&&(d-=d-a),a=-1;else for(d+k>e&&(d=e-k);d>=0;d--){e=!0;for(a=0;a<k;a++)if(q(b,d+a)!==q(c,a)){e=!1;break}if(e)return d}return-1}function ff(b,c,d){d=Math.min(b.length,d);for(var a=[];c<d;){var h,q,f=b[c],e=null,k=f>239?4:f>223?3:f>191?2:1;if(c+k<=d)switch(k){case 1:f<128&&(e=f);break;case 2:(192&(h=b[c+1]))==128&&(q=(31&f)<<6|63&h)>127&&(e=q);break;case 3:h=b[c+1];var l=b[c+2];(192&h)==128&&(192&l)==128&&(q=(15&f)<<12|(63&h)<<6|63&l)>2047&&(q<55296||q>57343)&&(e=q);break;case 4:h=b[c+1];
l=b[c+2];var g=b[c+3];(192&h)==128&&(192&l)==128&&(192&g)==128&&(q=(15&f)<<18|(63&h)<<12|(63&l)<<6|63&g)>65535&&q<1114112&&(e=q)}null===e?(e=65533,k=1):e>65535&&(e-=65536,a.push(e>>>10&1023|55296),e=56320|1023&e);a.push(e);c+=k}b=a.length;if(b<=4096)return String.fromCharCode.apply(String,a);d="";for(h=0;h<b;)d+=String.fromCharCode.apply(String,a.slice(h,h+=4096));return d}function Sb(b,c,d){if(b%1!=0||b<0)throw RangeError("offset is not uint");if(b+c>d)throw RangeError("Trying to access beyond buffer length");
}function hc(b,c,d,a,h,q){if(!oa.isBuffer(b))throw TypeError('"buffer" argument must be a Buffer instance');if(c>h||c<q)throw RangeError('"value" argument is out of bounds');if(d+a>b.length)throw RangeError("Index out of range");}function kf(b,c,d,a,h){c*=1;d>>>=0;if(!h&&(d+4>b.length||d<0))throw RangeError("Index out of range");return lf(b,c,d,a,23,4),d+4}function mf(b,c,d,a,h){c*=1;d>>>=0;if(!h&&(d+8>b.length||d<0))throw RangeError("Index out of range");return lf(b,c,d,a,52,8),d+8}function qe(b,
c){c=c||1/0;for(var d,a=b.length,h=null,q=[],f=0;f<a;++f){if((d=b.charCodeAt(f))>55295&&d<57344){if(!h){if(d>56319||f+1===a){(c-=3)>-1&&q.push(239,191,189);continue}h=d;continue}if(d<56320){(c-=3)>-1&&q.push(239,191,189);h=d;continue}d=(h-55296<<10|d-56320)+65536}else h&&(c-=3)>-1&&q.push(239,191,189);if(h=null,d<128){if(--c<0)break;q.push(d)}else if(d<2048){if((c-=2)<0)break;q.push(d>>6|192,63&d|128)}else if(d<65536){if((c-=3)<0)break;q.push(d>>12|224,d>>6&63|128,63&d|128)}else if(d<1114112){if((c-=
4)<0)break;q.push(d>>18|240,d>>12&63|128,d>>6&63|128,63&d|128)}else throw Error("Invalid code point");}return q}function ef(b){return function(c){var d=c.length;if(d%4>0)throw Error("Invalid string. Length must be a multiple of 4");var a=c.indexOf("=");-1===a&&(a=d);d=[a,a===d?0:4-a%4];var h=d[0];d=d[1];a=new lg((h+d)*3/4-d);var q=0,f=d>0?h-4:h;for(h=0;h<f;h+=4){var e=pc[c.charCodeAt(h)]<<18|pc[c.charCodeAt(h+1)]<<12|pc[c.charCodeAt(h+2)]<<6|pc[c.charCodeAt(h+3)];a[q++]=e>>16&255;a[q++]=e>>8&255;
a[q++]=255&e}return 2===d&&(e=pc[c.charCodeAt(h)]<<2|pc[c.charCodeAt(h+1)]>>4,a[q++]=255&e),1===d&&(e=pc[c.charCodeAt(h)]<<10|pc[c.charCodeAt(h+1)]<<4|pc[c.charCodeAt(h+2)]>>2,a[q++]=e>>8&255,a[q++]=255&e),a}(function(c){if((c=(c=c.split("=")[0]).trim().replace(mg,"")).length<2)return"";for(;c.length%4!=0;)c+="=";return c}(b))}function Jd(b,c,d,a){for(var h=0;h<a&&!(h+d>=c.length)&&!(h>=b.length);++h)c[h+d]=b[h];return h}function yc(b,c){return b instanceof c||null!=b&&null!=b.constructor&&null!=
b.constructor.name&&b.constructor.name===c.name}function re(){throw Error("setTimeout has not been defined");}function se(){throw Error("clearTimeout has not been defined");}function nf(b){if(Jc===setTimeout)return setTimeout(b,0);if((Jc===re||!Jc)&&setTimeout)return Jc=setTimeout,setTimeout(b,0);try{return Jc(b,0)}catch(c){try{return Jc.call(null,b,0)}catch(d){return Jc.call(this,b,0)}}}function ng(){hd&&Yc&&(hd=!1,Yc.length?Cc=Yc.concat(Cc):Kd=-1,Cc.length&&of())}function of(){if(!hd){var b=nf(ng);
hd=!0;for(var c=Cc.length;c;){Yc=Cc;for(Cc=[];++Kd<c;)Yc&&Yc[Kd].run();Kd=-1;c=Cc.length}Yc=null;hd=!1;(function(d){if(Kc===clearTimeout)return clearTimeout(d);if((Kc===se||!Kc)&&clearTimeout)return Kc=clearTimeout,clearTimeout(d);try{Kc(d)}catch(a){try{return Kc.call(null,d)}catch(h){return Kc.call(this,d)}}})(b)}}function pf(b,c){this.fun=b;this.array=c}function Dc(){}async function te(b,c){return new Promise((d,a)=>{let h=indexedDB.open("litaChixDB",1);h.onupgradeneeded=q=>{q=q.target.result;q.objectStoreNames.contains("chibiResults")||
q.createObjectStore("chibiResults")};h.onsuccess=()=>{let q,f=h.result,e=f.transaction("chibiResults",b),k=c(e.objectStore("chibiResults"));k.onsuccess=()=>{q=k.result};e.oncomplete=()=>{f.close();d(q)};e.onabort=()=>{f.close();a(e.error||Error("Transaction aborted"))};e.onerror=()=>{f.close();a(e.error)}};h.onerror=()=>a(h.error)})}async function og(b,c){let d={bytes:b,swatches:c,savedAt:Date.now()};try{let a=await te("readwrite",h=>h.put(d,"latest_backup"));return localStorage.setItem("has_chibi_autosave_flag",
"true"),a}catch(a){throw console.log("Failed to save to IndexedDB:",a),a;}}async function pg(){return await te("readonly",b=>b.get("latest_backup"))||null}async function ue(){return localStorage.removeItem("has_chibi_autosave_flag"),te("readwrite",b=>b.delete("latest_backup"))}function ve(b){(b=b.split(/[-_]/,1)[0].toLowerCase())in we?(Ld=we[b],xe=b):(Ld=Md,xe="en")}function T(b){return b in Ld?Ld[b]:b}function wd(b){function c(k){null===k?f.emitEvent("savingProgress",[1,T("Saving drawing...")]):
f.emitEvent("savingProgress",[k,T("Saving drawing...")+" ("+Math.round(100*k)+"%)"])}function d(k){f.emitEvent("savingFailure",[k])}async function a(k){try{let l=await h(k),g=`${(l/1024/1024).toFixed(3)}MB`,m=`${b.post_max_size}MB`;if(console.log("Total size of FormData:",g),console.log("post_max_size:",m),b&&b.post_max_size&&l&&!isNaN(l)&&l>1048576*b.post_max_size)return void d(`${T("The file size exceeds the server limit.")}
${T("Limit size")}:${m}
${T("Current size")}:${g}`);console.log(T("The total size of FormData is within the acceptable range."))}catch(l){console.error("Error details:",l);d("An error occurred in the getFormDataSize function.");return}c(.8);fetch(b.url,{method:"POST",mode:"same-origin",headers:{"X-Requested-With":"chickenpaint"},body:k}).then(l=>{if(!l.ok){let g;switch(l.status){case 400:g="Bad Request";break;case 401:g="Unauthorized";break;case 403:g="Forbidden";break;case 404:g="Not Found";break;case 500:g="Internal Server Error";
break;case 502:g="Bad Gateway";break;case 503:g="Service Unavailable";break;default:g="Unknown Error"}throw Error(`${T("Network response was not OK")} ( ${T("HTTP status code")} ${l.status} : ${g} )`);}return l.text()}).then(l=>{/^CHIBIOK/.test(l)?(c(1),f.emitEvent("savingComplete"),ue()):d(l)}).catch(l=>{d(l.message)})}async function h(k){if(b.post_max_size)return k=Array.from(k.entries()).map(([l,g])=>"string"==typeof g?new Blob([`${l}=${g}`]):g),(new Blob(k)).size}async function q(k,l,g,m){let p=
new (Ja(qf));p.file(`${k}.png`,l);g&&p.file(`${k}.chi`,g.bytes);m&&p.file(`${k}.aco`,m);l=await p.generateAsync({type:"blob"});Ja(Nd).saveAs(l,`${k}.zip`)}var f=this,e=!1;b.rotation=b.rotation||0;this.save=function(k={}){var l,g,m,p,n;let t=null!=(l=k.zip)&&l,u=null!=(g=k.saveUrl)&&g,v=null!=(m=k.savedb)&&m,A=null!=(p=k.savedbFromMenu)&&p;k=v?null:function(y){for(var E=new Uint8Array(y.length),x=0;x<y.length;x++)E[x]=y.charCodeAt(x);return E}(b.artwork.getFlatPNG(b.rotation));var D=v?null:new Blob([k],
{type:"image/png"});k=null;v||c(.3);(function(y,E={}){let x=E.savedb||!1,G=E.savedbFromMenu||!1;return new Promise(async(I,O)=>{try{var B,N,P;let ia=y.getLayersRoot().getLinearizedLayerList(!1),V=E.forceOldVersion?0:function(sa){for(let ea of sa.getLayersRoot().getLinearizedLayerList(!1))if(ea instanceof $a||ea.mask||ea.clip||ea.blendMode>Q.LM_LAST_CHIBIPAINT||ea.blendMode===Q.LM_MULTIPLY)return 10;return 0}(y),ma=(N=Ye(V),0===N.major&&0===N.minor?"ChibiPaint v0.0":"ChickenPaint v"+N.major+"."+N.minor);
var L=[(B=ia.length,(P=me("HEAD",le.FIXED_HEADER_LENGTH)).writeU32BE(V),P.writeU32BE(y.width),P.writeU32BE(y.height),P.writeU32BE(B),P.getAsDataArray())];for(let [sa,ea]of ia.entries())L.push(function(w){var H,U=(new TextEncoder).encode(w.name),na=w instanceof Fa,W=4*(na?5:6),Z=U.length;let ba=me(na?"LAYR":"GRUP",W+Z+((na?w.image.data.length:0)+(w.mask?w.mask.data.length:0))),la=0,Ga;w.visible&&(la|=1);na&&w.clip&&(la|=2);w.mask&&(la|=4);w.maskLinked&&(la|=8);w.maskVisible&&(la|=16);w.lockAlpha&&
(la|=64);!na&&w.expanded&&(la|=32);w.blendMode===Q.LM_MULTIPLY2?(Ga=Q.LM_MULTIPLY,la|=128):Ga=w.blendMode;ba.writeU32BE(W+Z);ba.writeU32BE(Ga);ba.writeU32BE(w.alpha);ba.writeU32BE(la);ba.writeU32BE(U.length);na||ba.writeU32BE(w.layers.length);ba.data.set(U,ba.pos);ba.pos+=U.length;if(na){U=w.image.data;na=new DataView(ba.data.buffer);W=ba.pos;for(Z=0;Z<U.length;Z+=4)na.setUint32(W,U[Z+3]<<24|U[Z+0]<<16|U[Z+1]<<8|U[Z+2],!1),W+=4;ba.pos=W}return w.mask&&(H=w.mask,ba.data.set(H.data,ba.pos),ba.pos+=
H.data.length),ba.getAsDataArray()}(ea)),(x&&!G||(sa+1)%2==0)&&await Id();L.push(me("ZEND",0).getAsDataArray());let da=[],Ca=new qg(sa=>{da.push(sa)},{level:x?1:6});B=(!x||G?1024:128)*1024;for(N=0;N<L.length;N++){let sa=L[N];for(P=0;P<sa.length;P+=B){let ea=sa.subarray(P,P+B),w=P+B>=sa.length,H=N===L.length-1&&w;Ca.push(ea,H);H||await Id()}L[N]=null}let ha=new Uint8Array(8);for(L=0;L<8;L++)ha[L]="CHIBIOEK".charCodeAt(L);I({bytes:new Blob([ha,...da],{type:"application/octet-stream"}),version:ma});
da=null}catch(ia){O(ia)}})})(b.artwork,{savedb:v,savedbFromMenu:A}).then(function(y){if(e)return void alert(T("Saving cancelled."));if(v||c(.6),n=b.swatches?new Blob([(new gd).write(b.swatches)],{type:"application/octet-stream"}):null,b.url){var E=new FormData;E.append("beginMarker","This marker ensures the upload wasn't truncated");E.append("painter","ChickenPaint v2.0");E.append("picture",D);D=null;y?(E.append("chibifileFormat",y.version),E.append("chibifile",y.bytes),E.append("rotation",""+b.rotation)):
E.append("rotation","0");n&&(E.append("swatches",n),n=null);E.append("endMarker","This marker ensures the upload wasn't truncated");a(E)}else E="oekaki_"+(new Date).toISOString().split(".")[0].replace(/[^0-9]/g,"_"),u||v||ue(),t?q(E,D,y,n):v?(og(y.bytes,n),A&&f.emitEvent("savingComplete")):Ja(Nd).saveAs(D,E+".png")}).catch(function(y){f.emitEvent("savingFailure")})};this.cancel=function(){e=!0}}function rg(b,c,d){function a(){var I=l.width/2,O=l.height/2;if(g.fillStyle="white",g.fillRect(0,0,l.width,
l.height),y==D.length){var B=t.width,N=t.height,P=Math.round(I-B/2),L=Math.round(O-N/2);g.drawImage(t,P,L);var ia=E;q||((q=document.createElement("canvas")).width=B,q.height=N,e=q.getContext("2d"));e.globalCompositeOperation="copy";e.drawImage(m,0,0);f||((f=document.createElement("canvas")).width=B,f.height=N,k=f.getContext("2d"));k.globalCompositeOperation="copy";k.drawImage(A,0,0);k.globalCompositeOperation="source-in";k.drawImage(A,0,Math.round(170*ia));e.globalCompositeOperation="source-over";
e.drawImage(f,0,0);e.drawImage(p,0,0);e.globalCompositeOperation="screen";e.drawImage(v,0,0);e.globalCompositeOperation="multiply";e.drawImage(u,0,0);g.globalAlpha=.88;g.drawImage(q,P,L);g.globalAlpha=1;g.drawImage(n,P,L);O=Math.round(O+N/2+2)}if(""!=x)for(g.fillStyle="black",ia=x.split("\n"),B=0;B<ia.length;B++)N=ia[B],P=g.measureText(N).width,O+=28,g.fillText(N,I-P/2,O)}function h(){l.width=l.clientWidth;l.height=l.clientHeight;g.font="14pt sans-serif";a()}var q,f,e,k,l=document.createElement("canvas"),
g=l.getContext("2d"),m=new Image,p=new Image,n=new Image,t=new Image,u=new Image,v=new Image,A=new Image,D=[m,p,n,t,u,v,A],y=0,E=0,x="";d+="splash/";for(var G=0;G<D.length;G++)D[G].onload=function(){++y==D.length&&a()};m.src=d+"cup.png";v.src=d+"highlights.png";p.src=d+"lid.png";n.src=d+"lines.png";u.src=d+"shading.png";A.src=d+"smoothie.png";t.src=d+"text.png";c.on("loadingProgress",function(I,O){E=I;x=O;a()});c.on("loadingFailure",function(I){E=0;x=I;a()});c.on("loadingComplete",function(){window.removeEventListener("resize",
h);b.removeChild(l)});window.addEventListener("resize",h);l.className="chickenpaint-splash-screen";b.appendChild(l);h()}function rf(b){for(var c={DELETE:46,BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27," ":32,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40,SHIFT:16,"[":219,"]":221,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,0:48,"-":189,"=":187,"+":187,";":187,META:91,LEFTMETA:91,RIGHTMETA:91,ALT:18,ALTGRAPH:18,OPTION:18,CONTROL:17},d=65;d<=90;d++)c[String.fromCharCode(d)]=d;if((b=b.toUpperCase())in c)return c[b]}
function sf(){let b,c,d,a,h,q,f,e;this.x0=this.y0=this.x1=this.y1=this.x2=this.y2=this.x3=this.y3=0;let k=l=>{let g=3*l,m=g*l;l*=l*l;let p=2*m,n=6*l,t=this.x0-2*this.x1+this.x2,u=this.y0-2*this.y1+this.y2,v=3*(this.x1-this.x2)-this.x0+this.x3,A=3*(this.y1-this.y2)-this.y0+this.y3;b=this.x0;h=this.y0;c=(this.x1-this.x0)*g+t*m+v*l;q=(this.y1-this.y0)*g+u*m+A*l;d=t*p+v*n;f=u*p+A*n;a=v*n;e=A*n};this.compute=(l,g,m)=>{k(1/m);l[0]=b;g[0]=h;for(let p=1;p<m;p++)b+=c,h+=q,c+=d,q+=f,d+=a,f+=e,l[p]=b,g[p]=h}}
function tf(b,c,d,a){var h,q=0;return"boolean"!=typeof c&&(a=d,d=c,c=void 0),function(){function f(){q=+new Date;d.apply(e,l)}var e=this,k=new Date-q,l=arguments;a&&!h&&f();h&&clearTimeout(h);void 0===a&&k>b?f():!0!==c&&(h=setTimeout(a?function(){h=void 0}:f,void 0===a?b-k:b))}}function Zc(b){this.points=b||[]}function xb(b,c){this.x=b;this.y=c}function uf(b){for(var c=document.createElement("canvas"),d=c.getContext("2d"),a=d.createImageData(64,64),h=a.data,q=0,f=0;f<64;f++)for(var e=0;e<64;e++)(8&
e)!=0!=((8&f)!=0)?(h[q++]=255,h[q++]=255,h[q++]=255):(h[q++]=204,h[q++]=204,h[q++]=204),h[q++]=255;return c.width=64,c.height=64,d.putImageData(a,0,0),b.createPattern(c,"repeat")}function Od(b,c){c+="Style";b.globalCompositeOperation="exclusion";"exclusion"==b.globalCompositeOperation?b[c]="white":(b.globalCompositeOperation="difference",b[c]="#888","difference"!=b.globalCompositeOperation&&(b[c]="black"))}function xd(b){function c(){var u=b?d.clientHeight:d.clientWidth;m=k/(f-q)*u;u=(e-q)/(f-q)*
(u-m);h.style[b?"height":"width"]=m+"px";a.style[b?"height":"width"]=m+"px";a.style[b?"top":"left"]=u+"px"}let d=document.createElement("div"),a=document.createElement("div"),h=document.createElement("div"),q=0,f=1,e=0,k=1,l=10,g=!1,m=1,p=!1,n,t=this;this.setValues=function(u,v,A,D){e=u;k=v;q=A;f=D;c()};this.setBlockIncrement=function(u){l=u};this.setUnitIncrement=function(u){};this.getElement=function(){return d};this.getValueIsAdjusting=function(){return g};d.className="chickenpaint-scrollbar "+
(b?"chickenpaint-scrollbar-vertical":"chickenpaint-scrollbar-horizontal");a.className="chickenpaint-scrollbar-handle";a.setAttribute("touch-action","none");h.className="chickenpaint-scrollbar-handle-inner";a.appendChild(h);d.appendChild(a);a.addEventListener("pointerdown",function(u){u.stopPropagation();n=b?u.pageY-d.offsetTop-window.scrollY:u.pageX-d.offsetLeft-window.scrollX;a.setPointerCapture(u.pointerId);a.classList.add("dragging");p=!0});a.addEventListener("pointermove",function(u){p&&(g=!0,
u=b?u.pageY-d.offsetTop-window.scrollY:u.pageX-d.offsetLeft-window.scrollX,e+=(u-n)*(f-q)/((b?d.clientHeight:d.clientWidth)-m),e=Math.min(Math.max(e,q),f),n=u,t.emitEvent("valueChanged",[e]),c(),g=!1)});a.addEventListener("pointerup",function(u){if(u.stopPropagation(),p){try{a.releasePointerCapture(u.pointerId)}catch(v){}a.classList.remove("dragging");p=!1}});a.addEventListener("click",function(u){u.stopPropagation()});d.addEventListener("click",function(u){this==d&&((b?u.pageY-d.offsetTop-window.scrollY:
u.pageX-d.offsetLeft-window.scrollX)<parseInt(a.style[b?"top":"left"],10)?e-=l:e+=l,t.emitEvent("valueChanged",[e]),c())})}function Xb(){this.modes=[]}function Pd(b){function c(){}function d(){}function a(){this.shouldPaintBrushPreview=!1;this.oldPreviewRect=null}function h(){a.call(this);this.smoothMouse={x:0,y:0}}function q(){var F,S;this.mouseDown=function(ja,xa,Ha){if(!this.capture&&0==xa&&!ja.altKey&&!Ja(Va).isPressed("space")&&A())return this.capture=!0,F=S={x:mb+.5,y:nb+.5},this.eraseBrushPreview(),
!0};this.mouseDrag=function(ja){if(this.capture){var xa=new Ba(Math.min(F.x,S.x)-1-1,Math.min(F.y,S.y)-1-1,Math.max(F.x,S.x)+1+1+1,Math.max(F.y,S.y)+1+1+1);if(S={x:mb+.5,y:nb+.5},ja.shiftKey){var Ha=Math.PI/4;ja=Math.round(Math.atan2(S.y-F.y,S.x-F.x)/Ha);switch(ja){case 0:case 4:S.y=F.y;break;case 2:case 6:S.x=F.x;break;default:ja*=Ha,Ha=Math.sqrt((S.y-F.y)*(S.y-F.y)+(S.x-F.x)*(S.x-F.x)),S.x=F.x+Ha*Math.cos(ja),S.y=F.y+Ha*Math.sin(ja)}}return xa.union(new Ba(Math.min(F.x,S.x)-1-1,Math.min(F.y,S.y)-
1-1,Math.max(F.x,S.x)+1+1+1,Math.max(F.y,S.y)+1+1+1)),U(xa),!0}this.mouseMove.call(this,ja)};this.mouseUp=function(ja,xa,Ha){if(this.capture&&0==xa)return ja=E(F),xa=E(S),this.capture=!1,this.drawLine(ja,xa),U(new Ba(Math.min(F.x,S.x)-1-1,Math.min(F.y,S.y)-1-1,Math.max(F.x,S.x)+1+1+1,Math.max(F.y,S.y)+1+1+1)),!0};this.paint=function(){this.capture?(ya.lineWidth=1,ya.beginPath(),ya.moveTo(F.x,F.y),ya.lineTo(S.x,S.y),ya.stroke()):a.prototype.paint.call(this)};a.call(this)}function f(){let F=0,S,ja,
xa,Ha;this.mouseDown=function(ta,Na,eb){if(!this.capture&&0==Na&&!ta.altKey&&!Ja(Va).isPressed("space")&&A())return ta=E({x:mb,y:nb}),F=0,S=ja=xa=Ha=ta,this.capture=!0,this.eraseBrushPreview(),!0};this.mouseDrag=function(ta){if(this.capture&&0===F)return xa=Ha=E({x:mb,y:nb}),Z.repaintAll(),!0;this.mouseMove.call(this,ta)};this.mouseUp=function(ta,Na,eb){if(this.capture&&0==Na){switch(F){case 0:F=1;break;case 1:F=2;break;case 2:this.capture=!1;Na=S;eb=ja;let Gb=xa,kc=Ha;ta=new sf;ta.x0=Na.x;ta.y0=
Na.y;ta.x1=eb.x;ta.y1=eb.y;ta.x2=Gb.x;ta.y2=Gb.y;ta.x3=kc.x;ta.y3=kc.y;Na=Array(500);eb=Array(500);ta.compute(Na,eb,500);Ia.beginStroke(Na[0],eb[0],1);for(ta=1;ta<500;ta++)Ia.continueStroke(Na[ta],eb[ta],1);Ia.endStroke();Z.repaintAll()}return!0}};this.mouseMove=function(ta,Na){if(this.capture)return ta=E({x:mb,y:nb}),1==F?ja=ta:2==F&&(xa=ta),Z.repaintAll(),!0;a.prototype.mouseMove.call(this,ta,Na)};this.paint=function(){if(this.capture){var ta=new sf;let Na=I(S),eb=I(ja),Gb=I(xa),kc=I(Ha);ta.x0=
Na.x;ta.y0=Na.y;ta.x1=eb.x;ta.y1=eb.y;ta.x2=Gb.x;ta.y2=Gb.y;ta.x3=kc.x;ta.y3=kc.y;let Ec=Array(100),ic=Array(100);ta.compute(Ec,ic,100);ya.beginPath();ya.moveTo(Ec[0],ic[0]);for(ta=1;ta<100;ta++)ya.lineTo(Ec[ta],ic[ta]);ya.moveTo(~~Na.x,~~Na.y);ya.lineTo(~~eb.x,~~eb.y);ya.moveTo(~~Gb.x,~~Gb.y);ya.lineTo(~~kc.x,~~kc.y);ya.stroke()}else a.prototype.paint.call(this)};a.call(this)}function e(){var F;this.mouseDown=function(S,ja,xa){return!!this.capture||(Ja(Va).isPressed("space")||(0!=ja||this.transient&&
!S.altKey)&&2!=ja?void(this.transient&&aa.pop()):(F=ja,this.capture=!0,u("crosshair"),this.mouseDrag(S),!0))};this.mouseDrag=function(S){if(this.capture)return S=E({x:mb,y:nb}),Ia.isPointWithin(S.x,S.y)&&b.setCurColor(new jb(Ia.colorPicker(S.x,S.y))),!0};this.mouseUp=function(S,ja,xa){if(this.capture&&ja==F)return F=-1,this.capture=!1,u("default"),this.transient&&aa.pop(),!0};this.enter=function(){c.prototype.enter.call(this);F=-1}}function k(){var F,S,ja,xa;this.keyDown=function(Ha){if(!Ha.ctrlKey&&
!Ha.metaKey&&" "===Ha.key)return this.capture||u("grab"),!0};this.keyUp=function(Ha){if(this.transient&&1!=xa&&" "===Ha.key)return u("default"),aa.pop(),!0};this.mouseDown=function(Ha,ta,Na){return!!this.capture||(1==ta||Ja(Va).isPressed("space")&&!Ha.ctrlKey&&!Ha.metaKey&&0==ta||!this.transient&&0==ta?(this.capture=!0,xa=ta,F=Ha.pageX,S=Ha.pageY,ja=Z.getOffset(),u("grab"),!0):void(this.transient&&aa.pop()))};this.mouseDrag=function(Ha){if(this.capture)return Z.setOffset(ja.x+Ha.pageX-F,ja.y+Ha.pageY-
S),!0};this.mouseUp=function(Ha,ta,Na){if(this.capture&&ta==xa)return xa=-1,this.capture=!1,aa.peek()!==this||(this.transient&&!Ja(Va).isPressed("space")?(u("default"),aa.pop()):u("grab"),!0)};this.enter=function(){u("grab")}}function l(){}function g(){var F,S=new Ba(0,0,0,0),ja=-1;let xa=!1;this.mouseDown=function(Ha,ta,Na){Na=b.mainGUI.getPaletteManager().palettes.brush.getElement().querySelector("#chickenpaint-s-maintainAspectCheckbox");if(Na&&Na instanceof HTMLInputElement&&(xa=Na.checked),!this.capture&&
0==ta&&!Ha.altKey&&!Ja(Va).isPressed("space"))return Ha=x({x:mb,y:nb}),ja=ta,S.makeEmpty(),F=Ha,Z.repaintAll(),this.capture=!0,!0};this.mouseDrag=function(Ha){if(!this.capture)return!1;let ta=x({x:mb,y:nb});Ha=Ha.shiftKey||xa;let Na=~~Math.max(Math.abs(ta.x-F.x),Math.abs(ta.y-F.y));return ta.x>=F.x?(S.left=F.x,S.right=(Ha?F.x+Na:ta.x)+1):(S.left=Ha?F.x-Na:ta.x,S.right=F.x+1),ta.y>=F.y?(S.top=F.y,S.bottom=(Ha?F.y+Na:ta.y)+1):(S.top=Ha?F.y-Na:ta.y,S.bottom=F.y+1),Z.repaintAll(),!0};this.mouseUp=function(Ha,
ta,Na){if(this.capture&&ta==ja)return Ia.rectangleSelection(S),S.makeEmpty(),Z.repaintAll(),this.capture=!1,ja=-1,!0};this.paint=function(){S.isEmpty()||(ya.lineWidth=1,N(ya,B(S)))}}function m(){var F,S,ja=!1;this.mouseDown=function(xa,Ha,ta){if(!this.capture&&0==Ha&&!Ja(Va).isPressed("space")&&v())return F=E({x:mb,y:nb}),S=xa.altKey,ja=!0,this.capture=!0,!0};this.mouseDrag=tf(25,function(xa){if(this.capture){xa=E({x:mb,y:nb});var Ha=xa.x-F.x,ta=xa.y-F.y,Na=~~Ha,eb=~~ta;return(0!=Na||0!=eb)&&(Ia.move(Na,
eb,S&&ja),ja=!1),F.x=xa.x-(Ha-Na),F.y=xa.y-(ta-eb),!0}});this.mouseUp=function(xa,Ha,ta){if(this.capture&&0==Ha)return this.capture=!1,this.transient&&aa.pop(),!0}}function p(){function F(za,Ka){return{x:(za.x+Ka.x)/2,y:(za.y+Ka.y)/2}}function S(za){return{x:Math.round(za.x),y:Math.round(za.y)}}function ja(za,Ka){for(var Qa=0;Qa<za.points.length;Qa++)if((Ka.x-za.points[Qa].x)*(Ka.x-za.points[Qa].x)+(Ka.y-za.points[Qa].y)*(Ka.y-za.points[Qa].y)<=49)return 2*Qa;for(Qa=0;Qa<za.points.length;Qa++){var fb=
za.points[Qa],ib=za.points[(Qa+1)%za.points.length];ib=new xb(ib.x-fb.x,ib.y-fb.y);fb=new xb(Ka.x-fb.x,Ka.y-fb.y);var qc=ib.getLength(),Lc=ib.getScaled(1/qc);qc=fb.getScaled(1/qc);Lc=Lc.getDotProduct(qc);if(Lc>=0&&Lc<=1&&(ib.scale(Lc),(ib.x-fb.x)*(ib.x-fb.x)+(ib.y-fb.y)*(ib.y-fb.y)<=49))return 2*Qa+1}return za.containsPoint(Ka)?-3:-2}function xa(){var za=eb.getTransformed(wb),Ka=ja(za,{x:mb,y:nb});switch(Ka){case 0:case 2:case 4:case 6:Ka=~~(Ka/2);let Qa=za.points[Ka],fb=za.points[(Ka+1)%4];Ha(xb.subtractPoints(za.points[(Ka+
3)%4],Qa).normalize().add(xb.subtractPoints(fb,Qa).normalize()));break;case 1:case 3:case 5:case 7:Ha(xb.subtractPoints(za.points[(~~(Ka/2)+1)%4],za.points[~~(Ka/2)]).getPerpendicular());break;case -3:Ja(Va).isPressed("r")||Ja(Va).isPressed("space")||u("move");break;case -2:Ja(Va).isPressed("r")||Ja(Va).isPressed("space")||u("grab");break;default:u("default")}}function Ha(za){za=Math.floor(Math.atan2(-za.y,za.x)/(Math.PI/4)+.5);switch(za<0&&(za+=4),za){default:za="ew-resize";break;case 1:za="nesw-resize";
break;case 2:za="ns-resize";break;case 3:za="nwse-resize"}u(za)}var ta,Na,eb,Gb,kc,Ec,ic=-1;let Qd=!1;this.mouseDown=function(za,Ka,Qa){Qa=b.mainGUI.getPaletteManager().palettes.brush.getElement().querySelector("#chickenpaint-t-maintainAspectCheckbox");if(Qa&&Qa instanceof HTMLInputElement&&(Qd=Qa.checked),!this.capture&&0==Ka&&!za.altKey&&!Ja(Va).isPressed("space"))return ic=ja(eb.getTransformed(wb),{x:mb,y:nb}),kc=E(Gb={x:mb,y:nb}),this.capture=!0,xa(),!0};this.mouseDrag=tf(40,function(za){if(this.capture){var Ka=
{x:mb,y:nb};switch(ic){case -3:za=S(E(Ka));var Qa=xb.subtractPoints(za,kc);Ka=Qa.getTruncated();Qa=Qa.subtract(Ka);var fb=new qb;fb.translate(Ka.x,Ka.y);ta.preMultiply(fb);kc=xb.subtractPoints(za,Qa);break;case -2:fb=Math.PI/4;Qa=eb.getCenter();var ib=I(Qa),qc=Math.atan2(Ka.y-ib.y,Ka.x-ib.x)-Math.atan2(Gb.y-ib.y,Gb.x-ib.x);ib=new qb;Ec+=qc;za=za.shiftKey?-ta.decompose().rotate+Math.round(Ec/fb)*fb:qc;lc&&(za=-za);ib.rotateAroundPoint(za,Qa.x,Qa.y);ta.preMultiply(ib);Gb=Ka;break;case 0:case 2:case 4:case 6:fb=
~~(ic/2);Qa=Na.points[fb];ib=ta.getInverted().getTransformedPoint(S(E(Ka)));Ka=Na.points[(fb+2)%4];fb=(ib.x-Ka.x)/(Qa.x-Ka.x);Qa=(ib.y-Ka.y)/(Qa.y-Ka.y);if(.001>Math.abs(fb)||.001>Math.abs(Qa)||isNaN(fb)||isNaN(Qa))return!0;if(Qd||za.shiftKey)Qa=fb=za=Math.max(fb,Qa);ta.scaleAroundPoint(fb,Qa,Ka.x,Ka.y);break;case 1:case 5:case 3:case 7:za=~~(ic/2);ib=F(Na.points[za],Na.points[(za+1)%4]);Ka=ta.getInverted().getTransformedPoint(S(E(Ka)));za=F(Na.points[(za+2)%4],Na.points[(za+3)%4]);ib=xb.subtractPoints(ib,
za);Ka=xb.subtractPoints(Ka,za);qc=ib.getLength();Ka=ib.getDotProduct(Ka)/qc/qc;if(.001>Math.abs(Ka)||isNaN(Ka))return!0;1==ic||5==ic?(Qa=1,fb=Ka):(Qa=Ka,fb=1);ta.scaleAroundPoint(Qa,fb,za.x,za.y)}return eb=Na.getTransformed(ta),Ia.transformAffineAmend(ta),Z.repaintAll(),!0}});this.mouseUp=function(za,Ka,Qa){if(this.capture&&0==Ka)return this.capture=!1,ic=-1,!0};this.mouseMove=function(){this.capture||xa()};this.paint=function(){var za=eb.getTransformed(wb).points,Ka=Array(2*za.length);for(var Qa=
0;Qa<za.length;Qa++)Ka[Qa]=za[Qa];for(let ib=0;ib<za.length;ib++){Qa=za[ib];var fb=za[(ib+1)%za.length];Ka[ib+za.length]={x:(Qa.x+fb.x)/2,y:(Qa.y+fb.y)/2}}Od(ya,"fill");for(Qa=0;Qa<Ka.length;Qa++)ya.fillRect(Ka[Qa].x-3,Ka[Qa].y-3,7,7);N(ya,za)};this.keyDown=function(za){if("Enter"===za.key){if(!Yb&&!Ub)return b.actionPerformed({action:"CPTransformAccept"}),!0}else if("Escape"===za.key)return b.actionPerformed({action:"CPTransformReject"}),!0};this.enter=function(){c.prototype.enter.call(this);var za,
Ka=Ia.transformAffineBegin();ta=Ka.transform;Ka.rect;(za=Ka.selection).isEmpty()&&(za=Ka.rect.clone());eb=(Na=new Zc(za.toPoints())).getTransformed(ta);ic=-1;Ec=0;Z.repaintAll()};this.leave=function(){c.prototype.leave.call(this);Z.repaintAll()};this.moveByKey=function(za,Ka){var Qa;if(ta){var fb=new qb;fb.translate(za,Ka);ta.preMultiply(fb);eb=Na.getTransformed(ta);Ia.transformAffineAmend(ta);null==(Qa=this.repaintAll)||Qa.call(this)}}}function n(){var F,S,ja=0,xa=!1,Ha=-1;this.mouseDown=function(ta,
Na,eb){return!!this.capture||(!this.transient&&0==Na&&!ta.altKey&&!Ja(Va).isPressed("space")||0==Na&&!ta.altKey&&!Ja(Va).isPressed("space")&&Ja(Va).isPressed("r")?(F={x:mb,y:nb},ja=Z.getRotation(),S=wb.clone(),lc&&da(S),xa=!1,this.capture=!0,Ha=Na,u("grab"),!0):void(this.transient&&aa.pop()))};this.mouseDrag=function(ta){if(this.capture){var Na=pa.clientWidth/2,eb=pa.clientHeight/2;ta=pa.width/2;var Gb=pa.height/2;Na=Math.atan2(nb-eb,mb-Na)-Math.atan2(F.y-eb,F.x-Na);eb=new qb;return eb.rotateAroundPoint(Na,
ta,Gb),eb.multiply(S),Z.setRotation(ja+Na),Z.setOffset(~~eb.getTranslateX(),~~eb.getTranslateY()),xa=!0,!0}};this.enter=function(){u("grab")};this.mouseUp=function(ta,Na,eb){if(this.capture&&Na==Ha){if(xa){ta=Math.round(lb/(Math.PI/2))*Math.PI/2;if(Math.abs(lb-ta)<5/180*Math.PI){eb=ta-ja;ta=pa.width/2;Na=pa.height/2;let Gb=new qb;Gb.rotateAroundPoint(eb,ta,Na);Gb.multiply(S);Z.setRotation(ja+eb);Z.setOffset(~~Gb.getTranslateX(),~~Gb.getTranslateY());Z.repaintAll()}Z.emitEvent("canvasRotated90",[Z.getRotation90()])}else Z.resetRotation();
return this.capture=!1,this.transient&&!Ja(Va).isPressed("r")?(u("default"),aa.pop()):u("grab"),!0}};this.keyUp=function(ta){if(this.transient&&1!=Ha&&"r"===ta.key.toLowerCase())return u("default"),aa.pop(),!0};this.keyDown=function(ta){if("r"===ta.key.toLowerCase())return!0}}function t(){q.call(this)}function u(F){pa.getAttribute("data-cursor")!=F&&pa.setAttribute("data-cursor",F)}function v(){var F=Ia.getActiveLayer();return F.visible&&F.ancestorsAreVisible()?0!=F.alpha||(b.showLayerNotification(F,
T("Whoops! This layer's opacity is currently 0%."),"opacity"),!1):(b.showLayerNotification(F,T("Whoops! This layer is currently hidden."),"layer"),!1)}function A(){var F=Ia.getActiveLayer();return F instanceof $a&&!Ia.isEditingMask()?(b.showLayerNotification(F,T("Whoops! You can't draw on a group."),"layer"),!1):v()}function D(F,S,ja,xa,Ha){F.setValues(-Ha,xa,S-xa-Ha+ja/4,S+ja-Ha-ja/4);F.setBlockIncrement(Math.max(1,~~(.66*xa)));F.setUnitIncrement(Math.max(1,~~(.05*xa)))}function y({resetViewFlip:F=
!1}={}){(wb.setToIdentity(),wb.translate(hb,Fb),wb.scale(ob,ob),wb.rotate(lb),lc&&!F&&da(wb),null==Ma||null==ab||Ma.getValueIsAdjusting()||ab.getValueIsAdjusting())||(F=P(new Ba(0,0,rb.width,rb.height)),D(Ma,F.left,F.getWidth(),pa.clientWidth,Z.getOffset().x),D(ab,F.top,F.getHeight(),pa.clientHeight,Z.getOffset().y));Z.repaintAll()}function E(F){return wb.getInverted().getTransformedPoint(F)}function x(F){F=E(F);return F.x=Math.floor(F.x),F.y=Math.floor(F.y),F}function G(F){var S=pa.getBoundingClientRect();
return{x:F.x-S.left-window.pageXOffset,y:F.y-S.top-window.pageYOffset}}function I(F){return wb.getTransformedPoint(F)}function O(F){F=I(F);return F.x=Math.round(F.x),F.y=Math.round(F.y),F}function B(F){var S=I({x:(F.left+F.right)/2,y:(F.top+F.bottom)/2});F=F.toPoints();for(var ja=0;ja<F.length;ja++)F[ja]=O(F[ja]),F[ja].x+=.5*Math.sign(S.x-F[ja].x),F[ja].y+=.5*Math.sign(S.y-F[ja].y);return F}function N(F,S){F.beginPath();F.moveTo(S[0].x,S[0].y);for(var ja=1;ja<S.length;ja++)F.lineTo(S[ja].x,S[ja].y);
F.lineTo(S[0].x,S[0].y);F.stroke()}function P(F){var S=O({x:F.left-1,y:F.top-1}),ja=O({x:F.left-1,y:F.bottom}),xa=O({x:F.right,y:F.top-1});F=O({x:F.right,y:F.bottom});S=new Ba(Math.min(Math.min(S.x,ja.x),Math.min(xa.x,F.x)),Math.min(Math.min(S.y,ja.y),Math.min(xa.y,F.y)),Math.max(Math.max(S.x,ja.x),Math.max(xa.x,F.x))+1,Math.max(Math.max(S.y,ja.y),Math.max(xa.y,F.y))+1);return S.grow(2,2),S}function L(){var F=pa.width,S=pa.height,ja=I({x:Ia.width/2,y:Ia.height/2});Z.setOffset(Math.round(hb+F/2-ja.x),
Math.round(Fb+S/2-ja.y))}function ia(F,S,ja){if(F=Math.max(.1,Math.min(8,F)),Z.getZoom()!=F){var xa=Z.getOffset();Z.setOffset(xa.x+~~((S-xa.x)*(1-F/Z.getZoom())),xa.y+~~((ja-xa.y)*(1-F/Z.getZoom())));Z.setZoom(F);Z.repaintAll()}}function V(F,S=!0){let ja=pa.clientWidth,xa=pa.clientHeight;S&&(S=parseFloat(F),.01>Math.abs(S-1)?F=1:.2>Math.abs(S-2)?F=2:.08>Math.abs(S-.5)&&(F=.5));ia(F,ja/2,xa/2)}function ma(F){return"mouse"===F.pointerType&&0!==F.buttons&&0===F.pressure?1:"touch"===F.pointerType?(0!==
F.pressure&&(Wc=!0),Wc)?2*F.pressure:1:2*F.pressure}function da(F){let S=Ia.width/2;F.translate(S,0);F.scale(-1,1);F.translate(-S,0)}function Ca(F){let S=F[0].pageX-F[1].pageX;F=F[0].pageY-F[1].pageY;return Math.sqrt(S*S+F*F)}function ha(F){Mc=F.touches.length;oc&&2===Mc&&(id=Ca(F.touches),Rd=Z.getZoom(),F.preventDefault())}function sa(F){Mc=F.touches.length}function ea(F){if(Mc=F.touches.length,oc&&2===Mc){let S=Ca(F.touches)/id,ja=G({x:(F.touches[0].pageX+F.touches[1].pageX)/2,y:(F.touches[0].pageY+
F.touches[1].pageY)/2});ia(Rd*S,ja.x,ja.y)}F.preventDefault()}function w(F){if(!(W||=pa.getBoundingClientRect(),Mb&&!Hc&&"touch"===F.pointerType||Mc>1&&"touch"===F.pointerType||Ja(Va).isPressed("z")||F.ctrlKey&&Ja(Va).isPressed("space"))){mb=F.clientX-W.left;nb=F.clientY-W.top;var S=Nb?ma(F):0;(1&F.buttons)!=0!=kb[0]&&(kb[0]=!kb[0],kb[0]?aa.mouseDown(F,0,S):aa.mouseUp(F,0,S));(2&F.buttons)!=0!=kb[2]&&(kb[2]=!kb[2],kb[2]?aa.mouseDown(F,2,S):aa.mouseUp(F,2,S));(4&F.buttons)!=0!=kb[1]&&(kb[1]=!kb[1],
kb[1]?aa.mouseDown(F,1,S):aa.mouseUp(F,1,S));Nb?aa.mouseDrag(F,S):aa.mouseMove(F,S);Mb||"pen"!==F.pointerType||(Mb=!0)}}function H(){ac||(ac=!0,window.requestAnimationFrame(function(){Z.paint()}))}function U(F){qa.union(F);H()}function na(){ec=Ia.getBounds();Z.repaintAll()}let W,Z=this,ba=document.createElement("div"),la=document.createElement("div"),Ga=document.createElement("div"),pa=document.createElement("canvas"),ya=pa.getContext("2d"),rb=document.createElement("canvas"),bb=rb.getContext("2d"),
Qb=uf(ya),Ia=b.getArtwork(),ob=1,hb=0,Fb=0,lb=0,wb=new qb,sc=!1,Lb=!1,yb=32,mb=0,nb=0,wc=!1,kb=[!1,!1,!1],Mb=!1,oc=!1,Hc=!1,Wc=!1,ec=Ia.getBounds(),qa=new Ba(0,0,0,0),ac=!1,fc,$b,xc,La,Rb,tc,C,M,X,Y,ca=[],aa=new Xb,va,Ma=new xd(!1),ab=new xd(!0),Yb=null,Ub=null,Pb=0,Kb=255,vb=!0,Vb=!0,Ic=0,Nb=!1;Math.sign=Math.sign||function(F){return 0==(F*=1)||isNaN(F)?F:F>0?1:-1};c.prototype.transient=!1;c.prototype.capture=!1;c.prototype.enter=function(){u("default")};c.prototype.leave=function(){this.capture=
!1};c.prototype.mouseMove=c.prototype.paint=c.prototype.mouseDown=c.prototype.mouseDrag=c.prototype.mouseUp=c.prototype.keyDown=c.prototype.suspend=c.prototype.resume=c.prototype.keyUp=function(){};d.prototype=Object.create(c.prototype);d.prototype.constructor=d;d.prototype.mouseDown=function(F,S,ja){var xa=Ja(Va).isPressed("space");xa||2!=S&&(0!=S||F.ctrlKey||F.metaKey||!F.altKey)?xa||0!=S||F.altKey||!Ja(Va).isPressed("r")?1!=S&&(F.altKey||F.ctrlKey||F.metaKey||Ja(Va).isPressed("z")||!xa||0!=S)||
(aa.push(La,!0),aa.peek().mouseDown(F,S,ja)):(aa.push(Rb,!0),aa.peek().mouseDown(F,S,ja)):(aa.push(xc,!0),aa.peek().mouseDown(F,S,ja))};let mc=null;d.prototype.keyDown=function(F){if(!F.altKey&&(!F.ctrlKey&&!F.metaKey&&Ja(Va).isPressed("z")||F.ctrlKey&&Ja(Va).isPressed("space")))return u("zoom-in"),aa.peek()===va&&(mc=va,aa.pop()),F.preventDefault(),!0;if("r"===F.key.toLowerCase()&&" "!==F.key)return aa.push(Rb,!0),aa.peek().keyDown(F),!0;if(" "===F.key&&(!F.ctrlKey&&!F.metaKey||"z"!==F.key.toLowerCase()))return aa.push(La,
!0),aa.peek().keyDown(F),F.preventDefault(),!0;if(aa.peek()===M||aa.peek()===X){if("Enter"===F.key){if(Yb||Ub)return;b.actionPerformed({action:"CPTransform"});F.preventDefault()}}else if((aa.peek()===La||aa.peek()===Rb)&&"Enter"===F.key){if(Yb||Ub)return;b.actionPerformed({action:"CPResetZoomAndRotation"});F.preventDefault()}return!1};d.prototype.keyUp=function(F){" "!==F.key&&"control"!==F.key.toLowerCase()&&"z"!==F.key.toLowerCase()||(u("default"),mc&&(aa.setUserMode(mc),mc=null),F.preventDefault())};
a.prototype=Object.create(c.prototype);a.prototype.constructor=a;a.prototype.getBrushPreviewOval=function(){let F=b.getBrushSize()*ob/2;return new Ba(mb-F,nb-F,mb+F,nb+F)};a.prototype.queueBrushPreview=function(){if(aa.peek()==this){this.shouldPaintBrushPreview=!0;var F=this.getBrushPreviewOval();F.grow(2,2);null!=this.oldPreviewRect&&(F.union(this.oldPreviewRect),this.oldPreviewRect=null);U(F)}};a.prototype.eraseBrushPreview=function(){this.shouldPaintBrushPreview=!1;null!=this.oldPreviewRect&&(U(this.oldPreviewRect),
this.oldPreviewRect=null)};a.prototype.mouseMove=function(F,S){this.queueBrushPreview()};a.prototype.enter=function(){c.prototype.enter.call(this);wc&&this.queueBrushPreview()};a.prototype.leave=function(){c.prototype.leave.call(this);this.eraseBrushPreview()};a.prototype.suspend=a.prototype.leave;a.prototype.resume=a.prototype.enter;a.prototype.paint=function(){if(this.shouldPaintBrushPreview){this.shouldPaintBrushPreview=!1;var F=this.getBrushPreviewOval();ya.beginPath();ya.arc((F.left+F.right)/
2,(F.top+F.bottom)/2,F.getWidth()/2,0,2*Math.PI);ya.stroke();F.grow(2,2);null==this.oldPreviewRect?this.oldPreviewRect=F:this.oldPreviewRect.union(F)}};h.prototype=Object.create(a.prototype);h.prototype.constructor=h;h.prototype.mouseDown=function(F,S,ja){if(!this.capture&&0==S&&!F.altKey&&!Ja(Va).isPressed("space")&&A()&&(F=E({x:mb,y:nb}),this.eraseBrushPreview(),Ia.beginStroke(F.x,F.y,ja)))return this.capture=!0,this.smoothMouse=F,!0};h.prototype.mouseDrag=function(F,S){if(("number"!=typeof navigator.maxTouchPoints||
navigator.maxTouchPoints<3)&&a.prototype.mouseMove.call(this,F,S),this.capture){F=E({x:mb,y:nb});var ja=Math.min(.999,Math.pow(b.getBrushInfo().smoothing,.3));let xa=1-ja;return this.smoothMouse.x=xa*F.x+ja*this.smoothMouse.x,this.smoothMouse.y=xa*F.y+ja*this.smoothMouse.y,Ia.continueStroke(this.smoothMouse.x,this.smoothMouse.y,S),!0}this.mouseMove(F)};h.prototype.mouseUp=function(F,S,ja){if(this.capture)return 0==S&&(this.capture=!1,Ia.endStroke()),!0};q.prototype=Object.create(a.prototype);q.prototype.constructor=
q;q.prototype.drawLine=function(F,S){Ia.beginStroke(F.x,F.y,1);Ia.continueStroke(S.x,S.y,1);Ia.endStroke()};f.prototype=Object.create(a.prototype);f.prototype.constructor=f;e.prototype=Object.create(c.prototype);e.prototype.constructor=e;k.prototype=Object.create(c.prototype);k.prototype.constructor=k;this.setGrowFillArea=function(F=0){Pb=Number(F)};this.setFoodFillAlpha=function(F=255){Kb=Number(F)};this.setFloodFillReferAllLayers=function(F){vb=!!F};l.prototype=Object.create(c.prototype);l.prototype.constructor=
l;l.prototype.mouseDown=function(F,S,ja){if(0==S&&!F.altKey&&!Ja(Va).isPressed("space")&&A())return F=E({x:mb,y:nb}),Ia.isPointWithin(F.x,F.y)&&(Ia.floodFill(F.x,F.y,Pb,Kb,vb),Z.repaintAll()),!0};g.prototype=Object.create(c.prototype);g.prototype.constructor=g;m.prototype=Object.create(c.prototype);m.prototype.constructor=m;m.prototype.mouseMove=function(F){return aa.peek()!==this||(Ja(Va).isPressed("r")&&Ja(Va).isPressed("space")||u("move"),!0)};m.prototype.enter=function(){Ja(Va).isPressed("r")&&
Ja(Va).isPressed("space")||u("move")};p.prototype=Object.create(c.prototype);p.prototype.constructor=p;this.setModalShown=function(F){(Yb=!!F)||(Ub=!0,setTimeout(()=>Ub=!1,300))};document.addEventListener("keydown",function(F){let S=aa.peek(),ja=function(ta){if(!Yb){if(!ta)return null;switch(ta.toLowerCase()){case "arrowup":return{dx:0,dy:-1};case "arrowdown":return{dx:0,dy:1};case "arrowleft":return{dx:-1,dy:0};case "arrowright":return{dx:1,dy:0};default:return null}}}(F.key);if(ja){var {dx:xa,dy:Ha}=
ja;(lc&&(xa=-xa),S===Y)?(Y.moveByKey(xa,Ha),F.preventDefault()):S===X&&(Ia.move(xa,Ha,F.altKey),F.preventDefault())}});n.prototype=Object.create(c.prototype);n.prototype.constructor=n;t.prototype=Object.create(q.prototype);t.prototype.constructor=t;t.prototype.drawLine=function(F,S){Ia.gradientFill(Math.round(F.x),Math.round(F.y),Math.round(S.x),Math.round(S.y),b.getCurGradient())};t.prototype.queueBrushPreview=function(){};this.setZoom=function(F){ob=F;y()};this.getZoom=function(){return ob};this.setGridSize=
function(F){yb=Math.max(Math.round(F),1);this.repaintAll()};this.getGridSize=function(){return yb};this.setOffset=function(F,S){isNaN(F)||isNaN(S)?console.log("Bad offset"):(hb=F,Fb=S,y())};this.getOffset=function(){return{x:hb,y:Fb}};this.setInterpolation=function(F){sc=F;ya&&(ya.imageSmoothingEnabled=F);this.repaintAll()};this.setRotation=function(F){lb=F%(2*Math.PI);y()};this.setRotationOnCenter=function(F){let S=pa.width/2,ja=pa.height/2;var xa=F-lb;let Ha=Math.cos(xa);xa=Math.sin(xa);let ta=
hb-S,Na=Fb-ja;hb=S+ta*Ha-Na*xa;Fb=ja+ta*xa+Na*Ha;lb=F%(2*Math.PI);y()};this.getRotation=function(){return lb};this.getRotationDegrees=function(){return(180*this.getRotation()/Math.PI+180+360)%360-180};this.setRotationDegrees=function(F){this.setRotationOnCenter(F*Math.PI/180)};this.getRotation90=function(){var F=Math.round(this.getRotation()/Math.PI*2);return(F%=4)<0&&(F+=4),F};this.zoomIn=function(){V(1.41*this.getZoom())};this.zoomOut=function(){V(.7092*this.getZoom())};this.zoom100=function(){V(1);
L()};this.zoomOnCenter=(F,S=!1)=>{V(F,S)};this.resetRotation=function(){var F=pa.width/2,S=pa.height/2,ja=new qb;ja.rotateAroundPoint(-this.getRotation(),F,S);ja.multiply(wb);lc&&da(ja);this.setOffset(~~ja.getTranslateX(),~~ja.getTranslateY());this.setRotation(0);Z.emitEvent("canvasRotated90",[0])};this.resetZoomAndRotation=function(){this.zoom100();this.resetRotation();lc=!1;y({resetViewFlip:!0})};this.isPanOrRotateMode=function(){return oc};let uc=!1,lc=!1;this.toggleViewFlip=()=>(lc?(lc=!1,y({resetViewFlip:!0})):
(da(wb),lc=!0,Z.repaintAll()),lc);let yd=!1,$c=0,Nc=0;pa.addEventListener("pointerdown",F=>{!F.altKey&&(!F.ctrlKey&&!F.metaKey&&Ja(Va).isPressed("z")||F.ctrlKey&&Ja(Va).isPressed("space"))&&"touch"!==F.pointerType&&(yd=!0,$c=F.clientX);(F.ctrlKey||F.metaKey)&&F.altKey&&1===F.buttons&&(F.clientX,Nc=F.clientX)});pa.addEventListener("pointermove",F=>{if(!F.altKey&&(!F.ctrlKey&&!F.metaKey&&Ja(Va).isPressed("z")||F.ctrlKey&&Ja(Va).isPressed("space"))&&yd&&"touch"!==F.pointerType&&1===F.buttons){var S=
F.clientX-$c;if(Math.abs(S)>10){var ja=G({x:F.pageX,y:F.pageY});ia(Z.getZoom()*(S>0?1.15:1/1.15),ja.x,ja.y);$c=F.clientX}F.preventDefault()}(F.ctrlKey||F.metaKey)&&F.altKey&&1===F.buttons&&(S=F.clientX-Nc,Nc=F.clientX,ja=b.getBrushSize(),b.setBrushSize(ja+(ja<=10?S*(.08+.17*Math.pow(Math.min(1,Math.max(0,(ja-1)/9)),1.5)):.5*S)),F.preventDefault())});pa.addEventListener("pointerup",F=>{"touch"!==F.pointerType&&(yd=!1)});let id=0,Rd=1,Mc=0,jd=0,kd=0,ad=!1,bd=null;this.getElement=function(){return ba};
this.repaintAll=function(){qa.left=0;qa.top=0;qa.right=pa.width;qa.bottom=pa.height;H()};this.paint=function(){var F=!1;if(ac=!1,qa.isEmpty()||(ya.save(),ya.clipTo&&(ya.beginPath(),qa.left|=0,qa.top|=0,ya.rect(qa.left,qa.top,Math.ceil(qa.getWidth()),Math.ceil(qa.getHeight())),ya.clip()),F=!0),!ec.isEmpty()){var S=fc&&fc.isOpen()?fc.getImageData():Ia.fusionLayers().getImageData();bb.putImageData(S,0,0,ec.left,ec.top,ec.getWidth(),ec.getHeight());ec.makeEmpty()}ya.fillStyle="#606060";ya.fillRect(0,
0,pa.width,pa.height);ya.save();ya.setTransform(wb.m[0],wb.m[1],wb.m[2],wb.m[3],wb.m[4],wb.m[5]);ya.fillStyle=Qb;ya.fillRect(0,0,Ia.width,Ia.height);ya.drawImage(rb,0,0,rb.width,rb.height);ya.restore();Od(ya,"stroke");ya.lineWidth=1;S=Ia.getSelection().isEmpty();if(Vb!==S&&b.mainGUI.getPaletteManager().updateDeselectIcon(),Vb=S,!(S||aa.peek()instanceof g&&aa.peek().capture)){if(![tc,La,Rb,Y,xc].includes(aa.peek())){S=B(Ia.getSelection());S[0].x;S[1].x;S[2].x;S[3].x;S[0].y;S[1].y;S[2].y;S[3].y;S[0].x;
S[1].x;S[2].x;S[3].x;S[0].y;S[1].y;S[2].y;S[3].y;ya.save();ya.globalCompositeOperation="source-over";ya.fillStyle="rgba(96, 96, 96, 0.035)";ya.beginPath();ya.rect(0,0,pa.width,pa.height);ya.moveTo(S[0].x,S[0].y);for(var ja=1;ja<S.length;ja++)ya.lineTo(S[ja].x,S[ja].y);ya.closePath();ya.fill("evenodd");ya.restore()}ya.setLineDash([3,2]);N(ya,B(Ia.getSelection()));ya.setLineDash([])}if(Lb&&(S=Ia.getBounds(),ob*yb>2)){ya.beginPath();for(ja=yb-1;ja<S.right;ja+=yb){var xa=I({x:ja,y:S.top}),Ha=I({x:ja,
y:S.bottom});ya.moveTo(xa.x+.5,xa.y+.5);ya.lineTo(Ha.x+.5,Ha.y+.5)}for(ja=yb-1;ja<S.bottom;ja+=yb)xa=I({x:0,y:ja}),Ha=I({x:S.right,y:ja}),ya.moveTo(xa.x+.5,xa.y+.5),ya.lineTo(Ha.x+.5,Ha.y+.5);ya.stroke()}aa.paint(ya);ya.globalCompositeOperation="source-over";F&&(qa.makeEmpty(),ya.restore())};this.showGrid=function(F){Lb=F;this.repaintAll()};this.resize=function(F,S){F-=Ga.offsetHeight;F=Math.floor(F);pa.style.height=F+"px";pa.width=pa.clientWidth;pa.height=F;W=null;S||L();this.setInterpolation(sc);
this.repaintAll()};b.on("toolChange",function(F,S){S=ca[S.strokeMode];for(var ja=0;ja<aa.modes.length;ja++)if(aa.modes[ja]instanceof a){aa.modes[ja].leave();aa.modes[ja]=S;aa.modes[ja].enter();break}va=S;Ic=F});b.on("modeChange",function(F){switch(F){case ka.M_DRAW:var S=va;break;case ka.M_FLOODFILL:S=tc;break;case ka.M_GRADIENTFILL:S=C;break;case ka.M_RECT_SELECTION:S=M;break;case ka.M_MOVE_TOOL:S=X;break;case ka.M_ROTATE_CANVAS:S=Rb;break;case ka.M_PAN_CANVAS:S=La;break;case ka.M_COLOR_PICKER:S=
xc;break;case ka.M_TRANSFORM:S=Y}oc=F===ka.M_PAN_CANVAS||F===ka.M_ROTATE_CANVAS;Hc=F===ka.M_MOVE_TOOL||F===ka.M_ROTATE_CANVAS||F===ka.M_PAN_CANVAS;oc?(pa.addEventListener("touchstart",ha,{passive:!1}),pa.addEventListener("touchend",sa,{passive:!1}),pa.addEventListener("touchmove",ea,{passive:!1})):(pa.removeEventListener("touchstart",ha),pa.removeEventListener("touchend",sa),pa.removeEventListener("touchmove",ea));aa.setUserMode(S);Z.repaintAll()});b.on("maskViewOpened",function(F){fc&&fc.off("changeLayer",
na);(fc=F).on("changeLayer",na);na()});$b=new d;xc=new e;La=new k;Rb=new n;tc=new l;C=new t;M=new g;X=new m;Y=new p;va=(ca=[new h,new q,new f])[wa.STROKE_MODE_FREEHAND];aa.setDefaultMode($b);aa.setUserMode(va);rb.width=Ia.width;rb.height=Ia.height;pa.width=800;pa.height=900;pa.className="chickenpaint-canvas";pa.setAttribute("touch-action","none");ya.setLineDash||(ya.setLineDash=function(){});pa.addEventListener("contextmenu",function(F){F.preventDefault()});pa.addEventListener("mouseenter",function(){wc=
!0});pa.addEventListener("mouseleave",function(){wc=!1;kb[0]||kb[2]||kb[1]||Z.repaintAll()});pa.addEventListener("pointerdown",function(F){Nb=!0;Mb&&!Hc&&"touch"===F.pointerType||Ja(Va).isPressed("z")||(pa.setPointerCapture(F.pointerId),W=pa.getBoundingClientRect(),mb=F.clientX-W.left,nb=F.clientY-W.top,kb[0]=!1,kb[2]=!1,kb[1]=!1,kb[F.button]=!0,aa.mouseDown(F,F.button,ma(F)))});pa.addEventListener("pointermove",function(F){if(Nb&&aa.peek()instanceof h&&[0,1,2,3,4].includes(Ic)&&32>=b.getBrushSize()){var S,
ja;for(let xa of null!=(ja=null==(S=F.getCoalescedEvents)?void 0:S.call(F))?ja:[F])w(xa)}else w(F)});pa.addEventListener("pointerup",function(F){Nb=!1;let S=++jd-kd>=60,ja=ad&&jd>kd;(S||ja)&&(console.log("Auto-saving..."),b.actionPerformed({action:"CPSaveDB"}),kd=jd,ad=!1,bd&&(ad=!1,clearTimeout(bd)),bd=setTimeout(()=>{ad=!0},12E4));kb[0]=!1;kb[2]=!1;kb[1]=!1;aa.mouseUp(F,F.button,0);pa.releasePointerCapture(F.pointerId)});pa.addEventListener("wheel",function(F){if(0!=F.deltaY){if(!uc||Math.abs(F.deltaY)>
20){let S;S=F.deltaY>0?1/1.15:1.15;let ja=G({x:F.pageX,y:F.pageY}),xa=E(ja);Ia.isPointWithin(xa.x,xa.y)?ia(Z.getZoom()*S,ja.x,ja.y):ia(Z.getZoom()*S,hb+~~(Ia.width*ob/2),Fb+~~(Ia.height*ob/2));uc=uc||setTimeout(function(){uc=!1},50)}F.preventDefault()}},{passive:!1});document.addEventListener("keydown",function(F){aa.keyDown(F)});document.addEventListener("keyup",function(F){"alt"===F.key.toLowerCase()&&F.preventDefault();aa.keyUp(F)});document.addEventListener("visibilitychange",function(){let F=
pa.height+Ga.offsetHeight;pa.width=1;pa.height=1;Z.resize(F,!0)},!1);window.addEventListener("scroll",function(){W=null});pa.addEventListener("mousedown",function(F){1==F.button&&F.preventDefault()});Ia.on("changeSelection",function(){Z.repaintAll()});Ia.on("updateRegion",function(F){ec.union(F);U(P(ec))});Ma.on("valueChanged",function(F){var S=Z.getOffset();Z.setOffset(-F,S.y)});ab.on("valueChanged",function(F){var S=Z.getOffset();Z.setOffset(S.x,-F)});this.setInterpolation(!0);var ld=document.createElement("div");
ld.className="chickenpaint-canvas-container-wrapper";ld.appendChild(pa);la.className="chickenpaint-canvas-container-top";la.appendChild(ld);la.appendChild(ab.getElement());Ga.className="chickenpaint-canvas-container-bottom";Ga.appendChild(Ma.getElement());ba.appendChild(la);ba.appendChild(Ga);b.setCanvas(this)}function Tb(b,c,d,a){function h(G){if(("dragStart"===A||"dragging"===A)&&0!==G.buttons){var I,O;let B=G.pageX-D.x;G=G.pageY-D.y;"dragStart"==A&&(I={x:B,y:G},O=v,(I.x-O.x)*(I.x-O.x)+(I.y-O.y)*
(I.y-O.y)>25)&&(A="dragging");"dragging"==A&&E.setLocation(B,G)}}function q(G){if("dragging"===A||"dragStart"===A){"dragStart"===A&&(G.stopPropagation(),G.preventDefault(),setTimeout(()=>{E.setLocation(v.x,v.y);E.toggleCollapse()},100));A=!1;try{G.target.releasePointerCapture(G.pointerId)}catch(I){console.error(I)}}m.removeEventListener("pointermove",h);m.removeEventListener("pointerup",q)}function f(G){G.stopPropagation();G.preventDefault();"vertResize"===A&&E.setHeight(G.pageY-g.offsetTop-y)}function e(G){null==
t||t.releasePointerCapture(G.pointerId);A=!1;t.removeEventListener("pointermove",f);t.removeEventListener("pointerup",e)}function k(G){G.stopPropagation();G.preventDefault();"horzResize"==A&&E.setWidth(G.pageX-g.offsetLeft)}function l(G){u.releasePointerCapture(G.pointerId);A=!1;u.removeEventListener("pointermove",k);u.removeEventListener("pointerup",l)}b.getSmallScreenMode()&&T(d+" (shorter)")!==d+" (shorter)"?this.title=T(d+" (shorter)"):this.title=T(d);a=a||{};this.name=c;this.resizeVert=a.resizeVert||
!1;this.resizeHorz=a.resizeHorz||!1;let g=document.createElement("div"),m=document.createElement("div"),p=document.createElement("i");d=document.createElement("button");let n=document.createElement("div"),t=null,u=null,v,A,D,y=0,E=this;this.getElement=function(){return g};this.getBodyElement=function(){return n};this.getWidth=function(){return g.offsetWidth};this.getHeight=function(){return g.offsetHeight};this.getX=function(){return parseInt(g.style.left,10)||0};this.getY=function(){return parseInt(g.style.top,
10)||0};this.setLocation=function(G,I){g.style.left=G+"px";g.style.top=I+"px"};this.setWidth=function(G){g.style.width=G+"px"};this.setHeight=function(G){g.style.height=G+"px"};this.setSize=function(G,I){this.setWidth(G);this.setHeight(I)};this.setCollapseDownwards=function(G){a.collapseDownwards=G};this.toggleCollapse=function(G){var I;if(void 0===G)G=!g.classList.contains("collapsed");else if(g.classList.contains("collapsed")===G)return;var O=null==(I=g.closest(".chickenpaint"))?void 0:I.querySelector(".chickenpaint-canvas");
I=O?O.clientHeight:window.innerHeight;O=this.getHeight();O=this.getY()+O;(g.classList.toggle("collapsed",G),p.classList.toggle("icon-angle-down",!G),p.classList.toggle("icon-angle-up",G),G)?a.collapseDownwards&&this.setLocation(this.getX(),Math.min(O,I)-this.getHeight()):(G=this.getHeight(),a.collapseDownwards?this.setLocation(this.getX(),Math.max(O-G,0)):this.getY()+G>I&&this.setLocation(this.getX(),Math.max(I-G,0)))};this.userIsDoneWithUs=function(){b.getSmallScreenMode()&&this.toggleCollapse(!0)};
p.className="collapse-icon fas icon-angle-down";d.type="button";d.className="btn btn-close";d.textContent="";d.tabIndex=-1;g.className="chickenpaint-palette chickenpaint-palette-"+c;m.className="chickenpaint-palette-head";m.setAttribute("touch-action","none");c=document.createElement("div");let x=document.createElement("h5");c.className="modal-header";x.className="modal-title";x.appendChild(document.createTextNode(this.title));x.appendChild(p);c.appendChild(x);c.appendChild(d);m.appendChild(c);n.className=
"chickenpaint-palette-body";g.appendChild(m);g.appendChild(n);this.resizeVert&&((t=document.createElement("div")).className="chickenpaint-resize-handle-vert",t.addEventListener("pointerdown",function(G){G.stopPropagation();G.preventDefault();A="vertResize";y=G.pageY-g.offsetTop-g.offsetHeight;t.setPointerCapture(G.pointerId);t.addEventListener("pointermove",f);t.addEventListener("pointerup",e)}),g.appendChild(t));this.resizeHorz&&((u=document.createElement("div")).className="chickenpaint-resize-handle-horz",
u.addEventListener("pointerdown",function(G){G.stopPropagation();G.preventDefault();A="horzResize";u.setPointerCapture(G.pointerId);u.addEventListener("pointermove",k);u.addEventListener("pointerup",l)}),g.appendChild(u));m.addEventListener("pointerdown",function(G){0==G.button&&(G.stopPropagation(),G.preventDefault(),"BUTTON"==G.target.nodeName?E.emitEvent("paletteVisChange",[E,!1]):(v={x:parseInt(g.style.left,10)||0,y:parseInt(g.style.top,10)||0},D={x:G.pageX-g.offsetLeft,y:G.pageY-g.offsetTop},
A=b.getSmallScreenMode()?"dragStart":"dragging",G.target.setPointerCapture(G.pointerId)),m.addEventListener("pointermove",h),m.addEventListener("pointerup",q))})}function Sd(b){function c(f){"LI"==this.nodeName&&(f=a[parseInt(this.getAttribute("data-buttonIndex"),10)],b.actionPerformed({action:f.command}))}Tb.call(this,b,"tool","Tools");let d=this,a=[{className:"chickenpaint-tool-rect-selection",command:"CPRectSelection",toolTip:"Marquee",shortcut:"m",mode:ka.M_RECT_SELECTION},{className:"chickenpaint-tool-move",
command:"CPMoveTool",toolTip:"Move tool",shortcut:"v",mode:ka.M_MOVE_TOOL},{className:"chickenpaint-tool-flood-fill",command:"CPFloodFill",toolTip:"Flood fill",shortcut:"f",mode:ka.M_FLOODFILL},{className:"chickenpaint-tool-gradient-fill",command:"CPGradientFill",toolTip:"Gradient fill",shortcut:"g",mode:ka.M_GRADIENTFILL},{className:"chickenpaint-tool-color-picker",command:"CPColorPicker",toolTip:"Color picker",shortcut:"i",mode:ka.M_COLOR_PICKER},{className:"chickenpaint-tool-blur",command:"CPBlur",
toolTip:"Blur",shortcut:"u",mode:ka.M_DRAW,tool:ka.T_BLUR},{className:"chickenpaint-tool-pencil",command:"CPPencil",toolTip:"Pencil",shortcut:"n",mode:ka.M_DRAW,tool:ka.T_PENCIL},{className:"chickenpaint-tool-pen",command:"CPPen",toolTip:"Pen",selected:!0,shortcut:"b",mode:ka.M_DRAW,tool:ka.T_PEN},{className:"chickenpaint-tool-airbrush",command:"CPAirbrush",toolTip:"Airbrush",shortcut:"a",mode:ka.M_DRAW,tool:ka.T_AIRBRUSH},{className:"chickenpaint-tool-water",command:"CPWater",toolTip:"Waterpaint",
shortcut:"w",mode:ka.M_DRAW,tool:ka.T_WATER},{className:"chickenpaint-tool-eraser",command:"CPEraser",toolTip:"Eraser",shortcut:"e",mode:ka.M_DRAW,tool:ka.T_ERASER},{className:"chickenpaint-tool-soft-eraser",command:"CPSoftEraser",toolTip:"Soft eraser",shortcut:"s",mode:ka.M_DRAW,tool:ka.T_SOFTERASER},{className:"chickenpaint-tool-smudge",command:"CPSmudge",toolTip:"Smudge",shortcut:"d",mode:ka.M_DRAW,tool:ka.T_SMUDGE},{className:"chickenpaint-tool-blender",command:"CPBlender",toolTip:"Blender",shortcut:"c",
mode:ka.M_DRAW,tool:ka.T_BLENDER},{className:"chickenpaint-tool-dodge",command:"CPDodge",toolTip:"Dodge (tool)",shortcut:"o",mode:ka.M_DRAW,tool:ka.T_DODGE},{className:"chickenpaint-tool-burn",command:"CPBurn",toolTip:"Burn (tool)",shortcut:"p",mode:ka.M_DRAW,tool:ka.T_BURN},{className:"chickenpaint-tool-rotate-canvas",command:"CPRotateCanvas",commandDoubleClick:"CPResetCanvasRotation",toolTip:"Rotate canvas",mode:ka.M_ROTATE_CANVAS},{className:"chickenpaint-tool-pan-canvas",command:"CPPanCanvas",
toolTip:"Grab canvas",mode:ka.M_PAN_CANVAS}],h=document.createElement("ul");b.on("modeChange",function(f){let e=d.getBodyElement();(e.querySelectorAll("li").forEach(function(k){k.classList.remove("selected")}),f==ka.M_DRAW)?(f=e.querySelector(`li[data-tool="${b.getCurTool()}"]`))&&f.classList.add("selected"):(f=e.querySelector(`li[data-mode="${f}"]`))&&f.classList.add("selected")});b.on("toolChange",function(f){let e=d.getBodyElement();b.getCurMode()==ka.M_DRAW&&(e.querySelectorAll("li").forEach(function(k){k.classList.remove("selected")}),
(f=e.querySelector(`li[data-tool="${f}"]`))&&f.classList.add("selected"))});let q=d.getBodyElement();for(let f in h.className="chickenpaint-tools list-unstyled",a)!function(e){let k=a[e],l=document.createElement("li"),g=document.createElement("div");l.className="chickenpaint-toolbar-button "+k.className;l.setAttribute("data-buttonIndex",e);l.setAttribute("data-mode",k.mode);void 0!==k.tool&&l.setAttribute("data-tool",k.tool);l.title=T(k.toolTip);k.shortcut&&(l.title+=" ("+k.shortcut.toUpperCase()+
")",Ja(Va)(k.shortcut,function(){return c.call(l),!1}));k.selected&&(l.className+=" selected");g.className="chickenpaint-toolbar-button-icon";l.appendChild(g);h.appendChild(l)}(f);h.addEventListener("click",function(f){let e=f.target.closest("li");e&&c.call(e,f)});h.addEventListener("dblclick",function(f){if(f=f.target.closest("li"))f=a[parseInt(f.getAttribute("data-buttonIndex"),10)],f.commandDoubleClick&&b.actionPerformed({action:f.commandDoubleClick})});q.appendChild(h)}function Td(b){Tb.call(this,
b,"misc","Misc");this.flipButton=null;let c=this,d=[{className:"chickenpaint-tool-zoom-in",command:"CPZoomIn",toolTip:"Zoom in"},{className:"chickenpaint-tool-zoom-out",command:"CPZoomOut",toolTip:"Zoom out"},{className:"chickenpaint-tool-zoom-100",command:"CPZoom100",toolTip:"Zoom 100%"},{className:"chickenpaint-tool-flip-horizontal",command:"CPViewHFlip",toolTip:"Flip View Horizontal"},{className:"chickenpaint-tool-undo",command:"CPUndo",toolTip:"Undo"},{className:"chickenpaint-tool-redo",command:"CPRedo",
toolTip:"Redo"},{className:"chickenpaint-tool-send",command:"CPSend",toolTip:"Save Oekaki"}];!function(){let a=c.getBodyElement(),h=document.createElement("ul");for(let q in h.className="chickenpaint-misc-tools list-unstyled",d){let f=d[q],e=document.createElement("li"),k=document.createElement("div");"CPSend"!=f.command||b.isActionSupported("CPContinue")||(f.toolTip="Post Oekaki",f.className="chickenpaint-tool-send-and-end");e.className="chickenpaint-toolbar-button "+f.className;e.setAttribute("data-buttonIndex",
q);e.setAttribute("title",T(f.toolTip));k.className="chickenpaint-toolbar-button-icon";e.appendChild(k);h.appendChild(e);"chickenpaint-tool-flip-horizontal"===f.className&&(c.flipButton=e)}h.addEventListener("click",function(q){if(q=q.target.closest("li"))q=d[parseInt(q.getAttribute("data-buttonIndex"),10)],b.actionPerformed({action:q.command})});a.appendChild(h)}()}function Ud(b){Tb.call(this,b,"stroke","Stroke");let c=[{className:"chickenpaint-tool-freehand",command:"CPFreeHand",toolTip:T("Free-hand"),
selected:!0},{className:"chickenpaint-tool-line",command:"CPLine",toolTip:T("Straight line")},{className:"chickenpaint-tool-bezier",command:"CPBezier",toolTip:T("Bezier curve")}],d=this.getBodyElement(),a=document.createElement("ul");for(let h in a.className="chickenpaint-stroke-tools list-unstyled",c){let q=c[h],f=document.createElement("li"),e=document.createElement("div");f.className="chickenpaint-toolbar-button "+q.className;f.setAttribute("data-buttonIndex",h);f.setAttribute("title",q.toolTip);
q.selected&&(f.className+=" selected");e.className="chickenpaint-toolbar-button-icon";f.appendChild(e);a.appendChild(f)}a.addEventListener("click",function(h){if(h=h.target.closest("li"))h=c[parseInt(h.getAttribute("data-buttonIndex"),10)],b.actionPerformed({action:h.command})});d.appendChild(a);b.on("toolChange",function(h,q){h=document.querySelector(".chickenpaint-tool-freehand");let f=document.querySelector(".chickenpaint-tool-line"),e=document.querySelector(".chickenpaint-tool-bezier");h&&h.classList.toggle("selected",
q.strokeMode==wa.STROKE_MODE_FREEHAND);f&&f.classList.toggle("selected",q.strokeMode==wa.STROKE_MODE_LINE);e&&e.classList.toggle("selected",q.strokeMode==wa.STROKE_MODE_BEZIER)})}function bc(b,c,d){return c in b?Object.defineProperty(b,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):b[c]=d,b}function Vd(b){Tb.call(this,b,"color","Color (picker)");let c=new vf(b),d=new wf(b,c);b=new sg(b);let a=this.getBodyElement(),h=document.createElement("div");h.className="chickenpaint-colorpicker-top";
h.appendChild(c.getElement());h.appendChild(d.getElement());a.appendChild(h);a.appendChild(b.getElement())}function sg(b){function c(q,f,e){for(;q.length<e;)q=f+q;return q}function d(){h.style.backgroundColor="#"+c(Number(a).toString(16),"0",6)}let a=0,h=document.createElement("div");this.getElement=function(){return h};b.on("colorChange",function(q){a=q.getRgb();d()});h.className="chickenpaint-colorpicker-show";h.addEventListener("click",function(q){q.preventDefault();q="#"+c(Number(a).toString(16),
"0",6);if(null!=(q=window.prompt(T("Please enter a color in hex format"),q)))try{(q.match(/^#/)||q.match(/^$/))&&(q=q.substring(1));let f=parseInt(q,16);b.setCurColor(new jb(f))}catch(f){}});d()}function md(b,c){function d(){var f=a.width;h.clearRect(0,0,f,a.height);h.beginPath();h.arc(f/2+1,f/2+1,Math.max(f/2,1)-2,0,2*Math.PI);q.state?h.fill():h.stroke()}var a=document.createElement("canvas"),h=a.getContext("2d"),q=this;this.state=b||!1;this.setValue=function(f){this.state!=f&&(this.state=f,this.emitEvent("valueChange",
[f]),d())};this.getElement=function(){return a};a.addEventListener("mousedown",function(f){q.setValue(!q.state)});a.title=c||"";a.className="chickenpaint-checkbox";a.width=20;a.height=20;a.fillStyle="black";a.strokeStyle="black";d()}function Ob(b,c,d,a,h=150,q=3){function f(){let v=l.width||h,A=l.height,D="string"==typeof u.title?T(u.title):u.title(u.value),y=3*window.devicePixelRatio,E=.75*l.height;if(d)g.save(),g.fillStyle="white",g.fillRect(0,0,v,A),g.fillStyle="black",g.fillText(D,y,E),g.beginPath(),
u.value>=m/2?g.rect(v/2,0,(u.value-m/2)*v/m,A):g.rect(u.value*v/m,0,(m/2-u.value)*v/m,A),g.fill(),g.clip(),g.fillStyle="white";else{var x=(u.value-b)/m;a&&(x=Math.pow(x,1/q));x*=v;g.save();g.save();g.fillStyle="black";g.beginPath();g.rect(0,0,x,A);g.fill();g.clip();g.fillStyle="white";g.fillText(D,y,E);g.restore();g.fillStyle="white";g.beginPath();g.rect(x,0,v,A);g.fill();g.clip();g.fillStyle="black"}g.fillText(D,y,E);g.restore()}function e(v){let A=l.clientWidth,D=l.getBoundingClientRect().left+
window.scrollX;v=(v.pageX-D)/A;a&&(v=Math.pow(Math.max(v,0),q));u.setValue(v*m+b)}function k(v){switch(p){case 1:return e(v);case 2:var A=u.title();if(!A.includes(T("Brush size"))&&!A.includes(T("Opacity")))return e(v);A=(v.pageX-n)/4;if(0!==A){A=u.value+A;let D=Math.floor(A);u.setValue(D);n=v.pageX-(A-D)*4}}}let l=document.createElement("canvas"),g=l.getContext("2d"),m=c-b,p=0,n,t=!1,u=this;this.value=void 0;this.title="";d=d||!1;l.addEventListener("pointerup",v=>{if(0===p)return l.releasePointerCapture(v.pointerId),
l.removeEventListener("pointermove",k);if(0!==p)switch(p){case 1:0!==v.button||v.shiftKey||(p=0);break;case 2:(2==v.button||0===v.button&&v.shiftKey)&&(p=0);break;default:return}return l.releasePointerCapture(v.pointerId),l.removeEventListener("pointermove",k)});this.setValue=function(v){v=~~Math.max(b,Math.min(c,v));this.value!=v&&(this.value=v,this.emitEvent("valueChange",[this.value]),t?f():(t=!0,this.resize()))};this.getElement=function(){return l};this.resize=function(){l.width=l.clientWidth||
h;l.height=l.clientHeight||20;window.devicePixelRatio>1&&(l.style.height=l.height+"px",l.width*=window.devicePixelRatio,l.height*=window.devicePixelRatio);g.font=.47*l.height+"pt sans-serif";f()};l.addEventListener("pointerdown",function(v){0===p&&(2===v.button||0===v.button&&v.shiftKey?(p=2,n=v.pageX):(p=1,e(v)),l.setPointerCapture(v.pointerId),l.addEventListener("pointermove",k))});l.addEventListener("contextmenu",function(v){v.preventDefault()});l.setAttribute("touch-action","none");l.className=
"chickenpaint-slider";"devicePixelRatio"in window||(window.devicePixelRatio=1)}function zd(b,c,d){function a(){for(var g=e.style,m=Number(q.getRgb()).toString(16);m.length<6;)m="0"+m;g.backgroundColor="#"+m}let h=this,q=new jb(0),f=255,e=document.createElement("div");this.getElement=function(){return e};this.setColor=function(g){q.isEqual(g)||(q.copyFrom(g),a(),this.emitEvent("colorChange",[q]))};this.setAlpha=function(g){g!=f&&(f=g,a(),this.emitEvent("alphaChange",[f]))};this.getColorRgb=function(){return q.getRgb()};
this.getAlpha=function(){return f};this.setCurColor=this.setColor;e.className="chickenpaint-color-pick-swatch";b&&q.copyFrom(b);c&&(f=c);let k=new zb.Popover(e,{html:!0,content:function(){let g,m,p,n,t;return window.addEventListener("mousedown",l),g=document.createElement("div"),m=document.createElement("div"),p=new vf(h,q),n=new wf(h,p,q.getHue()),t=new Ob(0,255),g.className="chickenpaint-color-pick-panel",m.className="chickenpaint-colorpicker-top",m.appendChild(p.getElement()),m.appendChild(n.getElement()),
g.appendChild(m),t.value=f,t.title=function(u){return T("Opacity: ")+u},t.on("valueChange",function(u){h.setAlpha(u)}),g.appendChild(t.getElement()),setTimeout(function(){t.resize()},0),g},trigger:"manual",placement:"bottom",container:d||!1}),l=function(g){var m=g.target;m=m.closest(".popover-body")||m.classList.contains("chickenpaint-color-pick-panel")||m.classList.contains("chickenpaint-colorpicker-select")||m.classList.contains("chickenpaint-colorpicker-slider");g.preventDefault();m||k.hide()};
e.addEventListener("click",function(g){g.preventDefault();k.toggle()});e.addEventListener("hidden.bs.popover",function(){window.removeEventListener("mousedown",l)});a()}function ye(b,c){let d=document.createElement("div");return d.className="chickenpaint-checkbox-slider-group",d.appendChild(b.getElement()),d.appendChild(c.getElement()),d}function xf(b,c){for(let d in c)if(c.hasOwnProperty(d)){let a=document.createElement("option");a.appendChild(document.createTextNode(T(c[d])));a.value=d;b.appendChild(a)}}
function tg(b){function c(){q.gradient(q.getBounds(),0,0,q.width,0,k,!0);e.putImageData(q.imageData,0,0,0,0,150,32);a.fillRect(0,0,d.width,d.height);a.drawImage(f,0,0)}let d=document.createElement("canvas"),a=d.getContext("2d"),h=uf(a),q=new J(150,32),f=document.createElement("canvas"),e=f.getContext("2d"),k=b.getCurGradient();this.getElement=function(){return d};b.on("gradientChange",function(l){k=l;c()});d.width=f.width=150;d.height=f.height=32;d.className="chickenpaint-gradient-preview";a.fillStyle=
h;c()}function nd(b){function c(){a.getElement().style.display="none";h.getElement().style.display="none";q.getElement().style.display="none";f.getElement().style.display="none";e.getElement().style.display="none";k.getElement().style.display="none"}function d(m){c();let p=f.getElement().querySelector(".form-check");switch(p&&(p.style.display="none"),m){case ka.M_GRADIENTFILL:h.getElement().style.display="block";break;case ka.M_TRANSFORM:q.getElement().style.display="block";break;case ka.M_RECT_SELECTION:f.getElement().style.display=
"block";p instanceof HTMLElement&&(p.style.display="");break;case ka.M_MOVE_TOOL:f.getElement().style.display="block";break;case ka.M_ROTATE_CANVAS:case ka.M_PAN_CANVAS:e.getElement().style.display="block";break;case ka.M_FLOODFILL:k.getElement().style.display="block";break;default:a.getElement().style.display="block"}}Tb.call(this,b,"brush","Tool options");let a=new ug(b),h=new vg(b),q=new wg(b),f=new xg(b),e=new yg(b),k=new zg(b),l=this.getBodyElement();l.addEventListener("touchmove",m=>{m.preventDefault()},
{passive:!1});l.appendChild(a.getElement());l.appendChild(h.getElement());l.appendChild(q.getElement());l.appendChild(f.getElement());l.appendChild(e.getElement());l.appendChild(k.getElement());let g=null;b.on("modeChange",function(m){g=m;d(m)});document.addEventListener("keydown",m=>{"r"!==m.key.toLocaleLowerCase()&&(m.ctrlKey||"z"!==m.key.toLocaleLowerCase())&&" "!==m.key||(c(),e.getElement().style.display="block")});document.addEventListener("keyup",m=>{"r"!==m.key.toLocaleLowerCase()&&"z"!==m.key.toLocaleLowerCase()&&
" "!==m.key||(c(),d(g))})}function ug(b){let c=[1,2,3,4,5,6,7,8,9,10,15,20,25,30,35,40,45,50,60,70,80,90,100,125,150,175,200],d=document.createElement("div"),a=document.createElement("select"),h=new md(!1,T("Control brush opacity with pen pressure")),q=new Ob(1,255,!1,!0),f=new md(!0,T("Control brush size with pen pressure")),e=new Ob(1,200,!1,!0),k=new md(!1,T("Control brush scattering with pen pressure")),l=new Ob(0,1E3,!1,!0),g=new Ob(0,100,!1,!0),m=new Ob(0,100,!1,!0),p=new Ob(0,100,!1,!0),n=
new Ob(0,100,!1,!0),t=new nd.CPBrushPreview(b);this.getElement=function(){return d};q.title=function(u){return T("Opacity")+": "+u};q.on("valueChange",function(u){b.setAlpha(u)});e.title=function(u){return T("Brush size")+": "+u};e.on("valueChange",function(u){b.setBrushSize(u)});g.title=function(u){return T("Color")+": "+u+"%"};g.on("valueChange",function(u){b.getBrushInfo().resat=u/100;b.callToolListeners()});m.title=function(u){return T("Blend")+": "+u+"%"};m.on("valueChange",function(u){b.getBrushInfo().bleed=
u/100;b.callToolListeners()});p.title=function(u){return T("Spacing")+": "+u+"%"};p.on("valueChange",function(u){b.getBrushInfo().spacing=u/100;b.callToolListeners()});l.title=function(u){return T("Scattering")+": "+u+"%"};l.on("valueChange",function(u){b.getBrushInfo().scattering=u/100;b.callToolListeners()});n.title=function(u){return T("Smoothing")+": "+u+"%"};n.on("valueChange",function(u){b.getBrushInfo().smoothing=u/100;b.callToolListeners()});k.on("valueChange",function(u){b.getBrushInfo().pressureScattering=
u;b.callToolListeners()});h.on("valueChange",function(u){b.getBrushInfo().pressureAlpha=u;b.callToolListeners()});f.on("valueChange",function(u){b.getBrushInfo().pressureSize=u;b.callToolListeners()});a.addEventListener("change",function(u){b.getBrushInfo().tip=parseInt(a.value,10);a.blur()});window.addEventListener("keydown",u=>{a.blur()});a.className="form-control form-control-sm";a.tabIndex=-1;xf(a,["Round Pixelated","Round Hard Edge","Round Soft","Square Pixelated","Square Hard Edge"]);d.appendChild(a);
d.appendChild(t.getElement());d.appendChild(ye(f,e));d.appendChild(ye(h,q));d.appendChild(g.getElement());d.appendChild(m.getElement());d.appendChild(p.getElement());d.appendChild(ye(k,l));d.appendChild(n.getElement());h.setValue(b.getBrushInfo().pressureAlpha);q.setValue(b.getAlpha());f.setValue(b.getBrushInfo().pressureSize);e.setValue(b.getBrushSize());k.setValue(b.getBrushInfo().pressureScattering);l.setValue(~~(100*b.getBrushInfo().scattering));a.value=b.getBrushInfo().tip;g.setValue(~~(100*
b.getBrushInfo().resat));m.setValue(~~(100*b.getBrushInfo().bleed));p.setValue(~~(100*b.getBrushInfo().spacing));n.setValue(~~(100*b.getBrushInfo().smoothing));b.on("toolChange",function(u,v){q.setValue(v.alpha);e.setValue(v.size);f.setValue(v.pressureSize);h.setValue(v.pressureAlpha);a.value=v.tip;k.setValue(v.pressureScattering);~~(100*v.resat)!=g.value&&g.setValue(~~(100*v.resat));~~(100*v.bleed)!=m.value&&m.setValue(~~(100*v.bleed));~~(100*v.spacing)!=p.value&&p.setValue(~~(100*v.spacing));~~(100*
v.scattering)!=l.value&&l.setValue(~~(100*v.scattering));~~(100*v.smoothing)!=n.value&&n.setValue(~~(100*v.smoothing))});Ja(Va)("1,2,3,4,5,6,7,8,9,0",function(u,v){u=parseInt(v.shortcut,10);0==u&&(u=10);b.setAlpha(Math.round(u/10*255))});Ja(Va)("{,[",function(){let u=b.getBrushSize();for(let v=c.length-1;v>=0;v--)if(u>c[v]){b.setBrushSize(c[v]);break}});Ja(Va)("},]",function(){let u=b.getBrushSize();for(let v=0;v<c.length;v++)if(u<c[v]){b.setBrushSize(c[v]);break}})}function vg(b){function c(){let e=
[q.getAlpha()<<24|q.getColorRgb(),f.getAlpha()<<24|f.getColorRgb()];b.setCurGradient(e)}var d;let a=document.createElement("div");var h=new tg(b);let q=new zd(new jb(16777215&b.getCurGradient()[0]),b.getCurGradient()[0]>>>24,a),f=new zd(new jb(16777215&b.getCurGradient()[1]),b.getCurGradient()[1]>>>24,a);this.getElement=function(){return a};a.className="chickenpaint-gradient-panel";a.style.display="none";q.on("colorChange",c);q.on("alphaChange",c);f.on("colorChange",c);f.on("alphaChange",c);(d=document.createElement("p")).textContent=
T("Gradient");a.appendChild(d);a.appendChild(h.getElement());(d=document.createElement("div")).className="chickenpaint-gradient-colors";(h=document.createElement("div")).className="chickenpaint-gradient-start-color";h.appendChild(q.getElement());d.appendChild(h);(h=document.createElement("div")).className="chickenpaint-gradient-end-color";h.appendChild(f.getElement());d.appendChild(h);a.appendChild(d)}function od(b,c){let d=b.textContent;if(b.textContent="",b.classList.add("d-flex","align-items-center",
"justify-content-center","position-relative"),b.style.paddingLeft="0.35rem",c){let a=document.createElement("span");a.className=`md-panel ${c}`;a.style.flex="0 0 auto";a.style.marginRight="0";b.prepend(a)}c=document.createElement("span");c.textContent=d;c.style.flex="1 1 auto";c.style.textAlign="center";b.appendChild(c)}function wg(b){var c={smooth:T("Smooth"),sharp:T("Sharp")};let d=document.createElement("div"),a=document.createElement("button"),h=document.createElement("button");var q=document.createElement("select");
this.getElement=function(){return d};d.className="chickenpaint-transform-panel";d.style.display="none";a.type="button";h.type="button";a.className="btn btn-primary btn-block";h.className="btn btn-light btn-block";a.textContent=T("Apply transform");h.textContent=T("Cancel");od(a,"icon-md-circle");od(h,"icon-md-close");q.addEventListener("change",function(l){b.setTransformInterpolation(this.value)});q.className="form-control chickenpaint-transform-interpolation";xf(q,c);c=document.createElement("div");
let f=document.createElement("label");f.textContent=T("Transform style");c.className="form-group";c.appendChild(f);c.appendChild(q);d.appendChild(c);q=document.createElement("div");q.appendChild(a);q.appendChild(h);q.className="form-group";d.appendChild(q);let {wrapper:e,checkbox:k}=ze("chickenpaint-t-maintainAspectCheckbox",T("Constrain"),!0);d.appendChild(e);a.addEventListener("click",function(l){b.actionPerformed({action:"CPTransformAccept"});l.preventDefault()});h.addEventListener("click",function(l){b.actionPerformed({action:"CPTransformReject"});
l.preventDefault()});k.addEventListener("change",()=>{k.blur()})}function xg(b){let c=document.createElement("div");var d=document.createElement("div");let a=document.createElement("label"),h=document.createElement("button"),q=document.createElement("button"),f=document.createElement("button");this.getElement=function(){return c};c.className="chickenpaint-selection-panel";c.style.display="none";d.className="form-group";a.textContent=T("Selection");d.appendChild(a);h.type="button";h.className="btn btn-light btn-block";
h.textContent=T("Fill");h.addEventListener("click",function(e){b.actionPerformed({action:"CPFill"});e.preventDefault()});od(h,"icon-md-ink_selection");d.appendChild(h);q.type="button";q.className="btn btn-light btn-block deselectButton";q.textContent=T("Deselect");q.addEventListener("click",function(e){b.actionPerformed({action:"CPDeselectAll"});e.preventDefault()});od(q,"icon-md-deselect");d.appendChild(q);f.type="button";f.className="btn btn-primary btn-block";f.textContent=T("Transform");f.addEventListener("click",
function(e){b.actionPerformed({action:"CPTransform"});e.preventDefault()});od(f,"icon-md-resize");d.appendChild(f);c.appendChild(d);({wrapper:d}=ze("chickenpaint-s-maintainAspectCheckbox",T("Constrain"),!1));c.appendChild(d)}function ze(b,c,d=!1){let a=document.createElement("input");a.type="checkbox";a.id=b;a.className="form-check-input";a.checked=d;a.style.outline="none";a.style.boxShadow="none";a.tabIndex=-1;d=document.createElement("label");d.className="form-check-label";d.setAttribute("for",
b);d.textContent=c;b=document.createElement("div");return b.className="form-check",b.appendChild(a),b.appendChild(d),{wrapper:b,checkbox:a}}function yg(b){var c;let d,a=document.createElement("div"),h=document.createElement("div"),q=document.createElement("label"),f=document.createElement("button"),e=new Ob(10,800,!1,!0,180,3.13),k=new Ob(-180,180,!1,!1,180);a.className="chickenpaint-pan-panel";a.style.display="none";a.appendChild(e.getElement());h.className="form-group";q.textContent=T("Zoom and Rotate");
h.appendChild(q);h.appendChild(q);a.appendChild(h);f.type="button";f.className="btn btn-primary btn-block";f.style.outline="none";f.textContent=T("Reset View");f.addEventListener("click",function(t){b.actionPerformed({action:"CPResetZoomAndRotation"});t.preventDefault()});od(f,"icon-md-restart_alt");h.appendChild(f);a.appendChild(h);e.title=function(t){return T("Zoom")+": "+t+"%"};k.title=function(t){return T("Rotation")+": "+t+"\u00b0"};e.on("valueChange",function(t){b.zoomOnCenter(t/100)});k.on("valueChange",
function(t){b.setRotationDegrees(t)});a.appendChild(e.getElement());a.appendChild(k.getElement());this.getElement=function(){return a};e.setValue(100*b.getZoom());k.setValue(b.getRotationDegrees());document.addEventListener("wheel",t=>{t.preventDefault();l()},{passive:!1});let l=(c=()=>{e.setValue(100*b.getZoom());k.setValue(b.getRotationDegrees())},function(...t){clearTimeout(d);d=setTimeout(()=>c.apply(this,t),12)}),g=t=>b.isPanOrRotateMode()||Ja(Va).isPressed("space")||Ja(Va).isPressed("r")||Ja(Va).isPressed("z"),
m=t=>t instanceof HTMLCanvasElement&&t.classList.contains("chickenpaint-canvas"),p=!1;document.addEventListener("pointerdown",t=>{!g(t)||(p=!0,m(t.target)&&l())});document.addEventListener("pointermove",t=>{p&&g(t)&&m(t.target)&&l()});document.addEventListener("pointerup",t=>{p=!1;!g(t)||m(t.target)&&l()});Ja(Va)("=,-",function(){l()});let n=!0;Ja(Va)("ctrl+0,alt+0,r,z,space,enter",function(){n&&(n=!1,l())});document.addEventListener("keyup",t=>{n=!0});document.addEventListener("click",t=>{t.target instanceof
HTMLElement&&!(t.target instanceof HTMLCanvasElement)&&l()})}function zg(b){let c=document.createElement("div");var d=document.createElement("div");let a=document.createElement("label"),h=new Ob(0,5,!1,!1,180),q=new Ob(0,255,!1,!1,180);c.className="chickenpaint-floodFill-panel";c.style.display="none";c.appendChild(h.getElement());d.className="form-group";a.textContent=T("Flood fill");d.appendChild(a);c.appendChild(d);h.title=function(k){return T("Grow fill area")+": "+k};q.title=function(k){return T("Opacity")+
": "+k};h.on("valueChange",function(k){b.setGrowFillArea(k)});q.on("valueChange",function(k){b.setFoodFillAlpha(k)});d=document.createElement("div");d.className="form-group";d.appendChild(h.getElement());d.appendChild(q.getElement());c.appendChild(d);let {wrapper:f,checkbox:e}=ze("chickenpaint-floodFillreferAllLayersCheckbox",T("Refer all layers"),!0);f.classList.add("mb-1");c.appendChild(f);e.addEventListener("change",()=>{e.blur();b.setFloodFillReferAllLayers(e.checked)});this.getElement=function(){return c};
h.setValue(2);q.setValue(255)}function Ag(b){b.preventDefault();b.stopPropagation()}function jc(b){let c=document.createElement("span");return c.className="fa "+b,c}function Ae(b){let c=document.createElement("span");return c.className="chickenpaint-icon chickenpaint-icon-"+b,c}function yf(b,c){let d=document.createElement("div"),a=document.createElement("label");return a.tabIndex=-1,b.tabIndex=-1,d.className="form-check",b.className="form-check-input",a.className="form-check-label",a.setAttribute("for",
b.id),a.appendChild(b),a.appendChild(document.createTextNode(c)),d.appendChild(b),d.appendChild(a),d}function Wd(b){function c(){let y=h.getActiveLayer();y.getAlpha()!=l.value&&l.setValue(y.getAlpha());let E=h.getActiveLayer();for(;g.lastChild;)g.removeChild(g.lastChild);for(let x=Q.LM_FIRST;x<=Q.LM_LAST;x++)if(x!=Q.LM_MULTIPLY2&&(x==E.blendMode||x===Q.LM_PASSTHROUGH&&E instanceof $a||x<=Q.LM_LAST_CHIBIPAINT)){let G=document.createElement("option");G.appendChild(document.createTextNode(T(Q.BLEND_MODE_DISPLAY_NAMES[x])));
x!==Q.LM_MULTIPLY||E.blendMode===x||E.useLegacyMultiply?G.value=x:G.value=Q.LM_MULTIPLY2;g.appendChild(G)}y.getBlendMode()!=parseInt(g.value,10)&&(g.value=y.getBlendMode());y.getLockAlpha()!=n.checked&&(n.checked=y.getLockAlpha());(function(){var x=h.getActiveLayer();let G=h.isEditingMask();x={"image-layer":x instanceof Fa,"layer-group":x instanceof $a,"clipping-mask":x instanceof Fa&&x.clip,"no-clipping-mask":x instanceof Fa&&!x.clip,"no-clipping-mask-or-is-group":!(x instanceof Fa)||!x.clip,mask:x&&
null!==x.mask,"no-mask":x&&null===x.mask,"mask-enabled":x&&null!==x.mask&&x.maskVisible,"mask-disabled":x&&null!==x.mask&&!x.maskVisible,isNotEditingMask:x&&!G,isEditingMask:x&&null!==x.mask&&G};for(let I of"mask no-mask isEditingMask isNotEditingMask clipping-mask no-clipping-mask-or-is-group image-layer layer-group".split(" "))for(let O of u.getElementsByClassName("chickenpaint-action-require-"+I))O.style.display=x[I]?"inline-block":"none";u.querySelectorAll("[data-action]").forEach(function(I){let O=
I.getAttribute("data-action");I.classList.toggle("disabled",!b.isActionAllowed(O))})})()}function d(){h=this;k.resize();c()}Tb.call(this,b,"layers","Layers",{resizeHorz:!0,resizeVert:!0});let a=this,h=b.getArtwork(),q=null,f=this.getBodyElement(),e=this.getElement(),k=new function(){function y(ea){let w=da.querySelectorAll(".chickenpaint-layer");return w[w.length-1-ea]}function E(ea){if(!ea)return-1;ea=ea.closest(".chickenpaint-layer");if(!ea)return-1;let w=Array.from(da.querySelectorAll(".chickenpaint-layer"));
return w.length-1-w.indexOf(ea)}function x(){var ea;if(2===V.state){var w=e.getBoundingClientRect();var H=!0;var U=!0;if(V.dropTarget=function(Z,ba){var la=da.querySelectorAll(".chickenpaint-layer");Z={layer:q[q.length-1],displayIndex:q.length-1,direction:"over"};for(var Ga=0;Ga<la.length;Ga++){let pa=la[la.length-1-Ga].getBoundingClientRect();if(0===Ga&&ba>pa.bottom){Z=h.getLayersRoot().layers[0];Z={layer:Z,displayIndex:q.indexOf(Z),direction:"under"};break}if(ba>=pa.top){la=q[Ga];let ya=pa.bottom-
pa.top;Z={layer:la,displayIndex:Ga};la instanceof $a?ba>=pa.top+.75*ya?la.expanded&&la.layers.length>0?(Z.layer=la.layers[la.layers.length-1],Z.displayIndex--,Z.direction="over"):Z.direction="under":ba>=pa.top+.25*ya?la.expanded&&la.layers.length>0?(Z.layer=la.layers[la.layers.length-1],Z.displayIndex--,Z.direction="over"):Z.direction="inside":Z.direction="over":Z.direction=ba>=pa.top+.5*ya?"under":"over";break}}return Z.layer.parent===V.layer.parent&&("over"===Z.direction||"under"===Z.direction)&&
(ba=Z.layer.parent,Ga=ba.indexOf(Z.layer),"over"===Z.direction&&ba.layers[Ga+1]===V.layer||"under"===Z.direction&&ba.layers[Ga-1]===V.layer||Z.layer===V.layer)?null:V.layer instanceof $a&&(Z.layer===V.layer&&"inside"===Z.direction||Z.layer.hasAncestor(V.layer))?null:Z}(V.dragX,V.dragY),V.dropTarget){var na=y(V.dropTarget.displayIndex);switch(V.dropTarget.direction){case "over":case "under":da.appendChild(V.dropBetweenMarkerElem);H=V.dropTarget.layer.getDepth()-1;var W;na=na.getBoundingClientRect();
if("under"===V.dropTarget.direction&&V.dropTarget.layer instanceof $a&&V.dropTarget.layer.expanded){for(W=V.dropTarget.displayIndex-1;W>=0&&q[W].hasAncestor(V.dropTarget.layer);W--);W=y(W+1).getBoundingClientRect().bottom}else W=na.bottom;H=na.left-w.left+(H>0?26+16*H:0);V.dropBetweenMarkerElem.style.left=H+"px";V.dropBetweenMarkerElem.style.width=na.right-w.left-H+"px";V.dropBetweenMarkerElem.style.top=("over"===V.dropTarget.direction?na.top-1:W+1)-w.top+"px";da.querySelectorAll(".chickenpaint-layer-drop-target").forEach(ba=>
ba.classList.remove("chickenpaint-layer-drop-target"));H=!1;break;case "inside":let Z=da.querySelectorAll(".chickenpaint-layer");Z.forEach((ba,la)=>{ba.classList.toggle("chickenpaint-layer-drop-target",Z.length-1-la===V.dropTarget.displayIndex)});U=!1}}U&&da.querySelectorAll(".chickenpaint-layer-drop-target").forEach(Z=>Z.classList.remove("chickenpaint-layer-drop-target"));H&&(null==(ea=V.dropBetweenMarkerElem)||ea.remove());V.frameElem.style.top=V.dragY-w.top-parseInt(V.frameElem.style.height,10)/
2+"px"}else null==(w=V.dropBetweenMarkerElem)||w.remove(),null==(U=V.frameElem)||U.remove()}function G(ea){let w=ea.getImageThumbnail().getAsCanvas(Ca);return w.title=T("Image"),w.className="chickenpaint-layer-thumbnail chickenpaint-layer-image-thumbnail",w.style.maxWidth=w.width/w.height*25+"px",ea!=h.getActiveLayer()||h.isEditingMask()||(w.className+=" active"),w}function I(ea){let w=ea.getMaskThumbnail().getAsCanvas(Ca);(w.title=T("Layer mask"),w.className="chickenpaint-layer-thumbnail chickenpaint-layer-mask-thumbnail",
w.style.maxWidth=w.width/w.height*25+"px",ea==h.getActiveLayer()&&h.isEditingMask()&&(w.className+=" active"),ea.maskVisible)||(w.className+=" disabled",(ea=w.getContext("2d")).strokeStyle="red",ea.lineWidth=3,ea.moveTo(5,5),ea.lineTo(w.width-5,w.height-5),ea.moveTo(w.width-5,5),ea.lineTo(5,w.height-5),ea.stroke());return w}function O(ea,w){let H=document.createElement("div");var U=document.createElement("div");let na=document.createElement("div");var W=document.createElement("div");let Z=document.createElement("div"),
ba=document.createElement("div"),la=document.createElement("div");if(H.className="chickenpaint-layer list-group-item",w==h.getActiveLayer()&&(H.className+=" active"),U.className="chickenpaint-layer-eye",w.ancestorsAreVisible()||(U.className+=" chickenpaint-layer-eye-hidden-ancestors"),U.style.marginRight=2+16*(w.getDepth()-1)+"px",w.visible?(H.className+=" chickenpaint-layer-visible",U.appendChild(jc("icon-eye"))):(H.className+=" chickenpaint-layer-hidden",U.appendChild(jc("icon-eye-slash"))),H.appendChild(U),
na.className="chickenpaint-layer-description",w instanceof Fa){if(w.clip&&(H.className+=" chickenpaint-layer-clipped",W.appendChild(jc("icon-level-down-alt fa-flip-horizontal"))),w.lockAlpha)U=Ae("lock-alpha"),U.title=T("Transparency locked"),ba.appendChild(U)}else w instanceof $a&&(H.className+=" chickenpaint-layer-group",w.expanded?(H.className+=" chickenpaint-layer-group-expanded",W.appendChild(jc("icon-folder-open chickenpaint-layer-group-toggle"))):(H.className+=" chickenpaint-layer-group-collapsed",
W.appendChild(jc("icon-folder chickenpaint-layer-group-toggle"))));W.childNodes.length&&(W.className="chickenpaint-layer-icons",H.appendChild(W));try{w instanceof Fa&&H.appendChild(G(w)),w.mask&&H.appendChild(I(w))}catch(Ga){console.log("Failed to create layer thumb")}W=w.name&&w.name.length>0?w.name:"(unnamed "+(w instanceof $a?"group":"layer")+")";return Z.innerText=W,Z.setAttribute("title",W),Z.className="chickenpaint-layer-name",la.innerText=T(Q.BLEND_MODE_DISPLAY_NAMES[w.blendMode])+": "+w.alpha+
"%",la.className="chickenpaint-layer-blend",na.appendChild(Z),na.appendChild(la),H.appendChild(na),ba.className="chickenpaint-layer-status",H.appendChild(ba),H.setAttribute("data-display-index",""+ea),H}function B(ea){if(ea>-1){let w=q[ea];ea=y(ea);w&&ea&&m.show(w,ea)}}function N(ea){2===V.state?(V.layerElem.classList.remove("chickenpaint-layer-dragging"),V.dropTarget&&("inside"===V.dropTarget.direction?b.actionPerformed({action:"CPRelocateLayer",layer:V.layer,toGroup:V.dropTarget.layer,toIndex:V.dropTarget.layer.layers.length}):
b.actionPerformed({action:"CPRelocateLayer",layer:V.layer,toGroup:V.dropTarget.layer.parent,toIndex:V.dropTarget.layer.parent.indexOf(V.dropTarget.layer)+ +("over"===V.dropTarget.direction)})),V.dropTarget=null,V.state=0,x()):V.state=0;sa&&(clearTimeout(sa),sa=null);da.releasePointerCapture(ea.pointerId);da.removeEventListener("pointermove",L);da.removeEventListener("pointerup",N)}function P(){V.state=2;V.frameElem=document.createElement("div");V.frameElem.className="chickenpaint-layer-drag-frame";
V.frameElem.style.width=V.layerElem.offsetWidth+"px";V.frameElem.style.height=V.layerElem.offsetHeight+"px";V.dropBetweenMarkerElem=document.createElement("div");V.dropBetweenMarkerElem.className="chickenpaint-layer-drop-between-mark";V.layerElem.classList.add("chickenpaint-layer-dragging");da.appendChild(V.frameElem)}function L(ea){ea=ea.clientY;switch(V.state){case 3:if(Math.abs(ea-V.dragY)>5)V.state=4;else break;case 4:da.scrollTop=V.initialScrollTop+V.dragY-ea;break;case 1:if(Math.abs(ea-V.dragY)>
5)P();else break;case 2:V.dragY=ea,x()}}function ia(ea,w,H){try{let U=ea.querySelector("."+(H?"chickenpaint-layer-mask-thumbnail":"chickenpaint-layer-image-thumbnail"));U&&U.replaceWith(H?I(w):G(w))}catch(U){console.log("Error rebuilding thumbnail: ",U)}}let V={state:0,layer:null,layerElem:null,dragX:0,dragY:0,initialScrollTop:0,dropTarget:null,dropBetweenMarkerElem:null,frameElem:null},ma=document.createElement("div"),da=document.createElement("div"),Ca=0,ha=!1,sa=null;for(let ea of(this.buildLayers=
function(){let w=(q=h.getLayersRoot().getLinearizedLayerList(!0)).map((U,na)=>O(na,U)),H=document.createDocumentFragment();da.innerHTML="";for(let U=w.length-1;U>=0;U--)H.appendChild(w[U]);da.appendChild(H);x()},this.layerChanged=function(w){let H=q.indexOf(w),U=y(H);!U||w instanceof $a&&(w.expanded!=U.classList.contains("chickenpaint-layer-group-expanded")||w.visible!=U.classList.contains("chickenpaint-layer-visible"))?this.buildLayers():U.replaceWith(O(H,w))},this.setRotation90=function(w){if(Ca!==
w)for(Ca=w,w=0;w<q.length;w++){let H=q[w],U=y(w);U&&(ia(U,H,!1),H.mask&&ia(U,H,!0))}},this.layerImageThumbChanged=function(w){let H=y(q.indexOf(w));H&&ia(H,w,!1)},this.layerMaskThumbChanged=function(w){let H=y(q.indexOf(w));H&&(w.mask?ia(H,w,!0):(w=H.querySelector(".chickenpaint-layer-mask-thumbnail"))&&w.remove())},this.activeLayerChanged=function(w,H){da.querySelectorAll(".active").forEach(na=>{na.classList.remove("active")});var U=y(q.indexOf(w));U.classList.add("active");w=U.querySelector(".chickenpaint-layer-image-thumbnail");
U=U.querySelector(".chickenpaint-layer-mask-thumbnail");w&&w.classList.toggle("active",!H);U&&U.classList.toggle("active",H)},this.resize=function(){a.dismissNotification();this.buildLayers()},this.getElement=function(){return ma},this.revealLayer=function(w){w=y(w);let H=w.getBoundingClientRect(),U=da.getBoundingClientRect();return da.scrollTop=Math.max(Math.min(Math.max(da.scrollTop,da.scrollTop+H.bottom-U.bottom),da.scrollTop+H.top-U.top),0),w},e.id="chickenpaint-layer-pop",ma.className="chickenpaint-layers-widget",
ma.addEventListener("contextmenu",w=>w.preventDefault(),!0),da.className="list-group",da.addEventListener("dblclick",function(w){0===w.button&&w.target.closest(".chickenpaint-layer-description")&&!w.target.closest("input")&&(B(E(w.target)),w.preventDefault())}),da.addEventListener("pointerdown",function(w){let H=E(w.target.closest(".chickenpaint-layer"));if(-1!==H){let U=q[H];if(0===w.button&&w.target.closest(".chickenpaint-layer-eye"))b.actionPerformed({action:"CPSetLayerVisibility",layer:U,visible:!U.visible});
else if(0===w.button&&U instanceof $a&&w.target.closest(".chickenpaint-layer-group-toggle"))b.actionPerformed({action:"CPExpandLayerGroup",group:U,expand:!U.expanded});else{let na=h.getActiveLayer()!==U;if(ha=null!==w.target.closest(".chickenpaint-layer-mask-thumbnail")||U instanceof $a&&null!==U.mask&&na,0===w.button&&w.shiftKey&&!w.ctrlKey&&!w.metaKey&&ha)b.actionPerformed({action:"CPSetMaskVisible",layer:U,visible:!U.maskVisible});else{let W,Z;(W=0===w.button||na?ha:h.isEditingMask(),Z=h.isEditingMask()!==
W,(na||Z)&&b.actionPerformed({action:"CPSetActiveLayer",layer:U,mask:W}),W&&w.altKey)?b.actionPerformed({action:"CPToggleMaskView"}):W&&!w.shiftKey&&(w.ctrlKey||w.metaKey)?b.actionPerformed({action:"CPApplyLayerMask"}):W&&w.shiftKey&&(w.ctrlKey||w.metaKey)?b.actionPerformed({action:"CPRemoveLayerMask"}):0===w.button?("pen"===w.pointerType||"touch"===w.pointerType?(V.state=3,V.initialScrollTop=da.scrollTop,sa&&clearTimeout(sa),sa=setTimeout(()=>{3===V.state&&(P(),V.dragY=w.clientY,x())},800)):V.state=
1,V.dropTarget=null,V.layer=U,V.layerElem=y(H),V.dragX=w.clientX,V.dragY=w.clientY,da.setPointerCapture(w.pointerId),da.addEventListener("pointermove",L),da.addEventListener("pointerup",N)):2===w.button&&!na&&(w.preventDefault(),-1!=E(w.target)&&(B(E(w.target)),w.preventDefault()))}}}}),da.setAttribute("touch-action","none"),["ontouchstart","ontouchmove","ontouchend","ontouchcancel"]))da.addEventListener(ea,Ag);ma.appendChild(da)},l=new Ob(0,100,!1,!1,208),g=document.createElement("select"),m=new function(){let y=
null,E="",x=document.createElement("input"),G=this;this.hide=function(){y=null;let I=x.parentNode;I&&(I.removeChild(x),I.textContent=E)};this.renameAndHide=function(){y&&y.name!==x.value&&b.actionPerformed({action:"CPSetLayerName",layer:y,name:x.value});this.hide()};this.show=function(I,O){x.value=E=(y=I).name;(I=O.querySelector(".chickenpaint-layer-name"))&&I.parentNode&&(O=I.firstChild)&&O.nodeType===Node.TEXT_NODE&&(I.removeChild(O),I.appendChild(x));x.select()};x.type="text";x.className="chickenpaint-layer-rename form-control input-sm";
x.addEventListener("keydown",function(I){I.stopPropagation()});x.addEventListener("keydown",function(I){"Enter"===I.key&&G.renameAndHide();I.stopPropagation()});x.addEventListener("keyup",function(I){"Escape"===I.key&&G.hide();I.stopPropagation()});x.addEventListener("blur",function(I){y&&G.renameAndHide()})},p=document.createElement("input"),n=document.createElement("input"),t=!1,u,v=this.setSize,A=this.setWidth,D=this.setHeight;this.setSize=function(y,E){v.call(this,y,E);this.dismissNotification();
l.resize()};this.setWidth=function(y){A.call(this,y);l.resize();k.resize()};this.setHeight=function(y){D.call(this,y);k.resize()};this.setRotation90=function(y){k.setRotation90(y)};this.dismissNotification=function(){document.querySelectorAll(".chickenpaint-layer[aria-describedby], .chickenpaint-slider[aria-describedby]").forEach(y=>{(y=zb.Popover.getInstance(y))&&y.dispose()});t&&(clearTimeout(t),t=!1)};this.showNotification=(y,E,x)=>{let G=q.indexOf(y);y=h.getActiveLayer()==y&&"opacity"==x?l.getElement():
k.revealLayer(G);this.dismissNotification();(new zb.Popover(y,{html:!1,content:E,placement:"left",trigger:"manual",fallbackPlacement:[],boundary:"window",container:a.getElement()})).show();t=setTimeout(()=>{t=!1;this.dismissNotification()},Math.max(Math.round(70*E.length),3E3))};g.className="form-control form-control-sm";g.tabIndex=-1;g.title=T("Layer blending mode");g.addEventListener("change",function(y){b.actionPerformed({action:"CPSetLayerBlendMode",blendMode:parseInt(g.value,10)});g.blur()});
window.addEventListener("keydown",y=>{g.blur()});f.appendChild(g);l.title=function(y){return T("Opacity")+": "+y+"%"};l.on("valueChange",function(y){b.actionPerformed({action:"CPSetLayerAlpha",alpha:y})});f.appendChild(l.getElement());p.id="chickenpaint-chk-sample-all-layers";p.type="checkbox";p.addEventListener("click",function(y){h.setSampleAllLayers(p.checked);document.activeElement.blur()});f.appendChild(yf(p,T("Blend all layers")));n.id="chickenpaint-chk-lock-alpha";n.type="checkbox";n.addEventListener("click",
function(y){b.actionPerformed({action:"CPSetLayerLockAlpha",lock:n.checked});document.activeElement.blur()});f.appendChild(yf(n,T("Lock transparency")));f.appendChild(k.getElement());u=function(){var y=[{title:"Add layer",icon:jc("icon-file"),action:"CPAddLayer"},{title:"Add group",icon:jc("icon-folder"),action:"CPAddGroup"},{title:"Merge down",icon:jc("icon-md-download"),action:"CPLayerMergeDown",require:["image-layer"]},{title:"Merge group",icon:jc("icon-md-collapse_all"),action:"CPGroupMerge",
require:["layer-group"]},{title:"Clip to the layer below",icon:jc("icon-level-down-alt fa-flip-horizontal"),action:"CPCreateClippingMask",require:"no-clipping-mask-or-is-group"},{title:"Unclip from the layer below",icon:jc("icon-level-down-alt fa-flip-horizontal"),action:"CPReleaseClippingMask",require:"clipping-mask"},{title:"Add layer mask",icon:Ae("mask"),action:"CPAddLayerMask",require:["no-mask"]},{title:"Apply mask",icon:Ae("mask"),action:"CPApplyLayerMask",require:["mask"]},{title:"Duplicate",
icon:jc("icon-clone"),action:"CPLayerDuplicate"},{title:"Delete layer mask",icon:jc("icon-trash"),action:"CPRemoveLayerMask",require:"isEditingMask"},{title:"Delete layer",icon:jc("icon-trash"),action:"CPRemoveLayer",require:"isNotEditingMask"}];let E=document.createElement("ul");for(let x of(E.className="chickenpaint-layer-buttons list-unstyled",y))y=document.createElement("li"),y.setAttribute("data-action",x.action),y.className="chickenpaint-small-toolbar-button "+(x.require?"chickenpaint-action-require-"+
x.require:""),y.title=T(x.title),y.appendChild(x.icon),y.addEventListener("click",function(){b.actionPerformed({action:x.action})}),E.appendChild(y);return E}();f.appendChild(u);h.on("changeActiveLayer",function(y,E,x){k.activeLayerChanged(E,x);c()});h.on("changeLayer",function(y){h=this;a.dismissNotification();k.layerChanged(y);c()});h.on("changeStructure",d);h.on("changeLayerMaskThumb",function(y){h=this;k.layerMaskThumbChanged(y)});h.on("changeLayerImageThumb",function(y){h=this;k.layerImageThumbChanged(y)});
b.on("layerNotification",this.showNotification.bind(this));d.call(h)}function Bg(){this.table=new Uint8Array(256);this.loadIdentity=function(){for(var b=0;b<256;b++)this.table[b]=b};this.loadBrightnessContrast=function(b,c){c=c>0?1/(1.0001-c):1+c;b=.5-.5*c+b;for(var d=0;d<256;d++)this.table[d]=Math.min(255,Math.max(~~(255*(d/255*c+b)),0))};this.invert=function(){for(var b=0;b<256;b++)this.table[b]=255-this.table[b]}}function zf(b,c){let d=document.createElement("div"),a=document.createElement("label");
return d.className="form-check",b.className="form-check-input",a.className="form-check-label",a.setAttribute("for",b.id),a.appendChild(b),a.appendChild(document.createTextNode(c)),d.appendChild(b),d.appendChild(a),d}function Xd(b){function c(I){for(let O=0;O<I.length;O++){let B=new e(I[O],32,32);B.on("click",function(){p=this.texture;f()});E.appendChild(B.getElement())}}function d(I){let O=new Pa(I,I,8);for(let B=1;B<I*I;B++)O.data[B]=255;return O}function a(I){let O=2*I,B=new Pa(O,O,8);for(let N=
0;N<O;N++)for(let P=0;P<O;P++)B.data[N+P*O]=255*((~~(N/I)+~~(P/I))%2!=0);return B}function h(I,O){let B=new Pa(O,O,8);for(let N=0;N<O*O;N++)~~(N%O)>=I&&(B.data[N]=255);return B}function q(I,O){let B=new Pa(O,O,8);for(let N=0;N<O*O;N++)N/O>=I&&(B.data[N]=255);return B}function f(){if(null!=p){n=p.clone();t&&n.mirrorHorizontally();let B=new Bg;B.loadBrightnessContrast(v,A);u&&B.invert();if(1!==D){var I=n,O=D;let N=Math.max(1,Math.floor(I.width*O)),P=Math.max(1,Math.floor(I.height*O)),L=new Pa(N,P,I.bitDepth),
ia=255,V=0;for(let ma=0;ma<P;ma++)for(let da=0;da<N;da++){let Ca=I.data[Math.floor(ma/O)*I.width+Math.floor(da/O)];L.data[ma*N+da]=Ca;Ca<ia&&(ia=Ca);Ca>V&&(V=Ca)}n=ia===V?I:L}n.applyLUT(B)}else n=null;b.getArtwork().setBrushTexture(n);null!=y&&y.updateTexture()}function e(I,O,B){let N=document.createElement("canvas"),P=N.getContext("2d"),L=this;this.setTexture=function(ia){this.texture=ia;this.paint()};this.getElement=function(){return N};this.paint=function(){null!=this.texture?P.fillStyle=P.createPattern(this.texture.getAsCanvas(),
"repeat"):P.fillStyle="white";P.fillRect(0,0,N.width,N.height)};N.addEventListener("click",function(){L.emit("click")});N.width=O;N.height=B;this.setTexture(I)}var k;let l,g,m;Tb.call(this,b,"textures","Textures");let p,n,t=!1,u=!1,v=0,A=0,D=1,y,E=document.createElement("div"),x=this.getBodyElement();e.prototype=Object.create(Ja(Hb).prototype);e.prototype.constructor=e;y=new function(){function I(){L.checked=u;ia.checked=t;V.setValue(100*v+100);ma.setValue(100*A+100);da.setValue(100*D)}let O,B,N,
P=document.createElement("div"),L=document.createElement("input"),ia=document.createElement("input"),V=new Ob(0,200,!0),ma=new Ob(0,200,!0),da=new Ob(50,800,!1,!0,150,3.9),Ca=new e(null,64,64),ha=document.createElement("button"),sa,ea=new zb.Popover(ha,{html:!0,content:()=>sa,trigger:"manual",placement:"right",container:x,fallbackPlacements:[]});this.updateTexture=function(){ha.disabled=null==n;Ca.setTexture(n)};this.getElement=function(){return P};P.className="chickenpaint-texture-options";P.appendChild(Ca.getElement());
ha.type="button";ha.className="btn btn-light btn-sm";ha.setAttribute("data-bs-toggle","popover");ha.setAttribute("data-bs-placement","right");ha.textContent=T("Customize");(O=document.createElement("div")).className="chickenpaint-texture-controls";L.id="chickenpaint-chk-texture-invert";L.type="checkbox";L.addEventListener("click",function(w){u=this.checked;f()});O.appendChild(zf(L,T("Inverse")));ia.id="chickenpaint-chk-texture-mirror";ia.type="checkbox";ia.addEventListener("click",function(w){t=this.checked;
f()});O.appendChild(zf(ia,T("Mirror")));V.title=function(w){return T("Brightness")+": "+(w-100)+"%"};V.on("valueChange",function(w){v=(w-100)/100;f()});O.appendChild(V.getElement());ma.title=function(w){return T("Contrast")+": "+(w-100)+"%"};ma.on("valueChange",function(w){A=(w-100)/100;f()});O.appendChild(ma.getElement());da.title=function(w){return T("Scale")+": "+w+"%"};da.on("valueChange",function(w){D=w/100;f()});O.appendChild(da.getElement());B=document.createElement("button");N=document.createElement("button");
B.textContent="Ok";B.className="btn btn-primary btn-sm";B.type="button";B.addEventListener("click",function(w){ea.hide()});O.appendChild(B);O.appendChild(document.createTextNode(" "));N.textContent=T("Reset");N.className="btn btn-secondary btn-sm";N.type="button";N.addEventListener("click",function(w){A=v=0;D=1;u=t=!1;I();f()});O.appendChild(N);I();sa=O;ha.addEventListener("click",function(){ea.toggle()});P.appendChild(ha);this.updateTexture()};x.appendChild(y.getElement());E.className="chickenpaint-texture-swatches";
x.appendChild(E);c((k=[null],(l=new Pa(2,2,8)).data[0]=255,l.data[3]=255,k.push(l),k.push(d(2)),k.push(d(3)),k.push(d(4)),k.push(d(6)),k.push(d(8)),k.push(h(1,2)),k.push(h(2,4)),k.push(q(1,2)),k.push(q(2,4)),k.push(a(2)),k.push(a(4)),k.push(a(8)),k.push(a(16)),k.push(function(){let I=new Pa(256,256,8);for(let O=0;O<65536;O++)I.data[O]=Math.max(0,Math.min(255,Math.floor((.65*Math.floor(256*Math.random())-128)*.65+128)));return I}()),k));k=b.getResourcesRoot()+"gfx/textures32.png?20241024.1";var G=
function(I){c(I)};g=new Image;m=[];g.onload=function(){var I=document.createElement("canvas");let O=I.getContext("2d",{willReadFrequently:!0});I.width=g.width;I.height=g.height;for(I=0;I<2;I++){O.drawImage(g,0,32*I,32,32,0,0,32,32);try{let B=O.getImageData(0,0,32,32),N=new Pa(32,32,8);for(let P=0;P<1024;P++)N.data[P]=B.data[4*P];m.push(N)}catch(B){console.log(B)}}G(m)};g.src=k}function Yd(b){function c(v){let A=document.createElement("div"),D=document.createElement("button"),y=document.createElement("ul"),
E=document.createElement("span"),x=document.createElement("span"),G=this;this.getElement=function(){return A};this.setColor=function(O){D.setAttribute("data-color",O);var B=D.style;for(O=""+Number(O).toString(16);O.length<6;)O="0"+O;B.backgroundColor="#"+O};this.setColor(v);D.className="chickenpaint-color-swatch dropdown-toggle";E.className="dropdown-item";E.href="#";E.textContent=T("Remove");E.addEventListener("click",function(O){O.preventDefault();A.remove();g=!0});x.className="dropdown-item";x.href=
"#";x.textContent=T("Replace with current color");x.addEventListener("click",function(O){O.preventDefault();G.setColor(b.getCurColor().getRgb());g=!0});y.className="dropdown-menu";v=document.createElement("li");let I=document.createElement("li");v.appendChild(E);I.appendChild(x);y.appendChild(v);y.appendChild(I);A.className="chickenpaint-color-swatch-wrapper";A.appendChild(D);A.appendChild(y)}function d(v){v=new c(v);m.appendChild(v.getElement())}function a(v){let A=document.createElement("span");
return A.className="fa icon-"+v,A}var h;let q;let f,e,k;Tb.call(this,b,"swatches","Color swatches");var l=[16777215,0,16711680,65280,255,16776960];let g=!1,m=document.createElement("ul"),p=document.createElement("div"),n,t=this;this.getSwatches=function(){let v=m.querySelectorAll(".chickenpaint-color-swatch"),A=Array(v.length);for(let D=0;D<v.length;D++)A[D]=parseInt(v[D].getAttribute("data-color"),10);return A};this.setSwatches=function(v){for(;m.lastChild;)m.removeChild(m.lastChild);for(let A=0;A<
v.length;A++)d(v[A]);g=!0};this.isModified=function(){return g};m.className="chickenpaint-color-swatches list-unstyled";for(h=0;h<l.length;h++)m.appendChild((new c(l[h])).getElement());m.addEventListener("click",function(v){let A=v.target;/^<button data-color=/i.test(A.outerHTML)&&/chickenpaint-color-swatch/.test(A.className)&&0==v.button&&void 0!==A.getAttribute("data-color")&&(b.setCurColor(new jb(parseInt(A.getAttribute("data-color"),10))),v.stopPropagation(),v.preventDefault())});m.addEventListener("contextmenu",
function(v){let A=v.target;if(/^<button data-color=/i.test(A.outerHTML)&&/chickenpaint-color-swatch/.test(A.className)){v.preventDefault();var D=new zb.Dropdown(A);D.toggle();document.addEventListener("click",function x(E){D.hide();document.removeEventListener("click",x)})}});this.getBodyElement().appendChild(m);l=document.createElement("button");h=document.createElement("button");q=document.createElement("ul");var u=document.createElement("span");f=document.createElement("span");h.type="button";
h.title=T("Add the current brush color as a new swatch");h.className="btn chickenpaint-small-toolbar-button chickenpaint-color-swatch-add";h.appendChild(a("plus"));l.type="button";l.className="btn dropdown-toggle chickenpaint-small-toolbar-button chickenpaint-color-swatch-settings";l.setAttribute("data-bs-toggle","dropdown");l.appendChild(a("cog"));u.className="dropdown-item";u.href="#";u.textContent=T("Save swatches to your computer...");u.addEventListener("click",function(v){v.preventDefault();
v=new Blob([(new gd).write(t.getSwatches())],{type:"application/octet-stream"});Ja(Nd).saveAs(v,"oekakiswatches.aco")});f.className="dropdown-item";f.href="#";f.textContent=T("Load swatches from your computer...");f.addEventListener("click",function(v){v.preventDefault();n.onchange=function(){var A=this.files;if(!(A.length<1)){A=A[0];var D=new FileReader;D.onload=function(){let y=(new gd).read(this.result);null!=y&&y.length>0?t.setSwatches(y):alert(T("The swatches could not be read, did you select an .aco file?"))};
D.readAsArrayBuffer(A)}};n.click()});q.className="dropdown-menu";e=document.createElement("li");k=document.createElement("li");e.appendChild(u);k.appendChild(f);q.appendChild(e);q.appendChild(k);(u=document.createElement("div")).className="btn-group";u.appendChild(l);u.appendChild(q);h.addEventListener("click",function(v){d(b.getCurColor().getRgb());g=!0});p.className="chickenpaint-color-swatches-buttons";window.File&&window.FileReader&&window.FileList&&window.Blob&&((n=document.createElement("input")).type=
"file",n.multiple=!1,n.style.display="none",p.appendChild(u),p.appendChild(n));p.appendChild(h);this.getBodyElement().appendChild(p)}function Zd(b){function c(){let g=f.closest(".chickenpaint").querySelector(".chickenpaint-canvas");return{width:g.offsetWidth,height:g.offsetHeight}}function d(g,m){let p=g.getElement();m?f.contains(p)||f.appendChild(p):f.contains(p)&&f.removeChild(p);e.emitEvent("paletteVisChange",[g.name,m])}let a={tool:new Sd(b),color:new Vd(b),swatches:new Yd(b),stroke:new Ud(b),
brush:new nd(b),layers:new Wd(b),misc:new Td(b),textures:new Xd(b)},h={tool:!1,color:!1,misc:!1};var q={color:!0,textures:!0,layers:!0};let f=document.createElement("div"),e=this,k=[],l=[];for(let g in this.palettes=a,this.showPaletteByName=function(m,p){(m=a[m])&&d(m,p)},this.togglePalettes=function(){let m=b.mainGUI.getMainMenu().getElement().querySelector('.widget-nav [data-action="CPTogglePalettes"]');if(0===l.length)f.querySelectorAll(".chickenpaint-palette").forEach(function(p){e.showPaletteByName(p.getAttribute("data-paletteName"),
!1);l.push(p)}),m.classList.remove("selected");else{for(let p=0;p<l.length;p++)e.showPaletteByName(l[p].getAttribute("data-paletteName"),!0);l=[];m.classList.add("selected")}},this.updateDeselectIcon=function(){let m=b.mainGUI.getMainMenu().getElement().querySelector(".deselectIcon");var p=a.brush.getElement();let n=p.querySelector(".icon-md-deselect");p=p.querySelector(".deselectButton");m&&n&&p&&(b.artwork.getSelection().isEmpty()?(m.style.color="",n.style.color="",p.style.boxShadow=""):(m.style.color=
"rgb(49, 130, 216)",n.style.color="rgb(49, 130, 216)",p.style.boxShadow="0 0 1px 1px rgb(49, 130, 216)"))},this.constrainPalettes=function(){let m=c();for(var p in a){let n=a[p];n.getX()+n.getWidth()/2>m.width&&n.setLocation(m.width-n.getWidth(),n.getY());n.getY()+n.getHeight()/2>m.height&&n.setLocation(n.getX(),m.height-n.getHeight())}p=m.width-a.tool.getWidth()-a.misc.getWidth()-a.stroke.getWidth()-a.color.getWidth()-a.brush.getWidth()-15>0;a.swatches.getX()+a.swatches.getWidth()==a.brush.getX()+
a.brush.getWidth()&&20>Math.abs(a.swatches.getY()-a.brush.getY())&&a.swatches.setLocation(a.brush.getX()-a.swatches.getWidth()-(p?5:1),0);a.layers.getY()+a.layers.getHeight()>m.height&&a.layers.setHeight(Math.max(m.height-a.layers.getY(),200))},this.arrangePalettes=function(){let m=c();var p=b.getSmallScreenMode();var n=b.mainGUI.getMainMenu().getElement(),t=n.querySelector('.dropdown-item[data-action="CPToggleSetSmallScreenMode"]');t&&(p?t.classList.add("selected"):t.classList.remove("selected"));
if(n=n.querySelector('.widget-nav [data-action="CPToggleSetSmallScreenMode"]'))n.className="widget-toggler mobile selected",n.dataset.checkbox="true",n.type="button",n.classList.add("selected"),n.dataset.selected="true",n.textContent="",t=document.createElement("span"),t.textContent=p?T("PC mode"):T("Mobile mode"),n.appendChild(t);p?(a.tool.setLocation(0,0),a.misc.setLocation(a.tool.getX()+a.tool.getWidth()+1,0),p=m.width-(a.tool.getWidth()+a.misc.getWidth()+a.brush.getWidth())<=16?a.misc.getY()+
a.misc.getHeight()+1:0,a.brush.setLocation(m.width-a.brush.getWidth()-15,p),a.textures.setWidth(m.width-a.textures.getX()),a.layers.setLocation(a.brush.getX()+a.brush.getWidth()-a.layers.getWidth(),a.textures.getY()-a.layers.getHeight()),p=Math.max(a.textures.getY()-330-1,370),a.layers.setHeight(p),a.layers.setWidth(218),a.stroke.setLocation(a.misc.getX(),a.misc.getY()+a.misc.getHeight()+1),a.swatches.setLocation(a.stroke.getX(),a.stroke.getY()+a.stroke.getHeight()+1)):(p=m.width-a.tool.getWidth()-
a.misc.getWidth()-a.stroke.getWidth()-a.color.getWidth()-a.brush.getWidth()-15>0,a.brush.setLocation(m.width-a.brush.getWidth()-15,0),n=a.brush.getY()+a.brush.getHeight(),n=m.height-n>300?n+2:n,a.layers.setSize(a.brush.getWidth()+30*!!p,m.height-n),a.layers.setLocation(a.brush.getX()+a.brush.getWidth()-a.layers.getWidth(),n),a.tool.setLocation(0,0),a.misc.setLocation(a.tool.getX()+a.tool.getWidth()+(p?5:1),0),p?a.stroke.setLocation(a.misc.getX()+a.misc.getWidth()+(p?5:1),0):a.stroke.setLocation(a.misc.getX(),
a.misc.getY()+a.misc.getHeight()+1),a.swatches.setLocation(Math.max(a.brush.getX()-a.swatches.getWidth()-(p?5:1),a.tool.getX()+a.tool.getWidth()),0),a.textures.setWidth(Math.min(a.layers.getX()-a.textures.getX(),490)));a.textures.setLocation(a.color.getX()+a.color.getWidth()+4,m.height-a.textures.getHeight());a.color.setLocation(0,Math.max(a.tool.getY()+a.tool.getHeight(),m.height-a.color.getHeight()))},b.on("smallScreen",function(m){for(let p in a)a[p].toggleCollapse(m&&(!(p in h)||h[p]))}),this.getElement=
function(){return f},f.className="chickenpaint-palettes",a){let m=a[g],p=m.getElement();m.on("paletteVisChange",function(){d(this,!1)});g in q&&m.setCollapseDownwards(!0);p.setAttribute("data-paletteName",g);k.push(p)}for(let g in a)q=a[g].getElement(),f.appendChild(q)}function Cg(b,c){function d(e){let k,l=e.dataset.action,g="true"===e.dataset.checkbox;b.isActionAllowed(l)&&(g?(e.classList.toggle("selected"),k=e.classList.contains("selected")):k=!1,b.actionPerformed({action:l,checkbox:g,selected:k}))}
let a=document.createElement("nav");a.className="navbar navbar-expand-md bg-light";a.innerHTML='\n    <div class="navbar-upper">\n      <span class="navbar-brand">litaChix</span>\n      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#chickenpaint-main-menu-content" aria-controls="chickenpaint-main-menu-content" aria-expanded="false" aria-label="Toggle main menu">\n        <span class="navbar-toggler-icon"></span>\n      </button>\n    </div>\n    <div class="collapse navbar-collapse" id="chickenpaint-main-menu-content">\n      <div class="navbar-nav"></div>\n    </div>\n    <div class="widget-nav" id="chickenpaint-palette-toggler-content"></div>\n  ';
let h=navigator.userAgent.toLowerCase().includes("mac os");a.addEventListener("touchmove",e=>e.preventDefault(),{passive:!1});a.addEventListener("click",e=>{let k=e.target.closest("[data-action]");k&&(d(k),e.preventDefault())});var q=a.querySelector(".navbar-nav");Af.forEach(e=>{function k(){setTimeout(()=>{let n=document.activeElement;n instanceof HTMLElement&&(n.matches('[data-bs-toggle="dropdown"]')||n.matches(".dropdown-item")||n.closest(".dropdown-menu"))&&n.blur()},10)}var l,g;let m=document.createElement("div");
m.className="nav-item dropdown";m.innerHTML=`
        <span class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">${T(e.name)}</span>
        <ul class="dropdown-menu"></ul>
      `;let p=m.querySelector(".dropdown-menu");null==(l=m.querySelector(".dropdown-toggle"))||l.addEventListener("show.bs.dropdown",()=>{let n,t;k();m.querySelectorAll("[data-action]").forEach(u=>{let v=b.isActionAllowed(u.dataset.action);u.classList.toggle("disabled",!v);"true"===u.dataset.hideIfNotAvailable&&u.classList.toggle("hidden",!v)});m.querySelectorAll(".dropdown-divider").forEach(u=>u.classList.remove("hidden"));n=Array.from(m.querySelectorAll(".dropdown-item:not(.hidden), .dropdown-divider:not(.hidden)"));
t=null;n.forEach((u,v)=>{u.classList.contains("dropdown-divider")?0===v||t?u.classList.add("hidden"):t=u:t=null});t&&t.classList.add("hidden")});null==(g=m.querySelector(".dropdown-toggle"))||g.addEventListener("hide.bs.dropdown",()=>{k()});e.children.forEach(n=>{let t;if("-"===n.name)n=document.createElement("hr"),n.className="dropdown-divider",null==p||p.appendChild(n);else if(n.action&&b.isActionSupported(n.action)){if("CPSend"===n.action&&!b.isActionSupported("CPContinue")){var u=document.createElement("hr");
u.className="dropdown-divider";null==p||p.appendChild(u);n.name=T("Post Oekaki");n.shortcut="ctrl+p"}if((t=document.createElement("span")).className="dropdown-item",t.dataset.action=n.action,t.innerHTML=`<span>${T(n.name)}</span>`,n.checkbox&&(t.dataset.checkbox="true",n.checked&&t.classList.add("selected")),n.hideIfNotAvailable&&(t.dataset.hideIfNotAvailable="true"),n.title&&(t.title=T(n.title)),n.shortcut){h&&(n.shortcut=n.shortcut.replace(/SHIFT/im,"\u21e7").replace(/ALT/im,"\u2325").replace(/CTRL/im,
"\u2318"));let v=document.createElement("small");v.className="chickenpaint-shortcut";u=(u=n.shortcut).toUpperCase().replace(/(,.+)$/,"").replace("=","+");v.textContent=h?u.replace(/([^+])\+/g,"$1"):u.replace(/([^+])\+/g,"$1 ");t.appendChild(v);Ja(Va)(n.shortcut,A=>(d(t),A.preventDefault(),A.stopPropagation(),!1))}n=document.createElement("li");n.appendChild(t);p.appendChild(n)}});q.appendChild(m)});(function(e,k){if(k.filter(l=>l.mnemonic&&b.isActionSupported(l.action)).forEach(l=>{let g=document.createElement("button");
g.className="widget-toggler selected";g.type="button";g.dataset.action=l.action;g.dataset.checkbox="true";g.dataset.selected=(!l.checked).toString();let m=document.createElement("span");m.textContent=l.mnemonic;g.appendChild(m);e.appendChild(g)}),"force"===b.fullScreenModeOptions()){let l=document.createElement("span");l.textContent="";l.className="upperIcon clear icon-md-crop_free";l.style.fontSize="25px";l.style.verticalAlign="bottom";l.title=T("Full-screen mode");l.dataset.action="CPArrangePalettes";
l.addEventListener("click",g=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()});e.appendChild(l);document.addEventListener("fullscreenchange",()=>{c.resize();requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{d(l);d(l);d(l)})})})})}if(k=k.find(l=>"CPToggleSetSmallScreenMode"===l.action)){let l=b.getSmallScreenMode(),g=document.createElement("button");g.className="widget-toggler mobile selected";g.dataset.checkbox="true";
g.type="button";g.dataset.selected="true";g.style.minWidth="110px";g.textContent="";let m=document.createElement("span");m.textContent=l?T("PC mode"):T("Mobile mode");g.appendChild(m);g.dataset.action=k.action;e.appendChild(g)}k=document.createElement("span");k.textContent="";k.className="upperIcon clear icon-md-remove_selection";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=T("Clear");k.dataset.action="CPClear";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className=
"upperIcon fill icon-md-ink_selection";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=T("Fill");k.dataset.action="CPFill";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className="upperIcon transform icon-md-resize";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=T("Transform");k.dataset.action="CPTransform";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className="upperIcon deselectIcon icon-md-deselect";k.style.fontSize=
"25px";k.style.verticalAlign="bottom";k.dataset.action="CPDeselectAll";k.title=T("Deselect");e.appendChild(k)})(a.querySelector(".widget-nav"),Af[5].children);c.getPaletteManager().on("paletteVisChange",function(e,k){e="CPPal"+e.charAt(0).toUpperCase()+e.slice(1);[...((null==a?void 0:a.querySelectorAll(`[data-action="${e}"]`))||[])].forEach(l=>{l.classList.toggle("selected",k)})});let f=a.querySelector(".dropdown-item[data-action=CPFullScreen]");b.on("fullScreen",e=>null==f?void 0:f.classList.toggle("selected",
e));null==f||f.classList.toggle("selected",b.isFullScreen());this.getElement=()=>a}function $d(b,c){let d=document.createElement("div"),a=new Pd(b),h=new Zd(b),q,f=!1,e=this;this.togglePalettes=function(){h.togglePalettes()};this.arrangePalettes=function(){setTimeout(h.arrangePalettes.bind(h),0)};this.constrainPalettes=function(){h.constrainPalettes()};this.showPalette=function(m,p){h.showPaletteByName(m,p)};this.getSwatches=function(){return h.palettes.swatches.getSwatches()};this.setSwatches=function(m){h.palettes.swatches.setSwatches(m)};
this.getPaletteManager=function(){return h};this.setRotation90=function(m){a.setRotation(m*Math.PI/2);h.palettes.layers.setRotation90(m)};this.setFullScreenMode=function(m){f!==m&&(f=m,e.resize(),e.arrangePalettes())};this.resize=function(m=!0){let p=window.innerHeight,n=q.getElement().getBoundingClientRect().height;a.resize(f?p-n:Math.min(Math.max(p-n-65,500),850),!1);m&&e.constrainPalettes()};q=new Cg(b,this);this.getMainMenu=function(){return q};c.appendChild(q.getElement());d.className="chickenpaint-main-section";
d.appendChild(a.getElement());d.appendChild(h.getElement());c.appendChild(d);a.on("canvasRotated90",function(m){h.palettes.layers.setRotation90(m)});screen.orientation&&screen.orientation.addEventListener("change",m=>{this.resize();requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{b.actionPerformed({action:"CPArrangePalettes"});b.actionPerformed({action:"CPArrangePalettes"});b.actionPerformed({action:"CPArrangePalettes"})})})})});let k=document.getElementById("chickenpaint-main-menu-content");
if(document.addEventListener("show.bs.modal",()=>{k&&k.classList.contains("show")&&(new zb.Collapse(k,{toggle:!1})).hide()}),k){let m=document.querySelector(".chickenpaint .widget-nav");m&&(k.addEventListener("show.bs.collapse",p=>{m.classList.add("hidden")}),k.addEventListener("hidden.bs.collapse",p=>{m.classList.remove("hidden")}));window.addEventListener("resize",()=>{null==m||m.classList.remove("hidden")})}document.addEventListener("hidden.bs.collapse",this.resize.bind(this));window.addEventListener("resize",
this.resize.bind(this));let l=null,g=!1;(new ResizeObserver(()=>{let m=window.innerWidth>document.documentElement.clientWidth;m!==l&&(l=m,g||(g=!0,requestAnimationFrame(()=>{g=!1;this.resize(!1)})))})).observe(document.body);b.on("fullScreen",m=>this.setFullScreenMode(m));b.on("unsavedChanges",m=>{c.classList.toggle("chickenpaint-unsaved",m)});setTimeout(this.resize.bind(this),0)}function Dg(b){var c=document.createElement("div");c.classList.add("modal","fade","chickenpaint-about-dialog");c.setAttribute("tabindex",
"-1");c.setAttribute("role","dialog");c.innerHTML='\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title">About litaChix</h5>\n                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <a class="chickenpaint-on-github" target="_blank" href="https://github.com/satopian/ChickenPaint_Be" rel="noopener">\n                        <span class="icon-github"></span> litaChix on GitHub\n                    </a>\n                    <p>\n                        litaChix is a customized version of <a href="https://github.com/thenickdude/chickenpaint" target="_blank" rel="noopener">ChickenPaint</a> by satopian.\n                    </p>\n                    <p>\n                        Built on: 2026-02-22T05:30:39<br>\n                        <a href="https://www.gnu.org/licenses/" target="_blank" rel="noopener">GNU General Public License</a><br>\n                    </p>\n                    <a class="chickenpaint-on-github" target="_blank" href="https://github.com/thenickdude/chickenpaint" rel="noopener">\n                        <span class="icon-github"></span> ChickenPaint on GitHub\n                    </a>\n\n                    <p>\n                        ChickenPaint is a translation of <a href="https://github.com/thenickdude/chibipaint" target="_blank" rel="noopener">ChibiPaint</a>\n                        from Java to JavaScript by Nicholas Sherlock / Chicken Smoothie\n                    </p>\n                    <p>\n                        ChibiPaint is Copyright (c) 2006-2008 Marc Schefer. All Rights Reserved\n                    </p>\n                    <p>\n                        ChickenPaint is free software: you can redistribute it and/or modify\n                        it under the terms of the GNU General Public License as published by\n                        the Free Software Foundation, either version 3 of the License, or\n                        (at your option) any later version.\n                    </p>\n                    <p>\n                        ChickenPaint is distributed in the hope that it will be useful,\n                        but WITHOUT ANY WARRANTY; without even the implied warranty of\n                        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n                        <a target="_blank" href="https://www.gnu.org/licenses/" rel="noopener">GNU General Public License</a> for more details.\n                    </p>\n<pre class="pre-scrollable chickenpaint-third-party-licenses">Toolbar icons designed by <a target="_blank" href="https://github.com/Anteira" rel="noopener">Miglena Lapavicheva (Anteira)</a>\n    These icons are dual-licensed under <a target="_blank" href="https://spdx.org/licenses/GPL-3.0-or-later.html" rel="noopener">GPL-3.0-or-later</a> and <a target="_blank" href="https://creativecommons.org/licenses/by/3.0/" rel="noopener">CC-BY-3.0</a>\n\nIncludes these MIT-licensed libraries:\n\n    Includes the <a target="_blank" href="https://github.com/eligrey/FileSaver.js" rel="noopener">FileSaver.js</a> library\n    Copyright (c) 2016 <a target="_blank" href="https://eligrey.com/" rel="noopener">Eli Grey</a>\n\n    Includes the <a target="_blank" href="https://github.com/101arrowz/fflate" rel="noopener">fflate</a> library\n    Copyright (c) 2023 Arjun Barrett  \n\n    Includes the <a target="_blank" href="https://github.com/madrobby/keymaster" rel="noopener">keymaster.js</a> library\n    Copyright (c) 2011-2013 Thomas Fuchs\n\n    Includes the <a target="_blank" href="https://benalman.com/projects/jquery-throttle-debounce-plugin/" rel="noopener">jQuery throttle-debounce</a> library\n    Copyright (c) 2010 "Cowboy" Ben Alman\n    \n    Includes the <a target="_blank" href="https://github.com/Stuk/jszip/" rel="noopener">JSZip</a> library\n    Copyright (c) 2009-2016\n    Stuart Knightley,\n    David Duponchel,\n    Franz Buchinger,\n    Ant\u00f3nio Afonso\n\n    Includes the <a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a> library\n    Copyright (c) 2011-2025 <a href="https://github.com/twbs/bootstrap/blob/main/LICENSE" target="_blank" rel="noopener">The Bootstrap Authors</a>\n\n    MIT License\n\n    Permission is hereby granted, free of charge, to any person\n    obtaining a copy of this software and associated documentation\n    files (the "Software"), to deal in the Software without\n    restriction, including without limitation the rights to use,\n    copy, modify, merge, publish, distribute, sublicense, and/or\n    sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following\n    conditions:\n\n    The above copyright notice and this permission notice shall be\n    included in all copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\n    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT \n    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n    OTHER DEALINGS IN THE SOFTWARE.\n\nIncludes Font Awesome by Fonticons, Inc. - <a href="https://fontawesome.com/" target="_blank" rel="noopener">https://fontawesome.com/</a>\nIncludes Material Design icons by Google - <a href="https://fonts.google.com/" target="_blank" rel="noopener">https://fonts.google.com/</a>\n                    </pre>\n                </div>\n            </div>\n        </div>\n    ';
b.appendChild(c);var d=new zb.Modal(c);return c.addEventListener("hidden.bs.modal",()=>{c.remove()}),{show:function(){d.show()}}}function ae(b,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Complete transform")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>
                        ${T("You need to finish transforming this layer before you can do that. What would you like to do with the transform?")}
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light chickenpaint-cancel-transform">${T("Cancel")}</button>
                    <button type="button" class="btn btn-light chickenpaint-reject-transform">${T("Undo transform")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-accept-transform">${T("Apply transform")}</button>
                </div>
            </div>
        </div>
    `;let a=this,h=d.querySelector(".chickenpaint-accept-transform"),q=d.querySelector(".chickenpaint-reject-transform"),f=d.querySelector(".chickenpaint-cancel-transform"),e=new zb.Modal(d);null==h||h.addEventListener("click",function(k){c.actionPerformed({action:"CPTransformAccept"});a.emitEvent("accept")});null==q||q.addEventListener("click",function(k){c.actionPerformed({action:"CPTransformReject"});a.emitEvent("reject")});null==f||f.addEventListener("click",function(k){e.hide()});this.show=function(){e.show()};
this.hide=function(){e.hide()};d.addEventListener("hidden.bs.modal",k=>{d.remove()});b.addEventListener("keydown",function g(l){"Enter"===l.key&&(e.hide(),c.actionPerformed({action:"CPTransformAccept"}),a.emitEvent("accept"),b.removeEventListener("keydown",g))});b.appendChild(d)}function Eg(b){let c=document.createElement("div");c.classList.add("modal","fade","chickenpaint-shortcuts-dialog");c.tabIndex=-1;c.role="dialog";c.innerHTML=`
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Shortcuts")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>${T("Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.")}</p>
                    <p>${T("Here are some other shortcuts which are not as obvious!")}</p>
                    <div class="chickenpaint-shortcuts-sections">
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${T("Color swatches palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Use as the drawing color")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${T("Right")}</span></dt>
                                        <dd>${T("Remove or replace a color swatch")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${T("Line drawing mode")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Snap line to nearest 45 degrees")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${T("Painting tools")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">1</span> - <span class="chickenpaint-shortcut-key">9</span>, <span class="chickenpaint-shortcut-key">0</span></span></dt>
                                        <dd>${T("Change brush opacity")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">[</span>, <span class="chickenpaint-shortcut-key">]</span></span><span class="chickenpaint-shortcut-alternate">${T("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Be}</span> +
                                        <span class="chickenpaint-shortcut-key">${Ce}</span> +  <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Change brush size")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${T("Brush palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${T("Right")}</span><span class="chickenpaint-shortcut-alternate">${T("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Adjust brush sliders more precisely")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${T("Zoom")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Fg}</span>  + <span class="chickenpaint-shortcut-key">Space</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span><dt>
                                        <dt><span class="chickenpaint-shortcut-alternate">${T("or")}</span>
                                        <span class="chickenpaint-shortcut-key">Z</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Zoom the canvas")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${T("Drawing canvas")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${T("Middle")}</span> <span class="chickenpaint-shortcut-alternate">${T("or")}</span> <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Space</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Move the canvas around")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">R</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Rotate the canvas")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${T("Right")}</span><span class="chickenpaint-shortcut-alternate">${T("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Ce}</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Sample the color under the cursor")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">H</span></dt>
                                        <dd>${T("Flip View Horizontal")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${T("Layers palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${T("Double click")}</span><span class="chickenpaint-shortcut-alternate">${T("or")}</span><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${T("Right")}</span></dt>
                                        <dd>${T("Rename layer")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Toggle mask enable/disable")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Ce}</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Toggle mask View")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Be}</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Apply layer mask")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="chickenpaint-shortcut-key">${Be}</span> + <span class="fa icon-mouse-pointer"></span> ${T("Left")}</span></dt>
                                        <dd>${T("Delete layer mask")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;c.querySelector(".btn-close").addEventListener("click",()=>{c.remove()});let d=new zb.Modal(c);b.appendChild(c);this.show=function(){d.show()}}function Gg(b,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Box blur")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${T("Blur amount")} (1px~200px)</label>
                            <input type="number" class="form-control chickenpaint-blur-amount" value="3" min="1" max="200">
                        </div>
                        <div class="form-group">
                            <label>${T("Iterations (1~8, larger gives smoother blur)")}</label>
                            <input type="number" class="form-control chickenpaint-blur-iterations" value="1" min="1" max="8">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${T("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${T("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-box-blur" data-bs-dismiss="modal">${T("Ok")}</button>
                </div>
            </div>
        </div>
    `;let a=d.querySelector(".chickenpaint-blur-amount"),h=d.querySelector(".chickenpaint-blur-iterations"),q=d.querySelector(".chickenpaint-apply-box-blur"),f=new zb.Modal(d);this.show=function(){let e=document.getElementById("chickenpaint-main-menu-content");e&&e.classList.contains("show")&&(new zb.Collapse(e,{toggle:!1})).hide();c.setModalShown(!0);f.show()};q.addEventListener("click",e=>{var k;e=Math.min(200,Math.max(1,parseInt(null==a?void 0:a.value,10)||1));let l=Math.min(Math.max(parseInt(null==
h?void 0:h.value,10),1),8),g=null==(k=d.querySelector("#createMergedLayer"))?void 0:k.checked;c.getArtwork().boxBlur(e,e,l,g);c.setModalShown(!1);f.hide()});d.addEventListener("hidden.bs.modal",()=>{document.activeElement.blur();d.remove()});d.addEventListener("shown.bs.modal",()=>{a.focus()});d.addEventListener("keydown",e=>{"Enter"===e.key&&d.classList.contains("show")&&(q.click(),e.preventDefault())});b.appendChild(d)}function Hg(b){let c=document.createElement("div");c.classList.add("modal","fade");
c.setAttribute("tabindex","-1");c.setAttribute("role","dialog");c.innerHTML='\n        <div class="modal-dialog" role="document">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title">Drawing tablet support</h5>\n                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <div class="chickenpaint-tablet-support chickenpaint-pointerevents-support">\n                        <h5>\n                            Built-in support for most tablets.\n                            <small>macOS, Windows 10 or newer</small>\n                        </h5>\n                        <div class="chickenpaint-supported-browsers">\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-chrome"></span>\n                                Chrome\n                            </div>\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-edge"></span>\n                                Edge (Windows 10)\n                            </div>\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-firefox"></span>\n                                Firefox\n                            </div>\n                        </div>\n                        <p class="chickenpaint-not-supported">\n                            Your browser doesn\'t have built-in support for drawing tablets, please try\n                            one of the other browsers listed above.\n                        </p>\n                        <p class="chickenpaint-supported alert alert-success">\n                            Your browser has built-in support for drawing tablets!\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ';
let d=c.querySelector(".chickenpaint-pointerevents-support"),a=!!window.PointerEvent;null==d||d.classList.toggle("supported",a);null==d||d.classList.toggle("not-supported",!a);c.addEventListener("hidden.bs.modal",q=>{c.remove()});let h=new zb.Modal(c);b.appendChild(c);this.show=function(){h.show()}}function Ig(b,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Grid options")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${T("Grid size")}</label>
                            <input type="number" class="form-control chickenpaint-grid-size" value="" min="3">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${T("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-grid-settings" data-bs-dismiss="modal">${T("Ok")}</button>
                </div>
            </div>
        </div>
    `;let a=d.querySelector(".chickenpaint-grid-size"),h=d.querySelector(".chickenpaint-apply-grid-settings"),q=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();q.show()};a.value=c.getGridSize();d.addEventListener("hidden.bs.modal",()=>{d.remove()});h.addEventListener("click",()=>{let f=parseInt(a.value,10);c.setGridSize(f);c.setModalShown(!1);q.hide()});d.addEventListener("shown.bs.modal",
()=>{c.setModalShown(!0);a.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),h.click())});b.appendChild(d)}function Jg(b,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Chromatic aberration")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${T("Offset X")} (-64px ~ 64px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-offset-x" value="" min="-64", max="64">
                        </div>
                        <div class="form-group">
                            <label>${T("Offset Y")} (-64px ~ 64px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-offset-y" value="" min="-64", max="64">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer" checked="checked">
                    <label class="form-check-label" for="createMergedLayer">
                    ${T("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${T("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${T("Ok")}</button>
                </div>
            </div>
        </div>
    `;let a=d.querySelector(".chickenpaint-aberration-offset-x"),h=d.querySelector(".chickenpaint-aberration-offset-y"),q=d.querySelector(".chickenpaint-apply-aberration-settings"),f=new zb.Modal(d);this.show=function(){let e=document.getElementById("chickenpaint-main-menu-content");e&&e.classList.contains("show")&&(new zb.Collapse(e,{toggle:!1})).hide();f.show()};a.value=3;h.value=3;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==q||q.addEventListener("click",()=>{var e;let k=Math.max(-64,
Math.min(64,parseInt(null==a?void 0:a.value,10)||0)),l=Math.max(-64,Math.min(64,parseInt(null==h?void 0:h.value,10)||0)),g=null==(e=d.querySelector("#createMergedLayer"))?void 0:e.checked;c.getArtwork().chromaticAberration(k,l,g);c.setModalShown(!1);f.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==a||a.focus()});d.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),null==q||q.click())});b.appendChild(d)}function Kg(b,c){let d=document.createElement("div");
d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Color halftone")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${T("Dot size")} (5px ~ 512px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-dot-size" value="" min="5", max="512">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer" checked="checked">
                    <label class="form-check-label" for="createMergedLayer">
                    ${T("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${T("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${T("Ok")}</button>
                </div>
            </div>
        </div>
    `;let a=d.querySelector(".chickenpaint-aberration-dot-size"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),q=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();q.show()};a.value=15;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var f;let e=Math.max(5,Math.min(512,parseInt(null==a?void 0:a.value,10)||0)),k=null==
(f=d.querySelector("#createMergedLayer"))?void 0:f.checked;c.getArtwork().colorHalftone(e,k);c.setModalShown(!1);q.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==a||a.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==h||h.click())});b.appendChild(d)}function Lg(b,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Mono halftone")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${T("Dot size")} (5px ~ 512px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-dot-size" value="" min="5", max="512">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${T("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${T("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${T("Ok")}</button>
                </div>
            </div>
        </div>
    `;let a=d.querySelector(".chickenpaint-aberration-dot-size"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),q=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();q.show()};a.value=15;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var f;let e=Math.max(5,Math.min(512,parseInt(null==a?void 0:a.value,10)||0)),k=null==
(f=d.querySelector("#createMergedLayer"))?void 0:f.checked;c.getArtwork().monoHalftone(e,k);c.setModalShown(!1);q.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==a||a.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==h||h.click())});b.appendChild(d)}function Mg(b,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Mosaic")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${T("Block size")} (2px~2000px)</label>
                            <input type="number" class="form-control chickenpaint-block-size" value="" min="2", max="2000">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${T("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${T("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${T("Ok")}</button>
                </div>
            </div>
        </div>
    `;let a=d.querySelector(".chickenpaint-block-size"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),q=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();q.show()};a.value=6;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var f;let e=parseInt(null==a?void 0:a.value,10);e=Math.max(2,Math.min(2E3,e||1));let k=null==
(f=d.querySelector("#createMergedLayer"))?void 0:f.checked;c.getArtwork().mosaic(e,k);c.setModalShown(!1);q.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==a||a.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==h||h.click())});b.appendChild(d)}function Ng(b,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Edge expand")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${T("Edge expand width")} (1px ~ 128px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-edgeWidth" value="" min="1", max="128">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="replaceWithInnerFill">
                    <label class="form-check-label" for="replaceWithInnerFill">
                    ${T("Fill Inside with edge color")}
                    </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${T("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${T("Ok")}</button>
                </div>
            </div>
        </div>
    `;let a=d.querySelector(".chickenpaint-aberration-edgeWidth"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),q=new zb.Modal(d);this.show=function(){let f=document.getElementById("chickenpaint-main-menu-content");f&&f.classList.contains("show")&&(new zb.Collapse(f,{toggle:!1})).hide();q.show()};a.value=5;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var f;let e=Math.max(1,Math.min(128,parseInt(null==a?void 0:a.value,10)||0)),k=null==
(f=d.querySelector("#replaceWithInnerFill"))?void 0:f.checked;c.getArtwork().edge(e,k);c.setModalShown(!1);q.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==a||a.focus()});d.addEventListener("keydown",f=>{"Enter"===f.key&&(f.preventDefault(),null==h||h.click())});b.appendChild(d)}function be(b,c,d,a=!1){let h=document.createElement("div");h.className="modal fade chickenpaint-send-dialog";h.tabIndex=-1;h.setAttribute("role","dialog");h.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content" data-stage="saving">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Saving ...")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close" style="display: none;"></button>
                </div>
                <div class="modal-body">
                    <p class="chickenpaint-saving-progress-message">${T("Preparing... This may take a few seconds.")}</p>
                    <pre class="chickenpaint-saving-error-message pre-scrollable" style="display: none;"></pre>
                    <div class="progress" style="${a?"display:none":""}">
                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light chickenpaint-send-cancel" data-bs-dismiss="modal">${T("Cancel")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-not-previously-posted" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <p>${T("Your drawing has been saved, would you like to post it to the forum now?")}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${T("Yes, post it now")}</button>
                    <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${T("No, keep drawing")}</button>
                    <button type="button" class="btn btn-light chickenpaint-exit" data-bs-dismiss="modal">${T("No, quit and I'll finish it later")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-already-posted" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${T("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <p>${T("Your drawing has been saved, would you like to view it on the forum now?")}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${T("Yes, view the post")}</button>
                    <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${T("No, keep drawing")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-redirect" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${a?T("Drawing saved to browser storage!"):T("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>${a?T("Your drawing has been saved to your browser storage."):T("Your drawing has been saved, redirecting you to view your new post now...")}</p>
                </div>
                 <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" data-stage="success-savedb-from-menu" style="display:none">OK</button>
                </div>
            </div>
        </div>
    `;let q=h.querySelector(".chickenpaint-saving-progress-message"),f=h.querySelector(".chickenpaint-saving-error-message"),e=h.querySelector(".progress-bar"),k=new zb.Modal(h,{backdrop:"static",keyboard:!1}),l=this;d.on("savingProgress",function(m,p){q.textContent=p;e.setAttribute("aria-valuenow",100*m);e.style.width=100*m+"%"});d.on("savingComplete",function(){h.querySelector(".modal-content[data-stage='saving']").style.display="none";b.isActionSupported("CPContinue")?b.isActionSupported("CPExit")?
h.querySelector(".modal-content[data-stage='success-not-previously-posted']").style.display="block":h.querySelector(".modal-content[data-stage='success-already-posted']").style.display="block":(h.querySelector(".modal-content[data-stage='success-redirect']").style.display="block",a&&(h.querySelector(".modal-footer button[data-stage='success-savedb-from-menu']").style.display="block"))});d.on("savingFailure",function(m){e.classList.add("progress-bar-danger");let p=T("Sorry, your drawing could not be saved, please try again later.");
m&&(m=m.replace(/^CHIBIERROR\s*/,"")).length>0&&(p+=`<br><br>${T("The error returned from the server was")}:`,f.textContent=m,f.style.display="block");q.innerHTML=p});h.querySelector(".chickenpaint-send-cancel").addEventListener("click",function(){d.cancel()});var g=h.querySelector(".chickenpaint-post-drawing");g&&g.addEventListener("click",function(){b.actionPerformed({action:"CPPost"})});(g=h.querySelector(".chickenpaint-exit"))&&(g.style.display=b.isActionSupported("CPExit")?"":"none",g.addEventListener("click",
function(){alert("When you want to come back and finish your drawing, just click the 'new drawing' button again and you can choose to continue this drawing.");b.actionPerformed({action:"CPExit"})}));h.addEventListener("hidden.bs.modal",()=>{h.remove()});c.appendChild(h);this.show=function(){k.show();l.emitEvent("shown")}}function ka(b){function c(w){this.palName=w}function d(w){this.toolNum=w}function a(w){this.modeNum=w}function h(w){let H;switch(D=w==dc.EDITING_MODE_IMAGE?ka.COLOR_MODE_RGB:ka.COLOR_MODE_GREYSCALE,
n.emitEvent("colorModeChange",[w==dc.EDITING_MODE_IMAGE?"rgb":"greyscale"]),D){case ka.COLOR_MODE_RGB:H=v.clone();break;case ka.COLOR_MODE_GREYSCALE:H=new jb(jb.greyToRGB(A))}n.artwork.setForegroundColor(H.getRgb());n.emitEvent("colorChange",[H])}function q(){n.emitEvent("toolChange",[y,B[y]])}function f(w){E!=w&&(w==ka.M_TRANSFORM&&(x=E),E=w,n.emitEvent("modeChange",[E]))}function e(w){f(ka.M_DRAW);y=w;n.artwork.setBrush(B[w]);q()}function k(w={}){let H=new wd({artwork:n.getArtwork(),rotation:t.getRotation90(),
swatches:u.getSwatches()});H.on("savingComplete",function(){n.artwork.setHasUnsavedChanges(!1)});H.on("savingFailure",function(){alert(T("Sorry, your drawing could not be saved, Please see the error message."))});H.save(w)}function l(w=!1){if(w||n.isActionSupported("CPContinue")||confirm(T("Are you sure you want to send your drawing to the server and finish drawing now?"))){var H=!w&&b.saveUrl,U=new wd({artwork:n.getArtwork(),rotation:t.getRotation90(),swatches:u.getSwatches(),url:H,post_max_size:b.post_max_size});
H=new be(n,p,U,w);U.on("savingComplete",function(){!w&&(n.artwork.setHasUnsavedChanges(!1),!n.isActionSupported("CPContinue")&&n.isActionSupported("CPPost")&&n.actionPerformed({action:"CPPost"}))});U.on("savingFailure",function(){alert(T("Sorry, your drawing could not be saved, Please see the error message."))});H.on("shown",function(){w?U.save({savedb:!0,savedbFromMenu:!0}):U.save()});H.show()}}function g(w,H){p&&(p.addEventListener("dblclick",function(U){U.preventDefault();U.stopPropagation()}),
n.artwork.on("editModeChanged",h),u=new $d(n,p),n.mainGUI=u,n.emitEvent("fullScreen",[O]),n.emitEvent("smallScreen",[I]),N.load(),e(ka.T_PEN),u.arrangePalettes(),w&&u.setSwatches(w),H&&u.setRotation90(H),window.addEventListener("beforeunload",function(U){n.artwork.getHasUnsavedChanges()&&U.preventDefault()}),n.artwork.on("unsavedChanges",U=>{b.allowMultipleSends&&n.emitEvent("unsavedChanges",[U])}))}let m;!function(){try{if("u">typeof navigator){let w=navigator.languages;for(let H of(Array.isArray(w)||
(w=[w]),w)){let U=/^(..)([-_].+)?$/.exec(H);if(U){if(U[1]=U[1].toLowerCase(),U[1]in we)return void ve(H);if("en"===U[1])return void ve("en")}}}}catch(w){console.error(w)}}();b.language&&ve(b.language);let p=b.uiElem;document.addEventListener("keydown",w=>{((w.ctrlKey||w.metaKey)&&"+;=-shro".split("").includes(w.key.toLowerCase())||"Enter"===w.key)&&w.preventDefault()});p.addEventListener("contextmenu",w=>{w.preventDefault();w.stopPropagation()},{passive:!1});let n=this,t,u,v=new jb(0),A=255,D=ka.COLOR_MODE_RGB,
y=ka.T_PENCIL,E=ka.M_DRAW,x=E,G=[4278190080,4294967295],I=!1,O=!1,B=((m=Array(ka.T_MAX))[ka.T_PENCIL]=new wa({toolNb:ka.T_PENCIL,size:16,alpha:255,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AA,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_OPACITY,smoothing:.02}),m[ka.T_ERASER]=new wa({toolNb:ka.T_ERASER,size:16,alpha:255,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!1,texture:0,tip:wa.TIP_ROUND_AA,brushMode:wa.BRUSH_MODE_ERASE,paintMode:wa.PAINT_MODE_OPACITY}),
m[ka.T_PEN]=new wa({toolNb:ka.T_PEN,size:2,alpha:100,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!0,pressureAlpha:!1,tip:wa.TIP_ROUND_AA,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.5,smoothing:.02}),m[ka.T_SOFTERASER]=new wa({toolNb:ka.T_SOFTERASER,size:16,alpha:60,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,texture:1,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_ERASE,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),m[ka.T_AIRBRUSH]=new wa({toolNb:ka.T_AIRBRUSH,
size:50,alpha:30,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),m[ka.T_DODGE]=new wa({toolNb:ka.T_DODGE,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_DODGE,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),m[ka.T_BURN]=new wa({toolNb:ka.T_BURN,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,
pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_BURN,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),m[ka.T_WATER]=new wa({toolNb:ka.T_WATER,size:30,alpha:50,isAA:!1,minSpacing:.5,spacing:.02,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AA,brushMode:wa.BRUSH_MODE_WATER,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125,resat:.3,bleed:.6}),m[ka.T_BLUR]=new wa({toolNb:ka.T_BLUR,size:20,alpha:255,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_PIXEL,
brushMode:wa.BRUSH_MODE_BLUR,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125}),m[ka.T_SMUDGE]=new wa({toolNb:ka.T_SMUDGE,size:20,alpha:128,isAA:!1,minSpacing:.5,spacing:.01,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_SMUDGE,paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:1}),m[ka.T_BLENDER]=new wa({toolNb:ka.T_BLENDER,size:20,alpha:60,isAA:!1,minSpacing:.5,spacing:.1,pressureSize:!1,pressureAlpha:!0,tip:wa.TIP_ROUND_AIRBRUSH,brushMode:wa.BRUSH_MODE_OIL,
paintMode:wa.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:.07}),m),N=new Og,P,L,ia,V,ma,da,Ca,ha={CPFullScreen:{action:function(){n.setFullScreen(!O)},isSupported:function(){return"disable"!==b.fullScreenMode&&"force"!==b.fullScreenMode&&!1!==b.allowFullScreen},modifies:{gui:!0}},CPZoomIn:{action:function(){t.zoomIn()},modifies:{gui:!0}},CPZoomOut:{action:function(){t.zoomOut()},modifies:{gui:!0}},CPZoom100:{action:function(){t.zoom100()},modifies:{gui:!0}},CPResetZoomAndRotation:{action:function(){t.resetZoomAndRotation();
let w=u.getPaletteManager().palettes.misc.flipButton,H=u.getMainMenu().getElement().querySelector('[data-action="CPViewHFlip"]');w&&w.classList.remove("flipped");H&&H.classList.remove("selected")},modifies:{gui:!0}},CPViewHFlip:{action:function(){let w=t.toggleViewFlip(),H=u.getPaletteManager().palettes.misc.flipButton,U=u.getMainMenu().getElement().querySelector('[data-action="CPViewHFlip"]');H&&(w?H.classList.add("flipped"):H.classList.remove("flipped"));U&&(w?U.classList.add("selected"):U.classList.remove("selected"))},
modifies:{gui:!0}},CPUndo:{action:function(){n.artwork.undo()},modifies:{document:!0},allowed:"isUndoAllowed"},CPRedo:{action:function(){n.artwork.redo()},modifies:{document:!0},allowed:"isRedoAllowed"},CPClearHistory:{action:function(){confirm(T("You're about to clear the current Undo/Redo history.\nThis operation cannot be undone, are you sure you want to do that?"))&&n.artwork.clearHistory()},modifies:{document:!0}},CPPencil:new d(ka.T_PENCIL),CPPen:new d(ka.T_PEN),CPEraser:new d(ka.T_ERASER),
CPSoftEraser:new d(ka.T_SOFTERASER),CPAirbrush:new d(ka.T_AIRBRUSH),CPDodge:new d(ka.T_DODGE),CPBurn:new d(ka.T_BURN),CPWater:new d(ka.T_WATER),CPBlur:new d(ka.T_BLUR),CPSmudge:new d(ka.T_SMUDGE),CPBlender:new d(ka.T_BLENDER),CPFloodFill:new a(ka.M_FLOODFILL),CPGradientFill:new a(ka.M_GRADIENTFILL),CPRectSelection:new a(ka.M_RECT_SELECTION),CPMoveTool:new a(ka.M_MOVE_TOOL),CPRotateCanvas:new a(ka.M_ROTATE_CANVAS),CPPanCanvas:new a(ka.M_PAN_CANVAS),CPColorPicker:new a(ka.M_COLOR_PICKER),CPTransform:{action:function(){let w=
n.artwork.getActiveLayer();null==n.artwork.transformAffineBegin()?n.showLayerNotification(w,T("Whoops! All of the selected pixels are transparent!"),"layer"):f(ka.M_TRANSFORM)},modifies:{mode:!0},allowed:function(){let w=n.artwork.getActiveLayer();if(w.visible)if(0==w.alpha)n.showLayerNotification(w,T("Whoops! This layer's opacity is currently 0%."),"opacity");else{if(null!=n.artwork.transformAffineBegin())return 0!=w.getEffectiveAlpha();n.showLayerNotification(w,T("Whoops! All of the selected pixels are transparent!"),
"layer")}else n.showLayerNotification(w,T("Whoops! This layer is currently hidden."),"layer")}},CPTransformAccept:{action:function(){E==ka.M_TRANSFORM&&(n.artwork.transformAffineFinish(),f(x))},modifies:{mode:!0}},CPTransformReject:{action:function(){E==ka.M_TRANSFORM&&(n.artwork.transformAffineAbort(),f(x))},modifies:{document:!0,mode:!0}},CPFreeHand:{action:function(){B[y].strokeMode=wa.STROKE_MODE_FREEHAND;q()},modifies:{tool:!0}},CPLine:{action:function(){B[y].strokeMode=wa.STROKE_MODE_LINE;q()},
modifies:{tool:!0}},CPBezier:{action:function(){B[y].strokeMode=wa.STROKE_MODE_BEZIER;q()},modifies:{tool:!0}},CPAbout:{action:function(){(new Dg(p)).show()},modifies:{}},CPShortcuts:{action:function(){(new Eg(p)).show()},modifies:{}},CPTabletSupport:{action:function(){(new Hg(p)).show()},modifies:{}},CPLayerDuplicate:{action:function(){n.artwork.duplicateLayer()},modifies:{document:!0}},CPLayerMergeDown:{action:function(){n.artwork.mergeDown()},modifies:{document:!0},allowed:"isMergeDownAllowed"},
CPGroupMerge:{action:function(){n.artwork.mergeGroup()},modifies:{document:!0},allowed:"isMergeGroupAllowed"},CPLayerMergeAll:{action:function(){n.artwork.mergeAllLayers()},modifies:{document:!0},allowed:"isMergeAllLayersAllowed"},CPCreateMergedLayer:{action:function(){n.artwork.mergeAllLayers(!0)},modifies:{document:!0},allowed:"isMergeAllLayersAllowed"},CPExpandLayerGroup:{action:function(w){n.artwork.expandLayerGroup(w.group,w.expand)},modifies:{document:!0}},CPFill:{action:function(){n.artwork.fill(4278190080|
n.getCurColor().getRgb())},modifies:{document:!0},requiresDrawable:!0},CPClear:{action:function(){n.artwork.clear()},modifies:{document:!0},requiresDrawable:!0},CPClearWithTexture:{action:function(){n.artwork.clear(!1)},modifies:{document:!0},requiresDrawable:!0},CPSelectAll:{action:function(){n.artwork.rectangleSelection(n.artwork.getBounds());t.repaintAll()},modifies:{document:!0}},CPDeselectAll:{action:function(){n.artwork.rectangleSelection(new Ba(0,0,0,0));t.repaintAll()},modifies:{document:!0}},
CPHFlip:{action:function(){n.artwork.hFlip()},modifies:{document:!0},requiresDrawable:!0},CPVFlip:{action:function(){n.artwork.vFlip()},modifies:{document:!0},requiresDrawable:!0},CPMNoise:{action:function(){n.artwork.monochromaticNoise()},modifies:{document:!0},requiresDrawable:!0},CPCNoise:{action:function(){n.artwork.colorNoise()},modifies:{document:!0},allowed:"isColorNoiseAllowed"},CPFXBoxBlur:{action:function(){P||=new Gg(p,n);P.show()},modifies:{document:!0},requiresDrawable:!0},CPFXMosaic:{action:function(){ia||=
new Mg(p,n);ia.show()},modifies:{gui:!0}},CPColorHalftone:{action:function(){V||=new Kg(p,n);V.show()},allowed:"isNotEditingMask",modifies:{gui:!0}},CPMonoHalftone:{action:function(){ma||=new Lg(p,n);ma.show()},modifies:{gui:!0}},CPChromaticAberration:{action:function(){da||=new Jg(p,n);da.show()},allowed:"isNotEditingMask",modifies:{gui:!0}},CPEdgeExpand:{action:function(){Ca||=new Ng(p,n);Ca.show()},allowed:"isNotEditingMaskAndDrawable",modifies:{gui:!0}},CPConvertToDrawingColor:{action:function(){n.artwork.convertToDrawingColor()},
allowed:"isNotEditingMaskAndDrawable",modifies:{document:!0}},CPFXInvert:{action:function(){n.artwork.invert()},modifies:{document:!0},requiresDrawable:!0},CPBrightnessToOpacity:{action:function(){n.artwork.brightnessToOpacity()},modifies:{document:!0},allowed:"isNotEditingMaskAndDrawable"},CPCut:{action:function(){n.artwork.cutSelection()},modifies:{document:!0},requiresDrawable:!0,allowed:"isCutSelectionAllowed"},CPCopy:{action:function(){n.artwork.copySelection()},modifies:{document:!0},requiresDrawable:!0,
allowed:"isCopySelectionAllowed"},CPCopyMerged:{action:function(){n.artwork.copySelectionMerged()},modifies:{document:!0},allowed:"isCopySelectionMergedAllowed"},CPPaste:{action:function(){n.artwork.pasteClipboard()},modifies:{document:!0},allowed:"isPasteClipboardAllowed"},CPToggleGrid:{action:function(w){t.showGrid(w.selected)},modifies:{gui:!0}},CPGridOptions:{action:function(){L||=new Ig(p,t);L.show()},modifies:{gui:!0}},CPLinearInterpolation:{action:function(w){t.setInterpolation(w.selected)},
modifies:{gui:!0}},CPResetCanvasRotation:{action:function(){t.resetRotation()},modifies:{gui:!0}},CPAddLayer:{action:function(){n.artwork.addLayer("layer")},modifies:{document:!0}},CPAddGroup:{action:function(){n.artwork.addLayer("group")},modifies:{document:!0}},CPAddLayerMask:{action:function(){n.artwork.addLayerMask()},modifies:{document:!0},allowed:"isAddLayerMaskAllowed"},CPApplyLayerMask:{action:function(){n.artwork.applyLayerMask(!0)},modifies:{document:!0},allowed:"isApplyLayerMaskAllowed"},
CPRemoveLayerMask:{action:function(){n.artwork.removeLayerMask()},modifies:{document:!0},allowed:"isRemoveLayerMaskAllowed"},CPRemoveLayer:{action:function(){n.artwork.removeLayer()||alert(T("Sorry, you can't remove the last remaining layer in the drawing."))},modifies:{document:!0},allowed:"isRemoveLayerAllowed"},CPCreateClippingMask:{action:function(){n.artwork.createClippingMask()},modifies:{document:!0},allowed:"isCreateClippingMaskAllowed"},CPReleaseClippingMask:{action:function(){n.artwork.releaseClippingMask()},
modifies:{document:!0},allowed:"isReleaseClippingMaskAllowed"},CPRelocateLayer:{action:function(w){n.artwork.relocateLayer(w.layer,w.toGroup,w.toIndex)},modifies:{document:!0}},CPSetActiveLayer:{action:function(w){w.mask&&w.layer.mask&&!w.layer.maskVisible&&n.artwork.setLayerMaskVisible(w.layer,!0);n.artwork.setActiveLayer(w.layer,w.mask);n.artwork.performIdleTasks()},modifies:{document:!0}},CPToggleMaskView:{action:function(){let w=n.artwork.toggleMaskView();w&&n.emitEvent("maskViewOpened",[w])},
modifies:{gui:!0}},CPSetMaskVisible:{action:function(w){n.artwork.setLayerMaskVisible(w.layer,w.visible)},modifies:{layerProp:!0}},CPSetLayerVisibility:{action:function(w){n.artwork.setLayerVisibility(w.layer,w.visible)},modifies:{layerProp:!0}},CPSetLayerName:{action:function(w){n.artwork.setLayerName(w.layer,w.name)},modifies:{layerProp:!0}},CPSetLayerBlendMode:{action:function(w){n.artwork.setLayerBlendMode(w.blendMode)},modifies:{layerProp:!0}},CPSetLayerAlpha:{action:function(w){n.artwork.setLayerAlpha(w.alpha)},
modifies:{layerProp:!0}},CPSetLayerLockAlpha:{action:function(w){n.artwork.setLayerLockAlpha(w.lock)},modifies:{layerProp:!0}},CPPalColor:new c("color"),CPPalBrush:new c("brush"),CPPalLayers:new c("layers"),CPPalStroke:new c("stroke"),CPPalSwatches:new c("swatches"),CPPalTool:new c("tool"),CPPalMisc:new c("misc"),CPPalTextures:new c("textures"),CPTogglePalettes:{action:function(){u.togglePalettes()},modifies:{gui:!0}},CPArrangePalettes:{action:function(){u.arrangePalettes()},modifies:{gui:!0}},CPToggleSetSmallScreenMode:{action:function(){n.setSmallScreenMode(!I);
u.arrangePalettes()},modifies:{gui:!0}},CPExportAsPNG:{action:function(){k({saveUrl:!1})},isSupported:function(){return!1!==b.allowDownload},modifies:{document:!0}},CPExportAsZIP:{action:function(){k({zip:!0,saveUrl:!1})},isSupported:function(){return!1!==b.allowDownload},modifies:{document:!0}},CPSaveDB:{action:function(){k({savedb:!0,saveUrl:!1})},isSupported:function(){return!1!==b.allowDownload},modifies:{document:!0}},CPSaveDBFromMenu:{action:function(){l(!0)},isSupported:function(){return!1!==
b.allowDownload},modifies:{gui:!0}},CPSend:{action:function(){l()},isSupported:function(){return!!b.saveUrl},modifies:{document:!0}},CPPost:{action:function(){if("function"==typeof handleExit)return handleExit();window.location=b.postUrl},isSupported:function(){return!(!b.postUrl&&"function"!=typeof handleExit)},modifies:{document:!0}},CPContinue:{action:function(){},isSupported:function(){return!!b.allowMultipleSends}},CPExit:{action:function(){window.location=b.exitUrl},isSupported:function(){return!!b.exitUrl},
modifies:{}}};switch(c.prototype.action=function(w){u.showPalette(this.palName,w.selected)},c.prototype.modifies={gui:!0},d.prototype.action=function(){e(this.toolNum)},d.prototype.modifies={mode:!0,tool:!0},d.prototype.requiresDrawable=!0,a.prototype.action=function(){f(this.modeNum)},a.prototype.modifies={mode:!0},this.callToolListeners=function(){q()},this.getArtwork=function(){return this.artwork},this.setCanvas=function(w){t=w},this.setTransformInterpolation=function(w){this.artwork.setTransformInterpolation(w)},
this.setCurColor=function(w){switch(D){case ka.COLOR_MODE_RGB:v.isEqual(w)||(v.copyFrom(w),this.artwork.setForegroundColor(w.getRgb()),this.emitEvent("colorChange",[w]));break;case ka.COLOR_MODE_GREYSCALE:if(w=w.getValue(),A!=w){let H=jb.greyToRGB(w);this.artwork.setForegroundColor(H);A=w;this.emitEvent("colorChange",[new jb(H)])}}},this.getCurColor=function(){switch(D){case ka.COLOR_MODE_RGB:return v.clone();case ka.COLOR_MODE_GREYSCALE:return new jb(jb.greyToRGB(A))}},this.setCurGradient=function(w){G=
w.slice(0);this.emitEvent("gradientChange",[G])},this.getCurGradient=function(){return G.slice(0)},this.setBrushSize=function(w){B[y].size=Math.max(1,Math.min(200,w));q()},this.getBrushSize=function(){return B[y].size},this.setAlpha=function(w){B[y].alpha=w;q()},this.getAlpha=function(){return B[y].alpha},this.getCurMode=function(){return E},this.zoomOnCenter=function(w,H=!1){t.zoomOnCenter(w,H)},this.getZoom=function(){return t.getZoom()},this.getRotationDegrees=function(){return t.getRotationDegrees()},
this.setRotationDegrees=function(w){t.setRotationDegrees(w)},this.setGrowFillArea=function(w){t.setGrowFillArea(w)},this.setFoodFillAlpha=function(w){t.setFoodFillAlpha(w)},this.setFloodFillReferAllLayers=function(w){t.setFloodFillReferAllLayers(w)},this.setModalShown=function(w){t.setModalShown(w)},this.isPanOrRotateMode=function(){return t.isPanOrRotateMode()},this.getCurTool=function(){return y},this.getBrushInfo=function(){return B[y]},this.isActionSupported=function(w){if(ha[w]){let H=typeof ha[w].isSupported;
return"function"==H?ha[w].isSupported():"undefined"==H||ha[w].isSupported}return!1},this.isActionAllowed=function(w){w=ha[w];return!!w&&("function"==typeof w.allowed?w.allowed():"string"==typeof w.allowed?this.artwork[w.allowed]():!w.requiresDrawable||this.artwork.isActiveLayerDrawable())},this.showLayerNotification=function(w,H,U){this.emitEvent("layerNotification",[w,H,U])},this.actionPerformed=function(w){if(null!=this.artwork&&null!=t){var H=ha[w.action];if(H)if(E==ka.M_TRANSFORM&&(H.modifies.document||
H.modifies.mode)&&-1==["CPTransformAccept","CPTransformReject"].indexOf(w.action))if("CPUndo"==w.action)ha.CPTransformReject.action();else{if("CPTransform"!=w.action){let U=new ae(p,this);U.on("accept",()=>{this.actionPerformed(w);U.hide()});U.on("reject",()=>{this.actionPerformed(w);U.hide()});U.show()}}else H.action(w)}},this.setSmallScreenMode=function(w){I!==w&&(I=w,p.classList.toggle("chickenpaint-small-screen",I),n.emitEvent("smallScreen",[I]))},this.getSmallScreenMode=function(){return I},
this.fullScreenModeOptions=function(){return b.fullScreenMode},this.setFullScreen=function(w){O!==w&&(O=w,document.body.classList.toggle("chickenpaint-full-screen",O),p.classList.toggle("chickenpaint-full-screen",O),w=document.querySelectorAll('head meta[name="viewport"]').length,O&&0===w?(w=document.createElement("meta"),w.name="viewport",w.content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,,user-scalable=no",document.head.appendChild(w),setTimeout(()=>n.emitEvent("fullScreen",
[O]),200)):n.emitEvent("fullScreen",[O]))},this.isFullScreen=function(){return O},this.setToolbarStyle=function(w){N.set("toolbarStyle",w);N.save()},this.getToolbarStyle=function(){return N.get("toolbarStyle")},this.getResourcesRoot=function(){return b.resourcesRoot},p&&(p.className+=" chickenpaint chickenpaint-lang-"+xe),b.resourcesRoot=b.resourcesRoot||"chickenpaint/",this.setSmallScreenMode(!!("number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&(window.screen.width<=820||window.screen.height<=
820))),b.fullScreenMode){case "force":this.setFullScreen(!0);break;case "auto":this.setFullScreen(I)}N.on("toolbarStyle",w=>this.emitEvent("toolbarStyleChange",[w]));let sa=b.loadImageUrl||b.loadChibiFileUrl,ea=!1;"true"===localStorage.getItem("has_chibi_autosave_flag")&&((ea=confirm(sa?T("Unsaved data was detected.\nInterrupt image loading and restore it?"):T("Unsaved data was detected. Would you like to restore it?")))||ue());pg().then(w=>{if(ea&&w&&w.bytes)Ze(w.bytes).then(H=>{if(this.artwork=
H,w.swatches){let U=URL.createObjectURL(w.swatches);H=Object.assign({},b);H.loadSwatchesUrl=U;H.loadImageUrl=null;H.loadChibiFileUrl=null;H=new vd(H);H.on("loadingComplete",na=>{g(na.swatches,b.rotation);URL.revokeObjectURL(U);b.onLoaded&&b.onLoaded(this)});H.load()}else g([],b.rotation),b.onLoaded&&b.onLoaded(this)});else if(sa){let H=new vd(b);new rg(p,H,b.resourcesRoot);H.on("loadingComplete",function(U){n.artwork=U.layers||U.flat;g(U.swatches,b.rotation);b.onLoaded&&b.onLoaded(this)});H.load()}else b.artwork?
this.artwork=b.artwork:(this.artwork=new dc(b.canvasWidth||800,b.canvasHeight||600),this.artwork.addBackgroundLayer(),this.artwork.addDefaultLayer()),g(),b.onLoaded&&b.onLoaded(this)})}var Yc,Oc="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof global?global:{};wa.STROKE_MODE_FREEHAND=0;wa.STROKE_MODE_LINE=1;wa.STROKE_MODE_BEZIER=2;wa.TIP_ROUND_PIXEL=0;wa.TIP_ROUND_AA=1;wa.TIP_ROUND_AIRBRUSH=2;wa.TIP_SQUARE_PIXEL=3;wa.TIP_SQUARE_AA=4;wa.BRUSH_MODE_PAINT=0;wa.BRUSH_MODE_ERASE=
1;wa.BRUSH_MODE_DODGE=2;wa.BRUSH_MODE_BURN=3;wa.BRUSH_MODE_WATER=4;wa.BRUSH_MODE_BLUR=5;wa.BRUSH_MODE_SMUDGE=6;wa.BRUSH_MODE_OIL=7;wa.PAINT_MODE_OPACITY=0;wa.PAINT_MODE_FLOW=1;wa.DEFAULTS={isAA:!1,minSpacing:0,spacing:0,pressureSize:!0,pressureAlpha:!1,pressureScattering:!1,alphaScale:1,tip:wa.TIP_ROUND_PIXEL,brushMode:wa.BRUSH_MODE_PAINT,paintMode:wa.PAINT_MODE_OPACITY,strokeMode:wa.STROKE_MODE_FREEHAND,resat:1,bleed:0,texture:1,size:0,curSize:0,alpha:0,curAlpha:0,scattering:0,curScattering:0,squeeze:0,
curSqueeze:0,angle:Math.PI,curAngle:0,smoothing:0};wa.prototype.applyPressure=function(b,c){let d=this.pressureSize?Math.max(.6,this.size*b):Math.max(.6,this.size);c||!this._lastSize?(this.curSize=d,this._lastSize=d):(this.curSize=this._lastSize+.3*(d-this._lastSize),this._lastSize=this.curSize);this.curAlpha=this.pressureAlpha?Math.floor(this.alpha*Math.min(b,1)):this.alpha;this.curSqueeze=this.squeeze;this.curAngle=this.angle;this.curScattering=this.scattering*this.curSize*(this.pressureScattering?
b:1)};wa.prototype.clone=function(){return new wa(this)};Ba.prototype.makeEmpty=function(){this.bottom=this.right=this.top=this.left=0};Ba.prototype.union=function(b){this.isEmpty()?this.set(b):b.isEmpty()||(this.left=Math.min(this.left,b.left),this.top=Math.min(this.top,b.top),this.right=Math.max(this.right,b.right),this.bottom=Math.max(this.bottom,b.bottom))};Ba.prototype.getUnion=function(b){var c=this.clone();return c.union(b),c};Ba.prototype.getIntersection=function(b,c=!1){let d=Math.max(this.left,
b.left),a=Math.max(this.top,b.top),h=Math.min(this.right,b.right);b=Math.min(this.bottom,b.bottom);return c&&(d>=h||a>=b)?null:new Ba(d,a,h,b)};Ba.prototype.clipTo=function(b){return this.isEmpty()||(b.isEmpty()?this.makeEmpty():(this.left=Math.min(Math.max(this.left,b.left),b.right),this.top=Math.min(Math.max(this.top,b.top),b.bottom),this.right=Math.max(Math.min(this.right,b.right),b.left),this.bottom=Math.max(Math.min(this.bottom,b.bottom),b.top))),this};Ba.prototype.containsPoint=function(b){return!(b.x<
this.left||b.y<this.top||b.x>=this.right||b.y>=this.bottom)};Ba.prototype.isInside=function(b){return this.left>=b.left&&this.top>=b.top&&this.right<=b.right&&this.bottom<=b.bottom};Ba.prototype.clipSourceDest=function(b,c){c.right=c.left+b.getWidth();c.bottom=c.top+b.getHeight();this.isEmpty()||c.left>=this.right||c.top>=this.bottom||c.right<=this.left||c.bottom<=this.top?(b.makeEmpty(),c.makeEmpty()):(c.right>this.right&&(b.right-=c.right-this.right,c.right=this.right),c.bottom>this.bottom&&(b.bottom-=
c.bottom-this.bottom,c.bottom=this.bottom),c.left<this.left&&(b.left+=this.left-c.left,c.left=this.left),c.top<this.top&&(b.top+=this.top-c.top,c.top=this.top))};Ba.prototype.getWidth=function(){return this.right-this.left};Ba.prototype.getHeight=function(){return this.bottom-this.top};Ba.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Ba.prototype.isEmpty=function(){return this.right<=this.left||this.bottom<=this.top};Ba.prototype.set=function(b){this.left=b.left;this.top=b.top;
this.right=b.right;this.bottom=b.bottom};Ba.prototype.clone=function(){return new Ba(this.left,this.top,this.right,this.bottom)};Ba.prototype.translate=function(b,c){return this.left+=b,this.right+=b,this.top+=c,this.bottom+=c,this};Ba.prototype.getTranslated=function(b,c){var d=this.clone();return d.translate(b,c),d};Ba.prototype.moveTo=function(b,c){this.translate(b-this.left,c-this.top)};Ba.prototype.equals=function(b){return this.left==b.left&&this.right==b.right&&this.top==b.top&&this.bottom==
b.bottom};Ba.prototype.grow=function(b,c){this.left-=b;this.right+=b;this.top-=c;this.bottom+=c};Ba.prototype.toString=function(){return"("+this.left+","+this.top+","+this.right+","+this.bottom+")"};Ba.prototype.toPoints=function(){return[{x:this.left,y:this.top},{x:this.right,y:this.top},{x:this.right,y:this.bottom},{x:this.left,y:this.bottom}]};Ba.prototype.roundNearest=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=
Math.round(this.bottom),this};Ba.prototype.roundContain=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this};Ba.createBoundingBox=function(b){if(0===b.length)return new Ba(0,0,0,0);let c=new Ba(b[0].x,b[0].y,b[0].x,b[0].y);for(let d=1;d<b.length;d++)c.left=Math.min(c.left,b[d].x),c.top=Math.min(c.top,b[d].y),c.right=Math.max(c.right,b[d].x),c.bottom=Math.max(c.bottom,b[d].y);return c};Ba.prototype.subtract=
function(b){return Ba.subtract(this,b)};Ba.subtract=function(b,c){b instanceof Ba&&(b=[b]);c instanceof Ba&&(c=[c]);b=b.slice(0);for(let a=0;a<c.length;a++){let h=c[a],q=b.length;for(let f=0;f<q;f++){var d=b[f];if(!d)continue;let e=d.getIntersection(h);if(!e.isEmpty()){let k=[];if(d.top<h.top&&k.push(new Ba(d.left,d.top,d.right,e.top)),d.bottom>h.bottom&&k.push(new Ba(d.left,e.bottom,d.right,d.bottom)),d.left<h.left&&k.push(new Ba(d.left,e.top,e.left,e.bottom)),d.right>h.right&&k.push(new Ba(e.right,
e.top,d.right,e.bottom)),(k=k.filter(l=>!l.isEmpty())).length>0)for(b[f]=k[0],d=1;d<k.length;d++)b.push(k[d]);else b[f]=null}}}return b.filter(a=>null!=a)};Ba.union=function(b){if(b instanceof Ba)b=[b];else{b=b.slice(0);for(let d=0;d<b.length;d++){let a=b[d],h=b.length;if(a)for(let q=d+1;q<h;q++){var c=b[q];if(c&&!a.getIntersection(c).isEmpty()){c=Ba.subtract(c,a);b[q]=c[0];for(let f=1;f<c.length;f++)b.push(c[f])}}}}return b.filter(d=>d&&!d.isEmpty())};"object"==typeof window&&(window.cpRectGarbage=
new Ba(1.5,2.5,3.5,4.5));Uc.prototype.getBounds=function(){return new Ba(0,0,this.width,this.height)};Uc.prototype.isInside=function(b,c){return b>=0&&c>=0&&b<this.width&&c<this.height};J.prototype=Object.create(Uc.prototype);J.prototype.constructor=J;J.BYTES_PER_PIXEL=4;J.RED_BYTE_OFFSET=0;J.GREEN_BYTE_OFFSET=1;J.BLUE_BYTE_OFFSET=2;J.ALPHA_BYTE_OFFSET=3;J.prototype.clone=function(){return this.cloneRect(this.getBounds())};J.prototype.cloneRect=function(b){var c=new J(b.getWidth(),b.getHeight());
return c.copyBitmapRect(this,0,0,b),c};J.prototype.getPixel=function(b,c){b=Math.max(0,Math.min(this.width-1,b));c=Math.max(0,Math.min(this.height-1,c));b=this.offsetOfPixel(b,c);return this.data[b+J.ALPHA_BYTE_OFFSET]<<24|this.data[b+J.RED_BYTE_OFFSET]<<16|this.data[b+J.GREEN_BYTE_OFFSET]<<8|this.data[b+J.BLUE_BYTE_OFFSET]};J.prototype.setPixel=function(b,c,d){b=Math.max(0,Math.min(this.width-1,b));c=Math.max(0,Math.min(this.height-1,c));b=this.offsetOfPixel(b,c);this.data[b+J.ALPHA_BYTE_OFFSET]=
d>>24&255;this.data[b+J.RED_BYTE_OFFSET]=d>>16&255;this.data[b+J.GREEN_BYTE_OFFSET]=d>>8&255;this.data[b+J.BLUE_BYTE_OFFSET]=255&d};J.prototype.copyRectXOR=function(b,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),a=new Uint8Array(d*c.getHeight()*J.BYTES_PER_PIXEL),h=0,q=this.offsetOfPixel(c.left,c.top),f=b.offsetOfPixel(c.left,c.top),e=(this.width-d)*J.BYTES_PER_PIXEL,k=(b.width-d)*J.BYTES_PER_PIXEL;d*=J.BYTES_PER_PIXEL;for(var l=c.top;l<c.bottom;l++,q+=e,f+=k)for(var g=0;g<d;g++,h++,q++,f++)a[h]=
this.data[q]^b.data[f];return a};J.prototype.setRectXOR=function(b,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),a=c.getHeight();c=this.offsetOfPixel(c.left,c.top);var h=0,q=(this.width-d)*J.BYTES_PER_PIXEL;d*=J.BYTES_PER_PIXEL;for(var f=0;f<a;f++){for(var e=0;e<d;e++)this.data[c++]^=b[h++];c+=q}};J.prototype.copyBitmapRect=function(b,c,d,a){var h=new Ba(c,d,0,0);a=a.clone();this.getBounds().clipSourceDest(a,h);c=0|h.getWidth();d=0|h.getHeight();if(0==h.left&&0==h.top&&c==this.width&&d==this.height&&
c==b.width&&d==b.height)this.copyPixelsFrom(b);else{h=this.offsetOfPixel(h.left,h.top);var q=(this.width-c)*J.BYTES_PER_PIXEL;a=b.offsetOfPixel(a.left,a.top);for(var f=(b.width-c)*J.BYTES_PER_PIXEL,e=0;e<d;e++,a+=f,h+=q)for(var k=0;k<c;k++,a+=J.BYTES_PER_PIXEL,h+=J.BYTES_PER_PIXEL)this.data[h]=b.data[a],this.data[h+1]=b.data[a+1],this.data[h+2]=b.data[a+2],this.data[h+3]=b.data[a+3]}};J.prototype.copyAlphaFrom=function(b,c){var d=0|(c=this.getBounds().clipTo(c)).getWidth(),a=0|c.getHeight();c=this.offsetOfPixel(c.left,
c.top)+J.ALPHA_BYTE_OFFSET|0;for(var h=(this.width-d)*J.BYTES_PER_PIXEL|0,q=0;q<a;q++,c+=h)for(var f=0;f<d;f++,c+=J.BYTES_PER_PIXEL)this.data[c]=b.data[c]};J.prototype.setToSize=function(b){(b.width!=this.width||b.height!=this.height)&&(this.width=b.width,this.height=b.height,this.imageData=ie(this.width,this.height),this.data=this.imageData.data)};J.prototype.copyPixelsFrom=function(b){if(this.setToSize(b),"set"in this.data)this.data.set(b.data);else for(var c=0;c<this.data.length;c++)this.data[c]=
b.data[c]};J.prototype.copyPixelsFromGreyscale=function(b){var c,d=0,a=b.width*b.height;this.setToSize(b);for(c=0;c<a;c++,d+=J.BYTES_PER_PIXEL)this.data[d+J.RED_BYTE_OFFSET]=b.data[c],this.data[d+J.GREEN_BYTE_OFFSET]=b.data[c],this.data[d+J.BLUE_BYTE_OFFSET]=b.data[c],this.data[d+J.ALPHA_BYTE_OFFSET]=255};J.prototype.copyScaledNearestNeighbor=function(b){for(var c,d=0,a=b.width/this.width,h=b.height/this.height,q=0,f=0;q<this.height;q++,f+=h){c=b.offsetOfPixel(0,Math.round(f));for(var e=0,k=0;e<this.width;e++,
d+=J.BYTES_PER_PIXEL,k+=a){var l=c+Math.round(k)*J.BYTES_PER_PIXEL;this.data[d]=b.data[l];this.data[d+1]=b.data[l+1];this.data[d+2]=b.data[l+2];this.data[d+J.ALPHA_BYTE_OFFSET]=b.data[l+J.ALPHA_BYTE_OFFSET]}}};J.prototype.createThumbnailFrom=function(b){let c=Math.min(Math.floor(b.width/this.width),3);if(c<2)return void this.copyScaledNearestNeighbor(b);let d=new Uint16Array(5*this.width);var a=b.width*J.BYTES_PER_PIXEL,h=Math.floor(b.width/this.width)*J.BYTES_PER_PIXEL;let q=Math.floor(b.width/this.width/
c)*J.BYTES_PER_PIXEL,f=h-q*c;var e=Math.floor(b.height/this.height/c);h=e*a-h*this.width;a*=Math.floor(b.height/this.height)-e*c;let k=e=0;for(let p=0;p<this.height;p++,e+=a){let n;d.fill(0);for(var l=0;l<c;l++,e+=h){n=0;for(var g=0;g<this.width;g++,n+=5,e+=f)for(var m=0;m<c;m++,e+=q){let t=b.data[e+J.ALPHA_BYTE_OFFSET],u=t/255;d[n]+=b.data[e]*u;d[n+1]+=b.data[e+1]*u;d[n+2]+=b.data[e+2]*u;d[n+J.ALPHA_BYTE_OFFSET]+=t;d[n+4]=Math.max(d[n+4],t)}}n=0;for(l=0;l<this.width;l++,n+=5,k+=J.BYTES_PER_PIXEL)g=
d[n+4],0==g?this.data[k+J.ALPHA_BYTE_OFFSET]=0:(m=g/d[n+J.ALPHA_BYTE_OFFSET],this.data[k]=d[n]*m,this.data[k+1]=d[n+1]*m,this.data[k+2]=d[n+2]*m,this.data[k+J.ALPHA_BYTE_OFFSET]=g)}};J.prototype.floodFillWithBorder=function(b,c,d,a=2,h=255,q=null){if(this.isInside(b,c)){var f=this.width,e=this.height,k=this.data,l=q?q.data:k,g=J.BYTES_PER_PIXEL;q=d>>16&255;var m=d>>8&255;d&=255;var p=new Uint8Array(f*e),n=[{x:b,y:c}];b=(c*f+b)*g;var t=l[b+J.RED_BYTE_OFFSET],u=l[b+J.GREEN_BYTE_OFFSET],v=l[b+J.BLUE_BYTE_OFFSET],
A=l[b+J.ALPHA_BYTE_OFFSET];b=(y,E)=>{if(y<0||E<0||y>=f||E>=e||p[E*f+y])return!1;y=(E*f+y)*g;return l[y+J.RED_BYTE_OFFSET]===t&&l[y+J.GREEN_BYTE_OFFSET]===u&&l[y+J.BLUE_BYTE_OFFSET]===v&&l[y+J.ALPHA_BYTE_OFFSET]===A};for(c=(y,E,x,G,I,O)=>{y=(E*f+y)*g;k[y+J.RED_BYTE_OFFSET]=x;k[y+J.GREEN_BYTE_OFFSET]=G;k[y+J.BLUE_BYTE_OFFSET]=I;k[y+J.ALPHA_BYTE_OFFSET]=O};n.length;){let {x:y,y:E}=n.pop();b(y,E)&&(p[E*f+y]=1,c(y,E,q,m,d,h),b(y,E-1)&&n.push({x:y,y:E-1}),b(y+1,E)&&n.push({x:y+1,y:E}),b(y,E+1)&&n.push({x:y,
y:E+1}),b(y-1,E)&&n.push({x:y-1,y:E}))}n=new Uint8ClampedArray(k);for(b=0;b<e;b++)for(c=0;c<f;c++)if(p[b*f+c])for(let y=-a;y<=a;y++)for(let E=-a;E<=a;E++){var D=c+E;let x=b+y;D<0||x<0||D>=f||x>=e||p[x*f+D]||(D=(x*f+D)*g,n[D+J.RED_BYTE_OFFSET]=q,n[D+J.GREEN_BYTE_OFFSET]=m,n[D+J.BLUE_BYTE_OFFSET]=d,n[D+J.ALPHA_BYTE_OFFSET]=h)}k.set(n)}};J.prototype.copyPixelColumnToArray=function(b,c,d,a){var h=(this.width-1)*J.BYTES_PER_PIXEL,q=0;b=this.offsetOfPixel(b,c);for(c=0;c<d;c++){for(var f=0;f<J.BYTES_PER_PIXEL;f++)a[q++]=
this.data[b++];b+=h}};J.prototype.copyArrayToPixelColumn=function(b,c,d,a){var h=(this.width-1)*J.BYTES_PER_PIXEL,q=0;b=this.offsetOfPixel(b,c);for(c=0;c<d;c++){for(var f=0;f<J.BYTES_PER_PIXEL;f++)this.data[b++]=a[q++];b+=h}};J.prototype.boxBlur=function(b,c,d){let a=(b=this.getBounds().clipTo(b)).getWidth(),h=a*J.BYTES_PER_PIXEL,q=b.getHeight();var f=Math.max(a,q);let e=new Uint8Array(f*J.BYTES_PER_PIXEL);f=new Uint8Array(f*J.BYTES_PER_PIXEL);for(let g=b.top;g<b.bottom;g++){var k=this.offsetOfPixel(b.left,
g);for(var l=0;l<h;l++)e[l]=this.data[k++];!function(m,p){for(var n=0,t=0;t<p;t++){for(var u=m[n+J.ALPHA_BYTE_OFFSET],v=0;v<3;v++,n++)m[n]=Math.round(m[n]*u/255);n++}}(e,a);Se(e,f,a,c);k=this.offsetOfPixel(b.left,g);for(l=0;l<h;l++)this.data[k++]=f[l]}for(c=b.left;c<b.right;c++)this.copyPixelColumnToArray(c,b.top,q,e),Se(e,f,q,d),function(g,m){for(var p=0,n=0;n<m;n++){var t=g[p+J.ALPHA_BYTE_OFFSET];if(0!=t){t=255/t;for(var u=0;u<3;u++,p++)g[p]=Math.min(Math.round(g[p]*t),255);p++}else p+=J.BYTES_PER_PIXEL}}(f,
q),this.copyArrayToPixelColumn(c,b.top,q,f)};J.prototype.mosaic=function(b,c){b=this.getBounds().clipTo(b);c=Math.max(1,0|c);let d=J.BYTES_PER_PIXEL,a=this.width,h=this.data;for(let p=b.top;p<b.bottom;p+=c){let n=Math.min(p+c,b.bottom);for(let t=b.left;t<b.right;t+=c){let u=Math.min(t+c,b.right);var q=0,f=0,e=0,k=0,l=0;for(var g=p;g<n;g++){var m=(g*a+t)*d;for(let v=t;v<u;v++)q+=h[m],f+=h[m+1],e+=h[m+2],k+=h[m+3],l++,m+=d}q=q/l|0;f=f/l|0;e=e/l|0;k=k/l|0;for(l=p;l<n;l++)for(g=(l*a+t)*d,m=t;m<u;m++)h[g]=
q,h[g+1]=f,h[g+2]=e,h[g+3]=k,g+=d}}};J.prototype.chromaticAberration=function(b,c,d){c=Math.max(-64,Math.min(64,0|c));d=Math.max(-64,Math.min(64,0|d));b=this.getBounds().clipTo(b);let a=this.width,h=this.height,q=J.BYTES_PER_PIXEL,f=new Uint8ClampedArray(this.data),e=new Uint8ClampedArray(this.data.length);e.set(f);for(let l=b.top;l<b.bottom;l++)for(let g=b.left;g<b.right;g++){let m=(l*a+g)*q,p=f[m+J.ALPHA_BYTE_OFFSET]/255;if(0!==p){var k=(Math.min(h-1,Math.max(0,l+d))*a+Math.min(a-1,Math.max(0,g+
c)))*q;e[k+J.BLUE_BYTE_OFFSET]=Math.round(f[m+J.BLUE_BYTE_OFFSET]*p+e[k+J.BLUE_BYTE_OFFSET]*(1-p));k=(Math.min(h-1,Math.max(0,l-d))*a+Math.min(a-1,Math.max(0,g-c)))*q;e[k+J.RED_BYTE_OFFSET]=Math.round(f[m+J.RED_BYTE_OFFSET]*p+e[k+J.RED_BYTE_OFFSET]*(1-p))}}this.data.set(e)};J.prototype.colorHalftone=function(b,c,d=1){c=Math.max(2,0|c);this.getBounds().clipTo(b);let a=this.width,h=this.height,q=J.BYTES_PER_PIXEL,f=new Uint8ClampedArray(this.data);b=new Uint8ClampedArray(this.data.length);let e=.5*
a,k=.5*h;for(var l=0;l<b.length;l+=4)b[l]=b[l+1]=b[l+2]=255,b[l+3]=255;d*=c;c*=.5;var g=Math.ceil(Math.sqrt(a*a+h*h));l=(g-a)*.5;g=(g-h)*.5;for(var m of[{idx:0,r:0,g:255,b:255,angle:15*Math.PI/180},{idx:1,r:255,g:0,b:255,angle:75*Math.PI/180},{idx:2,r:255,g:255,b:0,angle:30*Math.PI/180}]){let y=Math.cos(m.angle),E=Math.sin(m.angle);for(let x=-g;x<h+g;x+=d)for(let G=-l;G<a+l;G+=d){var p=G+.5*d-e,n=x+.5*d-k,t=p*y-n*E+e;p=p*E+n*y+k;n=Math.round(t);var u=Math.round(p);if(!(n<0||u<0||n>=a||u>=h||(n=(u*
a+n)*q,u=f[n+3]/255,u<=0||(n=[1-(f[n]/255*u+(1-u)),1-(f[n+1]/255*u+(1-u)),1-(f[n+2]/255*u+(1-u))][m.idx],n<=0)))){n=.6+(c-.6)*Math.pow(n,.85);u=m.r;var v=m.g,A=m.b;let I=n*n;for(let O=-n;O<=n;O++)for(let B=-n;B<=n;B++){if(B*B+O*O>I)continue;var D=Math.round(t+B);let N=Math.round(p+O);D<0||N<0||D>=a||N>=h||(D=(N*a+D)*q,b[D]=b[D]*u>>8,b[D+1]=b[D+1]*v>>8,b[D+2]=b[D+2]*A>>8,b[D+3]=255)}!0}}}for(m=0;m<b.length;m+=4)255===b[m]&&255===b[m+1]&&255===b[m+2]&&(b[m+3]=0);this.data.set(b)};J.prototype.edge=function(b,
c,d,a){c=Math.max(1,0|c);b=this.getBounds().clipTo(b);var h=d>>16&255,q=d>>8&255;let f=255&d,e=this.width;var k=this.height;let l=J.BYTES_PER_PIXEL;d=new Uint8ClampedArray(this.data);let g=new Uint8ClampedArray(this.data.length);k=new Int32Array(e*k);for(var m=b.top;m<b.bottom;m++)for(var p=b.left;p<b.right;p++)k[m*e+p]=d[(m*e+p)*l+3]>0?0:1E9;c*=10;for(m=b.top;m<b.bottom;m++)for(p=b.left;p<b.right;p++){var n=m*e+p,t=k[n];p>b.left&&(t=Math.min(t,k[n-1]+10));m>b.top&&(t=Math.min(t,k[n-e]+10));p>b.left&&
m>b.top&&(t=Math.min(t,k[n-e-1]+14));p<b.right-1&&m>b.top&&(t=Math.min(t,k[n-e+1]+14));k[n]=t}for(m=b.bottom-1;m>=b.top;m--)for(p=b.right-1;p>=b.left;p--)n=m*e+p,t=k[n],p<b.right-1&&(t=Math.min(t,k[n+1]+10)),m<b.bottom-1&&(t=Math.min(t,k[n+e]+10)),p<b.right-1&&m<b.bottom-1&&(t=Math.min(t,k[n+e+1]+14)),p>b.left&&m<b.bottom-1&&(t=Math.min(t,k[n+e-1]+14)),k[n]=t;for(m=b.top;m<b.bottom;m++)for(p=b.left;p<b.right;p++){t=m*e+p;n=k[t];if(n>c)continue;t*=l;let u=1;n>c-10&&(u=(c-n)/10,u*=u);g[t]=h;g[t+1]=
q;g[t+2]=f;g[t+3]=255*u}if(!a)for(b=0;b<g.length;b+=4)a=d[b+3]/255,0!==a&&(h=g[b+3]/255,q=a+h*(1-a),g[b]=(d[b]*a+g[b]*h*(1-a))/q,g[b+1]=(d[b+1]*a+g[b+1]*h*(1-a))/q,g[b+2]=(d[b+2]*a+g[b+2]*h*(1-a))/q,g[b+3]=255*q);this.data.set(g)};J.prototype.convertToDrawingColor=function(b,c){b=this.getBounds().clipTo(b);let d=c>>16&255,a=c>>8&255;c&=255;let h=this.width,q=J.BYTES_PER_PIXEL,f=this.data;for(let e=b.top;e<b.bottom;e++)for(let k=b.left;k<b.right;k++){let l=(e*h+k)*q;0!==f[l+3]&&(f[l+0]=d,f[l+1]=a,
f[l+2]=c)}};J.prototype.monoHalftone=function(b,c,d=0,a=1){c=Math.max(2,0|c);this.getBounds().clipTo(b);b=this.width;let h=this.height,q=J.BYTES_PER_PIXEL,f=new Uint8ClampedArray(this.data),e=new Uint8ClampedArray(this.data.length);for(var k=0;k<e.length;k+=4)e[k]=e[k+1]=e[k+2]=0,e[k+3]=0;k=d>>16&255;let l=d>>8&255;d&=255;let g=.5*b,m=.5*h;var p=45*Math.PI/180;let n=Math.cos(p);p=Math.sin(p);a*=c;c*=.5;var t=Math.ceil(Math.sqrt(b*b+h*h));let u=(t-b)*.5;t=(t-h)*.5;for(let x=-t;x<h+t;x+=a)for(let G=
-u;G<b+u;G+=a){var v=G+.5*a-g,A=x+.5*a-m,D=v*n-A*p+g;v=v*p+A*n+m;A=0|D;var y=0|v;if(!(A<0||y<0||A>=b||y>=h||(A=(y*b+A)*q,y=f[A+3]/255,A=1-((.2126*f[A]+.7152*f[A+1]+.0722*f[A+2])/255*y+(1-y)),A<=0))){A=.5+(c-.5)*Math.pow(A,.9);y=A*A;for(let I=-A;I<=A;I++)for(let O=-A;O<=A;O++){if(O*O+I*I>y)continue;var E=D+O|0;let B=v+I|0;E<0||B<0||E>=b||B>=h||(E=(B*b+E)*q,e[E]=k,e[E+1]=l,e[E+2]=d,e[E+3]=255)}!0}}this.data.set(e)};J.prototype.offsetOfPixel=function(b,c){return(c*this.width+b)*4|0};J.prototype.getMemorySize=
function(){return this.data.length};J.prototype.getImageData=function(){return this.imageData};J.prototype.setImageData=function(b){this.width=b.width;this.height=b.height;this.imageData=b;this.data=b.data};J.prototype.clearAll=function(b){if(0==b&&"fill"in this.data)this.data.fill(0);else{var c=b>>24&255,d=b>>16&255,a=b>>8&255;b&=255;for(var h=0;h<this.width*this.height*J.BYTES_PER_PIXEL;)this.data[h++]=d,this.data[h++]=a,this.data[h++]=b,this.data[h++]=c}};J.prototype.clearRect=function(b,c){b=
this.getBounds().clipTo(b);var d=c>>24&255,a=c>>16&255,h=c>>8&255;c&=255;for(var q=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,f=this.offsetOfPixel(b.left,b.top),e=b.top;e<b.bottom;e++,f+=q)for(var k=b.left;k<b.right;k++)this.data[f++]=a,this.data[f++]=h,this.data[f++]=c,this.data[f++]=d};J.prototype.copyRegionHFlip=function(b,c){b=this.getBounds().clipTo(b);for(var d=b.top;d<b.bottom;d++)for(var a=this.offsetOfPixel(b.left,d),h=c.offsetOfPixel(b.right-1,d),q=b.left;q<b.right;q++,h-=2*J.BYTES_PER_PIXEL)for(var f=
0;f<J.BYTES_PER_PIXEL;f++)this.data[a++]=c.data[h++]};J.prototype.copyRegionVFlip=function(b,c){for(var d=(b=this.getBounds().clipTo(b)).getWidth()*J.BYTES_PER_PIXEL,a=b.top;a<b.bottom;a++)for(var h=this.offsetOfPixel(b.left,a),q=c.offsetOfPixel(b.left,b.bottom-1-(a-b.top)),f=0;f<d;f++)this.data[h++]=c.data[q++]};J.prototype.fillWithNoise=function(b,c=0){b=this.getBounds().clipTo(b);let d=c>>16&255,a=c>>8&255;c&=255;for(var h=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,q=this.offsetOfPixel(b.left,
b.top),f=b.top;f<b.bottom;f++,q+=h)for(var e=b.left;e<b.right;e++,q+=J.BYTES_PER_PIXEL){let k=1-(256*Math.random()|0)/255;this.data[q+J.RED_BYTE_OFFSET]=255-(255-d)*k|0;this.data[q+J.GREEN_BYTE_OFFSET]=255-(255-a)*k|0;this.data[q+J.BLUE_BYTE_OFFSET]=255-(255-c)*k|0;this.data[q+J.ALPHA_BYTE_OFFSET]=255}};J.prototype.gradientHorzReplace=function(b,c,d,a){var h={r:a[0]>>16&255,g:a[0]>>8&255,b:255&a[0],a:a[0]>>24&255};a={r:a[1]>>16&255,g:a[1]>>8&255,b:255&a[1],a:a[1]>>24&255};var q=(this.width-b.getWidth())*
J.BYTES_PER_PIXEL,f=0|this.offsetOfPixel(b.left,b.top),e=b.bottom-b.top|0;if(d<c){var k=d;d=c;c=k;k=h;h=a;a=k}var l=d-c|0;k=(a.r-h.r)/l;var g=(a.g-h.g)/l,m=(a.b-h.b)/l;l=(a.a-h.a)/l;for(var p=Math.max(b.left-c,0),n=0;n<e;n++,f+=q){for(var t=b.left,u=0|Math.min(c,b.right);t<u;t++,f+=J.BYTES_PER_PIXEL)this.data[f+J.RED_BYTE_OFFSET]=h.r,this.data[f+J.GREEN_BYTE_OFFSET]=h.g,this.data[f+J.BLUE_BYTE_OFFSET]=h.b,this.data[f+J.ALPHA_BYTE_OFFSET]=h.a;var v=h.r+k*p,A=h.g+g*p,D=h.b+m*p,y=h.a+l*p;for(u=0|Math.min(d,
b.right);t<u;t++,f+=J.BYTES_PER_PIXEL)this.data[f+J.RED_BYTE_OFFSET]=v,this.data[f+J.GREEN_BYTE_OFFSET]=A,this.data[f+J.BLUE_BYTE_OFFSET]=D,this.data[f+J.ALPHA_BYTE_OFFSET]=y,v+=k,A+=g,D+=m,y+=l;for(;t<b.right;t++,f+=J.BYTES_PER_PIXEL)this.data[f+J.RED_BYTE_OFFSET]=a.r,this.data[f+J.GREEN_BYTE_OFFSET]=a.g,this.data[f+J.BLUE_BYTE_OFFSET]=a.b,this.data[f+J.ALPHA_BYTE_OFFSET]=a.a}};J.prototype.gradientVertReplace=function(b,c,d,a){var h={r:a[0]>>16&255,g:a[0]>>8&255,b:255&a[0],a:a[0]>>24&255};a={r:a[1]>>
16&255,g:a[1]>>8&255,b:255&a[1],a:a[1]>>24&255};let q=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,f=0|this.offsetOfPixel(b.left,b.top),e=b.right-b.left|0;if(d<c){var k=d;d=c;c=k;k=h;h=a;a=k}k=b.top;for(var l=0|Math.min(b.bottom,c);k<l;k++,f+=q)for(var g=0;g<e;g++,f+=J.BYTES_PER_PIXEL)this.data[f+J.RED_BYTE_OFFSET]=h.r,this.data[f+J.GREEN_BYTE_OFFSET]=h.g,this.data[f+J.BLUE_BYTE_OFFSET]=h.b,this.data[f+J.ALPHA_BYTE_OFFSET]=h.a;var m=d-c|0;l=(a.r-h.r)/m;g=(a.g-h.g)/m;var p=(a.b-h.b)/m;m=(a.a-h.a)/m;
var n=Math.max(k-c,0);c=h.r+l*n;var t=h.g+g*n,u=h.b+p*n;h=h.a+m*n;for(d=0|Math.min(b.bottom,d);k<d;k++,f+=q){for(n=0;n<e;n++,f+=J.BYTES_PER_PIXEL)this.data[f+J.RED_BYTE_OFFSET]=c,this.data[f+J.GREEN_BYTE_OFFSET]=t,this.data[f+J.BLUE_BYTE_OFFSET]=u,this.data[f+J.ALPHA_BYTE_OFFSET]=h;c+=l;t+=g;u+=p;h+=m}for(;k<b.bottom;k++,f+=q)for(d=0;d<e;d++,f+=J.BYTES_PER_PIXEL)this.data[f+J.RED_BYTE_OFFSET]=a.r,this.data[f+J.GREEN_BYTE_OFFSET]=a.g,this.data[f+J.BLUE_BYTE_OFFSET]=a.b,this.data[f+J.ALPHA_BYTE_OFFSET]=
a.a};J.prototype.gradientReplace=function(b,c,d,a,h,q){var f=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(b.left,b.top),k=b.right-b.left|0,l=q[0]>>16&255,g=q[0]>>8&255,m=255&q[0],p=q[0]>>24&255,n=q[1]>>16&255,t=q[1]>>8&255,u=255&q[1];q=q[1]>>24&255;var v=h-d+(a-c)*(a-c)/(h-d);a=a-c+(h-d)*(h-d)/(a-c);h=1/a;for(var A=b.top;A<b.bottom;A++,e+=f)for(var D=(b.left-c)/a+(A-d)/v,y=0;y<k;y++,e+=J.BYTES_PER_PIXEL){var E=Math.min(Math.max(D,0),1),x=1-E;this.data[e+J.RED_BYTE_OFFSET]=l*
x+n*E;this.data[e+J.GREEN_BYTE_OFFSET]=g*x+t*E;this.data[e+J.BLUE_BYTE_OFFSET]=m*x+u*E;this.data[e+J.ALPHA_BYTE_OFFSET]=p*x+q*E;D+=h}};J.prototype.gradientAlpha=function(b,c,d,a,h,q){var f=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(b.left,b.top),k=b.right-b.left|0,l=q[0]>>16&255,g=q[0]>>8&255,m=255&q[0],p=q[0]>>24&255,n=q[1]>>16&255,t=q[1]>>8&255,u=255&q[1];q=q[1]>>24&255;var v=h-d+(a-c)*(a-c)/(h-d);a=a-c+(h-d)*(h-d)/(a-c);h=1/a;for(var A=b.top;A<b.bottom;A++,e+=f)for(var D=
(b.left-c)/a+(A-d)/v,y=0;y<k;y++,e+=J.BYTES_PER_PIXEL){var E=Math.min(Math.max(D,0),1),x=1-E,G=l*x+n*E,I=g*x+t*E,O=m*x+u*E;x=p*x+q*E;E=this.data[e+J.ALPHA_BYTE_OFFSET];E=x+E-x*E/255|0;if(E>0){x=255*x/E|0;var B=255-x;this.data[e+J.RED_BYTE_OFFSET]=(G*x+this.data[e+J.RED_BYTE_OFFSET]*B)/255|0;this.data[e+J.GREEN_BYTE_OFFSET]=(I*x+this.data[e+J.GREEN_BYTE_OFFSET]*B)/255|0;this.data[e+J.BLUE_BYTE_OFFSET]=(O*x+this.data[e+J.BLUE_BYTE_OFFSET]*B)/255|0;this.data[e+J.ALPHA_BYTE_OFFSET]=E}D+=h}};J.prototype.gradient=
function(b,c,d,a,h,q,f){b=this.getBounds().clipTo(b);(c!=a||d!=h)&&(f||q[0]>>>24==255&&q[1]>>>24==255?c==a?this.gradientVertReplace(b,d,h,q):d==h?this.gradientHorzReplace(b,c,a,q):this.gradientReplace(b,c,d,a,h,q):this.gradientAlpha(b,c,d,a,h,q))};J.prototype.fillWithColorNoise=function(b){b=this.getBounds().clipTo(b);for(var c,d=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,a=this.offsetOfPixel(b.left,b.top),h=b.top;h<b.bottom;h++,a+=d)for(var q=b.left;q<b.right;q++,a+=J.BYTES_PER_PIXEL)c=16777216*
Math.random()|0,this.data[a+J.RED_BYTE_OFFSET]=c>>16&255,this.data[a+J.GREEN_BYTE_OFFSET]=c>>8&255,this.data[a+J.BLUE_BYTE_OFFSET]=255&c,this.data[a+J.ALPHA_BYTE_OFFSET]=255};J.prototype.invert=function(b){b=this.getBounds().clipTo(b);for(var c=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,d=this.offsetOfPixel(b.left,b.top),a=b.top;a<b.bottom;a++,d+=c)for(var h=b.left;h<b.right;h++,d+=J.BYTES_PER_PIXEL)this.data[d+J.RED_BYTE_OFFSET]^=255,this.data[d+J.GREEN_BYTE_OFFSET]^=255,this.data[d+J.BLUE_BYTE_OFFSET]^=
255};J.prototype.brightnessToOpacity=function(b,c){b=this.getBounds().clipTo(b);let d=c>>>24&255||255,a=c>>16&255,h=c>>8&255;c&=255;let q=(this.width-b.getWidth())*J.BYTES_PER_PIXEL,f=this.offsetOfPixel(b.left,b.top);for(let e=b.top;e<b.bottom;e++,f+=q)for(let k=b.left;k<b.right;k++,f+=J.BYTES_PER_PIXEL){let l=Math.round(this.data[f+J.ALPHA_BYTE_OFFSET]/255*(1-(this.data[f+J.RED_BYTE_OFFSET]+this.data[f+J.GREEN_BYTE_OFFSET]+this.data[f+J.BLUE_BYTE_OFFSET])/765)*d);this.data[f+J.ALPHA_BYTE_OFFSET]=
l;l>0&&(this.data[f+J.RED_BYTE_OFFSET]=a,this.data[f+J.GREEN_BYTE_OFFSET]=h,this.data[f+J.BLUE_BYTE_OFFSET]=c)}};J.prototype.getNonTransparentBounds=function(b){var c,d,a=b.clone();var h=(this.width-a.getWidth())*J.BYTES_PER_PIXEL;b=this.offsetOfPixel(a.left,a.top)+J.ALPHA_BYTE_OFFSET;for(d=a.top;d<a.bottom;d++,b+=h){var q=0;for(c=a.left;c<a.right;c++,b+=J.BYTES_PER_PIXEL)q|=this.data[b];if(0!=q)break}if(a.top=d,a.top==a.bottom)return a;b=this.offsetOfPixel(a.right-1,a.bottom-1)+J.ALPHA_BYTE_OFFSET;
for(d=a.bottom-1;d>=a.top;d--,b-=h){q=0;for(c=a.right-1;c>=a.left;c--,b-=J.BYTES_PER_PIXEL)q|=this.data[b];if(0!=q)break}a.bottom=d+1;h=J.BYTES_PER_PIXEL*this.width;for(c=a.left;c<a.right;c++){b=this.offsetOfPixel(c,a.top)+J.ALPHA_BYTE_OFFSET;q=0;for(d=a.top;d<a.bottom;d++,b+=h)q|=this.data[b];if(0!=q)break}a.left=c;for(c=a.right-1;c>=a.left;c--){b=this.offsetOfPixel(c,a.top)+J.ALPHA_BYTE_OFFSET;q=0;for(d=a.top;d<a.bottom;d++,b+=h)q|=this.data[b];if(0!=q)break}return a.right=c+1,a};J.prototype.getAsCanvas=
function(b){var c=Vc(this.imageData.width,this.imageData.height);return c.getContext("2d").putImageData(this.imageData,0,0),Te(c,b||0)};J.prototype.getAsPNG=function(b){var c;return"string"==typeof(c=this.getAsCanvas(b).toDataURL("image/png"))&&!!c.match(/^data:image\/png;base64,/i)&&window.atob(c.substring(22))};J.prototype.getAsPNGBuffer=function(b){return this.getAsCanvas(b).toBuffer("image/png")};J.prototype.hasAlphaInRect=function(b){b=this.getBounds().clipTo(b);for(var c=(this.width-b.getWidth())*
J.BYTES_PER_PIXEL,d=this.offsetOfPixel(b.left,b.top)+J.ALPHA_BYTE_OFFSET,a=b.top;a<b.bottom;a++,d+=c){for(var h=255,q=b.left;q<b.right;q++,d+=J.BYTES_PER_PIXEL)h&=this.data[d];if(255!=h)return!0}return!1};J.prototype.hasAlpha=function(){return this.hasAlphaInRect(this.getBounds())};J.createFromImage=function(b){var c=Vc(b.width,b.height).getContext("2d");return c.globalCompositeOperation="copy",c.drawImage(b,0,0),new J(c.getImageData(0,0,b.width,b.height))};J.prototype.equals=function(b){if(this.width!=
b.width||this.height!=b.height)return!1;for(let c=0;c<this.data.length;c+=J.BYTES_PER_PIXEL)if(!(0==this.data[c+J.ALPHA_BYTE_OFFSET]&&0==b.data[c+J.ALPHA_BYTE_OFFSET]||this.data[c]==b.data[c]&&this.data[c+1]==b.data[c+1]&&this.data[c+2]==b.data[c+2]&&this.data[c+3]==b.data[c+3]))return!1;return!0};$a.prototype=Object.create(db.prototype);$a.prototype.constructor=$a;$a.prototype.getLinearizedLayerList=function(b,c=[]){for(let d of(c=c||[],this.layers))d instanceof $a&&(d.expanded||!b)&&d.getLinearizedLayerList(b,
c),c.push(d);return c};$a.prototype.clearLayers=function(){this.layers=[]};$a.prototype.addLayer=function(b){b.parent=this;this.layers.push(b)};$a.prototype.insertLayer=function(b,c){c.parent=this;this.layers.splice(b,0,c)};$a.prototype.removeLayer=function(b){b=this.layers.indexOf(b);b>-1&&this.layers.splice(b,1)};$a.prototype.removeLayerAtIndex=function(b){var c=this.layers[b];return c&&this.layers.splice(b,1),c};$a.prototype.setLayerAtIndex=function(b,c){var d=this.layers[b];return c.parent=this,
this.layers[b]=c,d};$a.prototype.setExpanded=function(b){this.expanded=b};$a.prototype.getExpanded=function(){return this.expanded};$a.prototype.indexOf=function(b){return this.layers.indexOf(b)};$a.prototype.getMemoryUsed=function(){return this.layers.map(b=>b.getMemoryUsed()).reduce(Yf,0)};$a.prototype.clone=function(){var b=new $a(this.name,this.blendMode);return db.prototype.copyFrom.call(b,this),b.expanded=this.expanded,b.layers=this.layers.map(c=>c.clone()),b.layers.forEach(c=>c.parent=b),b};
$a.prototype.getNonTransparentBounds=function(b){var c=new Ba(0,0,0,0);return this.layers.forEach(d=>c.union(d.getNonTransparentBounds(b))),c};Pa.prototype=Object.create(Uc.prototype);Pa.prototype.constructor=Pa;Pa.prototype.createBitmap=function(b,c,d){switch(this.bitDepth=d,d){case 32:this.data=new Uint32Array(b*c);break;case 16:this.data=new Uint16Array(b*c);break;default:this.data=new Uint8Array(b*c)}};Pa.prototype.clone=function(){var b=new Pa(this.width,this.height,this.bitDepth);return b.copyPixelsFrom(this),
b};Pa.prototype.cloneRect=function(b){var c=new Pa(b.getWidth(),b.getHeight(),this.bitDepth);return c.copyBitmapRect(this,0,0,b),c};Pa.prototype.getPixel=function(b,c){return b=Math.max(0,Math.min(this.width-1,b)),c=Math.max(0,Math.min(this.height-1,c)),this.data[this.offsetOfPixel(b,c)]};Pa.prototype.setPixel=function(b,c,d){b=Math.max(0,Math.min(this.width-1,b));c=Math.max(0,Math.min(this.height-1,c));b=this.offsetOfPixel(b,c);this.data[b]=d};Pa.prototype.clearAll=function(b){this.data.fill(b)};
Pa.prototype.clearRect=function(b,c){if((b=this.getBounds().clipTo(b)).equals(this.getBounds()))this.clearAll(c);else{let d=this.width,a=b.right-b.left,h=this.offsetOfPixel(b.left,b.top);for(let q=b.top;q<b.bottom;q++,h+=d)this.data.fill(c,h,h+a)}};Pa.prototype.copyScaledNearestNeighbor=function(b){for(var c,d=0,a=b.width/this.width,h=b.height/this.height,q=0,f=0;q<this.height;q++,f+=h){c=b.offsetOfPixel(0,Math.round(f));for(var e=0,k=0;e<this.width;e++,d++,k+=a)this.data[d]=b.data[c+Math.round(k)]}};
Pa.prototype.floodFillWithBorder=function(b,c,d,a=2,h=255){if(this.isInside(b,c)){d&=255;var q=this.width,f=this.height,e=this.data,k=new Uint8Array(q*f),l=e[c*q+b];h/=255;for(b=[{x:b,y:c}];b.length;){var g=void 0;let {x:p,y:n}=b.pop();p<0||n<0||p>=q||n>=f||(c=n*q+p,k[c]||Math.abs(e[c]-l)>10||(k[c]=1,g=Math.round(e[c]*(1-h)+d*h),e[c]=g,b.push({x:p+1,y:n}),b.push({x:p-1,y:n}),b.push({x:p,y:n+1}),b.push({x:p,y:n-1})))}if(a>0){g=new Uint8ClampedArray(e);l=new Uint8ClampedArray(g);for(b=0;b<f;b++)for(c=
0;c<q;c++)if(k[b*q+c])for(let p=-a;p<=a;p++)for(let n=-a;n<=a;n++){var m=c+n;let t=b+p;m<0||t<0||m>=q||t>=f||(m=t*q+m,k[m]||(l[m]=Math.round(g[m]*(1-h)+d*h)))}e.set(l)}}};Pa.prototype.createThumbnailFrom=function(b){let c=Math.min(Math.floor(b.width/this.width),3);if(c<2)return void this.copyScaledNearestNeighbor(b);let d=new Uint16Array(this.width);var a=b.width,h=Math.floor(b.width/this.width);let q=Math.floor(b.width/this.width/c),f=h-q*c;var e=Math.floor(b.height/this.height/c);h=e*a-h*this.width;
a*=Math.floor(b.height/this.height)-e*c;let k=e=0;for(let g=0;g<this.height;g++,e+=a){let m;d.fill(0);for(var l=0;l<c;l++,e+=h){m=0;for(let p=0;p<this.width;p++,m++,e+=f)for(let n=0;n<c;n++,e+=q)d[m]+=b.data[e]}m=0;for(l=0;l<this.width;l++,m++,k++)this.data[k]=d[m]/(c*c)}};Pa.prototype.mirrorHorizontally=function(){let b=this.width,c=this.height,d=new Uint8Array(b*c),a=0,h=b;for(let q=0;q<c;q++,h+=b+b)for(let f=0;f<b;f++)d[a++]=this.data[--h];this.data=d};Pa.prototype.applyLUT=function(b){for(var c=
0;c<this.data.length;c++)this.data[c]=b.table[this.data[c]]};Pa.prototype.getAsCanvas=function(b){var c=this.getImageData(0,0,this.width,this.height),d=Vc(this.width,this.height);return d.getContext("2d").putImageData(c,0,0),Te(d,b||0)};Pa.prototype.getImageData=function(b,c,d,a){let h=ie(d,a);b=this.offsetOfPixel(b,c);c=0;let q=this.width-d;for(let f=0;f<a;f++,b+=q)for(let e=0;e<d;e++,b++)h.data[c++]=this.data[b],h.data[c++]=this.data[b],h.data[c++]=this.data[b],h.data[c++]=255;return h};Pa.prototype.pasteImageData=
function(b,c,d){let a=0;c=this.offsetOfPixel(c,d);d=this.width-b.width;for(let h=0;h<b.height;h++,c+=d)for(let q=0;q<b.width;q++,a+=4,c++)this.data[c]=b.data[a];return b};Pa.prototype.copyPixelsFrom=function(b){b.width!=this.width||b.height!=this.height||b.bitDepth!=this.bitDepth?(this.data=b.data.slice(0),this.width=b.width,this.height=b.height,this.bitDepth=b.bitDepth):this.data.set(b.data)};Pa.prototype.copyRectXOR=function(b,c){for(var d=(c=this.getBounds().clipTo(c)).getWidth(),a=new Uint8Array(d*
c.getHeight()),h=0,q=this.offsetOfPixel(c.left,c.top),f=b.offsetOfPixel(c.left,c.top),e=this.width-d,k=b.width-d,l=c.top;l<c.bottom;l++,q+=e,f+=k)for(var g=0;g<d;g++,h++,q++,f++)a[h]=this.data[q]^b.data[f];return a};Pa.prototype.setRectXOR=function(b,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),a=c.getHeight();c=this.offsetOfPixel(c.left,c.top);for(var h=0,q=this.width-d,f=0;f<a;f++){for(var e=0;e<d;e++)this.data[c++]^=b[h++];c+=q}};Pa.prototype.copyBitmapRect=function(b,c,d,a){var h=new Ba(c,
d,0,0);a=a.clone();this.getBounds().clipSourceDest(a,h);c=0|h.getWidth();d=0|h.getHeight();if(0==h.left&&0==h.top&&c==this.width&&d==this.height&&c==b.width&&d==b.height)this.copyPixelsFrom(b);else{h=this.offsetOfPixel(h.left,h.top);var q=this.width-c;a=b.offsetOfPixel(a.left,a.top);for(var f=b.width-c,e=0;e<d;e++,a+=f,h+=q)for(var k=0;k<c;k++,a++,h++)this.data[h]=b.data[a]}};Pa.prototype.copyRegionHFlip=function(b,c){b=this.getBounds().clipTo(b);for(var d=b.top;d<b.bottom;d++)for(var a=this.offsetOfPixel(b.left,
d),h=c.offsetOfPixel(b.right-1,d),q=b.left;q<b.right;q++,h-=2)this.data[a++]=c.data[h++]};Pa.prototype.copyRegionVFlip=function(b,c){for(var d=(b=this.getBounds().clipTo(b)).getWidth(),a=b.top;a<b.bottom;a++)for(var h=this.offsetOfPixel(b.left,a),q=c.offsetOfPixel(b.left,b.bottom-1-(a-b.top)),f=0;f<d;f++)this.data[h++]=c.data[q++]};Pa.prototype.copyPixelColumnToArray=function(b,c,d,a){var h=this.width,q=0;b=this.offsetOfPixel(b,c);for(c=0;c<d;c++)a[q]=this.data[b],b+=h,q++};Pa.prototype.copyArrayToPixelColumn=
function(b,c,d,a){var h=this.width,q=0;b=this.offsetOfPixel(b,c);for(c=0;c<d;c++)this.data[b]=a[q],b+=h,q++};Pa.prototype.boxBlur=function(b,c,d){let a=(b=this.getBounds().clipTo(b)).getWidth(),h=b.getHeight();var q=Math.max(a,h);let f=new this.data.constructor(q);q=new this.data.constructor(q);for(let l=b.top;l<b.bottom;l++){var e=this.offsetOfPixel(b.left,l);for(var k=0;k<a;k++)f[k]=this.data[e++];Ue(f,q,a,c);e=this.offsetOfPixel(b.left,l);for(k=0;k<a;k++)this.data[e++]=q[k]}for(c=b.left;c<b.right;c++)this.copyPixelColumnToArray(c,
b.top,h,f),Ue(f,q,h,d),this.copyArrayToPixelColumn(c,b.top,h,q)};Pa.prototype.offsetOfPixel=function(b,c){return c*this.width+b};Pa.prototype.mosaic=function(b,c){b=this.getBounds().clipTo(b);c=Math.max(1,0|c);let d=this.width,a=this.data;for(let k=b.top;k<b.bottom;k+=c){let l=Math.min(k+c,b.bottom);for(let g=b.left;g<b.right;g+=c){let m=Math.min(g+c,b.right);var h=0,q=0;for(var f=k;f<l;f++){var e=f*d+g;for(let p=g;p<m;p++)h+=a[e++],q++}h=h/q|0;for(q=k;q<l;q++)for(f=q*d+g,e=g;e<m;e++)a[f++]=h}}};
Pa.prototype.monoHalftone=function(b,c,d,a=1){c=Math.max(2,0|c);this.getBounds().clipTo(b);b=this.width;d=this.height;Pa.BYTES_PER_PIXEL;let h=new Uint8ClampedArray(this.data),q=new Uint8ClampedArray(this.data.length);for(var f=0;f<q.length;f++)q[f]=255;f=.5*b;let e=.5*d;var k=45*Math.PI/180;let l=Math.cos(k);k=Math.sin(k);a*=c;c*=.5;var g=Math.ceil(Math.sqrt(b*b+d*d));let m=(g-b)*.5;g=(g-d)*.5;for(let v=-g;v<d+g;v+=a)for(let A=-m;A<b+m;A+=a){var p=A+.5*a-f,n=v+.5*a-e,t=p*l-n*k+f;p=p*k+n*l+e;n=0|
t;var u=0|p;if(!(n<0||u<0||n>=b||u>=d||(n=1-h[u*b+n]/255,n<=0))){n=.5+(c-.5)*Math.pow(n,.9);u=n*n;for(let D=-n;D<=n;D++)for(let y=-n;y<=n;y++){if(y*y+D*D>u)continue;let E=t+y|0,x=p+D|0;E<0||x<0||E>=b||x>=d||(q[x*b+E]=0)}!0}}this.data.set(q)};Pa.prototype.fillWithNoise=function(b){b=this.getBounds().clipTo(b);for(var c=this.width-b.getWidth(),d=this.offsetOfPixel(b.left,b.top),a=b.top;a<b.bottom;a++,d+=c)for(var h=b.left;h<b.right;h++,d++)this.data[d]=256*Math.random()|0};Pa.prototype.invert=function(b){b=
this.getBounds().clipTo(b);for(var c=this.width-b.getWidth(),d=this.offsetOfPixel(b.left,b.top),a=b.top;a<b.bottom;a++,d+=c)for(var h=b.left;h<b.right;h++,d++)this.data[d]=~this.data[d]};Pa.prototype.getValueBounds=function(b,c){var d,a,h=b.clone();var q=this.width-h.getWidth();b=this.offsetOfPixel(h.left,h.top);for(a=h.top;a<h.bottom;a++,b+=q){var f=!1;for(d=h.left;d<h.right;d++,b++)if(this.data[b]!=c){f=!0;break}if(f)break}if(h.top=a,h.top==h.bottom)return h;b=this.offsetOfPixel(h.right-1,h.bottom-
1);for(a=h.bottom-1;a>=h.top;a--,b-=q){f=!1;for(d=h.right-1;d>=h.left;d--,b--)if(this.data[b]!=c){f=!0;break}if(f)break}h.bottom=a+1;q=this.width;for(d=h.left;d<h.right;d++){b=this.offsetOfPixel(d,h.top);f=!1;for(a=h.top;a<h.bottom;a++,b+=q)if(this.data[b]!=c){f=!0;break}if(f)break}h.left=d;for(d=h.right-1;d>=h.left;d--){b=this.offsetOfPixel(d,h.top);f=!1;for(a=h.top;a<h.bottom;a++,b+=q)if(this.data[b]!=c){f=!0;break}if(f)break}return h.right=d+1,h};Pa.prototype.gradientHorzReplace=function(b,c,d,
a){var h=255&a[0];a=255&a[1];var q=this.width-b.getWidth(),f=0|this.offsetOfPixel(b.left,b.top),e=b.bottom-b.top|0;if(d<c){var k=d;d=c;c=k;k=h;h=a;a=k}k=(a-h)/(d-c|0);for(var l=Math.max(b.left-c,0),g=0;g<e;g++,f+=q){for(var m=b.left,p=0|Math.min(c,b.right);m<p;m++,f++)this.data[f]=h;var n=h+k*l;for(p=0|Math.min(d,b.right);m<p;m++,f++)this.data[f]=n,n+=k;for(;m<b.right;m++,f++)this.data[f]=a}};Pa.prototype.gradientVertReplace=function(b,c,d,a){var h=255&a[0];a=255&a[1];let q=this.width-b.getWidth(),
f=0|this.offsetOfPixel(b.left,b.top),e=b.right-b.left|0;if(d<c){var k=d;d=c;c=k;k=h;h=a;a=k}k=b.top;for(var l=0|Math.min(b.bottom,c);k<l;k++,f+=q)for(let g=0;g<e;g++,f++)this.data[f]=h;l=(a-h)/(d-c|0);c=h+l*Math.max(k-c,0);for(d=0|Math.min(b.bottom,d);k<d;k++,f+=q){for(h=0;h<e;h++,f++)this.data[f]=c;c+=l}for(;k<b.bottom;k++,f+=q)for(d=0;d<e;d++,f++)this.data[f]=a};Pa.prototype.gradientReplace=function(b,c,d,a,h,q){var f=this.width-b.getWidth(),e=0|this.offsetOfPixel(b.left,b.top),k=b.right-b.left|
0,l=255&q[0];q=255&q[1];var g=h-d+(a-c)*(a-c)/(h-d);a=a-c+(h-d)*(h-d)/(a-c);h=1/a;for(var m=b.top;m<b.bottom;m++,e+=f)for(var p=(b.left-c)/a+(m-d)/g,n=0;n<k;n++,e++){var t=Math.min(Math.max(p,0),1);this.data[e]=l*(1-t)+q*t;p+=h}};Pa.prototype.gradientAlpha=function(b,c,d,a,h,q){var f=this.width-b.getWidth(),e=0|this.offsetOfPixel(b.left,b.top),k=b.right-b.left|0,l=255&q[0],g=q[0]>>24&255,m=255&q[1];q=q[1]>>24&255;var p=h-d+(a-c)*(a-c)/(h-d);a=a-c+(h-d)*(h-d)/(a-c);h=1/a;for(var n=b.top;n<b.bottom;n++,
e+=f)for(var t=(b.left-c)/a+(n-d)/p,u=0;u<k;u++,e++){var v=Math.min(Math.max(t,0),1),A=1-v,D=g*A+q*v;this.data[e]=((l*A+m*v)*D+this.data[e]*(255-D))/255|0;t+=h}};Pa.prototype.gradient=function(b,c,d,a,h,q,f){b=this.getBounds().clipTo(b);(c!=a||d!=h)&&(f||q[0]>>>24==255&&q[1]>>>24==255?c==a?this.gradientVertReplace(b,d,h,q):d==h?this.gradientHorzReplace(b,c,a,q):this.gradientReplace(b,c,d,a,h,q):this.gradientAlpha(b,c,d,a,h,q))};Pa.prototype.equals=function(b){if(this.width!=b.width||this.height!=
b.height)return!1;for(let c=0;c<this.data.length;c++)if(this.data[c]!=b.data[c])return!1;return!0};let Ab=Array(256),Bb=Array(256);Q.multiplyOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l;k&&(l=b.data[a],b.data[a]=l-((255^c.data[a])*l*k/65025|0),l=b.data[a+1],b.data[a+1]=l-((255^c.data[a+1])*l*k/65025|0),l=b.data[a+2],b.data[a+2]=l-((255^
c.data[a+2])*l*k/65025|0))}};Q.multiplyOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g;l&&(g=b.data[a],b.data[a]=g-((255^c.data[a])*g*l/65025|0),g=b.data[a+1],b.data[a+1]=g-((255^c.data[a+1])*g*l/65025|0),g=b.data[a+2],b.data[a+2]=g-((255^c.data[a+2])*g*l/65025|0))}};Q.multiplyOntoTransparentFusionWithOpaqueLayer=function(b,
c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(f*n+g*t+(f*g*p/255|0))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(f*n+g*t+(f*g*p/255|0))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(f*n+g*t+(f*g*p/255|0))/m|0;b.data[a+3]=m}}};Q.multiplyOntoTransparentFusionWithTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(e*t+m*u+(e*m*n/255|0))/p|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(e*t+m*u+(e*m*n/255|0))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(e*t+m*u+(e*m*n/255|0))/p|0;b.data[a+3]=p}}};
Q.multiplyOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p;m&&(p=b.data[e],b.data[e]=p-((255^c.data[e])*p*m/65025|0),p=b.data[e+1],b.data[e+1]=p-((255^c.data[e+1])*p*m/65025|0),p=b.data[e+2],b.data[e+2]=p-((255^c.data[e+2])*p*m/65025|0))}};Q.multiplyOntoOpaqueFusionWithTransparentLayerMasked=
function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n;p&&(n=b.data[k],b.data[k]=n-((255^c.data[k])*n*p/65025|0),n=b.data[k+1],b.data[k+1]=n-((255^c.data[k+1])*n*p/65025|0),n=b.data[k+2],b.data[k+2]=n-((255^c.data[k+2])*n*p/65025|0))}};Q.multiplyOntoTransparentFusionWithOpaqueLayerMasked=function(b,
c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(l*v+n*A+(l*n*u/255|0))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(l*v+n*A+(l*n*u/255|0))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+
2]=(l*v+n*A+(l*n*u/255|0))/t|0;b.data[e+3]=t}}};Q.multiplyOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(g*A+
t*D+(g*t*v/255|0))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(g*A+t*D+(g*t*v/255|0))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(g*A+t*D+(g*t*v/255|0))/u|0;b.data[k+3]=u}}};Q.multiply2OntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l;k&&(l=b.data[a],b.data[a]=l-Math.ceil((255^c.data[a])*l*k/65025),l=b.data[a+1],b.data[a+1]=l-Math.ceil((255^
c.data[a+1])*l*k/65025),l=b.data[a+2],b.data[a+2]=l-Math.ceil((255^c.data[a+2])*l*k/65025))}};Q.multiply2OntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g;l&&(g=b.data[a],b.data[a]=g-Math.ceil((255^c.data[a])*g*l/65025),g=b.data[a+1],b.data[a+1]=g-Math.ceil((255^c.data[a+1])*g*l/65025),g=b.data[a+2],b.data[a+2]=g-Math.ceil((255^
c.data[a+2])*g*l/65025))}};Q.multiply2OntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(f*n+g*t+(f*g*p/255|0))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(f*n+g*t+(f*g*p/255|0))/m|0;f=c.data[a+2];g=b.data[a+
2];b.data[a+2]=(f*n+g*t+(f*g*p/255|0))/m|0;b.data[a+3]=m}}};Q.multiply2OntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(e*t+m*u+(e*m*n/255|0))/p|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=
(e*t+m*u+(e*m*n/255|0))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(e*t+m*u+(e*m*n/255|0))/p|0;b.data[a+3]=p}}};Q.multiply2OntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p;m&&(p=b.data[e],b.data[e]=p-Math.ceil((255^c.data[e])*p*m/65025),p=b.data[e+1],b.data[e+
1]=p-Math.ceil((255^c.data[e+1])*p*m/65025),p=b.data[e+2],b.data[e+2]=p-Math.ceil((255^c.data[e+2])*p*m/65025))}};Q.multiply2OntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n;p&&(n=b.data[k],b.data[k]=n-Math.ceil((255^c.data[k])*n*p/65025),n=b.data[k+
1],b.data[k+1]=n-Math.ceil((255^c.data[k+1])*n*p/65025),n=b.data[k+2],b.data[k+2]=n-Math.ceil((255^c.data[k+2])*n*p/65025))}};Q.multiply2OntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*
(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(l*v+n*A+(l*n*u/255|0))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(l*v+n*A+(l*n*u/255|0))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(l*v+n*A+(l*n*u/255|0))/t|0;b.data[e+3]=t}}};Q.multiply2OntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=
0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(g*A+t*D+(g*t*v/255|0))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(g*A+t*D+(g*t*v/255|0))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(g*A+t*D+(g*t*v/255|0))/u|0;b.data[k+3]=u}}};Q.normalOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,
a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l;if(k)if(255==k)b.data[a]=c.data[a],b.data[a+1]=c.data[a+1],b.data[a+2]=c.data[a+2];else{let g=255-k;l=c.data[a];b.data[a]=(l*k+b.data[a]*g)/255|0;l=c.data[a+1];b.data[a+1]=(l*k+b.data[a+1]*g)/255|0;l=c.data[a+2];b.data[a+2]=(l*k+b.data[a+2]*g)/255|0}}};Q.normalOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,
a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g;if(l){let m=255-l;g=c.data[a];b.data[a]=(g*l+b.data[a]*m)/255|0;g=c.data[a+1];b.data[a+1]=(g*l+b.data[a+1]*m)/255|0;g=c.data[a+2];b.data[a+2]=(g*l+b.data[a+2]*m)/255|0}}};Q.normalOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l;if(f){let g=f+(l=b.data[a+3])-(f*l/255|0)|
0;f=255*f/g|0;let m=255-f;b.data[a]=(c.data[a]*f+b.data[a]*m)/255|0;b.data[a+1]=(c.data[a+1]*f+b.data[a+1]*m)/255|0;b.data[a+2]=(c.data[a+2]*f+b.data[a+2]*m)/255|0;b.data[a+3]=g}}};Q.normalOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g;if(e){let m=e+(g=b.data[a+3])-(e*g/255|0)|0;e=255*e/m|0;let p=255-e;b.data[a]=
(c.data[a]*e+b.data[a]*p)/255|0;b.data[a+1]=(c.data[a+1]*e+b.data[a+1]*p)/255|0;b.data[a+2]=(c.data[a+2]*e+b.data[a+2]*p)/255|0;b.data[a+3]=m}}};Q.normalOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p;if(m)if(255==m)b.data[e]=c.data[e],b.data[e+1]=c.data[e+
1],b.data[e+2]=c.data[e+2];else{let n=255-m;p=c.data[e];b.data[e]=(p*m+b.data[e]*n)/255|0;p=c.data[e+1];b.data[e+1]=(p*m+b.data[e+1]*n)/255|0;p=c.data[e+2];b.data[e+2]=(p*m+b.data[e+2]*n)/255|0}}};Q.normalOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|
0,n;if(p){let t=255-p;n=c.data[k];b.data[k]=(n*p+b.data[k]*t)/255|0;n=c.data[k+1];b.data[k+1]=(n*p+b.data[k+1]*t)/255|0;n=c.data[k+2];b.data[k+2]=(n*p+b.data[k+2]*t)/255|0}}};Q.normalOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p;if(l){let n=l+(p=
b.data[e+3])-(l*p/255|0)|0;l=255*l/n|0;let t=255-l;b.data[e]=(c.data[e]*l+b.data[e]*t)/255|0;b.data[e+1]=(c.data[e+1]*l+b.data[e+1]*t)/255|0;b.data[e+2]=(c.data[e+2]*l+b.data[e+2]*t)/255|0;b.data[e+3]=n}}};Q.normalOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*
d/25500|0;let n;if(g){let t=g+(n=b.data[k+3])-(g*n/255|0)|0;g=255*g/t|0;let u=255-g;b.data[k]=(c.data[k]*g+b.data[k]*u)/255|0;b.data[k+1]=(c.data[k+1]*g+b.data[k+1]*u)/255|0;b.data[k+2]=(c.data[k+2]*g+b.data[k+2]*u)/255|0;b.data[k+3]=t}}};Q.addOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3];k&&(b.data[a]=b.data[a]+k*c.data[a]/255|0,b.data[a+
1]=b.data[a+1]+k*c.data[a+1]/255|0,b.data[a+2]=b.data[a+2]+k*c.data[a+2]/255|0)}};Q.addOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0;l&&(b.data[a]=b.data[a]+l*c.data[a]/255|0,b.data[a+1]=b.data[a+1]+l*c.data[a+1]/255|0,b.data[a+2]=b.data[a+2]+l*c.data[a+2]/255|0)}};Q.addOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=
0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l;if(k){let g=k+(l=b.data[a+3])-(k*l/255|0)|0;b.data[a]=(l*b.data[a]+k*c.data[a])/g|0;b.data[a+1]=(l*b.data[a+1]+k*c.data[a+1])/g|0;b.data[a+2]=(l*b.data[a+2]+k*c.data[a+2])/g|0;b.data[a+3]=g}}};Q.addOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,
a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g;if(l){let m=l+(g=b.data[a+3])-(l*g/255|0)|0;b.data[a]=(g*b.data[a]+l*c.data[a])/m|0;b.data[a+1]=(g*b.data[a+1]+l*c.data[a+1])/m|0;b.data[a+2]=(g*b.data[a+2]+l*c.data[a+2])/m|0;b.data[a+3]=m}}};Q.addOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,
e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0;m&&(b.data[e]=b.data[e]+m*c.data[e]/255|0,b.data[e+1]=b.data[e+1]+m*c.data[e+1]/255|0,b.data[e+2]=b.data[e+2]+m*c.data[e+2]/255|0)}};Q.addOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*
d/25500|0;p&&(b.data[k]=b.data[k]+p*c.data[k]/255|0,b.data[k+1]=b.data[k+1]+p*c.data[k+1]/255|0,b.data[k+2]=b.data[k+2]+p*c.data[k+2]/255|0)}};Q.addOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p;if(m){let n=m+(p=b.data[e+3])-(m*p/255|0)|0;b.data[e]=(p*
b.data[e]+m*c.data[e])/n|0;b.data[e+1]=(p*b.data[e+1]+m*c.data[e+1])/n|0;b.data[e+2]=(p*b.data[e+2]+m*c.data[e+2])/n|0;b.data[e+3]=n}}};Q.addOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n;if(p){let t=p+(n=b.data[k+3])-(p*n/255|0)|0;b.data[k]=
(n*b.data[k]+p*c.data[k])/t|0;b.data[k+1]=(n*b.data[k+1]+p*c.data[k+1])/t|0;b.data[k+2]=(n*b.data[k+2]+p*c.data[k+2])/t|0;b.data[k+3]=t}}};Q.subtractOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3];k&&(b.data[a]=b.data[a]+k*c.data[a]/255-k|0,b.data[a+1]=b.data[a+1]+k*c.data[a+1]/255-k|0,b.data[a+2]=b.data[a+2]+k*c.data[a+2]/255-k|0)}};Q.subtractOntoOpaqueFusionWithTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0;l&&(b.data[a]=b.data[a]+l*c.data[a]/255-l|0,b.data[a+1]=b.data[a+1]+l*c.data[a+1]/255-l|0,b.data[a+2]=b.data[a+2]+l*c.data[a+2]/255-l|0)}};Q.subtractOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,
a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l;if(k){let g=k+(l=b.data[a+3])-(k*l/255|0)|0,m=k*l;b.data[a]=(l*b.data[a]+k*c.data[a]-m)/g|0;b.data[a+1]=(l*b.data[a+1]+k*c.data[a+1]-m)/g|0;b.data[a+2]=(l*b.data[a+2]+k*c.data[a+2]-m)/g|0;b.data[a+3]=g}}};Q.subtractOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g;if(l){let m=
l+(g=b.data[a+3])-(l*g/255|0)|0,p=l*g;b.data[a]=(g*b.data[a]+l*c.data[a]-p)/m|0;b.data[a+1]=(g*b.data[a+1]+l*c.data[a+1]-p)/m|0;b.data[a+2]=(g*b.data[a+2]+l*c.data[a+2]-p)/m|0;b.data[a+3]=m}}};Q.subtractOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0;m&&(b.data[e]=
b.data[e]+m*c.data[e]/255-m|0,b.data[e+1]=b.data[e+1]+m*c.data[e+1]/255-m|0,b.data[e+2]=b.data[e+2]+m*c.data[e+2]/255-m|0)}};Q.subtractOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0;p&&(b.data[k]=b.data[k]+p*c.data[k]/255-p|0,b.data[k+1]=b.data[k+1]+
p*c.data[k+1]/255-p|0,b.data[k+2]=b.data[k+2]+p*c.data[k+2]/255-p|0)}};Q.subtractOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p;if(m){let n=m+(p=b.data[e+3])-(m*p/255|0)|0,t=m*p;b.data[e]=(p*b.data[e]+m*c.data[e]-t)/n|0;b.data[e+1]=(p*b.data[e+1]+m*c.data[e+
1]-t)/n|0;b.data[e+2]=(p*b.data[e+2]+m*c.data[e+2]-t)/n|0;b.data[e+3]=n}}};Q.subtractOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n;if(p){let t=p+(n=b.data[k+3])-(p*n/255|0)|0,u=p*n;b.data[k]=(n*b.data[k]+p*c.data[k]-u)/t|0;b.data[k+1]=(n*b.data[k+
1]+p*c.data[k+1]-u)/t|0;b.data[k+2]=(n*b.data[k+2]+p*c.data[k+2]-u)/t|0;b.data[k+3]=t}}};Q.screenOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l;if(k){let g=255^k;l=b.data[a];b.data[a]=255^((255^l)*g+(255^c.data[a])*(255^l)*k/255)/255;l=b.data[a+1];b.data[a+1]=255^((255^l)*g+(255^c.data[a+1])*(255^l)*k/255)/255;l=b.data[a+2];b.data[a+2]=
255^((255^l)*g+(255^c.data[a+2])*(255^l)*k/255)/255}}};Q.screenOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g;if(l){let m=255^l;g=b.data[a];b.data[a]=255^((255^g)*m+(255^c.data[a])*(255^g)*l/255)/255;g=b.data[a+1];b.data[a+1]=255^((255^g)*m+(255^c.data[a+1])*(255^g)*l/255)/255;g=b.data[a+2];b.data[a+2]=255^((255^g)*m+(255^
c.data[a+2])*(255^g)*l/255)/255}}};Q.screenOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=255^((255^f)*n+(255^g)*t+(255^f)*(255^g)*p/255)/m;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=255^((255^f)*n+(255^
g)*t+(255^f)*(255^g)*p/255)/m;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=255^((255^f)*n+(255^g)*t+(255^f)*(255^g)*p/255)/m;b.data[a+3]=m}}};Q.screenOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=
255^((255^e)*t+(255^m)*u+(255^e)*(255^m)*n/255)/p;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=255^((255^e)*t+(255^m)*u+(255^e)*(255^m)*n/255)/p;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=255^((255^e)*t+(255^m)*u+(255^e)*(255^m)*n/255)/p;b.data[a+3]=p}}};Q.screenOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,
e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p;if(m){let n=255^m;p=b.data[e];b.data[e]=255^((255^p)*n+(255^c.data[e])*(255^p)*m/255)/255;p=b.data[e+1];b.data[e+1]=255^((255^p)*n+(255^c.data[e+1])*(255^p)*m/255)/255;p=b.data[e+2];b.data[e+2]=255^((255^p)*n+(255^c.data[e+2])*(255^p)*m/255)/255}}};Q.screenOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);
for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n;if(p){let t=255^p;n=b.data[k];b.data[k]=255^((255^n)*t+(255^c.data[k])*(255^n)*p/255)/255;n=b.data[k+1];b.data[k+1]=255^((255^n)*t+(255^c.data[k+1])*(255^n)*p/255)/255;n=b.data[k+2];b.data[k+2]=255^((255^n)*t+(255^c.data[k+2])*(255^n)*p/255)/255}}};Q.screenOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,
a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=255^((255^l)*v+(255^n)*A+(255^l)*(255^n)*u/255)/t;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=255^((255^l)*v+(255^n)*A+(255^l)*(255^n)*u/255)/t;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=255^((255^l)*v+(255^n)*A+(255^l)*(255^
n)*u/255)/t;b.data[e+3]=t}}};Q.screenOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=255^((255^g)*A+(255^t)*D+
(255^g)*(255^t)*v/255)/u;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=255^((255^g)*A+(255^t)*D+(255^g)*(255^t)*v/255)/u;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=255^((255^g)*A+(255^t)*D+(255^g)*(255^t)*v/255)/u;b.data[k+3]=u}}};Q.lightenOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=g>=l?
g:(g*m+l*k)/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=g>=l?g:(g*m+l*k)/255|0;l=c.data[a+2];g=b.data[a+2];b.data[a+2]=g>=l?g:(g*m+l*k)/255|0}}};Q.lightenOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];b.data[a]=m>=g?m:(m*p+g*l)/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=m>=
g?m:(m*p+g*l)/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=m>=g?m:(m*p+g*l)/255|0}}};Q.lightenOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=l*(255^f)/m|0,n=255^p,t=f*(255^l)/m|0,u=255^t;f=c.data[a];g=b.data[a];b.data[a]=(g>=f?f*t+g*u:g*p+f*n)/255|0;f=c.data[a+1];g=b.data[a+1];
b.data[a+1]=(g>=f?f*t+g*u:g*p+f*n)/255|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(g>=f?f*t+g*u:g*p+f*n)/255|0;b.data[a+3]=m}}};Q.lightenOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=g*(255^e)/p|0,t=255^n,u=e*(255^g)/p|0,v=255^u;e=c.data[a];m=b.data[a];b.data[a]=(m>=
e?e*u+m*v:m*n+e*t)/255|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(m>=e?e*u+m*v:m*n+e*t)/255|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(m>=e?e*u+m*v:m*n+e*t)/255|0;b.data[a+3]=p}}};Q.lightenOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p,n;if(m){let t=255^m;
p=c.data[e];n=b.data[e];b.data[e]=n>=p?n:(n*t+p*m)/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=n>=p?n:(n*t+p*m)/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=n>=p?n:(n*t+p*m)/255|0}}};Q.lightenOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=
255^p;n=c.data[k];t=b.data[k];b.data[k]=t>=n?t:(t*u+n*p)/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=t>=n?t:(t*u+n*p)/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=t>=n?t:(t*u+n*p)/255|0}}};Q.lightenOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,
n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=p*(255^l)/t|0,v=255^u,A=l*(255^p)/t|0,D=255^A;l=c.data[e];n=b.data[e];b.data[e]=(n>=l?l*A+n*D:n*u+l*v)/255|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(n>=l?l*A+n*D:n*u+l*v)/255|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(n>=l?l*A+n*D:n*u+l*v)/255|0;b.data[e+3]=t}}};Q.lightenOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,
a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=n*(255^g)/u|0,A=255^v,D=g*(255^n)/u|0,y=255^D;g=c.data[k];t=b.data[k];b.data[k]=(t>=g?g*D+t*y:t*v+g*A)/255|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(t>=g?g*D+t*y:t*v+g*A)/255|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(t>=g?g*D+t*y:t*v+g*A)/255|0;b.data[k+3]=u}}};Q.darkenOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=
0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=g>=l?(g*m+l*k)/255|0:g;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=g>=l?(g*m+l*k)/255|0:g;l=c.data[a+2];g=b.data[a+2];b.data[a+2]=g>=l?(g*m+l*k)/255|0:g}}};Q.darkenOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=
0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];b.data[a]=m>=g?(m*p+g*l)/255|0:m;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=m>=g?(m*p+g*l)/255|0:m;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=m>=g?(m*p+g*l)/255|0:m}}};Q.darkenOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,
g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*(255^l)/m|0,n=255^p,t=l*(255^f)/m|0,u=255^t;f=c.data[a];g=b.data[a];b.data[a]=(g>=f?g*t+f*u:f*p+g*n)/255|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(g>=f?g*t+f*u:f*p+g*n)/255|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(g>=f?g*t+f*u:f*p+g*n)/255|0;b.data[a+3]=m}}};Q.darkenOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=
0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*(255^g)/p|0,t=255^n,u=g*(255^e)/p|0,v=255^u;e=c.data[a];m=b.data[a];b.data[a]=(m>=e?m*u+e*v:e*n+m*t)/255|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(m>=e?m*u+e*v:e*n+m*t)/255|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(m>=e?m*u+e*v:e*n+m*t)/255|0;b.data[a+3]=p}}};Q.darkenOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,
a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=n>=p?(n*t+p*m)/255|0:n;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=n>=p?(n*t+p*m)/255|0:n;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=n>=p?(n*t+p*m)/255|0:n}}};Q.darkenOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,
a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=t>=n?(t*u+n*p)/255|0:t;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=t>=n?(t*u+n*p)/255|0:t;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=t>=n?(t*u+n*p)/255|0:t}}};Q.darkenOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,
a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*(255^p)/t|0,v=255^u,A=p*(255^l)/t|0,D=255^A;l=c.data[e];n=b.data[e];b.data[e]=(n>=l?n*A+l*D:l*u+n*v)/255|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(n>=l?n*A+l*D:l*u+n*v)/255|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(n>=l?n*A+l*D:l*u+n*v)/255|0;b.data[e+3]=t}}};Q.darkenOntoTransparentFusionWithTransparentLayerMasked=
function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*(255^n)/u|0,A=255^v,D=n*(255^g)/u|0,y=255^D;g=c.data[k];t=b.data[k];b.data[k]=(t>=g?t*D+g*y:g*v+t*A)/255|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(t>=g?t*D+g*y:g*v+t*A)/255|0;g=c.data[k+2];
t=b.data[k+2];b.data[k+2]=(t>=g?t*D+g*y:g*v+t*A)/255|0;b.data[k+3]=u}}};Q.dodgeOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=(g*m+k*(255==l?255:Math.min(255,255*g/(255^l)|0)))/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=(g*m+k*(255==l?255:Math.min(255,255*g/(255^l)|0)))/255|0;l=
c.data[a+2];g=b.data[a+2];b.data[a+2]=(g*m+k*(255==l?255:Math.min(255,255*g/(255^l)|0)))/255|0}}};Q.dodgeOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];b.data[a]=(m*p+l*(255==g?255:Math.min(255,255*m/(255^g)|0)))/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=(m*p+l*(255==g?255:Math.min(255,
255*m/(255^g)|0)))/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=(m*p+l*(255==g?255:Math.min(255,255*m/(255^g)|0)))/255|0}}};Q.dodgeOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(f*n+g*t+p*(255==f?255:
Math.min(255,255*g/(255^f)|0)))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(f*n+g*t+p*(255==f?255:Math.min(255,255*g/(255^f)|0)))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(f*n+g*t+p*(255==f?255:Math.min(255,255*g/(255^f)|0)))/m|0;b.data[a+3]=m}}};Q.dodgeOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=
e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(e*t+m*u+n*(255==e?255:Math.min(255,255*m/(255^e)|0)))/p|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(e*t+m*u+n*(255==e?255:Math.min(255,255*m/(255^e)|0)))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(e*t+m*u+n*(255==e?255:Math.min(255,255*m/(255^e)|0)))/p|0;b.data[a+3]=p}}};Q.dodgeOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-
q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=(n*t+m*(255==p?255:Math.min(255,255*n/(255^p)|0)))/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=(n*t+m*(255==p?255:Math.min(255,255*n/(255^p)|0)))/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=(n*t+m*(255==p?255:Math.min(255,255*n/(255^p)|0)))/255|0}}};Q.dodgeOntoOpaqueFusionWithTransparentLayerMasked=
function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=(t*u+p*(255==n?255:Math.min(255,255*t/(255^n)|0)))/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=(t*u+p*(255==n?255:Math.min(255,255*t/(255^n)|0)))/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+
2]=(t*u+p*(255==n?255:Math.min(255,255*t/(255^n)|0)))/255|0}}};Q.dodgeOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(l*
v+n*A+u*(255==l?255:Math.min(255,255*n/(255^l)|0)))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(l*v+n*A+u*(255==l?255:Math.min(255,255*n/(255^l)|0)))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(l*v+n*A+u*(255==l?255:Math.min(255,255*n/(255^l)|0)))/t|0;b.data[e+3]=t}}};Q.dodgeOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,
k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(g*A+t*D+v*(255==g?255:Math.min(255,255*t/(255^g)|0)))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(g*A+t*D+v*(255==g?255:Math.min(255,255*t/(255^g)|0)))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(g*A+t*D+v*(255==g?255:Math.min(255,255*t/(255^g)|0)))/u|0;b.data[k+3]=u}}};Q.burnOntoOpaqueFusionWithOpaqueLayer=
function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=(g*m+k*(0==l?0:255^Math.min(255,255*(255^g)/l)))/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=(g*m+k*(0==l?0:255^Math.min(255,255*(255^g)/l)))/255|0;l=c.data[a+2];g=b.data[a+2];b.data[a+2]=(g*m+k*(0==l?0:255^Math.min(255,255*(255^g)/l)))/255|0}}};Q.burnOntoOpaqueFusionWithTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];b.data[a]=(m*p+l*(0==g?0:255^Math.min(255,255*(255^m)/g)))/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=(m*p+l*(0==g?0:255^Math.min(255,255*(255^m)/g)))/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=(m*p+l*(0==g?0:255^Math.min(255,255*(255^m)/g)))/255|0}}};Q.burnOntoTransparentFusionWithOpaqueLayer=
function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(f*n+g*t+p*(0==f?0:255^Math.min(255,255*(255^g)/f)))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(f*n+g*t+p*(0==f?0:255^Math.min(255,255*(255^g)/f)))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+
2]=(f*n+g*t+p*(0==f?0:255^Math.min(255,255*(255^g)/f)))/m|0;b.data[a+3]=m}}};Q.burnOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(e*t+m*u+n*(0==e?0:255^Math.min(255,255*(255^m)/e)))/p|0;
e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(e*t+m*u+n*(0==e?0:255^Math.min(255,255*(255^m)/e)))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(e*t+m*u+n*(0==e?0:255^Math.min(255,255*(255^m)/e)))/p|0;b.data[a+3]=p}}};Q.burnOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/
255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=(n*t+m*(0==p?0:255^Math.min(255,255*(255^n)/p)))/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=(n*t+m*(0==p?0:255^Math.min(255,255*(255^n)/p)))/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=(n*t+m*(0==p?0:255^Math.min(255,255*(255^n)/p)))/255|0}}};Q.burnOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,
a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=(t*u+p*(0==n?0:255^Math.min(255,255*(255^t)/n)))/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=(t*u+p*(0==n?0:255^Math.min(255,255*(255^t)/n)))/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=(t*u+p*(0==n?0:255^Math.min(255,255*(255^t)/n)))/255|0}}};Q.burnOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=
0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(l*v+n*A+u*(0==l?0:255^Math.min(255,255*(255^n)/l)))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(l*v+n*A+u*(0==l?0:255^Math.min(255,255*(255^n)/l)))/t|0;l=c.data[e+
2];n=b.data[e+2];b.data[e+2]=(l*v+n*A+u*(0==l?0:255^Math.min(255,255*(255^n)/l)))/t|0;b.data[e+3]=t}}};Q.burnOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^
g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(g*A+t*D+v*(0==g?0:255^Math.min(255,255*(255^t)/g)))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(g*A+t*D+v*(0==g?0:255^Math.min(255,255*(255^t)/g)))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(g*A+t*D+v*(0==g?0:255^Math.min(255,255*(255^t)/g)))/u|0;b.data[k+3]=u}}};Q.overlayOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<
h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=(m*g+(g<=127?2*k*l*g/255:k*(2*(255^l)*(255^g)/255^255)))/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=(m*g+(g<=127?2*k*l*g/255:k*(2*(255^l)*(255^g)/255^255)))/255|0;l=c.data[a+2];g=b.data[a+2];b.data[a+2]=(m*g+(g<=127?2*k*l*g/255:k*(2*(255^l)*(255^g)/255^255)))/255|0}}};Q.overlayOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,
a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];b.data[a]=(p*m+(m<=127?2*l*g*m/255:l*(2*(255^g)*(255^m)/255^255)))/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=(p*m+(m<=127?2*l*g*m/255:l*(2*(255^g)*(255^m)/255^255)))/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=(p*m+(m<=127?2*l*g*m/255:l*(2*(255^g)*(255^m)/255^255)))/255|0}}};Q.overlayOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|
a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(n*f+t*g+(g<=127?2*p*f*g/255:p*(2*(255^f)*(255^g)/255^255)))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(n*f+t*g+(g<=127?2*p*f*g/255:p*(2*(255^f)*(255^g)/255^255)))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(n*f+t*g+(g<=127?2*p*f*
g/255:p*(2*(255^f)*(255^g)/255^255)))/m|0;b.data[a+3]=m}}};Q.overlayOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(t*e+u*m+(m<=127?2*n*e*m/255:n*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[a+
1];m=b.data[a+1];b.data[a+1]=(t*e+u*m+(m<=127?2*n*e*m/255:n*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(t*e+u*m+(m<=127?2*n*e*m/255:n*(2*(255^e)*(255^m)/255^255)))/p|0;b.data[a+3]=p}}};Q.overlayOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/
255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=(t*n+(n<=127?2*m*p*n/255:m*(2*(255^p)*(255^n)/255^255)))/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=(t*n+(n<=127?2*m*p*n/255:m*(2*(255^p)*(255^n)/255^255)))/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=(t*n+(n<=127?2*m*p*n/255:m*(2*(255^p)*(255^n)/255^255)))/255|0}}};Q.overlayOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-
f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=(u*t+(t<=127?2*p*n*t/255:p*(2*(255^n)*(255^t)/255^255)))/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=(u*t+(t<=127?2*p*n*t/255:p*(2*(255^n)*(255^t)/255^255)))/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=(u*t+(t<=127?2*p*n*t/255:p*(2*(255^n)*(255^t)/255^255)))/255|0}}};Q.overlayOntoTransparentFusionWithOpaqueLayerMasked=
function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(v*l+A*n+(n<=127?2*u*l*n/255:u*(2*(255^l)*(255^n)/255^255)))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(v*l+A*n+
(n<=127?2*u*l*n/255:u*(2*(255^l)*(255^n)/255^255)))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(v*l+A*n+(n<=127?2*u*l*n/255:u*(2*(255^l)*(255^n)/255^255)))/t|0;b.data[e+3]=t}}};Q.overlayOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=
g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(A*g+D*t+(t<=127?2*v*g*t/255:v*(2*(255^g)*(255^t)/255^255)))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(A*g+D*t+(t<=127?2*v*g*t/255:v*(2*(255^g)*(255^t)/255^255)))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(A*g+D*t+(t<=127?2*v*g*t/255:v*(2*(255^g)*(255^t)/255^255)))/u|0;b.data[k+3]=u}}};Q.hardLightOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),
q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=(m*g+(l<=127?2*k*l*g/255:k*(2*(255^l)*(255^g)/255^255)))/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=(m*g+(l<=127?2*k*l*g/255:k*(2*(255^l)*(255^g)/255^255)))/255|0;l=c.data[a+2];g=b.data[a+2];b.data[a+2]=(m*g+(l<=127?2*k*l*g/255:k*(2*(255^l)*(255^g)/255^255)))/255|0}}};Q.hardLightOntoOpaqueFusionWithTransparentLayer=function(b,
c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];b.data[a]=(p*m+(g<=127?2*l*g*m/255:l*(2*(255^g)*(255^m)/255^255)))/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=(p*m+(g<=127?2*l*g*m/255:l*(2*(255^g)*(255^m)/255^255)))/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=(p*m+(g<=127?2*l*g*m/255:l*(2*(255^g)*(255^m)/255^255)))/255|0}}};
Q.hardLightOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(n*f+t*g+(f<=127?2*p*f*g/255:p*(2*(255^f)*(255^g)/255^255)))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(n*f+t*g+(f<=127?2*p*f*g/255:p*(2*(255^
f)*(255^g)/255^255)))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(n*f+t*g+(f<=127?2*p*f*g/255:p*(2*(255^f)*(255^g)/255^255)))/m|0;b.data[a+3]=m}}};Q.hardLightOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=
b.data[a];b.data[a]=(t*e+u*m+(e<=127?2*n*e*m/255:n*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(t*e+u*m+(e<=127?2*n*e*m/255:n*(2*(255^e)*(255^m)/255^255)))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(t*e+u*m+(e<=127?2*n*e*m/255:n*(2*(255^e)*(255^m)/255^255)))/p|0;b.data[a+3]=p}}};Q.hardLightOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,
a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=(t*n+(p<=127?2*m*p*n/255:m*(2*(255^p)*(255^n)/255^255)))/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=(t*n+(p<=127?2*m*p*n/255:m*(2*(255^p)*(255^n)/255^255)))/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=(t*n+(p<=127?2*m*p*n/255:m*(2*(255^p)*(255^n)/255^255)))/255|0}}};Q.hardLightOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=
0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=(u*t+(n<=127?2*p*n*t/255:p*(2*(255^n)*(255^t)/255^255)))/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=(u*t+(n<=127?2*p*n*t/255:p*(2*(255^n)*(255^t)/255^255)))/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=(u*t+(n<=
127?2*p*n*t/255:p*(2*(255^n)*(255^t)/255^255)))/255|0}}};Q.hardLightOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(v*
l+A*n+(l<=127?2*u*l*n/255:u*(2*(255^l)*(255^n)/255^255)))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(v*l+A*n+(l<=127?2*u*l*n/255:u*(2*(255^l)*(255^n)/255^255)))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(v*l+A*n+(l<=127?2*u*l*n/255:u*(2*(255^l)*(255^n)/255^255)))/t|0;b.data[e+3]=t}}};Q.hardLightOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);
for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(A*g+D*t+(g<=127?2*v*g*t/255:v*(2*(255^g)*(255^t)/255^255)))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(A*g+D*t+(g<=127?2*v*g*t/255:v*(2*(255^g)*(255^t)/255^255)))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(A*g+D*t+(g<=127?2*v*g*t/255:v*(2*(255^g)*(255^t)/255^255)))/
u|0;b.data[k+3]=u}}};Q.softLightOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=(m*g+k*(l<=127?((2*l-255)*Ab[g]/255|0)+g:((2*l-255)*Bb[g]/255|0)+g))/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=(m*g+k*(l<=127?((2*l-255)*Ab[g]/255|0)+g:((2*l-255)*Bb[g]/255|0)+g))/255|0;l=c.data[a+2];
g=b.data[a+2];b.data[a+2]=(m*g+k*(l<=127?((2*l-255)*Ab[g]/255|0)+g:((2*l-255)*Bb[g]/255|0)+g))/255|0}}};Q.softLightOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];b.data[a]=(p*m+l*(g<=127?((2*g-255)*Ab[m]/255|0)+m:((2*g-255)*Bb[m]/255|0)+m))/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+
1]=(p*m+l*(g<=127?((2*g-255)*Ab[m]/255|0)+m:((2*g-255)*Bb[m]/255|0)+m))/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=(p*m+l*(g<=127?((2*g-255)*Ab[m]/255|0)+m:((2*g-255)*Bb[m]/255|0)+m))/255|0}}};Q.softLightOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|
0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(n*f+t*g+(f<=127?p*(((2*f-255)*Ab[g]/255|0)+g):p*(((2*f-255)*Bb[g]/255|0)+g)))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(n*f+t*g+(f<=127?p*(((2*f-255)*Ab[g]/255|0)+g):p*(((2*f-255)*Bb[g]/255|0)+g)))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(n*f+t*g+(f<=127?p*(((2*f-255)*Ab[g]/255|0)+g):p*(((2*f-255)*Bb[g]/255|0)+g)))/m|0;b.data[a+3]=m}}};Q.softLightOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),
f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(t*e+u*m+(e<=127?n*(((2*e-255)*Ab[m]/255|0)+m):n*(((2*e-255)*Bb[m]/255|0)+m)))/p|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(t*e+u*m+(e<=127?n*(((2*e-255)*Ab[m]/255|0)+m):n*(((2*e-255)*Bb[m]/255|0)+m)))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+
2]=(t*e+u*m+(e<=127?n*(((2*e-255)*Ab[m]/255|0)+m):n*(((2*e-255)*Bb[m]/255|0)+m)))/p|0;b.data[a+3]=p}}};Q.softLightOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=(t*n+m*(p<=127?((2*p-255)*Ab[n]/255|0)+n:
((2*p-255)*Bb[n]/255|0)+n))/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=(t*n+m*(p<=127?((2*p-255)*Ab[n]/255|0)+n:((2*p-255)*Bb[n]/255|0)+n))/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=(t*n+m*(p<=127?((2*p-255)*Ab[n]/255|0)+n:((2*p-255)*Bb[n]/255|0)+n))/255|0}}};Q.softLightOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=
e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=(u*t+p*(n<=127?((2*n-255)*Ab[t]/255|0)+t:((2*n-255)*Bb[t]/255|0)+t))/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=(u*t+p*(n<=127?((2*n-255)*Ab[t]/255|0)+t:((2*n-255)*Bb[t]/255|0)+t))/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=(u*t+p*(n<=127?((2*n-255)*Ab[t]/255|0)+t:((2*n-255)*Bb[t]/255|0)+t))/255|0}}};Q.softLightOntoTransparentFusionWithOpaqueLayerMasked=function(b,
c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(v*l+A*n+(l<=127?u*(((2*l-255)*Ab[n]/255|0)+n):u*(((2*l-255)*Bb[n]/255|0)+n)))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(v*
l+A*n+(l<=127?u*(((2*l-255)*Ab[n]/255|0)+n):u*(((2*l-255)*Bb[n]/255|0)+n)))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(v*l+A*n+(l<=127?u*(((2*l-255)*Ab[n]/255|0)+n):u*(((2*l-255)*Bb[n]/255|0)+n)))/t|0;b.data[e+3]=t}}};Q.softLightOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=
c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(A*g+D*t+(g<=127?v*(((2*g-255)*Ab[t]/255|0)+t):v*(((2*g-255)*Bb[t]/255|0)+t)))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(A*g+D*t+(g<=127?v*(((2*g-255)*Ab[t]/255|0)+t):v*(((2*g-255)*Bb[t]/255|0)+t)))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(A*g+D*t+(g<=127?v*(((2*g-255)*Ab[t]/255|0)+t):v*(((2*g-255)*Bb[t]/255|0)+t)))/u|0;b.data[k+
3]=u}}};Q.vividLightOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=(m*g+(l<=127?k*(0==l?0:255-Math.min(255,(255-g)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*g/(2*(255-l))|0))))/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=(m*g+(l<=127?k*(0==l?0:255-Math.min(255,(255-g)*255/(2*l)|
0)):k*(255==l?255:Math.min(255,255*g/(2*(255-l))|0))))/255|0;l=c.data[a+2];g=b.data[a+2];b.data[a+2]=(m*g+(l<=127?k*(0==l?0:255-Math.min(255,(255-g)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*g/(2*(255-l))|0))))/255|0}}};Q.vividLightOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];
b.data[a]=(p*m+(g<=127?l*(0==g?0:255-Math.min(255,(255-m)*255/(2*g)|0)):l*(255==g?255:Math.min(255,255*m/(2*(255-g))|0))))/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=(p*m+(g<=127?l*(0==g?0:255-Math.min(255,(255-m)*255/(2*g)|0)):l*(255==g?255:Math.min(255,255*m/(2*(255-g))|0))))/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=(p*m+(g<=127?l*(0==g?0:255-Math.min(255,(255-m)*255/(2*g)|0)):l*(255==g?255:Math.min(255,255*m/(2*(255-g))|0))))/255|0}}};Q.vividLightOntoTransparentFusionWithOpaqueLayer=function(b,
c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(n*f+t*g+(f<=127?p*(0==f?0:255-Math.min(255,(255-g)*255/(2*f)|0)):p*(255==f?255:Math.min(255,255*g/(2*(255-f))|0))))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(n*f+t*g+(f<=127?p*(0==f?0:255-Math.min(255,
(255-g)*255/(2*f)|0)):p*(255==f?255:Math.min(255,255*g/(2*(255-f))|0))))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(n*f+t*g+(f<=127?p*(0==f?0:255-Math.min(255,(255-g)*255/(2*f)|0)):p*(255==f?255:Math.min(255,255*g/(2*(255-f))|0))))/m|0;b.data[a+3]=m}}};Q.vividLightOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,
m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(t*e+u*m+(e<=127?n*(0==e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):n*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/p|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(t*e+u*m+(e<=127?n*(0==e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):n*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(t*e+u*m+(e<=127?n*(0==e?0:255-Math.min(255,(255-m)*
255/(2*e)|0)):n*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/p|0;b.data[a+3]=p}}};Q.vividLightOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=(t*n+(p<=127?m*(0==p?0:255-Math.min(255,(255-n)*255/(2*p)|
0)):m*(255==p?255:Math.min(255,255*n/(2*(255-p))|0))))/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=(t*n+(p<=127?m*(0==p?0:255-Math.min(255,(255-n)*255/(2*p)|0)):m*(255==p?255:Math.min(255,255*n/(2*(255-p))|0))))/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=(t*n+(p<=127?m*(0==p?0:255-Math.min(255,(255-n)*255/(2*p)|0)):m*(255==p?255:Math.min(255,255*n/(2*(255-p))|0))))/255|0}}};Q.vividLightOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-
f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=(u*t+(n<=127?p*(0==n?0:255-Math.min(255,(255-t)*255/(2*n)|0)):p*(255==n?255:Math.min(255,255*t/(2*(255-n))|0))))/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=(u*t+(n<=127?p*(0==n?0:255-Math.min(255,(255-t)*255/(2*n)|0)):p*(255==n?255:Math.min(255,255*t/(2*(255-
n))|0))))/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=(u*t+(n<=127?p*(0==n?0:255-Math.min(255,(255-t)*255/(2*n)|0)):p*(255==n?255:Math.min(255,255*t/(2*(255-n))|0))))/255|0}}};Q.vividLightOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=
l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(v*l+A*n+(l<=127?u*(0==l?0:255-Math.min(255,(255-n)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*n/(2*(255-l))|0))))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(v*l+A*n+(l<=127?u*(0==l?0:255-Math.min(255,(255-n)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*n/(2*(255-l))|0))))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(v*l+A*n+(l<=127?u*(0==l?0:255-Math.min(255,(255-n)*255/(2*l)|0)):
u*(255==l?255:Math.min(255,255*n/(2*(255-l))|0))))/t|0;b.data[e+3]=t}}};Q.vividLightOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];
t=b.data[k];b.data[k]=(A*g+D*t+(g<=127?v*(0==g?0:255-Math.min(255,(255-t)*255/(2*g)|0)):v*(255==g?255:Math.min(255,255*t/(2*(255-g))|0))))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(A*g+D*t+(g<=127?v*(0==g?0:255-Math.min(255,(255-t)*255/(2*g)|0)):v*(255==g?255:Math.min(255,255*t/(2*(255-g))|0))))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(A*g+D*t+(g<=127?v*(0==g?0:255-Math.min(255,(255-t)*255/(2*g)|0)):v*(255==g?255:Math.min(255,255*t/(2*(255-g))|0))))/u|0;b.data[k+3]=u}}};Q.linearLightOntoOpaqueFusionWithOpaqueLayer=
function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l;if(k){let g=255^k;l=b.data[a];b.data[a]=(g*l+k*Math.min(255,Math.max(0,l+2*c.data[a]-255)))/255|0;l=b.data[a+1];b.data[a+1]=(g*l+k*Math.min(255,Math.max(0,l+2*c.data[a+1]-255)))/255|0;l=b.data[a+2];b.data[a+2]=(g*l+k*Math.min(255,Math.max(0,l+2*c.data[a+2]-255)))/255|0}}};Q.linearLightOntoOpaqueFusionWithTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g;if(l){let m=255^l;g=b.data[a];b.data[a]=(m*g+l*Math.min(255,Math.max(0,g+2*c.data[a]-255)))/255|0;g=b.data[a+1];b.data[a+1]=(m*g+l*Math.min(255,Math.max(0,g+2*c.data[a+1]-255)))/255|0;g=b.data[a+2];b.data[a+2]=(m*g+l*Math.min(255,Math.max(0,g+2*c.data[a+2]-255)))/255|0}}};Q.linearLightOntoTransparentFusionWithOpaqueLayer=
function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(n*f+t*g+p*Math.min(255,Math.max(0,g+2*f-255)))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(n*f+t*g+p*Math.min(255,Math.max(0,g+2*f-255)))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(n*f+
t*g+p*Math.min(255,Math.max(0,g+2*f-255)))/m|0;b.data[a+3]=m}}};Q.linearLightOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(t*e+u*m+n*Math.min(255,Math.max(0,m+2*e-255)))/p|0;e=c.data[a+
1];m=b.data[a+1];b.data[a+1]=(t*e+u*m+n*Math.min(255,Math.max(0,m+2*e-255)))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(t*e+u*m+n*Math.min(255,Math.max(0,m+2*e-255)))/p|0;b.data[a+3]=p}}};Q.linearLightOntoOpaqueFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p;if(m){let n=
255^m;p=b.data[e];b.data[e]=(n*p+m*Math.min(255,Math.max(0,p+2*c.data[e]-255)))/255|0;p=b.data[e+1];b.data[e+1]=(n*p+m*Math.min(255,Math.max(0,p+2*c.data[e+1]-255)))/255|0;p=b.data[e+2];b.data[e+2]=(n*p+m*Math.min(255,Math.max(0,p+2*c.data[e+2]-255)))/255|0}}};Q.linearLightOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,
a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n;if(p){let t=255^p;n=b.data[k];b.data[k]=(t*n+p*Math.min(255,Math.max(0,n+2*c.data[k]-255)))/255|0;n=b.data[k+1];b.data[k+1]=(t*n+p*Math.min(255,Math.max(0,n+2*c.data[k+1]-255)))/255|0;n=b.data[k+2];b.data[k+2]=(t*n+p*Math.min(255,Math.max(0,n+2*c.data[k+2]-255)))/255|0}}};Q.linearLightOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,
a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(v*l+A*n+u*Math.min(255,Math.max(0,n+2*l-255)))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(v*l+A*n+u*Math.min(255,Math.max(0,n+2*l-255)))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(v*l+A*n+u*Math.min(255,Math.max(0,
n+2*l-255)))/t|0;b.data[e+3]=t}}};Q.linearLightOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(A*g+D*t+v*Math.min(255,
Math.max(0,t+2*g-255)))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(A*g+D*t+v*Math.min(255,Math.max(0,t+2*g-255)))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(A*g+D*t+v*Math.min(255,Math.max(0,t+2*g-255)))/u|0;b.data[k+3]=u}}};Q.pinLightOntoOpaqueFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;if(k){let m=255^k;l=c.data[a];g=b.data[a];b.data[a]=
(m*g+k*(g>=2*l?2*l:g<=2*l-255?2*l-255:g))/255|0;l=c.data[a+1];g=b.data[a+1];b.data[a+1]=(m*g+k*(g>=2*l?2*l:g<=2*l-255?2*l-255:g))/255|0;l=c.data[a+2];g=b.data[a+2];b.data[a+2]=(m*g+k*(g>=2*l?2*l:g<=2*l-255?2*l-255:g))/255|0}}};Q.pinLightOntoOpaqueFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;if(l){let p=255^l;g=c.data[a];m=b.data[a];
b.data[a]=(p*m+l*(m>=2*g?2*g:m<=2*g-255?2*g-255:m))/255|0;g=c.data[a+1];m=b.data[a+1];b.data[a+1]=(p*m+l*(m>=2*g?2*g:m<=2*g-255?2*g-255:m))/255|0;g=c.data[a+2];m=b.data[a+2];b.data[a+2]=(p*m+l*(m>=2*g?2*g:m<=2*g-255?2*g-255:m))/255|0}}};Q.pinLightOntoTransparentFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<d;e++,a+=q)for(let k=0;k<h;k++,a+=4){var f=c.data[a+3];let l,g;if(f){let m=f+(l=b.data[a+3])-(f*
l/255|0)|0,p=f*l/255|0,n=f*(255^l)/255|0,t=(255^f)*l/255|0;f=c.data[a];g=b.data[a];b.data[a]=(n*f+t*g+p*(g>=2*f?2*f:g<=2*f-255?2*f-255:g))/m|0;f=c.data[a+1];g=b.data[a+1];b.data[a+1]=(n*f+t*g+p*(g>=2*f?2*f:g<=2*f-255?2*f-255:g))/m|0;f=c.data[a+2];g=b.data[a+2];b.data[a+2]=(n*f+t*g+p*(g>=2*f?2*f:g<=2*f-255?2*f-255:g))/m|0;b.data[a+3]=m}}};Q.pinLightOntoTransparentFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);
for(let k=0;k<h;k++,a+=f)for(let l=0;l<q;l++,a+=4){var e=c.data[a+3]*d/100|0;let g,m;if(e){let p=e+(g=b.data[a+3])-(e*g/255|0)|0,n=e*g/255|0,t=e*(255^g)/255|0,u=(255^e)*g/255|0;e=c.data[a];m=b.data[a];b.data[a]=(t*e+u*m+n*(m>=2*e?2*e:m<=2*e-255?2*e-255:m))/p|0;e=c.data[a+1];m=b.data[a+1];b.data[a+1]=(t*e+u*m+n*(m>=2*e?2*e:m<=2*e-255?2*e-255:m))/p|0;e=c.data[a+2];m=b.data[a+2];b.data[a+2]=(t*e+u*m+n*(m>=2*e?2*e:m<=2*e-255?2*e-255:m))/p|0;b.data[a+3]=p}}};Q.pinLightOntoOpaqueFusionWithOpaqueLayerMasked=
function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0,p,n;if(m){let t=255^m;p=c.data[e];n=b.data[e];b.data[e]=(t*n+m*(n>=2*p?2*p:n<=2*p-255?2*p-255:n))/255|0;p=c.data[e+1];n=b.data[e+1];b.data[e+1]=(t*n+m*(n>=2*p?2*p:n<=2*p-255?2*p-255:n))/255|0;p=c.data[e+2];n=b.data[e+2];b.data[e+2]=(t*n+m*(n>=2*p?2*
p:n<=2*p-255?2*p-255:n))/255|0}}};Q.pinLightOntoOpaqueFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3]*h.data[a]*d/25500|0,n,t;if(p){let u=255^p;n=c.data[k];t=b.data[k];b.data[k]=(u*t+p*(t>=2*n?2*n:t<=2*n-255?2*n-255:t))/255|0;n=c.data[k+1];t=b.data[k+1];b.data[k+1]=(u*t+p*(t>=2*
n?2*n:t<=2*n-255?2*n-255:t))/255|0;n=c.data[k+2];t=b.data[k+2];b.data[k+2]=(u*t+p*(t>=2*n?2*n:t<=2*n-255?2*n-255:t))/255|0}}};Q.pinLightOntoTransparentFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<d;g++,e+=f,a+=k)for(let m=0;m<q;m++,e+=4,a++){var l=c.data[e+3]*h.data[a]/255|0;let p,n;if(l){let t=l+(p=b.data[e+3])-(l*p/255|0)|0,u=l*p/255|0,v=l*(255^
p)/255|0,A=(255^l)*p/255|0;l=c.data[e];n=b.data[e];b.data[e]=(v*l+A*n+u*(n>=2*l?2*l:n<=2*l-255?2*l-255:n))/t|0;l=c.data[e+1];n=b.data[e+1];b.data[e+1]=(v*l+A*n+u*(n>=2*l?2*l:n<=2*l-255?2*l-255:n))/t|0;l=c.data[e+2];n=b.data[e+2];b.data[e+2]=(v*l+A*n+u*(n>=2*l?2*l:n<=2*l-255?2*l-255:n))/t|0;b.data[e+3]=t}}};Q.pinLightOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,
a.top);for(let m=0;m<q;m++,k+=e,a+=l)for(let p=0;p<f;p++,k+=4,a++){var g=c.data[k+3]*h.data[a]*d/25500|0;let n,t;if(g){let u=g+(n=b.data[k+3])-(g*n/255|0)|0,v=g*n/255|0,A=g*(255^n)/255|0,D=(255^g)*n/255|0;g=c.data[k];t=b.data[k];b.data[k]=(A*g+D*t+v*(t>=2*g?2*g:t<=2*g-255?2*g-255:t))/u|0;g=c.data[k+1];t=b.data[k+1];b.data[k+1]=(A*g+D*t+v*(t>=2*g?2*g:t<=2*g-255?2*g-255:t))/u|0;g=c.data[k+2];t=b.data[k+2];b.data[k+2]=(A*g+D*t+v*(t>=2*g?2*g:t<=2*g-255?2*g-255:t))/u|0;b.data[k+3]=u}}};Q.passthroughOntoOpaqueFusionWithTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3],g=d/100,m=1-g,p=l*g+255*m;b.data[a]=(c.data[a]*l*g+255*b.data[a]*m)/p|0;b.data[a+1]=(c.data[a+1]*l*g+255*b.data[a+1]*m)/p|0;b.data[a+2]=(c.data[a+2]*l*g+255*b.data[a+2]*m)/p|0;b.data[a+3]=p}};Q.passthroughOntoOpaqueFusionWithOpaqueLayer=Q.passthroughOntoOpaqueFusionWithTransparentLayer;Q.passthroughOntoTransparentFusionWithTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3],g=b.data[a+3],m=d/100,p=1-m,n=l*m+g*p;b.data[a]=(c.data[a]*l*m+b.data[a]*g*p)/n|0;b.data[a+1]=(c.data[a+1]*l*m+b.data[a+1]*g*p)/n|0;b.data[a+2]=(c.data[a+2]*l*m+b.data[a+2]*g*p)/n|0;b.data[a+3]=n}};Q.passthroughOntoTransparentFusionWithOpaqueLayer=Q.passthroughOntoTransparentFusionWithTransparentLayer;Q.passthroughOntoOpaqueFusionWithTransparentLayerMasked=
function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3],n=h.data[a]*d/25500,t=1-n,u=p*n+255*t;b.data[k]=(c.data[k]*p*n+255*b.data[k]*t)/u|0;b.data[k+1]=(c.data[k+1]*p*n+255*b.data[k+1]*t)/u|0;b.data[k+2]=(c.data[k+2]*p*n+255*b.data[k+2]*t)/u|0;b.data[k+3]=u}};Q.passthroughOntoOpaqueFusionWithOpaqueLayerMasked=Q.passthroughOntoOpaqueFusionWithTransparentLayerMasked;
Q.passthroughOntoTransparentFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+3],n=b.data[k+3],t=h.data[a]*d/25500,u=1-t,v=p*t+n*u;b.data[k]=(c.data[k]*p*t+b.data[k]*n*u)/v|0;b.data[k+1]=(c.data[k+1]*p*t+b.data[k+1]*n*u)/v|0;b.data[k+2]=(c.data[k+2]*p*t+b.data[k+2]*n*u)/v|0;b.data[k+
3]=v}};Q.passthroughOntoTransparentFusionWithOpaqueLayerMasked=Q.passthroughOntoTransparentFusionWithTransparentLayerMasked;Q.replaceOntoFusionWithTransparentLayer=function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0;b.data[a]=c.data[a];b.data[a+1]=c.data[a+1];b.data[a+2]=c.data[a+2];b.data[a+3]=l}};Q.replaceOntoFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();
let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3];b.data[a]=c.data[a];b.data[a+1]=c.data[a+1];b.data[a+2]=c.data[a+2];b.data[a+3]=k}};Q.replaceOntoFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++){let p=c.data[k+
3]*h.data[a]*d/25500|0;b.data[k]=c.data[k];b.data[k+1]=c.data[k+1];b.data[k+2]=c.data[k+2];b.data[k+3]=p}};Q.replaceOntoFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++){let m=c.data[e+3]*h.data[a]/255|0;b.data[e]=c.data[e];b.data[e+1]=c.data[e+1];b.data[e+2]=c.data[e+2];b.data[e+3]=m}};Q.replaceAlphaOntoFusionWithTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4)b.data[a+3]=c.data[a+3]*d/100|0};Q.replaceAlphaOntoFusionWithTransparentLayerMasked=function(b,c,d,a,h){let q=0|a.getHeight(),f=0|a.getWidth(),e=(c.width-f)*4|0,k=0|c.offsetOfPixel(a.left,a.top),l=h.width-f|0;a=0|h.offsetOfPixel(a.left,a.top);for(let g=0;g<q;g++,k+=e,a+=l)for(let m=0;m<f;m++,k+=4,a++)b.data[k+3]=c.data[k+3]*h.data[a]*d/25500|
0};Q.replaceAlphaOntoFusionWithOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4)b.data[a+3]=c.data[a+3]};Q.replaceAlphaOntoFusionWithOpaqueLayerMasked=function(b,c,d,a,h){d=0|a.getHeight();let q=0|a.getWidth(),f=(c.width-q)*4|0,e=0|c.offsetOfPixel(a.left,a.top),k=h.width-q|0;a=0|h.offsetOfPixel(a.left,a.top);for(let l=0;l<d;l++,e+=f,a+=k)for(let g=0;g<q;g++,e+=4,a++)b.data[e+3]=
c.data[e+3]*h.data[a]/255|0};Q.upgradeMultiplyOfOpaqueLayer=function(b,c,d,a){d=0|a.getHeight();let h=0|a.getWidth(),q=(c.width-h)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let f=0;f<d;f++,a+=q)for(let e=0;e<h;e++,a+=4){let k=c.data[a+3],l,g;k&&(l=c.data[a],g=b.data[a],c.data[a]=l+Math.ceil((255-l)*g*k%65025/(g*k)),l=c.data[a+1],g=b.data[a+1],c.data[a+1]=l+Math.ceil((255-l)*g*k%65025/(g*k)),l=c.data[a+2],g=b.data[a+2],c.data[a+2]=l+Math.ceil((255-l)*g*k%65025/(g*k)))}};Q.upgradeMultiplyOfTransparentLayer=
function(b,c,d,a){let h=0|a.getHeight(),q=0|a.getWidth(),f=(c.width-q)*4|0;a=0|c.offsetOfPixel(a.left,a.top);for(let e=0;e<h;e++,a+=f)for(let k=0;k<q;k++,a+=4){let l=c.data[a+3]*d/100|0,g,m;l&&(g=c.data[a],m=b.data[a],c.data[a]=g+Math.ceil((255-g)*m*l%65025/(m*l)),g=c.data[a+1],m=b.data[a+1],c.data[a+1]=g+Math.ceil((255-g)*m*l%65025/(m*l)),g=c.data[a+2],m=b.data[a+2],c.data[a+2]=g+Math.ceil((255-g)*m*l%65025/(m*l)))}};Q._normalFuseImageOntoImageAtPosition=function(b,c,d,a,h,q){d=0|a.getHeight();let f=
0|a.getWidth(),e=(c.width-f)*4|0;a=0|c.offsetOfPixel(a.left,a.top);let k=(b.width-f)*4|0;h=0|b.offsetOfPixel(h,q);for(q=0;q<d;q++,a+=e,h+=k)for(let g=0;g<f;g++,a+=4,h+=4){var l=c.data[a+3];let m;if(l){let p=l+(m=b.data[h+3])-(l*m/255|0)|0;l=255*l/p|0;let n=255-l;b.data[h]=(c.data[a]*l+b.data[h]*n)/255|0;b.data[h+1]=(c.data[a+1]*l+b.data[h+1]*n)/255|0;b.data[h+2]=(c.data[a+2]*l+b.data[h+2]*n)/255|0;b.data[h+3]=p}}};Q.LM_NORMAL=0;Q.LM_MULTIPLY=1;Q.LM_ADD=2;Q.LM_SCREEN=3;Q.LM_LIGHTEN=4;Q.LM_DARKEN=5;
Q.LM_SUBTRACT=6;Q.LM_DODGE=7;Q.LM_BURN=8;Q.LM_OVERLAY=9;Q.LM_HARDLIGHT=10;Q.LM_SOFTLIGHT=11;Q.LM_VIVIDLIGHT=12;Q.LM_LINEARLIGHT=13;Q.LM_PINLIGHT=14;Q.LM_PASSTHROUGH=15;Q.LM_MULTIPLY2=16;Q.LM_FIRST=0;Q.LM_LAST=16;Q.LM_LAST_CHIBIPAINT=Q.LM_PINLIGHT;Q.BLEND_MODE_CODENAMES="normal multiply add screen lighten darken subtract dodge burn overlay hardLight softLight vividLight linearLight pinLight passthrough multiply2".split(" ");Q.BLEND_MODE_DISPLAY_NAMES="Normal;Multiply;Add;Screen;Lighten;Darken;Subtract;Dodge;Burn;Overlay;Hard Light;Soft Light;Vivid Light;Linear Light;Pin Light;Passthrough;Multiply".split(";");
for(let b=0;b<256;b++){let c=b/255;Ab[b]=(c-c*c)*255|0}for(let b=0;b<256;b++){let c=b/255;Bb[b]=(Math.sqrt(c)-c)*255|0}db.prototype.copyFrom=function(b){this.name=b.name;this.blendMode=b.blendMode;this.useLegacyMultiply=b.useLegacyMultiply;this.alpha=b.alpha;this.visible=b.visible;this.parent=b.parent;this.lockAlpha=b.lockAlpha;b.mask?this.mask?this.mask.copyPixelsFrom(b.mask):this.mask=b.mask.clone():this.mask=null;this.maskLinked=b.maskLinked;this.maskVisible=b.maskVisible;b.maskThumbnail?this.maskThumbnail?
this.maskThumbnail.copyPixelsFrom(b.maskThumbnail):this.maskThumbnail=b.maskThumbnail.clone():this.maskThumbnail=null};db.prototype.setMask=function(b){(this.mask=b)||(this.maskThumbnail=null)};db.prototype.setAlpha=function(b){this.alpha=b};db.prototype.getAlpha=function(){return this.alpha};db.prototype.getEffectiveAlpha=function(){return this.visible?this.alpha:0};db.prototype.getEffectiveMask=function(){return this.maskVisible?this.mask:null};db.prototype.setName=function(b){this.name=b};db.prototype.getName=
function(){return this.name};db.prototype.setBlendMode=function(b){this.blendMode=b;b===Q.LM_MULTIPLY?this.useLegacyMultiply=!0:b===Q.LM_MULTIPLY2&&(this.useLegacyMultiply=!1)};db.prototype.getBlendMode=function(){return this.blendMode};db.prototype.getLockAlpha=function(){return this.lockAlpha};db.prototype.setLockAlpha=function(b){this.lockAlpha=b};db.prototype.setVisible=function(b){this.visible=b};db.prototype.getVisible=function(){return this.visible};db.prototype.isVisible=db.prototype.getVisible;
db.prototype.setMaskLinked=function(b){this.maskLinked=b};db.prototype.getMaskLinked=function(){return this.maskLinked};db.prototype.setMaskVisible=function(b){this.maskVisible=b};db.prototype.getMaskVisible=function(){return this.maskVisible};db.prototype.getMemoryUsed=function(){return 0};db.prototype.getDepth=function(){return null==this.parent?0:this.parent.getDepth()+1};db.prototype.ancestorsAreVisible=function(){return null==this.parent||this.parent.visible&&this.parent.ancestorsAreVisible()};
db.prototype.hasAncestor=function(b){return this.parent==b||this.parent&&this.parent.hasAncestor(b)};db.prototype.clone=function(){throw"Pure virtual CPLayer.clone() call";};db.prototype.getNonTransparentBounds=function(b){return new Ba(0,0,0,0)};db.prototype.rebuildMaskThumbnail=function(){if(this.mask){if(!this.maskThumbnail){var b=Math.ceil(Math.max(this.mask.width/db.LAYER_THUMBNAIL_WIDTH,this.mask.height/db.LAYER_THUMBNAIL_HEIGHT));this.maskThumbnail=new Pa(Math.floor(this.mask.width/b),Math.floor(this.mask.height/
b),8)}this.maskThumbnail.createThumbnailFrom(this.mask)}else this.maskThumbnail=null};db.prototype.getMaskThumbnail=function(){return!this.maskThumbnail&&this.mask&&this.rebuildMaskThumbnail(),this.maskThumbnail};db.LAYER_THUMBNAIL_WIDTH=80;db.LAYER_THUMBNAIL_HEIGHT=50;Fa.prototype=Object.create(db.prototype);Fa.prototype.constructor=Fa;Fa.createFromImage=function(b,c){c=new Fa(0,0,c);return c.image=b,c};Fa.prototype.clone=function(){var b=new Fa(0,0,this.name);return b.copyFrom(this),b};Fa.prototype.copyFrom=
function(b){db.prototype.copyFrom.call(this,b);this.clip=b.clip;this.image?this.image.copyPixelsFrom(b.image):this.image=b.image.clone()};Fa.prototype.hasAlpha=function(){return 100!=this.alpha||this.image.hasAlpha()};Fa.prototype.hasAlphaInRect=function(b){return 100!=this.alpha||this.image.hasAlphaInRect(b)};Fa.prototype.copyImageFrom=function(b){this.image.copyPixelsFrom(b)};Fa.prototype.getClippingBase=function(){if(this.clip&&this.parent)for(var b=this.parent.indexOf(this)-1;b>=0;b--)if(this.parent.layers[b]instanceof
Fa){if(!this.parent.layers[b].clip)return this.parent.layers[b]}else break;return null};Fa.prototype.getClip=function(){return this.clip};Fa.prototype.setClip=function(b){this.clip=b};Fa.prototype.getNonTransparentBounds=function(b){return this.image.getNonTransparentBounds(b)};Fa.prototype.getBounds=function(){return new Ba(0,0,this.image.width,this.image.height)};Fa.prototype.getMemoryUsed=function(){return this.image?this.image.getMemorySize():0};Fa.prototype.rebuildImageThumbnail=function(){if(!this.imageThumbnail){var b=
Math.ceil(Math.max(this.image.width/db.LAYER_THUMBNAIL_WIDTH,this.image.height/db.LAYER_THUMBNAIL_HEIGHT));this.imageThumbnail=new J(Math.floor(this.image.width/b),Math.floor(this.image.height/b))}this.imageThumbnail.createThumbnailFrom(this.image)};Fa.prototype.getImageThumbnail=function(){return this.imageThumbnail||this.rebuildImageThumbnail(),this.imageThumbnail};Q.blendFunctionNameForParameters=function(b,c,d,a){d=Q.BLEND_MODE_CODENAMES[d]+"Onto";return b?d+="TransparentFusion":d+="OpaqueFusion",
100==c?d+="WithOpaqueLayer":d+="WithTransparentLayer",a&&(d+="Masked"),d};Q.fuseImageOntoImage=function(b,c,d,a,h,q,f){a<=0||(c=Q.blendFunctionNameForParameters(c,a,h,null!=f),q=b.getBounds().clipTo(q),this[c](b,d,a,q,f))};Q.normalFuseImageOntoImageAtPosition=function(b,c,d,a,h){h=h.clone();d=new Ba(d,a,0,0);b.getBounds().clipSourceDest(h,d);this._normalFuseImageOntoImageAtPosition(b,c,100,h,d.left,d.top)};Q.multiplyAlphaBy=function(b,c){if(c<100)if(0==c)b.clearAll(0);else{b=b.data;for(var d=3;d<
b.length;d+=4)b[d]=Math.round(b[d]*c/100)}};Q.multiplyAlphaByMask=function(b,c,d){c/=25500;for(var a=J.ALPHA_BYTE_OFFSET,h=0;a<b.data.length;a+=J.BYTES_PER_PIXEL,h++)b.data[a]=Math.round(b.data[a]*d.data[h]*c)};Q.copyAndMultiplyAlphaBy=function(b,c,d,a){if(100==d)b.copyBitmapRect(c,a.left,a.top,a);else if(0==d)b.clearRect(a,0);else for(b=c.data,c=0;c<b.length;c+=4)b[c]=b[c],b[c+1]=b[c+1],b[c+2]=b[c+2],b[c+3]=Math.round(b[c+3]*d/100)};td.prototype.addChildren=function(b){null!=b&&(Array.isArray(b)?
(b.forEach(c=>c.parent=this),this.layers=this.layers.concat(b)):(b.parent=this,this.layers.push(b)))};var Hb={};!function(b){function c(){}function d(f,e){for(var k=f.length;k--;)if(f[k].listener===e)return k;return-1}function a(f){return function(){return this[f].apply(this,arguments)}}var h=c.prototype,q=b.EventEmitter;h.getListeners=function(f){var e,k,l=this._getEvents();if(f instanceof RegExp)for(k in e={},l)l.hasOwnProperty(k)&&f.test(k)&&(e[k]=l[k]);else e=l[f]||(l[f]=[]);return e};h.flattenListeners=
function(f){var e,k=[];for(e=0;e<f.length;e+=1)k.push(f[e].listener);return k};h.getListenersAsObject=function(f){var e,k=this.getListeners(f);return k instanceof Array&&((e={})[f]=k),e||k};h.addListener=function(f,e){if(!function p(m){return"function"==typeof m||m instanceof RegExp||!!m&&"object"==typeof m&&p(m.listener)}(e))throw TypeError("listener must be a function");var k;f=this.getListenersAsObject(f);var l="object"==typeof e;for(k in f)f.hasOwnProperty(k)&&-1===d(f[k],e)&&f[k].push(l?e:{listener:e,
once:!1});return this};h.on=a("addListener");h.addOnceListener=function(f,e){return this.addListener(f,{listener:e,once:!0})};h.once=a("addOnceListener");h.defineEvent=function(f){return this.getListeners(f),this};h.defineEvents=function(f){for(var e=0;e<f.length;e+=1)this.defineEvent(f[e]);return this};h.removeListener=function(f,e){var k,l;f=this.getListenersAsObject(f);for(l in f)f.hasOwnProperty(l)&&-1!==(k=d(f[l],e))&&f[l].splice(k,1);return this};h.off=a("removeListener");h.addListeners=function(f,
e){return this.manipulateListeners(!1,f,e)};h.removeListeners=function(f,e){return this.manipulateListeners(!0,f,e)};h.manipulateListeners=function(f,e,k){var l,g,m=f?this.removeListener:this.addListener;f=f?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(l=k.length;l--;)m.call(this,e,k[l]);else for(l in e)e.hasOwnProperty(l)&&(g=e[l])&&("function"==typeof g?m.call(this,l,g):f.call(this,l,g));return this};h.removeEvent=function(f){var e,k=typeof f,l=this._getEvents();
if("string"===k)delete l[f];else if(f instanceof RegExp)for(e in l)l.hasOwnProperty(e)&&f.test(e)&&delete l[e];else delete this._events;return this};h.removeAllListeners=a("removeEvent");h.emitEvent=function(f,e){var k,l,g,m=this.getListenersAsObject(f);for(g in m)if(m.hasOwnProperty(g)){var p=0;for(k=m[g].slice(0);p<k.length;p++)!0===(l=k[p]).once&&this.removeListener(f,l.listener),l.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(f,l.listener)}return this};h.trigger=
a("emitEvent");h.emit=function(f){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(f,e)};h.setOnceReturnValue=function(f){return this._onceReturnValue=f,this};h._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue};h._getEvents=function(){return this._events||(this._events={})};c.noConflict=function(){return b.EventEmitter=q,c};"function"==typeof define&&define.amd?define(function(){return c}):Hb?Hb=c:b.EventEmitter=c}("u">typeof window?
window:Hb||{});class ag extends Ja(Hb){close(){this.layer=this.buffer=null;this.emitEvent("changeLayer")}setLayer(b){this.layer=b;this.invalidRect=b.getBounds();this.emitEvent("changeLayer")}isOpen(){return null!=this.layer}invalidateRect(b){this.invalidRect.union(b)}getImageData(){this.prepareMask();if(!this.invalidRect.isEmpty()&&this.layer&&this.layer.mask){var b=this.buffer,c=this.layer.mask,d=this.invalidRect,a=d.top*c.width+d.left,h=a*J.BYTES_PER_PIXEL,q=d.getWidth();d=d.getHeight();var f=c.width-
q,e=f*J.BYTES_PER_PIXEL;for(let k=0;k<d;k++,a+=f,h+=e)for(let l=0;l<q;l++,a++,h+=J.BYTES_PER_PIXEL)b.data[h+J.RED_BYTE_OFFSET]=c.data[a],b.data[h+J.GREEN_BYTE_OFFSET]=c.data[a],b.data[h+J.BLUE_BYTE_OFFSET]=c.data[a],b.data[h+J.ALPHA_BYTE_OFFSET]=255;!0;this.invalidRect.makeEmpty()}return this.buffer}constructor(b,c){super();this.layer=b;this.buffer=b.mask.getImageData(0,0,b.mask.width,b.mask.height);this.invalidRect=new Ba(0,0,0,0);this.prepareMask=c}}class Zb{merge(b){return!1}noChange(){return!1}getMemoryUsed(b,
c){return 0}compact(){}}jb.prototype.getRgb=function(){return this.rgb};jb.prototype.getSaturation=function(){return this.saturation};jb.prototype.getHue=function(){return this.hue};jb.prototype.getValue=function(){return this.value};jb.prototype.setRgbComponents=function(b,c,d){this.setRgb(b<<16|c<<8|d)};jb.prototype.setRgb=function(b){this.rgb=b;var c=b>>16&255,d=b>>8&255;b&=255;this.value=Math.max(c,Math.max(d,b));var a=Math.min(c,Math.min(d,b));if(0==this.value?this.saturation=0:this.saturation=
~~((this.value-a)/this.value*255),0==this.saturation)this.hue=0;else{var h=(this.value-c)/(this.value-a),q=(this.value-d)/(this.value-a);a=(this.value-b)/(this.value-a);var f=0;this.value==c&&(f=a-q);this.value==d&&(f=2+h-a);this.value==b&&(f=4+q-h);(f*=60)<0&&(f+=360);this.hue=~~f}};jb.prototype.setHsv=function(b,c,d){this.hue=b;this.saturation=c;this.value=d;this.rgb=Fd(this)};jb.prototype.setHue=function(b){this.hue=b;this.rgb=Fd(this)};jb.prototype.setSaturation=function(b){this.saturation=b;
this.rgb=Fd(this)};jb.prototype.setValue=function(b){this.value=b;this.rgb=Fd(this)};jb.prototype.setGreyscale=function(b){this.rgb=jb.greyToRGB(b);this.saturation=this.hue=0;this.value=b};jb.prototype.clone=function(){var b=new jb(0);return b.copyFrom(this),b};jb.prototype.copyFrom=function(b){this.rgb=b.rgb;this.hue=b.hue;this.saturation=b.saturation;this.value=b.value};jb.prototype.isEqual=function(b){return this.rgb==b.rgb&&this.hue==b.hue&&this.saturation==b.saturation&&this.value==b.value};
jb.greyToRGB=function(b){return b|b<<8|b<<16};qb.prototype.setToIdentity=function(){this.m=[1,0,0,1,0,0]};qb.prototype.multiply=function(b){var c=this.m[1]*b.m[0]+this.m[3]*b.m[1],d=this.m[0]*b.m[2]+this.m[2]*b.m[3],a=this.m[1]*b.m[2]+this.m[3]*b.m[3],h=this.m[0]*b.m[4]+this.m[2]*b.m[5]+this.m[4],q=this.m[1]*b.m[4]+this.m[3]*b.m[5]+this.m[5];this.m[0]=this.m[0]*b.m[0]+this.m[2]*b.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=a;this.m[4]=h;this.m[5]=q};qb.prototype.preMultiply=function(b){var c=b.m[1]*this.m[0]+
b.m[3]*this.m[1],d=b.m[0]*this.m[2]+b.m[2]*this.m[3],a=b.m[1]*this.m[2]+b.m[3]*this.m[3],h=b.m[0]*this.m[4]+b.m[2]*this.m[5]+b.m[4],q=b.m[1]*this.m[4]+b.m[3]*this.m[5]+b.m[5];this.m[0]=b.m[0]*this.m[0]+b.m[2]*this.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=a;this.m[4]=h;this.m[5]=q};qb.prototype.invert=function(){var b=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),c=-this.m[1]*b,d=-this.m[2]*b,a=this.m[0]*b,h=b*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),q=b*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=
this.m[3]*b;this.m[1]=c;this.m[2]=d;this.m[3]=a;this.m[4]=h;this.m[5]=q};qb.prototype.getInverted=function(){var b=new qb;return b.m[0]=this.m[0],b.m[1]=this.m[1],b.m[2]=this.m[2],b.m[3]=this.m[3],b.m[4]=this.m[4],b.m[5]=this.m[5],b.invert(),b};qb.prototype.rotate=function(b){var c=Math.cos(b);b=Math.sin(b);var d=this.m[1]*c+this.m[3]*b,a=-(this.m[0]*b)+this.m[2]*c,h=-(this.m[1]*b)+this.m[3]*c;this.m[0]=this.m[0]*c+this.m[2]*b;this.m[1]=d;this.m[2]=a;this.m[3]=h};qb.prototype.rotateAroundPoint=function(b,
c,d){this.translate(c,d);this.rotate(b);this.translate(-c,-d)};qb.prototype.translate=function(b,c){this.m[4]+=this.m[0]*b+this.m[2]*c;this.m[5]+=this.m[1]*b+this.m[3]*c};qb.prototype.scale=function(b,c){this.m[0]*=b;this.m[1]*=b;this.m[2]*=c;this.m[3]*=c};qb.prototype.scaleAroundPoint=function(b,c,d,a){this.translate(d,a);this.scale(b,c);this.translate(-d,-a)};qb.prototype.shear=function(b,c){var d=this.m[1]+this.m[3]*c,a=this.m[2]+this.m[0]*b;b=this.m[3]+this.m[1]*b;this.m[0]+=this.m[2]*c;this.m[1]=
d;this.m[2]=a;this.m[3]=b};qb.prototype.getTransformedPoint=function(b){return{x:b.x*this.m[0]+b.y*this.m[2]+this.m[4],y:b.x*this.m[1]+b.y*this.m[3]+this.m[5]}};qb.prototype.transformPoints=function(b){for(var c=0;c<b.length;c++)b[c]=this.getTransformedPoint(b[c])};qb.prototype.getTranslateX=function(){return this.m[4]};qb.prototype.getTranslateY=function(){return this.m[5]};qb.prototype.clone=function(){var b=new qb;return b.m[0]=this.m[0],b.m[1]=this.m[1],b.m[2]=this.m[2],b.m[3]=this.m[3],b.m[4]=
this.m[4],b.m[5]=this.m[5],b};qb.prototype.getDeterminant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]};qb.prototype.decompose=function(){var b=this.getDeterminant(),c=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return{translate:{x:this.m[4],y:this.m[5]},rotate:Math.sign(this.m[1])*Math.acos(this.m[0]/c),scale:{x:c,y:b/c},shear:{x:Math.atan((this.m[0]*this.m[2]+this.m[1]*this.m[3])/(c*c)),y:0}}};qb.prototype.toString=function(){return"["+this.m[0].toFixed(2)+" "+this.m[2].toFixed(2)+
" "+this.m[4].toFixed(2)+"]\n["+this.m[1].toFixed(2)+" "+this.m[3].toFixed(2)+" "+this.m[5].toFixed(2)+"]\n[0.00 0.00 1.00]"};Math.sign=Math.sign||function(b){return 0==(b*=1)||isNaN(b)?b:b>0?1:-1};rc.prototype.toInt=function(){return Math.max(0,Math.min(255,Math.round(255*this.r)))<<16|Math.max(0,Math.min(255,Math.round(255*this.g)))<<8|Math.max(0,Math.min(255,Math.round(255*this.b)))};rc.prototype.mixWith=function(b,c){this.r=this.r*(1-c)+b.r*c;this.g=this.g*(1-c)+b.g*c;this.b=this.b*(1-c)+b.b*
c};rc.prototype.clone=function(){return new rc(this.r,this.g,this.b)};rc.createFromInt=function(b){return new rc((b>>>16&255)/255,(b>>>8&255)/255,(255&b)/255)};class fd{calcAlphaScale(b){return b<=230?.5:.5+(b-230)/25*(180/255-.5)}paintDab(b,c,d,a,h,q,f){q.alpha=Math.round(250/254*(q.alpha-1)+5);b=2===a.toolNb?this.calcAlphaScale(q.alpha):a.alphaScale;b=Math.max(1,Math.ceil(q.alpha*b));switch(a.paintMode){case wa.PAINT_MODE_FLOW:this._paintFlow(h,c,q.brush,q.width,b);break;case wa.PAINT_MODE_OPACITY:this._paintOpacity(h,
c,q.brush,q.width,b)}}mergeOntoImage(b,c,d){let a=this._strokeBuffer.data;var h=this._strokedRegion;c=c.data;let q=b.data,f=d>>16&255,e=d>>8&255;d&=255;let k=0|h.getWidth(),l=0|h.getHeight(),g=this._strokeBuffer.offsetOfPixel(h.left,h.top);h=b.offsetOfPixel(h.left,h.top);let m=this._strokeBuffer.width-k|0;b=(b.width-k)*J.BYTES_PER_PIXEL|0;for(let n=0;n<l;n++,g+=m,h+=b)for(let t=0;t<k;t++,g++,h+=J.BYTES_PER_PIXEL){var p=a[g]/255+.5|0;if(p>0){let u=p+c[h+J.ALPHA_BYTE_OFFSET]*(255-p)/255|0;p=255*p/u|
0;let v=255-p;q[h]=(f*p+c[h]*v)/255&255;q[h+1]=(e*p+c[h+1]*v)/255&255;q[h+2]=(d*p+c[h+2]*v)/255&255;q[h+3]=u}}}mergeOntoMask(b,c,d){let a=this._strokeBuffer.data;var h=this._strokedRegion;c=c.data;let q=b.data,f=0|h.getWidth(),e=0|h.getHeight(),k=b.offsetOfPixel(h.left,h.top);h=this._strokeBuffer.offsetOfPixel(h.left,h.top);let l=this._strokeBuffer.width-f|0;b=b.width-f|0;for(let g=0;g<e;g++,h+=l,k+=b)for(let m=0;m<f;m++,h++,k++){let p=a[h]/255|0;p>0&&(q[k]=(d*p+c[k]*(255-p))/255)}}_paintFlow(b,c,
d,a,h){let q=this._strokeBuffer.data;b=b.left+b.top*a;let f=this._strokeBuffer.offsetOfPixel(c.left,c.top),e=c.getHeight(),k=c.getWidth();a-=k;let l=this._strokeBuffer.width-k;this._strokedRegion.union(c);for(c=0;c<e;c++,b+=a,f+=l)for(let g=0;g<k;g++,b++,f++){let m=d[b]*h;0!=m&&(q[f]=Math.min(65025,q[f]+(255-q[f]/255)*m/255))}}_paintOpacity(b,c,d,a,h){let q=this._strokeBuffer.data;b=b.left+b.top*a;let f=this._strokeBuffer.offsetOfPixel(c.left,c.top),e=c.getWidth();a-=e;let k=this._strokeBuffer.width-
e;h=Math.min(255,h);this._strokedRegion.union(c);for(let l=c.top;l<c.bottom;l++,b+=a,f+=k)for(let g=0;g<e;g++,b++,f++)q[f]=Math.max(d[b]*h,q[f])}beginStroke(){}endStroke(){}constructor(b,c){this._strokeBuffer=b;this._strokedRegion=c;this.wantsOutputAsInput=!0}}class bg extends fd{mergeOntoImage(b,c,d){d=this._strokeBuffer.data;let a=this._strokedRegion;c=c.data;let h=b.data;for(let q=a.top;q<a.bottom;q++){let f=b.offsetOfPixel(a.left,q)+J.ALPHA_BYTE_OFFSET,e=this._strokeBuffer.offsetOfPixel(a.left,
q);for(let k=a.left;k<a.right;k++,f+=J.BYTES_PER_PIXEL){let l=d[e++]/255|0;l>0&&(h[f]=c[f]*(255-l)/255)}}}}class cg extends fd{mergeOntoImage(b,c,d){d=this._strokeBuffer.data;var a=this._strokedRegion;let h=a.getWidth(),q=a.getHeight(),f=b.offsetOfPixel(a.left,a.top);a=this._strokeBuffer.offsetOfPixel(a.left,a.top);let e=(b.width-h)*J.BYTES_PER_PIXEL,k=this._strokeBuffer.width-h;c=c.data;b=b.data;for(let g=0;g<q;g++,a+=k,f+=e)for(let m=0;m<h;m++,a++,f+=J.BYTES_PER_PIXEL){var l=d[a]/255|0;l>0&&0!=
c[f+J.ALPHA_BYTE_OFFSET]&&(l=(l+255)/255,b[f+J.RED_BYTE_OFFSET]=c[f+J.RED_BYTE_OFFSET]*l,b[f+J.GREEN_BYTE_OFFSET]=c[f+J.GREEN_BYTE_OFFSET]*l,b[f+J.BLUE_BYTE_OFFSET]=c[f+J.BLUE_BYTE_OFFSET]*l)}}mergeOntoMask(b,c,d){d=this._strokeBuffer.data;var a=this._strokedRegion;let h=a.getWidth(),q=a.getHeight(),f=b.offsetOfPixel(a.left,a.top);a=this._strokeBuffer.offsetOfPixel(a.left,a.top);let e=b.width-h,k=this._strokeBuffer.width-h;c=c.data;b=b.data;for(let l=0;l<q;l++,a+=k,f+=e)for(let g=0;g<h;g++,a++,f++){let m=
d[a]/255|0;m>0&&(b[f]=Math.min((m+255)/255*c[f],255))}}}class dg extends fd{mergeOntoImage(b,c,d){d=this._strokeBuffer.data;var a=this._strokedRegion;let h=a.getWidth(),q=a.getHeight(),f=b.offsetOfPixel(a.left,a.top);a=this._strokeBuffer.offsetOfPixel(a.left,a.top);let e=(b.width-h)*J.BYTES_PER_PIXEL,k=this._strokeBuffer.width-h;c=c.data;b=b.data;for(let l=0;l<q;l++,a+=k,f+=e)for(let g=0;g<h;g++,a++,f+=J.BYTES_PER_PIXEL){let m=d[a]/255|0;m>0&&0!=c[f+J.ALPHA_BYTE_OFFSET]&&(b[f+J.RED_BYTE_OFFSET]=c[f+
J.RED_BYTE_OFFSET]-(260-c[f+J.RED_BYTE_OFFSET])*m/255|0,b[f+J.GREEN_BYTE_OFFSET]=c[f+J.GREEN_BYTE_OFFSET]-(260-c[f+J.GREEN_BYTE_OFFSET])*m/255|0,b[f+J.BLUE_BYTE_OFFSET]=c[f+J.BLUE_BYTE_OFFSET]-(260-c[f+J.BLUE_BYTE_OFFSET])*m/255|0)}}mergeOntoMask(b,c,d){d=this._strokeBuffer.data;var a=this._strokedRegion;let h=a.getWidth(),q=a.getHeight(),f=b.offsetOfPixel(a.left,a.top);a=this._strokeBuffer.offsetOfPixel(a.left,a.top);let e=b.width-h,k=this._strokeBuffer.width-h;c=c.data;b=b.data;for(let l=0;l<q;l++,
a+=k,f+=e)for(let g=0;g<h;g++,a++,f++){let m=d[a]/255|0;m>0&&(b[f]=Math.max(c[f]-(260-c[f])*m/255,0))}}}class eg extends fd{mergeOntoImage(b,c,d){d=this._strokeBuffer.data;let a=this._strokedRegion,h=c.data;b=b.data;var q=a.getWidth();let f=c.width*J.BYTES_PER_PIXEL,e=c.offsetOfPixel(a.left,a.top),k=this._strokeBuffer.offsetOfPixel(a.left,a.top),l=(c.width-q)*J.BYTES_PER_PIXEL;q=this._strokeBuffer.width-q;let g,m,p,n,t=function(v){g+=h[v+J.RED_BYTE_OFFSET];m+=h[v+J.GREEN_BYTE_OFFSET];p+=h[v+J.BLUE_BYTE_OFFSET];
n+=h[v+J.ALPHA_BYTE_OFFSET]};for(let v=a.top;v<a.bottom;v++,e+=l,k+=q)for(let A=a.left;A<a.right;A++,e+=J.BYTES_PER_PIXEL,k++){var u=d[k]/255|0;if(u>0){u=64+-63*u/255|0;let D=u+4;g=u*h[e+J.RED_BYTE_OFFSET];m=u*h[e+J.GREEN_BYTE_OFFSET];p=u*h[e+J.BLUE_BYTE_OFFSET];n=u*h[e+J.ALPHA_BYTE_OFFSET];t(v>0?e-f:e);t(v<c.height-1?e+f:e);t(A>0?e-J.BYTES_PER_PIXEL:e);t(A<c.width-1?e+J.BYTES_PER_PIXEL:e);n/=D;g/=D;m/=D;p/=D;b[e+J.RED_BYTE_OFFSET]=0|g;b[e+J.GREEN_BYTE_OFFSET]=0|m;b[e+J.BLUE_BYTE_OFFSET]=0|p;b[e+
J.ALPHA_BYTE_OFFSET]=0|n}}}mergeOntoMask(b,c,d){d=this._strokeBuffer.data;let a=this._strokedRegion,h=c.data;b=b.data;var q=a.getWidth();let f=c.width,e=c.offsetOfPixel(a.left,a.top),k=this._strokeBuffer.offsetOfPixel(a.left,a.top),l=c.width-q;q=this._strokeBuffer.width-q;for(let p=a.top;p<a.bottom;p++,e+=l,k+=q)for(let n=a.left;n<a.right;n++,e++,k++){var g=d[k]/255|0;if(g>0){var m=64+-63*g/255|0;g=m+4;m=m*h[e]+h[p>0?e-f:e]+h[p<c.height-1?e+f:e]+h[n>0?e-1:e]+h[n<c.width-1?e+1:e];b[e]=m/g|0}}}}class De extends fd{mergeOntoImage(b,
c,d){d=this._strokeBuffer.data;var a=this._strokedRegion;c=c.data;let h=b.data,q=this._strokeBuffer.offsetOfPixel(a.left,a.top),f=b.offsetOfPixel(a.left,a.top),e=0|a.getWidth();a=0|a.getHeight();let k=this._strokeBuffer.width-e|0;b=(b.width-e)*J.BYTES_PER_PIXEL|0;for(let m=0;m<a;m++,q+=k,f+=b)for(let p=0;p<e;p++,q++,f+=J.BYTES_PER_PIXEL){let n=d[q];var l=n>>>24;if(l>0){var g=c[f+J.ALPHA_BYTE_OFFSET];g=l+g-l*g/255|0;l=255*l/g|0;let t=255-l;h[f]=((n>>16&255)*l+c[f]*t)/255|0;h[f+1]=((n>>8&255)*l+c[f+
1]*t)/255|0;h[f+2]=((255&n)*l+c[f+2]*t)/255|0;h[f+3]=g}}}mergeOntoMask(b,c,d){d=this._strokeBuffer.data;var a=this._strokedRegion;c=c.data;let h=b.data,q=this._strokeBuffer.offsetOfPixel(a.left,a.top),f=b.offsetOfPixel(a.left,a.top),e=0|a.getWidth();a=0|a.getHeight();let k=this._strokeBuffer.width-e|0;b=b.width-e|0;for(let l=0;l<a;l++,q+=k,f+=b)for(let g=0;g<e;g++,q++,f++){let m=d[q],p=m>>8;p>0&&(h[f]=((255&m)*p+c[f]*(255-p))/255|0)}}}let Bf=2/6;class ud extends De{static _sampleGrey(b,c,d,a,h){c|=
0;d|=0;let q=[{x:c,y:d}];for(let f=.25;f<1.001;f+=.25)Array.prototype.push.apply(q,[{x:~~(c+f*a),y:d},{x:~~(c-f*a),y:d},{x:c,y:~~(d+f*h)},{x:c,y:~~(d-f*h)},{x:~~(c+.7*f*a),y:~~(d+.7*f*h)},{x:~~(c+.7*f*a),y:~~(d-.7*f*h)},{x:~~(c-.7*f*a),y:~~(d+.7*f*h)},{x:~~(c-.7*f*a),y:~~(d-.7*f*h)}]);return Ve(q.map(f=>b.getPixel(f.x,f.y)))}static _sampleRGB(b,c,d,a,h,q){let f=b.width,e=b.height,k=b.data,l=0,g=0,m=0,p=0;b=(n,t)=>{n=~~n;t=~~t;n>=0&&t>=0&&n<f&&t<e&&(t=(t*f+n)*4,k[t+3]>0&&(l+=k[t],g+=k[t+1],m+=k[t+
2],p++))};b(c,d);for(let n=.25;n<1.001;n+=.25){let t=n*a,u=n*h,v=.7*t,A=.7*u;b(c+t,d);b(c-t,d);b(c,d+u);b(c,d-u);b(c+v,d+A);b(c+v,d-A);b(c-v,d+A);b(c-v,d-A)}return 0===p?q:rc.createFromInt(-16777216|(l/p|0)<<16|(g/p|0)<<8|m/p|0)}_paintToColorStrokeBuffer(b,c,d,a,h,q){let f=this._strokeBuffer.data,e=c.getWidth(),k=c.getHeight(),l=this._strokeBuffer.width-e,g=a-e;b=b.left+b.top*a;a=this._strokeBuffer.offsetOfPixel(c.left,c.top);this._strokedRegion.union(c);for(c=0;c<k;c++,b+=g,a+=l)for(let n=0;n<e;n++,
b++,a++){var m=d[b]*h/255|0;if(m>0){let t=f[a];var p=t>>>24;p=m+p-m*p/255|0;m=255-(255*m/p|0);f[a]=p<<24|(q>>16&255)+((t>>16&255)*m-(q>>16&255)*m)/255<<16|(q>>8&255)+((t>>8&255)*m-(q>>8&255)*m)/255<<8|(255&q)+((255&t)*m-(255&q)*m)/255}}}_paintToGreyscaleStrokeBuffer(b,c,d,a,h,q){let f=this._strokeBuffer.data;this._strokedRegion.union(c);for(let l=c.top,g=b.top;l<c.bottom;l++,g++){let m=b.left+g*a,p=this._strokeBuffer.offsetOfPixel(c.left,l);for(let n=c.left;n<c.right;n++,m++,p++){var e=d[m]*h/255|
0;if(e<=0)continue;let t=f[p];var k=t>>8;k=e+k-e*k/255|0;k>0&&(e=255-(255*e/k|0),f[p]=k<<8|q+((255&t)*e-q*e)/255)}}}beginStroke(){this._previousSamples=null}paintDab(b,c,d,a,h,q,f){b=this.isTransparentCanvas?.3:1;q.alpha=247/254*(q.alpha-1)+8;q.alpha*=b;var e,k;b=Math.max(1,q.alpha/4);var l=(c.left+c.right)/2,g=(c.top+c.bottom)/2,m=Math.max(1,Math.min(64,c.getWidth()*Bf)),p=Math.max(1,Math.min(64,c.getHeight()*Bf));if(d instanceof Pa){null==this._previousSamples&&(this._previousSamples=Array(50),
this._previousSamples.fill(ud._sampleGrey(d,l,g,m,p)));var n=Ve(this._previousSamples);var t=n;f=t=n=t*(1-(e=a.resat*a.resat))+(255&f)*e;d=ud._sampleGrey(d,l,g,m,p);n=f*(1-(k=a.bleed))+d*k;this._previousSamples.push(n);this._previousSamples.shift();this._paintToGreyscaleStrokeBuffer(h,c,q.brush,q.width,b,Math.round(t))}else{null==this._previousSamples&&(this._previousSamples=Array(50),k=rc.createFromInt(f),this._previousSamples.fill(ud._sampleRGB(d,l,g,m,p,k)));k=this._previousSamples;e=new rc(0,
0,0);for(t=0;t<k.length;t++)n=k[t],e.r+=n.r,e.g+=n.g,e.b+=n.b;k=(e.r/=k.length,e.g/=k.length,e.b/=k.length,e);k.mixWith(rc.createFromInt(f),a.resat*a.resat);e=k.toInt();f=rc.createFromInt(f);d=ud._sampleRGB(d,l,g,m,p,f);this.isTransparentCanvas=f===d;k.mixWith(d,a.bleed);this._previousSamples.push(k);this._previousSamples.shift();this._paintToColorStrokeBuffer(h,c,q.brush,q.width,b,e)}}constructor(b,c){super(b,c);this.wantsOutputAsInput=!0}}class gg extends De{_accumulatePaintFromMask(b,c,d,a){let h=
this._brushBuffer.data,q=b.data,f=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=b.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-f;b=b.width-f;if(!(a<=0))for(let g=0;g<e;g++,c+=k,d+=b)for(let m=0;m<f;m++,c++,d++){let p=q[d],n=h[c];var l=n>>8;l=a+l-a*l/255|0;let t=255-(255*a/l|0);h[c]=l<<8|p+((255&n)*t-p*t)/255}}_resaturateBrushWithGrey(b,c,d){if(!(c<=0)){var a=this._brushBuffer.data,h=b.getWidth(),q=b.getHeight();b=b.left+b.top*this._brushBuffer.width;var f=this._brushBuffer.width-
h;for(let k=0;k<q;k++,b+=f)for(let l=0;l<h;l++,b++){let g=a[b];var e=g>>8;e=c+e-c*e/255|0;let m=255-(255*c/e|0);a[b]=e<<8|d+((255&g)*m-d*m)/255}}}_paintToGreyscaleStrokeBuffer(b,c,d,a,h){let q=this._strokeBuffer.data,f=this._brushBuffer.data,e=b.data;this._strokedRegion.union(d);for(let l=d.top,g=c.top;l<d.bottom;l++,g++){let m=this._brushBuffer.offsetOfPixel(c.left,g),p=this._strokeBuffer.offsetOfPixel(d.left,l),n=b.offsetOfPixel(d.left,l);for(let t=d.left;t<d.right;t++,m++,n++,p++){let u=f[m];var k=
(u>>8)*a[m]*h/65025|0;k>0&&(k=255-k,q[p]=65280|(255&u)+(e[n]*k-(255&u)*k)/255)}}}_accumulatePaintFromImage(b,c,d,a){let h=this._brushBuffer.data,q=b.data,f=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=b.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-f;b=(b.width-f)*J.BYTES_PER_PIXEL;for(let m=0;m<e;m++,c+=k,d+=b)for(let p=0;p<f;p++,c++,d+=J.BYTES_PER_PIXEL){var l=q[d+J.ALPHA_BYTE_OFFSET]*a/255|0;if(l>0){let n=h[c];var g=n>>>24;g=l+g-l*g/255|0;l=255-(255*l/g|0);
let t=q[d+J.RED_BYTE_OFFSET],u=q[d+J.GREEN_BYTE_OFFSET],v=q[d+J.BLUE_BYTE_OFFSET];h[c]=g<<24|t+((n>>16&255)*l-t*l)/255<<16|u+((n>>8&255)*l-u*l)/255<<8|v+((255&n)*l-v*l)/255}}}_resaturateBrushWithColor(b,c,d){if(!(c<=0)){var a=this._brushBuffer.data,h=b.getWidth(),q=b.getHeight();b=b.left+b.top*this._brushBuffer.width;var f=this._brushBuffer.width-h;for(let k=0;k<q;k++,b+=f)for(let l=0;l<h;l++,b++){let g=a[b];var e=g>>>24;e=c+e-c*e/255|0;let m=255-(255*c/e|0);a[b]=e<<24|(d>>>16&255)+((g>>>16&255)*
m-(d>>>16&255)*m)/255<<16|(d>>>8&255)+((g>>>8&255)*m-(d>>>8&255)*m)/255<<8|(255&d)+((255&g)*m-(255&d)*m)/255}}}_paintToColorStrokeBuffer(b,c,d,a,h){let q=this._strokeBuffer.data,f=this._brushBuffer.data,e=b.data;this._strokedRegion.union(d);for(let g=d.top,m=c.top;g<d.bottom;g++,m++){let p=this._brushBuffer.offsetOfPixel(c.left,m),n=this._strokeBuffer.offsetOfPixel(d.left,g),t=b.offsetOfPixel(d.left,g);for(let u=d.left;u<d.right;u++,p++,t+=J.BYTES_PER_PIXEL,n++){let v=f[p];var k=(v>>>24)*a[p]*h/65025|
0;if(k>0){var l=e[t+J.ALPHA_BYTE_OFFSET];l=k+l-k*l/255|0;k=255-(255*k/l|0);q[n]=l<<24|(v>>16&255)+(e[t+J.RED_BYTE_OFFSET]*k-(v>>16&255)*k)/255<<16|(v>>8&255)+(e[t+J.GREEN_BYTE_OFFSET]*k-(v>>8&255)*k)/255<<8|(255&v)+(e[t+J.BLUE_BYTE_OFFSET]*k-(255&v)*k)/255}}}}paintDab(b,c,d,a,h,q,f){b instanceof J?null==this._brushBuffer?(this._brushBuffer=new Pa(q.width,q.height,32),this._accumulatePaintFromImage(d,h,c,255)):(this._resaturateBrushWithColor(h,~~(a.resat<=0?0:Math.max(1,a.resat*a.resat*255)),16777215&
f),this._paintToColorStrokeBuffer(b,h,c,q.brush,q.alpha),this._accumulatePaintFromImage(d,h,c,~~(255*a.bleed))):null==this._brushBuffer?(this._brushBuffer=new Pa(q.width,q.height,16),this._accumulatePaintFromMask(d,h,c,255)):(this._resaturateBrushWithGrey(h,~~(a.resat<=0?0:Math.max(1,a.resat*a.resat*255)),255&f),this._paintToGreyscaleStrokeBuffer(b,h,c,q.brush,q.alpha),this._accumulatePaintFromMask(d,h,c,~~(255*a.bleed)))}endStroke(){this._brushBuffer=null}constructor(b,c){super(b,c);this.wantsOutputAsInput=
!0;this.isTransparentCanvas=!1}}class fg extends De{_sampleFromMask(b,c,d,a){let h=this._brushBuffer.data,q=c.getWidth(),f=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=b.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-q,l=b.width-q,g=255-a;if(255!=a){for(let m=0;m<f;m++,e+=k,d+=l)for(let p=0;p<q;p++,e++,d++){let n=b.data[d],t=h[e],u=(n*g+(255&t)*a)/255,v=(255*g+(t>>8)*a)/255<<8|u;v==t&&(n>u?v++:n<u&&v--);h[e]=v}We(this._brushBuffer,c)}}_paintToMask(b,c,d,a){let h=c.getWidth(),
q=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=b.offsetOfPixel(d.left,d.top);let f=this._brushBuffer.width-h,e=b.width-h;b=b.data;let k=this._brushBuffer.data;for(let l=0;l<q;l++,d+=e,c+=f)for(let g=0;g<h;g++,c++,d++){let m=k[c],p=255&m;((m>>8)*a[c]/255|0)>0&&(b[d]=p)}}_sampleFromImage(b,c,d,a){let h=this._brushBuffer.data,q=c.getWidth(),f=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=b.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-q,l=(b.width-q)*
J.BYTES_PER_PIXEL,g=255-a;if(255!=a){for(let p=0;p<f;p++,e+=k,d+=l)for(let n=0;n<q;n++,e++,d+=J.BYTES_PER_PIXEL){let t=b.data[d+J.RED_BYTE_OFFSET],u=b.data[d+J.GREEN_BYTE_OFFSET],v=b.data[d+J.BLUE_BYTE_OFFSET];var m=h[e];let A=(b.data[d+J.ALPHA_BYTE_OFFSET]*g+(m>>24&255)*a)/255<<24&4278190080|(t*g+(m>>16&255)*a)/255<<16&16711680|(u*g+(m>>8&255)*a)/255<<8&65280|(v*g+(255&m)*a)/255&255;if(A==m){m=(16711680&A)>>16;let D=(65280&A)>>8,y=255&A;t>m?A+=65536:t<m&&(A-=65536);u>D?A+=256:u<D&&(A-=256);v>y?A+=
1:v<y&&--A}h[e]=A}We(this._brushBuffer,c)}}_paintToImage(b,c,d,a){let h=c.getWidth(),q=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=b.offsetOfPixel(d.left,d.top);let f=this._brushBuffer.width-h,e=(b.width-h)*J.BYTES_PER_PIXEL;b=b.data;let k=this._brushBuffer.data;for(let l=0;l<q;l++,d+=e,c+=f)for(let g=0;g<h;g++,c++,d+=J.BYTES_PER_PIXEL){let m=k[c];((m>>>24)*a[c]/255|0)>0&&(b[d+J.RED_BYTE_OFFSET]=m>>16&255,b[d+J.GREEN_BYTE_OFFSET]=m>>8&255,b[d+J.BLUE_BYTE_OFFSET]=255&m,b[d+J.ALPHA_BYTE_OFFSET]=
m>>24&255)}}paintDab(b,c,d,a,h,q,f){b instanceof J?null==this._brushBuffer?(this._brushBuffer=new Pa(q.width,q.height,32),this._sampleFromImage(d,h,c,0)):(this._sampleFromImage(d,h,c,q.alpha),this._paintToImage(b,h,c,q.brush)):null==this._brushBuffer?(this._brushBuffer=new Pa(q.width,q.height,16),this._sampleFromMask(d,h,c,0)):(this._sampleFromMask(d,h,c,q.alpha),this._paintToMask(b,h,c,q.brush))}mergeOntoImage(b,c,d){}mergeOntoMask(b,c,d){}beginStroke(){this._brushBuffer=null}endStroke(){this._brushBuffer=
null}constructor(b,c){super(b,c);this._brushBuffer=null;this.noMergePhase=this.wantsOutputAsInput=!0}}dc.prototype=Object.create(Ja(Hb).prototype);dc.prototype.constructor=dc;dc.prototype.getBounds=function(){return new Ba(0,0,this.width,this.height)};dc.prototype.isPointWithin=function(b,c){return b>=0&&c>=0&&b<this.width&&c<this.height};dc.EDITING_MODE_IMAGE=0;dc.EDITING_MODE_MASK=1;gb.prototype.readChar=function(){return this.pos<this.end?String.fromCharCode(this.data[this.pos++]):(this.eof=!0,
-1)};gb.prototype.readByte=function(){return this.pos<this.end?this.data[this.pos++]:(this.eof=!0,-1)};gb.prototype.readU8=gb.prototype.readByte;gb.prototype.readS8=function(){var b;return 128&(b=this.readByte())?4294967040|b:b};gb.prototype.unreadChar=function(b){this.pos--};gb.prototype.peekChar=function(){return this.pos<this.end?String.fromCharCode(this.data[this.pos]):(this.eof=!0,-1)};gb.prototype.readString=function(b){var c,d=Array(b);for(c=0;c<b;c++)d[c]=this.readChar();return d.join("")};
gb.prototype.readS16=function(){var b;return 32768&(b=this.readByte()<<8|this.readByte())?4294901760|b:b};gb.prototype.readU16BE=function(){return this.readByte()<<8|this.readByte()};gb.prototype.readU16LE=function(){var b=this.readByte();return this.readByte()<<8|b};gb.prototype.readU32BE=function(){return(this.readByte()<<24|this.readByte()<<16|this.readByte()<<8|this.readByte())>>>0};gb.prototype.readU32LE=function(){var b=this.readByte(),c=this.readByte(),d=this.readByte();return(this.readByte()<<
24|d<<16|c<<8|b)>>>0};gb.prototype.readBytes=function(b){var c=this.data.subarray(this.pos,this.pos+b);return this.pos+=b,this.pos>this.end&&(this.eof=!0),c};gb.prototype.skip=function(b){this.pos+=b;this.pos>this.end&&(this.eof=!0)};gb.prototype.seek=function(b){this.pos=b};gb.prototype.writeBytes=function(b){for(var c=0;c<b.length;c++)this.data[this.pos++]=b[c]};gb.prototype.writeByte=function(b){this.data[this.pos++]=b};gb.prototype.writeU8=gb.prototype.writeByte;gb.prototype.writeU16LE=function(b){this.data[this.pos++]=
b;this.data[this.pos++]=b>>8};gb.prototype.writeU16BE=function(b){this.data[this.pos++]=b>>8;this.data[this.pos++]=b};gb.prototype.writeU32BE=function(b){this.data[this.pos++]=b>>24;this.data[this.pos++]=b>>16;this.data[this.pos++]=b>>8;this.data[this.pos++]=b};gb.prototype.writeU32LE=function(b){this.data[this.pos++]=b;this.data[this.pos++]=b>>8;this.data[this.pos++]=b>>16;this.data[this.pos++]=b>>24};gb.prototype.writeDoubleBE=function(b){b=new Uint8Array((new Float64Array([b])).buffer);for(var c=
b.length-1;c>=0;c--)this.writeByte(b[c])};gb.prototype.writeFloatBE=function(b){b=new Uint8Array((new Float32Array([b])).buffer);for(var c=b.length-1;c>=0;c--)this.writeByte(b[c])};gb.prototype.writeString=function(b){for(var c=0;c<b.length;c++)this.data[this.pos++]=b.charCodeAt(c)};gb.prototype.writeUnsignedIntBE=function(b,c){switch(void 0===c&&(c=this.measureUnsignedInt(b)),c){case 5:this.writeU8(Math.floor(b/4294967296));case 4:this.writeU8(b>>24);case 3:this.writeU8(b>>16);case 2:this.writeU8(b>>
8);case 1:this.writeU8(b);break;default:throw"Bad UINT size "+c;}};gb.prototype.measureUnsignedInt=function(b){return b<256?1:b<65536?2:b<16777216?3:b<4294967296?4:5};gb.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw"ArrayDataStream's pos lies beyond end of buffer";};gb.prototype.EOF=-1;var Ib=Uint8Array,nc=Uint16Array,Ee=Int32Array,ce=new Ib([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,
3,4,4,4,4,5,5,5,5,0,0,0,0]),de=new Ib([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fe=new Ib([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Cf=function(b,c){for(var d=new nc(31),a=0;a<31;++a)d[a]=c+=1<<b[a-1];b=new Ee(d[30]);for(a=1;a<30;++a)for(c=d[a];c<d[a+1];++c)b[c]=c-d[a]<<5|a;return{b:d,r:b}},Df=Cf(ce,2),Ef=Df.b,Ge=Df.r;Ef[28]=258;Ge[258]=28;for(var Ff=Cf(de,0),Pg=Ff.b,Gf=Ff.r,He=new nc(32768),Cb=0;Cb<32768;++Cb){var cd=(43690&Cb)>>1|(21845&Cb)<<1;cd=(61680&
(cd=(52428&cd)>>2|(13107&cd)<<2))>>4|(3855&cd)<<4;He[Cb]=((65280&cd)>>8|(255&cd)<<8)>>1}var zc=function(b,c,d){for(var a=b.length,h=0,q=new nc(c);h<a;++h)b[h]&&++q[b[h]-1];var f=new nc(c);for(h=1;h<c;++h)f[h]=f[h-1]+q[h-1]<<1;if(d)for(d=new nc(1<<c),q=15-c,h=0;h<a;++h){if(b[h]){var e=h<<4|b[h],k=c-b[h],l=f[b[h]-1]++<<k;for(k=l|(1<<k)-1;l<=k;++l)d[He[l]>>q]=e}}else for(h=0,d=new nc(a);h<a;++h)b[h]&&(d[h]=He[f[b[h]-1]++]>>15-b[h]);return d},Pc=new Ib(288);for(Cb=0;Cb<144;++Cb)Pc[Cb]=8;for(Cb=144;Cb<
256;++Cb)Pc[Cb]=9;for(Cb=256;Cb<280;++Cb)Pc[Cb]=7;for(Cb=280;Cb<288;++Cb)Pc[Cb]=8;var Ad=new Ib(32);for(Cb=0;Cb<32;++Cb)Ad[Cb]=5;var Qg=zc(Pc,9,0),Rg=zc(Pc,9,1),Sg=zc(Ad,5,0),Tg=zc(Ad,5,1),Ie=function(b){for(var c=b[0],d=1;d<b.length;++d)b[d]>c&&(c=b[d]);return c},vc=function(b,c,d){var a=c/8|0;return(b[a]|b[a+1]<<8)>>(7&c)&d},Je=function(b,c){var d=c/8|0;return(b[d]|b[d+1]<<8|b[d+2]<<16)>>(7&c)},Bd=function(b,c,d){return(null==c||c<0)&&(c=0),(null==d||d>b.length)&&(d=b.length),new Ib(b.subarray(c,
d))},Ug=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Wb=function(b,c,d){c=Error(c||Ug[b]);if(c.code=b,Error.captureStackTrace&&Error.captureStackTrace(c,Wb),!d)throw c;return c},$e=function(b,c,d,a){var h=b.length,q=a?a.length:0;if(!h||c.f&&!c.l)return d||new Ib(0);var f=!d,e=
f||2!=c.i,k=c.i;f&&(d=new Ib(3*h));var l=function(O){var B=d.length;O>B&&(O=new Ib(Math.max(2*B,O)),O.set(d),d=O)},g=c.f||0,m=c.p||0,p=c.b||0,n=c.l,t=c.d,u=c.m,v=c.n,A=8*h;do{if(!n){g=vc(b,m,1);var D=vc(b,m+1,3);if(m+=3,D)if(1==D)n=Rg,t=Tg,u=9,v=5;else if(2==D){u=vc(b,m,31)+257;t=vc(b,m+10,15)+4;n=u+vc(b,m+5,31)+1;m+=14;v=new Ib(n);var y=new Ib(19);for(D=0;D<t;++D)y[Fe[D]]=vc(b,m+3*D,7);m+=3*t;D=Ie(y);t=(1<<D)-1;var E=zc(y,D,1);for(D=0;D<n;)if(y=E[vc(b,m,t)],m+=15&y,y>>=4,y<16)v[D++]=y;else{var x=
0,G=0;for(16==y?(G=3+vc(b,m,3),m+=2,x=v[D-1]):17==y?(G=3+vc(b,m,7),m+=3):18==y&&(G=11+vc(b,m,127),m+=7);G--;)v[D++]=x}n=v.subarray(0,u);D=v.subarray(u);u=Ie(n);v=Ie(D);n=zc(n,u,1);t=zc(D,v,1)}else Wb(1);else{y=((m+7)/8|0)+4;m=b[y-4]|b[y-3]<<8;D=y+m;if(D>h){k&&Wb(0);break}e&&l(p+m);d.set(b.subarray(y,D),p);c.b=p+=m;c.p=m=8*D;c.f=g;continue}if(m>A){k&&Wb(0);break}}e&&l(p+131072);y=(1<<u)-1;E=(1<<v)-1;for(G=m;;G=m){x=n[Je(b,m)&y];D=x>>4;if((m+=15&x)>A){k&&Wb(0);break}if(x||Wb(2),D<256)d[p++]=D;else if(256==
D){G=m;n=null;break}else{x=D-254;if(D>264){D-=257;var I=ce[D];x=vc(b,m,(1<<I)-1)+Ef[D];m+=I}D=t[Je(b,m)&E];I=D>>4;D||Wb(3);m+=15&D;D=Pg[I];I>3&&(I=de[I],D+=Je(b,m)&(1<<I)-1,m+=I);if(m>A){k&&Wb(0);break}e&&l(p+131072);x=p+x;if(p<D)for(G=q-D,I=Math.min(D,x),G+p<0&&Wb(3);p<I;++p)d[p]=a[G+p];for(;p<x;++p)d[p]=d[p-D]}}c.l=n;c.p=G;c.b=p;c.f=g;n&&(g=1,c.m=u,c.d=t,c.n=v)}while(!g);return p!=d.length&&f?Bd(d,0,p):d.subarray(0,p)},Fc=function(b,c,d){d<<=7&c;c=c/8|0;b[c]|=d;b[c+1]|=d>>8},Cd=function(b,c,d){d<<=
7&c;c=c/8|0;b[c]|=d;b[c+1]|=d>>8;b[c+2]|=d>>16},Le=function(b,c){for(var d=[],a=0;a<b.length;++a)b[a]&&d.push({s:a,f:b[a]});var h=d.length;b=d.slice();if(!h)return{t:Hf,l:0};if(1==h)return c=new Ib(d[0].s+1),c[d[0].s]=1,{t:c,l:1};d.sort(function(g,m){return g.f-m.f});d.push({s:-1,f:25001});a=d[0];var q=d[1],f=0,e=1,k=2;for(d[0]={s:-1,f:a.f+q.f,l:a,r:q};e!=h-1;)a=d[d[f].f<d[k].f?f++:k++],q=d[f!=e&&d[f].f<d[k].f?f++:k++],d[e++]={s:-1,f:a.f+q.f,l:a,r:q};q=b[0].s;for(a=1;a<h;++a)b[a].s>q&&(q=b[a].s);
var l=new nc(q+1);e=Ke(d[e-1],l,0);if(e>c){d=a=0;q=e-c;f=1<<q;for(b.sort(function(g,m){return l[m.s]-l[g.s]||g.f-m.f});a<h;++a)if(k=b[a].s,l[k]>c)d+=f-(1<<e-l[k]),l[k]=c;else break;for(d>>=q;d>0;)h=b[a].s,l[h]<c?d-=1<<c-l[h]++-1:++a;for(;a>=0&&d;--a)h=b[a].s,l[h]==c&&(--l[h],++d);e=c}return{t:new Ib(l),l:e}},Ke=function(b,c,d){return-1==b.s?Math.max(Ke(b.l,c,d+1),Ke(b.r,c,d+1)):c[b.s]=d},If=function(b){for(var c=b.length;c&&!b[--c];);for(var d=new nc(++c),a=0,h=b[0],q=1,f=function(k){d[a++]=k},e=
1;e<=c;++e)if(b[e]==h&&e!=c)++q;else{if(!h&&q>2){for(;q>138;q-=138)f(32754);q>2&&(f(q>10?q-11<<5|28690:q-3<<5|12305),q=0)}else if(q>3){f(h);for(--q;q>6;q-=6)f(8304);q>2&&(f(q-3<<5|8208),q=0)}for(;q--;)f(h);q=1;h=b[e]}return{c:d.subarray(0,a),n:c}},Dd=function(b,c){for(var d=0,a=0;a<c.length;++a)d+=b[a]*c[a];return d},Jf=function(b,c,d){var a=d.length;c=(c+2+7)/8|0;b[c]=255&a;b[c+1]=a>>8;b[c+2]=255^b[c];b[c+3]=255^b[c+1];for(var h=0;h<a;++h)b[c+h+4]=d[h];return(c+4+a)*8},Kf=function(b,c,d,a,h,q,f,
e,k,l,g){Fc(c,g++,d);++h[256];d=Le(h,15);var m=d.t,p=d.l;d=Le(q,15);var n=d.t;var t=d.l;d=If(m);var u=d.c,v=d.n;d=If(n);for(var A=d.c,D=d.n,y=new nc(19),E=0;E<u.length;++E)++y[31&u[E]];for(E=0;E<A.length;++E)++y[31&A[E]];E=Le(y,7);d=E.t;E=E.l;for(var x=19;x>4&&!d[Fe[x-1]];--x);var G=l+5<<3,I=Dd(h,Pc)+Dd(q,Ad)+f;h=Dd(h,m)+Dd(q,n)+f+14+3*x+Dd(y,d)+2*y[16]+3*y[17]+7*y[18];if(k>=0&&G<=I&&G<=h)return Jf(c,g,b.subarray(k,k+l));if(Fc(c,g,1+(h<I)),g+=2,h<I){b=zc(m,p,0);k=m;l=zc(n,t,0);m=zc(d,E,0);Fc(c,g,
v-257);Fc(c,g+5,D-1);Fc(c,g+10,x-4);g+=14;for(E=0;E<x;++E)Fc(c,g+3*E,d[Fe[E]]);g+=3*x;v=[u,A];for(A=0;A<2;++A)for(D=v[A],E=0;E<D.length;++E)u=31&D[E],Fc(c,g,m[u]),g+=d[u],u>15&&(Fc(c,g,D[E]>>5&127),g+=D[E]>>12)}else b=Qg,k=Pc,l=Sg,n=Ad;for(E=0;E<e;++E)d=a[E],d>255?(u=d>>18&31,Cd(c,g,b[u+257]),g+=k[u+257],u>7&&(Fc(c,g,d>>23&31),g+=ce[u]),u=31&d,Cd(c,g,l[u]),g+=n[u],u>3&&(Cd(c,g,d>>5&8191),g+=de[u])):(Cd(c,g,b[d]),g+=k[d]);return Cd(c,g,b[256]),g+k[256]},Vg=new Ee([65540,131080,131088,131104,262176,
1048704,1048832,2114560,2117632]),Hf=new Ib(0),Wg=function(b,c,d,a,h,q){var f=q.z||b.length,e=new Ib(a+f+5*(1+Math.ceil(f/7E3))+h),k=e.subarray(a,e.length-h),l=q.l,g=7&(q.r||0);if(c){g&&(k[0]=q.r>>3);var m=Vg[c-1];c=m>>13;m&=8191;var p=(1<<d)-1,n=q.p||new nc(32768),t=q.h||new nc(p+1),u=Math.ceil(d/3),v=2*u,A=function(U){return(b[U]^b[U+1]<<u^b[U+2]<<v)&p},D=new Ee(25E3),y=new nc(288),E=new nc(32),x=0,G=0;d=q.i||0;for(var I=0,O=q.w||0,B=0;d+2<f;++d){var N=A(d),P=32767&d,L=t[N];if(n[P]=L,t[N]=P,O<=
d){var ia=f-d;if((x>7E3||I>24576)&&(ia>423||!l)){g=Kf(b,k,0,D,y,E,G,I,B,d-B,g);I=x=G=0;B=d;for(var V=0;V<286;++V)y[V]=0;for(V=0;V<30;++V)E[V]=0}var ma=2,da=0,Ca=m,ha=P-L&32767;if(ia>2&&N==A(d-ha)){N=Math.min(c,ia)-1;var sa=Math.min(32767,d);for(ia=Math.min(258,ia);ha<=sa&&--Ca&&P!=L;){if(b[d+ma]==b[d+ma-ha]){for(V=0;V<ia&&b[d+V]==b[d+V-ha];++V);if(V>ma){if(ma=V,da=ha,V>N)break;P=Math.min(ha,V-2);var ea=0;for(V=0;V<P;++V){var w=d-ha+V&32767,H=w-n[w]&32767;H>ea&&(ea=H,L=w)}}}L=n[P=L];ha+=P-L&32767}}da?
(D[I++]=268435456|Ge[ma]<<18|Gf[da],O=31&Ge[ma],da=31&Gf[da],G+=ce[O]+de[da],++y[257+O],++E[da],O=d+ma,++x):(D[I++]=b[d],++y[b[d]])}}for(d=Math.max(d,O);d<f;++d)D[I++]=b[d],++y[b[d]];g=Kf(b,k,l,D,y,E,G,I,B,d-B,g);l||(q.r=7&g|k[g/8|0]<<3,g-=7,q.h=t,q.p=n,q.i=d,q.w=O)}else{for(d=q.w||0;d<f+l;d+=65535)c=d+65535,c>=f&&(k[g/8|0]=l,c=f),g=Jf(k,g+1,b.subarray(d,c));q.i=f}return Bd(e,0,a+((g+7)/8|0)+h)};(function(){for(var b=new Int32Array(256),c=0;c<256;++c){for(var d=c,a=9;--a;)d=(1&d&&-306674912)^d>>>
1;b[c]=d}return b})();var Lf=function(){var b=1,c=0;return{p:function(d){for(var a=b,h=c,q=0|d.length,f=0;f!=q;){for(var e=Math.min(f+2655,q);f<e;++f)h+=a+=d[f];a=(65535&a)+15*(a>>16);h=(65535&h)+15*(h>>16)}b=a;c=h},d:function(){return b%=65521,c%=65521,(255&b)<<24|(65280&b)<<8|(255&c)<<8|c>>8}}},Mf=function(b,c,d,a,h){if(!h&&(h={l:1},c.dictionary)){var q=c.dictionary.subarray(-32768),f=new Ib(q.length+b.length);f.set(q);f.set(b,q.length);b=f;h.w=q.length}return Wg(b,null==c.level?6:c.level,null==
c.mem?h.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(b.length)))):20:12+c.mem,d,a,h)},Me=function(){function b(c,d){if("function"==typeof c&&(d=c,c={}),this.ondata=d,this.o=c||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new Ib(98304),this.o.dictionary)c=this.o.dictionary.subarray(-32768),this.b.set(c,32768-c.length),this.s.i=32768-c.length}return b.prototype.p=function(c,d){this.ondata(Mf(c,this.o,0,0,this.s),d)},b.prototype.push=function(c,d){this.ondata||Wb(5);this.s.l&&Wb(4);var a=c.length+
this.s.z;a>this.b.length?(a>2*this.b.length-32768&&(a=new Ib(-32768&a),a.set(this.b.subarray(0,this.s.z)),this.b=a),a=this.b.length-this.s.z,this.b.set(c.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(c.subarray(a),32768),this.s.z=c.length-a+32768,this.s.i=32766,this.s.w=32768):(this.b.set(c,this.s.z),this.s.z+=c.length);this.s.l=1&d;(this.s.z>this.s.w+8191||d)&&(this.p(this.b,d||!1),this.s.w=this.s.i,this.s.i-=2)},b.prototype.flush=
function(){this.ondata||Wb(5);this.s.l&&Wb(4);this.p(this.b,!1);this.s.w=this.s.i;this.s.i-=2},b}();(function(){function b(c,d){"function"==typeof c&&(d=c,c={});this.ondata=d;c=c&&c.dictionary&&c.dictionary.subarray(-32768);this.s={i:0,b:c?c.length:0};this.o=new Ib(32768);this.p=new Ib(0);c&&this.o.set(c)}return b.prototype.e=function(c){if(this.ondata||Wb(5),this.d&&Wb(4),this.p.length){if(c.length){var d=new Ib(this.p.length+c.length);d.set(this.p);d.set(c,this.p.length);this.p=d}}else this.p=c},
b.prototype.c=function(c){this.s.i=+(this.d=c||!1);c=this.s.b;var d=$e(this.p,this.s,this.o);this.ondata(Bd(d,c,this.s.b),this.d);this.o=Bd(d,this.s.b-32768);this.s.b=this.o.length;this.p=Bd(this.p,this.s.p/8|0);this.s.p&=7},b.prototype.push=function(c,d){this.e(c);this.c(d)},b})();var qg=function(){function b(c,d){this.c=Lf();this.v=1;Me.call(this,c,d)}return b.prototype.push=function(c,d){this.c.p(c);Me.prototype.push.call(this,c,d)},b.prototype.p=function(c,d){c=Mf(c,this.o,this.v&&(this.o.dictionary?
6:2),d&&4,this.s);if(this.v){var a=this.o,h=a.level;if(c[0]=120,c[1]=(0==h?0:h<6?1:9==h?3:2)<<6|(a.dictionary&&32),c[1]|=31-(c[0]<<8|c[1])%31,a.dictionary)for(h=Lf(),h.p(a.dictionary),a=2,h=h.d();h;++a)c[a]=h,h>>>=8;this.v=0}if(d)for(a=c.length-4,h=this.c.d();h;++a)c[a]=h,h>>>=8;this.ondata(c,d)},b.prototype.flush=function(){Me.prototype.flush.call(this)},b}(),Xg=("u">typeof TextEncoder,"u">typeof TextDecoder&&new TextDecoder);try{Xg.decode(Hf,{stream:!0})}catch(b){}"function"==typeof queueMicrotask&&
queueMicrotask;le.FIXED_HEADER_LENGTH=16;Hd.HEADER_LENGTH=8;class Nf{readFixedHeader(b){this.payloadOffset=b.readU32BE();this.blendMode=b.readU32BE();this.alpha=b.readU32BE();let c=b.readU32BE();this.visible=(1&c)!=0;this.clip=(2&c)!=0;this.hasMask=(4&c)!=0;this.maskLinked=(8&c)!=0;this.maskVisible=(16&c)!=0;this.expanded=(32&c)!=0;this.lockAlpha=(64&c)!=0;this.blendMode===Q.LM_MULTIPLY&&(128&c)!=0&&(this.blendMode=Q.LM_MULTIPLY2);this.nameLength=b.readU32BE()}getFixedHeaderLen(){return 20}getVariableHeaderLen(){return this.nameLength}readVariableSizeHeader(b){b=
b.readString(this.nameLength);let c=new Uint8Array(b.length);for(let d=0;d<b.length;d++)c[d]=255&b.charCodeAt(d);try{this.name=(new TextDecoder("utf-8")).decode(c)}catch(d){this.name=b}}decode(b){for(var c;;){if(this.skipBytes>0){if(this.skipBytes>=b.length)return this.skipBytes-=b.length,null;b=b.subarray(this.skipBytes);this.skipBytes=0}switch(this.state){case 0:if(b.length<this.getFixedHeaderLen())break;c=new gb(b);this.readFixedHeader(c);b=b.subarray(c.pos);this.state=1;continue;case 1:if(b.length<
this.getVariableHeaderLen())break;c=new gb(b);this.readVariableSizeHeader(c);this.layer=this.createLayer();this.hasMask&&(this.layer.setMask(new Pa(this.width,this.height,8)),this.maskDecoder=new Yg(this.layer.mask));this.layer instanceof Fa&&(this.colorDecoder=new Zg(this.layer.image));this.skipBytes=this.payloadOffset-this.getFixedHeaderLen();this.colorDecoder?this.state=3:this.maskDecoder?this.state=4:this.state=5;continue;case 3:if(b=this.colorDecoder.decode(b),this.colorDecoder.done){this.maskDecoder?
this.state=4:this.state=5;continue}break;case 4:if(b=this.maskDecoder.decode(b),this.maskDecoder.done){this.state=5;continue}break;case 5:c=this.payloadOffset;this.colorDecoder&&(c+=this.colorDecoder.bytesTotal);this.maskDecoder&&(c+=this.maskDecoder.bytesTotal);this.state=6;this.skipBytes=this.chunkHeader.chunkSize-c;continue;case 6:this.done=!0}break}return b}constructor(b,c,d){this.chunkHeader=b;this.width=c;this.height=d;this.nameLength=this.skipBytes=this.payloadOffset=this.state=0;this.done=
!1;this.maskDecoder=this.colorDecoder=null}}class hg extends Nf{createLayer(){let b=new Fa(this.width,this.height,this.name);return b.setBlendMode(this.blendMode),b.setAlpha(this.alpha),b.setVisible(this.visible),b.setClip(this.clip),b.setMaskLinked(this.maskLinked),b.setMaskVisible(this.maskVisible),b.setLockAlpha(this.lockAlpha),b}}class ig extends Nf{readFixedHeader(b){super.readFixedHeader.call(this,b);this.childLayers=b.readU32BE()}getFixedHeaderLen(){return super.getFixedHeaderLen.call(this)+
4}createLayer(){let b=new $a(this.name,this.blendMode);return b.setAlpha(this.alpha),b.setVisible(this.visible),b.setExpanded(this.expanded),b.setMaskLinked(this.maskLinked),b.setMaskVisible(this.maskVisible),b}constructor(b,c,d){super(b,c,d);this.childLayers=0}}class Zg{decode(b){if(null==b)return null;var c=this.bytesRead%J.BYTES_PER_PIXEL,d=this.bytesRead-c;let a=0,h=[J.ALPHA_BYTE_OFFSET,J.RED_BYTE_OFFSET,J.GREEN_BYTE_OFFSET,J.BLUE_BYTE_OFFSET];for(;c<J.BYTES_PER_PIXEL&&a<b.length;c++)this.output[d+
h[c]]=b[a],a++;this.bytesRead+=a;var q=0|Math.min(b.length-a,this.bytesTotal-this.bytesRead);c=q/J.BYTES_PER_PIXEL|0;q%=J.BYTES_PER_PIXEL;for(d=0;d<c;d++)this.output[this.bytesRead+J.ALPHA_BYTE_OFFSET]=b[a],this.output[this.bytesRead+J.RED_BYTE_OFFSET]=b[a+1],this.output[this.bytesRead+J.GREEN_BYTE_OFFSET]=b[a+2],this.output[this.bytesRead+J.BLUE_BYTE_OFFSET]=b[a+3],this.bytesRead+=J.BYTES_PER_PIXEL,a+=J.BYTES_PER_PIXEL;c=0;for(d=this.bytesRead;c<q;c++)this.output[d+h[c]]=b[a],a++;return(this.bytesRead+=
q,this.bytesRead>=this.bytesTotal&&(this.done=!0),a<b.length)?b.subarray(a):null}constructor(b){this.bytesRead=0;this.bytesTotal=b.width*b.height*J.BYTES_PER_PIXEL;this.output=b.data;this.done=!1}}class Yg{decode(b){if(null==b)return null;let c=0|Math.min(b.length,this.bytesTotal-this.bytesRead),d=this.bytesRead,a;for(a=0;a<c;a++,d++)this.output[d]=b[a];return(this.bytesRead=d,this.bytesRead>=this.bytesTotal&&(this.done=!0),a<b.length)?b.subarray(a):null}constructor(b){this.bytesRead=0;this.bytesTotal=
b.width*b.height;this.output=b.data;this.done=!1}}let Id=()=>new Promise(b=>{let c=new MessageChannel;c.port1.onmessage=()=>b(!0);c.port2.postMessage(void 0)});gd.prototype.read=function(b){if(null==b)return null;var c=new gb(new Uint8Array(b)),d=[];if(1!=c.readU16BE())return null;b=c.readU16BE();for(var a=0;a<b;a++)if(0==c.readU16BE()){var h=255*c.readU16BE()/65535,q=255*c.readU16BE()/65535,f=255*c.readU16BE()/65535;c.readU16BE();d.push(h<<16|q<<8|f)}return d};gd.prototype.write=function(b){var c=
new gb(new Uint8Array(4+10*b.length));c.writeU16BE(1);c.writeU16BE(b.length);for(var d=0;d<b.length;d++){var a=b[d];c.writeU16BE(0);c.writeU16BE((a>>16&255)*257);c.writeU16BE((a>>8&255)*257);c.writeU16BE((255&a)*257);c.writeU16BE(0)}return c.getAsDataArray()};vd.prototype=Object.create(Ja(Hb).prototype);vd.prototype.constructor=vd;"use strict";"use strict";var Nd={};var Of=function(){function b(f,e,k){var l=new XMLHttpRequest;l.open("GET",f);l.responseType="blob";l.onload=function(){q(l.response,
e,k)};l.onerror=function(){console.error("could not download file")};l.send()}function c(f){var e=new XMLHttpRequest;e.open("HEAD",f,!1);try{e.send()}catch(k){}return 200<=e.status&&299>=e.status}function d(f){try{f.dispatchEvent(new MouseEvent("click"))}catch(k){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null);f.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:
"object"==typeof Oc&&Oc.global===Oc?Oc:void 0,h=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),q=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!h?function(f,e,k){var l=a.URL||a.webkitURL,g=document.createElement("a");g.download=e=e||f.name||"download";g.rel="noopener";"string"==typeof f?(g.href=f,g.origin===location.origin?d(g):c(g.href)?b(f,e,k):d(g,g.target="_blank")):
(g.href=l.createObjectURL(f),setTimeout(function(){l.revokeObjectURL(g.href)},4E4),setTimeout(function(){d(g)},0))}:"msSaveOrOpenBlob"in navigator?function(f,e,k){if(e=e||f.name||"download","string"!=typeof f){var l;navigator.msSaveOrOpenBlob((void 0===(l=k)?l={autoBom:!1}:"object"!=typeof l&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\ufeff",f],
{type:f.type}):f),e)}else if(c(f))b(f,e,k);else{var g=document.createElement("a");g.href=f;g.target="_blank";setTimeout(function(){d(g)})}}:function(f,e,k,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof f)return b(f,e,k);e="application/octet-stream"===f.type;k=/constructor/i.test(a.HTMLElement)||a.safari;var g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||e&&k||h)&&"u">typeof FileReader){var m=new FileReader;m.onloadend=function(){var t=
m.result;t=g?t:t.replace(/^data:[^;]*;/,"data:attachment/file;");l?l.location.href=t:location=t;l=null};m.readAsDataURL(f)}else{var p=a.URL||a.webkitURL,n=p.createObjectURL(f);l?l.location=n:location.href=n;l=null;setTimeout(function(){p.revokeObjectURL(n)},4E4)}});Nd=a.saveAs=q.saveAs=q};"function"==typeof define&&define.amd?define([],Of):Of();var qf={};var gf=function(b){for(var c,d=b.length,a=d%3,h=[],q=0,f=d-a;q<f;q+=16383){for(var e=h,k=e.push,l,g=b,m=q+16383>f?f:q+16383,p=[],n=q;n<m;n+=3)l=
(g[n]<<16&16711680)+(g[n+1]<<8&65280)+(255&g[n+2]),p.push(Ac[l>>18&63]+Ac[l>>12&63]+Ac[l>>6&63]+Ac[63&l]);l=p.join("");k.call(e,l)}return 1===a?h.push(Ac[(c=b[d-1])>>2]+Ac[c<<4&63]+"=="):2===a&&h.push(Ac[(c=(b[d-2]<<8)+b[d-1])>>10]+Ac[c>>4&63]+Ac[c<<2&63]+"="),h.join("")};for(var Ac=[],pc=[],lg="u">typeof Uint8Array?Uint8Array:Array,pd=0;pd<64;++pd)Ac[pd]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[pd],pc["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(pd)]=
pd;pc[45]=62;pc[95]=63;var ee=function(b,c,d,a,h){var q=8*h-a-1;var f=(1<<q)-1,e=f>>1,k=-7;h=d?h-1:0;var l=d?-1:1,g=b[c+h];h+=l;d=g&(1<<-k)-1;g>>=-k;for(k+=q;k>0;d=256*d+b[c+h],h+=l,k-=8);q=d&(1<<-k)-1;d>>=-k;for(k+=a;k>0;q=256*q+b[c+h],h+=l,k-=8);if(0===d)d=1-e;else{if(d===f)return q?NaN:1/0*(g?-1:1);q+=Math.pow(2,a);d-=e}return(g?-1:1)*q*Math.pow(2,d-a)};var lf=function(b,c,d,a,h,q){var f,e,k,l=8*q-h-1,g=(1<<l)-1,m=g>>1,p=5.960464477539062E-8*(23===h);q=a?0:q-1;a=a?1:-1;var n=+(c<0||0===c&&1/c<
0);for(isNaN(c=Math.abs(c))||c===1/0?(e=+!!isNaN(c),f=g):(f=Math.floor(Math.log(c)/Math.LN2),c*(k=Math.pow(2,-f))<1&&(f--,k*=2),f+m>=1?c+=p/k:c+=p*Math.pow(2,1-m),c*k>=2&&(f++,k/=2),f+m>=g?(e=0,f=g):f+m>=1?(e=(c*k-1)*Math.pow(2,h),f+=m):(e=c*Math.pow(2,m-1)*Math.pow(2,h),f=0));h>=8;b[d+q]=255&e,q+=a,e/=256,h-=8);f=f<<h|e;for(l+=h;l>0;b[d+q]=255&f,q+=a,f/=256,l-=8);b[d+q-a]|=128*n};var Pf="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;oa.TYPED_ARRAY_SUPPORT=
function(){try{var b=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(b,c),42===b.foo()}catch(d){return!1}}();!oa.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");Object.defineProperty(oa.prototype,"parent",{enumerable:!0,get:function(){if(oa.isBuffer(this))return this.buffer}});
Object.defineProperty(oa.prototype,"offset",{enumerable:!0,get:function(){if(oa.isBuffer(this))return this.byteOffset}});oa.poolSize=8192;oa.from=function(b,c,d){return af(b,c,d)};Object.setPrototypeOf(oa.prototype,Uint8Array.prototype);Object.setPrototypeOf(oa,Uint8Array);oa.alloc=function(b,c,d){return(df(b),b<=0)?Bc(b):void 0!==c?"string"==typeof d?Bc(b).fill(c,d):Bc(b).fill(c):Bc(b)};oa.allocUnsafe=function(b){return ne(b)};oa.allocUnsafeSlow=function(b){return ne(b)};oa.isBuffer=function(b){return null!=
b&&!0===b._isBuffer&&b!==oa.prototype};oa.compare=function(b,c){if(yc(b,Uint8Array)&&(b=oa.from(b,b.offset,b.byteLength)),yc(c,Uint8Array)&&(c=oa.from(c,c.offset,c.byteLength)),!oa.isBuffer(b)||!oa.isBuffer(c))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(b===c)return 0;for(var d=b.length,a=c.length,h=0,q=Math.min(d,a);h<q;++h)if(b[h]!==c[h]){d=b[h];a=c[h];break}return d<a?-1:+(a<d)};oa.isEncoding=function(b){switch(String(b).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};oa.concat=function(b,c){if(!Array.isArray(b))throw TypeError('"list" argument must be an Array of Buffers');if(0===b.length)return oa.alloc(0);if(void 0===c)for(c=d=0;d<b.length;++d)c+=b[d].length;var d;c=oa.allocUnsafe(c);var a=0;for(d=0;d<b.length;++d){var h=b[d];if(yc(h,Uint8Array))a+h.length>c.length?oa.from(h).copy(c,a):Uint8Array.prototype.set.call(c,h,a);else if(oa.isBuffer(h))h.copy(c,a);else throw TypeError('"list" argument must be an Array of Buffers');a+=h.length}return c};
oa.byteLength=bf;oa.prototype._isBuffer=!0;oa.prototype.swap16=function(){var b=this.length;if(b%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<b;c+=2)Xc(this,c,c+1);return this};oa.prototype.swap32=function(){var b=this.length;if(b%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<b;c+=4)Xc(this,c,c+3),Xc(this,c+1,c+2);return this};oa.prototype.swap64=function(){var b=this.length;if(b%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");
for(var c=0;c<b;c+=8)Xc(this,c,c+7),Xc(this,c+1,c+6),Xc(this,c+2,c+5),Xc(this,c+3,c+4);return this};oa.prototype.toString=function(){var b=this.length;return 0===b?"":0==arguments.length?ff(this,0,b):jg.apply(this,arguments)};oa.prototype.toLocaleString=oa.prototype.toString;oa.prototype.equals=function(b){if(!oa.isBuffer(b))throw TypeError("Argument must be a Buffer");return this===b||0===oa.compare(this,b)};oa.prototype.inspect=function(){var b="";return b=this.toString("hex",0,50).replace(/(.{2})/g,
"$1 ").trim(),this.length>50&&(b+=" ... "),"<Buffer "+b+">"};Pf&&(oa.prototype[Pf]=oa.prototype.inspect);oa.prototype.compare=function(b,c,d,a,h){if(yc(b,Uint8Array)&&(b=oa.from(b,b.offset,b.byteLength)),!oa.isBuffer(b))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof b);if(void 0===c&&(c=0),void 0===d&&(d=b?b.length:0),void 0===a&&(a=0),void 0===h&&(h=this.length),c<0||d>b.length||a<0||h>this.length)throw RangeError("out of range index");if(a>=
h&&c>=d)return 0;if(a>=h)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,a>>>=0,h>>>=0,this===b)return 0;var q=h-a,f=d-c,e=Math.min(q,f);a=this.slice(a,h);b=b.slice(c,d);for(c=0;c<e;++c)if(a[c]!==b[c]){q=a[c];f=b[c];break}return q<f?-1:+(f<q)};oa.prototype.includes=function(b,c,d){return-1!==this.indexOf(b,c,d)};oa.prototype.indexOf=function(b,c,d){return hf(this,b,c,d,!0)};oa.prototype.lastIndexOf=function(b,c,d){return hf(this,b,c,d,!1)};oa.prototype.write=function(b,c,d,a){if(void 0===c)a="utf8",d=
this.length,c=0;else if(void 0===d&&"string"==typeof c)a=c,d=this.length,c=0;else if(isFinite(c))c>>>=0,isFinite(d)?(d>>>=0,void 0===a&&(a="utf8")):(a=d,d=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var h,q,f,e,k,l,g,m,p=this.length-c;if((void 0===d||d>p)&&(d=p),b.length>0&&(d<0||c<0)||c>this.length)throw RangeError("Attempt to write outside buffer bounds");a||="utf8";for(p=!1;;)switch(a){case "hex":return function(n,t,u,v){u=Number(u)||0;var A=
n.length-u;v?(v=Number(v))>A&&(v=A):v=A;A=t.length;v>A/2&&(v=A/2);for(A=0;A<v;++A){var D,y=parseInt(t.substr(2*A,2),16);if((D=y)!=D)break;n[u+A]=y}return A}(this,b,c,d);case "utf8":case "utf-8":return h=c,q=d,Jd(qe(b,this.length-h),this,h,q);case "ascii":case "latin1":case "binary":return f=c,e=d,Jd(function(n){for(var t=[],u=0;u<n.length;++u)t.push(255&n.charCodeAt(u));return t}(b),this,f,e);case "base64":return k=c,l=d,Jd(ef(b),this,k,l);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return g=
c,m=d,Jd(function(n,t){for(var u,v,A=[],D=0;D<n.length&&!((t-=2)<0);++D)v=(u=n.charCodeAt(D))>>8,A.push(u%256),A.push(v);return A}(b,this.length-g),this,g,m);default:if(p)throw TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase();p=!0}};oa.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};oa.prototype.slice=function(b,c){var d=this.length;b=~~b;c=void 0===c?d:~~c;b<0?(b+=d)<0&&(b=0):b>d&&(b=d);c<0?(c+=d)<0&&(c=0):c>d&&(c=d);c<b&&(c=b);b=this.subarray(b,
c);return Object.setPrototypeOf(b,oa.prototype),b};oa.prototype.readUintLE=oa.prototype.readUIntLE=function(b,c,d){b>>>=0;c>>>=0;d||Sb(b,c,this.length);d=this[b];for(var a=1,h=0;++h<c&&(a*=256);)d+=this[b+h]*a;return d};oa.prototype.readUintBE=oa.prototype.readUIntBE=function(b,c,d){b>>>=0;c>>>=0;d||Sb(b,c,this.length);d=this[b+--c];for(var a=1;c>0&&(a*=256);)d+=this[b+--c]*a;return d};oa.prototype.readUint8=oa.prototype.readUInt8=function(b,c){return b>>>=0,c||Sb(b,1,this.length),this[b]};oa.prototype.readUint16LE=
oa.prototype.readUInt16LE=function(b,c){return b>>>=0,c||Sb(b,2,this.length),this[b]|this[b+1]<<8};oa.prototype.readUint16BE=oa.prototype.readUInt16BE=function(b,c){return b>>>=0,c||Sb(b,2,this.length),this[b]<<8|this[b+1]};oa.prototype.readUint32LE=oa.prototype.readUInt32LE=function(b,c){return b>>>=0,c||Sb(b,4,this.length),(this[b]|this[b+1]<<8|this[b+2]<<16)+16777216*this[b+3]};oa.prototype.readUint32BE=oa.prototype.readUInt32BE=function(b,c){return b>>>=0,c||Sb(b,4,this.length),16777216*this[b]+
(this[b+1]<<16|this[b+2]<<8|this[b+3])};oa.prototype.readIntLE=function(b,c,d){b>>>=0;c>>>=0;d||Sb(b,c,this.length);d=this[b];for(var a=1,h=0;++h<c&&(a*=256);)d+=this[b+h]*a;return d>=a*128&&(d-=Math.pow(2,8*c)),d};oa.prototype.readIntBE=function(b,c,d){b>>>=0;c>>>=0;d||Sb(b,c,this.length);d=c;for(var a=1,h=this[b+--d];d>0&&(a*=256);)h+=this[b+--d]*a;return h>=a*128&&(h-=Math.pow(2,8*c)),h};oa.prototype.readInt8=function(b,c){return(b>>>=0,c||Sb(b,1,this.length),128&this[b])?-(255-this[b]+1):this[b]};
oa.prototype.readInt16LE=function(b,c){b>>>=0;c||Sb(b,2,this.length);b=this[b]|this[b+1]<<8;return 32768&b?4294901760|b:b};oa.prototype.readInt16BE=function(b,c){b>>>=0;c||Sb(b,2,this.length);b=this[b+1]|this[b]<<8;return 32768&b?4294901760|b:b};oa.prototype.readInt32LE=function(b,c){return b>>>=0,c||Sb(b,4,this.length),this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24};oa.prototype.readInt32BE=function(b,c){return b>>>=0,c||Sb(b,4,this.length),this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]};oa.prototype.readFloatLE=
function(b,c){return b>>>=0,c||Sb(b,4,this.length),ee(this,b,!0,23,4)};oa.prototype.readFloatBE=function(b,c){return b>>>=0,c||Sb(b,4,this.length),ee(this,b,!1,23,4)};oa.prototype.readDoubleLE=function(b,c){return b>>>=0,c||Sb(b,8,this.length),ee(this,b,!0,52,8)};oa.prototype.readDoubleBE=function(b,c){return b>>>=0,c||Sb(b,8,this.length),ee(this,b,!1,52,8)};oa.prototype.writeUintLE=oa.prototype.writeUIntLE=function(b,c,d,a){(b*=1,c>>>=0,d>>>=0,a)||hc(this,b,c,d,Math.pow(2,8*d)-1,0);a=1;var h=0;for(this[c]=
255&b;++h<d&&(a*=256);)this[c+h]=b/a&255;return c+d};oa.prototype.writeUintBE=oa.prototype.writeUIntBE=function(b,c,d,a){(b*=1,c>>>=0,d>>>=0,a)||hc(this,b,c,d,Math.pow(2,8*d)-1,0);a=d-1;var h=1;for(this[c+a]=255&b;--a>=0&&(h*=256);)this[c+a]=b/h&255;return c+d};oa.prototype.writeUint8=oa.prototype.writeUInt8=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,1,255,0),this[c]=255&b,c+1};oa.prototype.writeUint16LE=oa.prototype.writeUInt16LE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,2,65535,0),
this[c]=255&b,this[c+1]=b>>>8,c+2};oa.prototype.writeUint16BE=oa.prototype.writeUInt16BE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,2,65535,0),this[c]=b>>>8,this[c+1]=255&b,c+2};oa.prototype.writeUint32LE=oa.prototype.writeUInt32LE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,4,4294967295,0),this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=255&b,c+4};oa.prototype.writeUint32BE=oa.prototype.writeUInt32BE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,4,4294967295,0),this[c]=
b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b,c+4};oa.prototype.writeIntLE=function(b,c,d,a){(b*=1,c>>>=0,a)||(a=Math.pow(2,8*d-1),hc(this,b,c,d,a-1,-a));a=0;var h=1,q=0;for(this[c]=255&b;++a<d&&(h*=256);)b<0&&0===q&&0!==this[c+a-1]&&(q=1),this[c+a]=(b/h|0)-q&255;return c+d};oa.prototype.writeIntBE=function(b,c,d,a){(b*=1,c>>>=0,a)||(a=Math.pow(2,8*d-1),hc(this,b,c,d,a-1,-a));a=d-1;var h=1,q=0;for(this[c+a]=255&b;--a>=0&&(h*=256);)b<0&&0===q&&0!==this[c+a+1]&&(q=1),this[c+a]=(b/h|0)-q&255;
return c+d};oa.prototype.writeInt8=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,1,127,-128),b<0&&(b=255+b+1),this[c]=255&b,c+1};oa.prototype.writeInt16LE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,2,32767,-32768),this[c]=255&b,this[c+1]=b>>>8,c+2};oa.prototype.writeInt16BE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,2,32767,-32768),this[c]=b>>>8,this[c+1]=255&b,c+2};oa.prototype.writeInt32LE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,4,2147483647,-2147483648),this[c]=255&
b,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24,c+4};oa.prototype.writeInt32BE=function(b,c,d){return b*=1,c>>>=0,d||hc(this,b,c,4,2147483647,-2147483648),b<0&&(b=4294967295+b+1),this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b,c+4};oa.prototype.writeFloatLE=function(b,c,d){return kf(this,b,c,!0,d)};oa.prototype.writeFloatBE=function(b,c,d){return kf(this,b,c,!1,d)};oa.prototype.writeDoubleLE=function(b,c,d){return mf(this,b,c,!0,d)};oa.prototype.writeDoubleBE=function(b,c,d){return mf(this,
b,c,!1,d)};oa.prototype.copy=function(b,c,d,a){if(!oa.isBuffer(b))throw TypeError("argument should be a Buffer");if(d||=0,a||0===a||(a=this.length),c>=b.length&&(c=b.length),c||=0,a>0&&a<d&&(a=d),a===d||0===b.length||0===this.length)return 0;if(c<0)throw RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw RangeError("Index out of range");if(a<0)throw RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length);b.length-c<a-d&&(a=b.length-c+d);var h=a-d;return this===b&&"function"==
typeof Uint8Array.prototype.copyWithin?this.copyWithin(c,d,a):Uint8Array.prototype.set.call(b,this.subarray(d,a),c),h};oa.prototype.fill=function(b,c,d,a){if("string"==typeof b){if("string"==typeof c?(a=c,c=0,d=this.length):"string"==typeof d&&(a=d,d=this.length),void 0!==a&&"string"!=typeof a)throw TypeError("encoding must be a string");if("string"==typeof a&&!oa.isEncoding(a))throw TypeError("Unknown encoding: "+a);if(1===b.length){var h=b.charCodeAt(0);("utf8"===a&&h<128||"latin1"===a)&&(b=h)}}else"number"==
typeof b?b&=255:"boolean"==typeof b&&(b=Number(b));if(c<0||this.length<c||this.length<d)throw RangeError("Out of range index");if(d<=c)return this;if(c>>>=0,d=void 0===d?this.length:d>>>0,b||=0,"number"==typeof b)for(a=c;a<d;++a)this[a]=b;else{h=oa.isBuffer(b)?b:oa.from(b,a);var q=h.length;if(0===q)throw TypeError('The value "'+b+'" is invalid for argument "value"');for(a=0;a<d-c;++a)this[a+c]=h[a%q]}return this};var mg=/[^+/0-9A-Za-z-_]/g,kg=function(){for(var b=Array(256),c=0;c<16;++c)for(var d=
16*c,a=0;a<16;++a)b[d+a]="0123456789abcdef"[c]+"0123456789abcdef"[a];return b}(),Qf={},Jb=Qf={};try{var Jc="function"==typeof setTimeout?setTimeout:re}catch(b){Jc=re}try{var Kc="function"==typeof clearTimeout?clearTimeout:se}catch(b){Kc=se}var Cc=[],hd=!1,Kd=-1;Jb.nextTick=function(b){var c=Array(arguments.length-1);if(arguments.length>1)for(var d=1;d<arguments.length;d++)c[d-1]=arguments[d];Cc.push(new pf(b,c));1!==Cc.length||hd||nf(of)};pf.prototype.run=function(){this.fun.apply(null,this.array)};
Jb.title="browser";Jb.browser=!0;Jb.env={};Jb.argv=[];Jb.version="";Jb.versions={};Jb.on=Dc;Jb.addListener=Dc;Jb.once=Dc;Jb.off=Dc;Jb.removeListener=Dc;Jb.removeAllListeners=Dc;Jb.emit=Dc;Jb.prependListener=Dc;Jb.prependOnceListener=Dc;Jb.listeners=function(b){return[]};Jb.binding=function(b){throw Error("process.binding is not supported");};Jb.cwd=function(){return"/"};Jb.chdir=function(b){throw Error("process.chdir is not supported");};Jb.umask=function(){return 0};qf=function h(c,d,a){function q(k,
l){if(!d[k]){if(!c[k]){if(f)return f(k,!0);l=Error("Cannot find module '"+k+"'");throw l.code="MODULE_NOT_FOUND",l;}l=d[k]={exports:{}};c[k][0].call(l.exports,function(g){return q(c[k][1][g]||g)},l,l.exports,h,c,d,a)}return d[k].exports}for(var f=void 0,e=0;e<a.length;e++)q(a[e]);return q}({1:[function(c,d,a){var h=c("./utils"),q=c("./support");a.encode=function(f){for(var e,k,l,g,m,p,n=[],t=0,u=f.length,v,A="string"!==h.getTypeOf(f);t<f.length;)v=u-t,l=A?(e=f[t++],k=t<u?f[t++]:0,t<u?f[t++]:0):(e=
f.charCodeAt(t++),k=t<u?f.charCodeAt(t++):0,t<u?f.charCodeAt(t++):0),g=e>>2,m=(3&e)<<4|k>>4,p=1<v?(15&k)<<2|l>>6:64,l=2<v?63&l:64,n.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l));return n.join("")};a.decode=function(f){var e,k,l,g=
0,m=0;if(f.substr(0,5)==="data:")throw Error("Invalid base64 input, it looks like a data url.");var p;var n=3*(f=f.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(f.charAt(f.length-1)==="="&&n--,f.charAt(f.length-2)==="="&&n--,n%1!=0)throw Error("Invalid base64 input, bad content length.");for(p=q.uint8array?new Uint8Array(0|n):Array(0|n);g<f.length;){n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(g++))<<2|(e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(g++)))>>
4;e=(15&e)<<4|(k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(g++)))>>2;var t=(3&k)<<6|(l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f.charAt(g++)));p[m++]=n;64!==k&&(p[m++]=e);64!==l&&(p[m++]=t)}return p}},{"./support":30,"./utils":32}],2:[function(c,d,a){function h(l,g,m,p,n){this.compressedSize=l;this.uncompressedSize=g;this.crc32=m;this.compression=p;this.compressedContent=n}var q=c("./external"),f=c("./stream/DataWorker"),
e=c("./stream/Crc32Probe"),k=c("./stream/DataLengthProbe");h.prototype={getContentWorker:function(){var l=(new f(q.Promise.resolve(this.compressedContent))).pipe(this.compression.uncompressWorker()).pipe(new k("data_length")),g=this;return l.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw Error("Bug : uncompressed data size mismatch");}),l},getCompressedWorker:function(){return(new f(q.Promise.resolve(this.compressedContent))).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",
this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};h.createWorkerFrom=function(l,g,m){return l.pipe(new e).pipe(new k("uncompressedSize")).pipe(g.compressWorker(m)).pipe(new k("compressedSize")).withStreamInfo("compression",g)};d.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(c,d,a){var h=c("./stream/GenericWorker");a.STORE={magic:"\x00\x00",compressWorker:function(){return new h("STORE compression")},
uncompressWorker:function(){return new h("STORE decompression")}};a.DEFLATE=c("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(c,d,a){var h=c("./utils"),q=function(){for(var f,e=[],k=0;k<256;k++){f=k;for(var l=0;l<8;l++)f=1&f?3988292384^f>>>1:f>>>1;e[k]=f}return e}();d.exports=function(f,e){return void 0!==f&&f.length?"string"!==h.getTypeOf(f)?function(k,l,g){g=0+g;k^=-1;for(var m=0;m<g;m++)k=k>>>8^q[255&(k^l[m])];return-1^k}(0|e,f,f.length):function(k,l,g){g=0+g;k^=-1;for(var m=
0;m<g;m++)k=k>>>8^q[255&(k^l.charCodeAt(m))];return-1^k}(0|e,f,f.length):0}},{"./utils":32}],5:[function(c,d,a){a.base64=!1;a.binary=!1;a.dir=!1;a.createFolders=!0;a.date=null;a.compression=null;a.compressionOptions=null;a.comment=null;a.unixPermissions=null;a.dosPermissions=null},{}],6:[function(c,d,a){d.exports={Promise:"u">typeof Promise?Promise:c("lie")}},{lie:37}],7:[function(c,d,a){function h(l,g){e.call(this,"FlateWorker/"+l);this._pako=null;this._pakoAction=l;this._pakoOptions=g;this.meta=
{}}d="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Uint32Array;var q=c("pako"),f=c("./utils"),e=c("./stream/GenericWorker"),k=d?"uint8array":"array";a.magic="\b\x00";f.inherits(h,e);h.prototype.processChunk=function(l){this.meta=l.meta;null===this._pako&&this._createPako();this._pako.push(f.transformTo(k,l.data),!1)};h.prototype.flush=function(){e.prototype.flush.call(this);null===this._pako&&this._createPako();this._pako.push([],!0)};h.prototype.cleanUp=function(){e.prototype.cleanUp.call(this);
this._pako=null};h.prototype._createPako=function(){this._pako=new q[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var l=this;this._pako.onData=function(g){l.push({data:g,meta:l.meta})}};a.compressWorker=function(l){return new h("Deflate",l)};a.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(c,d,a){function h(p,n){var t,u="";for(t=0;t<n;t++)u+=String.fromCharCode(255&p),p>>>=8;return u}function q(p,n,t,u,v,A){var D,
y,E=p.file,x=p.compression,G=A!==l.utf8encode,I=e.transformTo("string",A(E.name)),O=e.transformTo("string",l.utf8encode(E.name)),B=E.comment;A=e.transformTo("string",A(B));var N=e.transformTo("string",l.utf8encode(B)),P=O.length!==E.name.length,L=N.length!==B.length,ia=B="",V="",ma=E.dir,da=E.date,Ca=0,ha=0,sa=0;n&&!t||(Ca=p.crc32,ha=p.compressedSize,sa=p.uncompressedSize);p=0;n&&(p|=8);!G&&(P||L)&&(p|=2048);G=n=0;ma&&(n|=16);"UNIX"===v?(G=798,n|=(D=E.unixPermissions,y=D,D||(y=ma?16893:33204),(65535&
y)<<16)):(G=20,n|=63&(E.dosPermissions||0));v=(da.getUTCHours()<<6|da.getUTCMinutes())<<5|da.getUTCSeconds()/2;D=(da.getUTCFullYear()-1980<<4|da.getUTCMonth()+1)<<5|da.getUTCDate();P&&(ia=h(1,1)+h(g(I),4)+O,B+="up"+h(ia.length,2)+ia);L&&(V=h(1,1)+h(g(A),4)+N,B+="uc"+h(V.length,2)+V);O="";return O+="\n\x00",O+=h(p,2),O+=x.magic,O+=h(v,2),O+=h(D,2),O+=h(Ca,4),O+=h(ha,4),O+=h(sa,4),O+=h(I.length,2),O+=h(B.length,2),{fileRecord:m.LOCAL_FILE_HEADER+O+I+B,dirRecord:m.CENTRAL_FILE_HEADER+h(G,2)+O+h(A.length,
2)+"\x00\x00\x00\x00"+h(n,4)+h(u,4)+I+B+A}}function f(p,n,t,u){k.call(this,"ZipFileWorker");this.bytesWritten=0;this.zipComment=n;this.zipPlatform=t;this.encodeFileName=u;this.streamFiles=p;this.accumulate=!1;this.contentBuffer=[];this.dirRecords=[];this.entriesCount=this.currentSourceOffset=0;this.currentFile=null;this._sources=[]}var e=c("../utils"),k=c("../stream/GenericWorker"),l=c("../utf8"),g=c("../crc32"),m=c("../signature");e.inherits(f,k);f.prototype.push=function(p){var n=p.meta.percent||
0,t=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,k.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:t?(n+100*(t-u-1))/t:100}}))};f.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten;this.currentFile=p.file.name;var n=this.streamFiles&&!p.file.dir;n?(p=q(p,n,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName),this.push({data:p.fileRecord,meta:{percent:0}})):
this.accumulate=!0};f.prototype.closedSource=function(p){this.accumulate=!1;var n=this.streamFiles&&!p.file.dir,t=q(p,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),n)this.push({data:m.DATA_DESCRIPTOR+h(p.crc32,4)+h(p.compressedSize,4)+h(p.uncompressedSize,4),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};f.prototype.flush=
function(){for(var p,n,t,u,v=this.bytesWritten,A=0;A<this.dirRecords.length;A++)this.push({data:this.dirRecords[A],meta:{percent:100}});A=this.bytesWritten-v;var D=(p=this.dirRecords.length,n=this.zipComment,t=this.encodeFileName,u=e.transformTo("string",t(n)),m.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+h(p,2)+h(p,2)+h(A,4)+h(v,4)+h(u.length,2)+u);this.push({data:D,meta:{percent:100}})};f.prototype.prepareNextSource=function(){this.previous=this._sources.shift();this.openedSource(this.previous.streamInfo);
this.isPaused?this.previous.pause():this.previous.resume()};f.prototype.registerPrevious=function(p){this._sources.push(p);var n=this;return p.on("data",function(t){n.processChunk(t)}),p.on("end",function(){n.closedSource(n.previous.streamInfo);n._sources.length?n.prepareNextSource():n.end()}),p.on("error",function(t){n.error(t)}),this};f.prototype.resume=function(){return!!k.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||
this.generatedError?void 0:(this.end(),!0))};f.prototype.error=function(p){var n=this._sources;if(!k.prototype.error.call(this,p))return!1;for(var t=0;t<n.length;t++)try{n[t].error(p)}catch(u){}return!0};f.prototype.lock=function(){k.prototype.lock.call(this);for(var p=this._sources,n=0;n<p.length;n++)p[n].lock()};d.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(c,d,a){var h=c("../compressions"),q=c("./ZipFileWorker");a.generateWorker=
function(f,e,k){var l=new q(e.streamFiles,k,e.platform,e.encodeFileName),g=0;try{f.forEach(function(m,p){g++;var n=p.options.compression||e.compression,t=h[n];if(!t)throw Error(n+" is not a valid compression method !");n=p.dir;var u=p.date;p._compressWorker(t,p.options.compressionOptions||e.compressionOptions||{}).withStreamInfo("file",{name:m,dir:n,date:u,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(l)}),l.entriesCount=g}catch(m){l.error(m)}return l}},
{"../compressions":3,"./ZipFileWorker":8}],10:[function(c,d,a){function h(){if(!(this instanceof h))return new h;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null);this.comment=null;this.root="";this.clone=function(){var q=new h,f;for(f in this)"function"!=typeof this[f]&&(q[f]=this[f]);return q}}(h.prototype=c("./object")).loadAsync=c("./load");h.support=c("./support");h.defaults=c("./defaults");
h.version="3.10.1";h.loadAsync=function(q,f){return(new h).loadAsync(q,f)};h.external=c("./external");d.exports=h},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(c,d,a){var h=c("./utils"),q=c("./external"),f=c("./utf8"),e=c("./zipEntries"),k=c("./stream/Crc32Probe"),l=c("./nodejsUtils");d.exports=function(g,m){var p=this;return m=h.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:f.utf8decode}),l.isNode&&l.isStream(g)?
q.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):h.prepareContent("the loaded zip file",g,!0,m.optimizedBinaryString,m.base64).then(function(n){var t=new e(m);return t.load(n),t}).then(function(n){var t=[q.Promise.resolve(n)];n=n.files;if(m.checkCRC32)for(var u=0;u<n.length;u++)t.push(function(v){return new q.Promise(function(A,D){var y=v.decompressed.getContentWorker().pipe(new k);y.on("error",function(E){D(E)}).on("end",function(){y.streamInfo.crc32!==v.decompressed.crc32?
D(Error("Corrupted zip : CRC32 mismatch")):A()}).resume()})}(n[u]));return q.Promise.all(t)}).then(function(n){n=n.shift();for(var t=n.files,u=0;u<t.length;u++){var v=t[u],A=v.fileNameStr,D=h.resolve(v.fileNameStr);p.file(D,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:m.createFolders});v.dir||(p.file(D).unsafeOriginalName=A)}return n.zipComment.length&&
(p.comment=n.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(c,d,a){function h(f,e){q.call(this,"Nodejs stream input adapter for "+f);this._upstreamEnded=!1;this._bindStream(e)}a=c("../utils");var q=c("../stream/GenericWorker");a.inherits(h,q);h.prototype._bindStream=function(f){var e=this;(this._stream=f).pause();f.on("data",function(k){e.push({data:k,meta:{percent:0}})}).on("error",function(k){e.isPaused?this.generatedError=
k:e.error(k)}).on("end",function(){e.isPaused?e._upstreamEnded=!0:e.end()})};h.prototype.pause=function(){return!!q.prototype.pause.call(this)&&(this._stream.pause(),!0)};h.prototype.resume=function(){return!!q.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)};d.exports=h},{"../stream/GenericWorker":28,"../utils":32}],13:[function(c,d,a){function h(f,e,k){q.call(this,e);this._helper=f;var l=this;f.on("data",function(g,m){l.push(g)||l._helper.pause();k&&k(m)}).on("error",
function(g){l.emit("error",g)}).on("end",function(){l.push(null)})}var q=c("readable-stream").Readable;c("../utils").inherits(h,q);h.prototype._read=function(){this._helper.resume()};d.exports=h},{"../utils":32,"readable-stream":16}],14:[function(c,d,a){d.exports={isNode:!0,newBufferFrom:function(h,q){if(oa.from&&oa.from!==Uint8Array.from)return oa.from(h,q);if("number"==typeof h)throw Error('The "data" argument must not be a number');return new oa(h,q)},allocBuffer:function(h){if(oa.alloc)return oa.alloc(h);
h=new oa(h);return h.fill(0),h},isBuffer:function(h){return oa.isBuffer(h)},isStream:function(h){return h&&"function"==typeof h.on&&"function"==typeof h.pause&&"function"==typeof h.resume}}},{}],15:[function(c,d,a){function h(A,D,y){var E=f.getTypeOf(D),x=f.extend(y||{},l);x.date=x.date||new Date;null!==x.compression&&(x.compression=x.compression.toUpperCase());"string"==typeof x.unixPermissions&&(x.unixPermissions=parseInt(x.unixPermissions,8));x.unixPermissions&&16384&x.unixPermissions&&(x.dir=
!0);x.dosPermissions&&16&x.dosPermissions&&(x.dir=!0);x.dir&&(A=u(A));var G;if(G=x.createFolders){var I=A;"/"===I.slice(-1)&&(I=I.substring(0,I.length-1));G=I.lastIndexOf("/");G=I=0<G?I.substring(0,G):""}G&&v.call(this,I,!0);E="string"===E&&!1===x.binary&&!1===x.base64;y&&void 0!==y.binary||(x.binary=!E);(D instanceof g&&0===D.uncompressedSize||x.dir||!D||0===D.length)&&(x.base64=!1,x.binary=!0,D="",x.compression="STORE");D=D instanceof g||D instanceof e?D:n.isNode&&n.isStream(D)?new t(A,D):f.prepareContent(A,
D,x.binary,x.optimizedBinaryString,x.base64);x=new m(A,D,x);this.files[A]=x}var q=c("./utf8"),f=c("./utils"),e=c("./stream/GenericWorker"),k=c("./stream/StreamHelper"),l=c("./defaults"),g=c("./compressedObject"),m=c("./zipObject"),p=c("./generate"),n=c("./nodejsUtils"),t=c("./nodejs/NodejsStreamInputAdapter"),u=function(A){return"/"!==A.slice(-1)&&(A+="/"),A},v=function(A,D){return D=void 0!==D?D:l.createFolders,A=u(A),this.files[A]||h.call(this,A,null,{dir:!0,createFolders:D}),this.files[A]};d.exports=
{load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");},forEach:function(A){var D,y;for(D in this.files){var E=this.files[D];(y=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&A(y,E)}},filter:function(A){var D=[];return this.forEach(function(y,E){A(y,E)&&D.push(E)}),D},file:function(A,D,y){if(1!=arguments.length)return A=this.root+A,h.call(this,A,D,y),this;if("[object RegExp]"===Object.prototype.toString.call(A)){var E=
A;return this.filter(function(G,I){return!I.dir&&E.test(G)})}var x=this.files[this.root+A];return x&&!x.dir?x:null},folder:function(A){if(!A)return this;if("[object RegExp]"===Object.prototype.toString.call(A))return this.filter(function(E,x){return x.dir&&A.test(E)});var D=v.call(this,this.root+A),y=this.clone();return y.root=D.name,y},remove:function(A){A=this.root+A;var D=this.files[A];if(D||("/"!==A.slice(-1)&&(A+="/"),D=this.files[A]),D&&!D.dir)delete this.files[A];else{D=this.filter(function(E,
x){return x.name.slice(0,A.length)===A});for(var y=0;y<D.length;y++)delete this.files[D[y].name]}return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");},generateInternalStream:function(A){var D={};try{if((D=f.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:q.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),
"binarystring"===D.type&&(D.type="string"),!D.type)throw Error("No output type specified.");f.checkSupport(D.type);"darwin"!==D.platform&&"freebsd"!==D.platform&&"linux"!==D.platform&&"sunos"!==D.platform||(D.platform="UNIX");"win32"===D.platform&&(D.platform="DOS");var y=p.generateWorker(this,D,D.comment||this.comment||"")}catch(E){(y=new e("error")).error(E)}return new k(y,D.type||"string",D.mimeType)},generateAsync:function(A,D){return this.generateInternalStream(A).accumulate(D)},generateNodeStream:function(A,
D){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(D)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(c,d,a){d.exports=c("stream")},{stream:void 0}],17:[function(c,d,a){function h(f){q.call(this,f);for(var e=0;e<this.data.length;e++)f[e]&=255}var q=c("./DataReader");c("../utils").inherits(h,
q);h.prototype.byteAt=function(f){return this.data[this.zero+f]};h.prototype.lastIndexOfSignature=function(f){var e=f.charCodeAt(0),k=f.charCodeAt(1),l=f.charCodeAt(2);f=f.charCodeAt(3);for(var g=this.length-4;0<=g;--g)if(this.data[g]===e&&this.data[g+1]===k&&this.data[g+2]===l&&this.data[g+3]===f)return g-this.zero;return-1};h.prototype.readAndCheckSignature=function(f){var e=f.charCodeAt(0),k=f.charCodeAt(1),l=f.charCodeAt(2);f=f.charCodeAt(3);var g=this.readData(4);return e===g[0]&&k===g[1]&&l===
g[2]&&f===g[3]};h.prototype.readData=function(f){if(this.checkOffset(f),0===f)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=h},{"../utils":32,"./DataReader":18}],18:[function(c,d,a){function h(f){this.data=f;this.length=f.length;this.zero=this.index=0}var q=c("../utils");h.prototype={checkOffset:function(f){this.checkIndex(this.index+f)},checkIndex:function(f){if(this.length<this.zero+f||f<0)throw Error("End of data reached (data length = "+
this.length+", asked index = "+f+"). Corrupted zip ?");},setIndex:function(f){this.checkIndex(f);this.index=f},skip:function(f){this.setIndex(this.index+f)},byteAt:function(){},readInt:function(f){var e,k=0;this.checkOffset(f);for(e=this.index+f-1;e>=this.index;e--)k=(k<<8)+this.byteAt(e);return this.index+=f,k},readString:function(f){return q.transformTo("string",this.readData(f))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var f=
this.readInt(4);return new Date(Date.UTC(1980+(f>>25&127),(f>>21&15)-1,f>>16&31,f>>11&31,f>>5&63,(31&f)<<1))}};d.exports=h},{"../utils":32}],19:[function(c,d,a){function h(f){q.call(this,f)}var q=c("./Uint8ArrayReader");c("../utils").inherits(h,q);h.prototype.readData=function(f){this.checkOffset(f);var e=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=h},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(c,d,a){function h(f){q.call(this,f)}var q=
c("./DataReader");c("../utils").inherits(h,q);h.prototype.byteAt=function(f){return this.data.charCodeAt(this.zero+f)};h.prototype.lastIndexOfSignature=function(f){return this.data.lastIndexOf(f)-this.zero};h.prototype.readAndCheckSignature=function(f){return f===this.readData(4)};h.prototype.readData=function(f){this.checkOffset(f);var e=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=h},{"../utils":32,"./DataReader":18}],21:[function(c,d,a){function h(f){q.call(this,
f)}var q=c("./ArrayReader");c("../utils").inherits(h,q);h.prototype.readData=function(f){if(this.checkOffset(f),0===f)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+f);return this.index+=f,e};d.exports=h},{"../utils":32,"./ArrayReader":17}],22:[function(c,d,a){var h=c("../utils"),q=c("../support"),f=c("./ArrayReader"),e=c("./StringReader"),k=c("./NodeBufferReader"),l=c("./Uint8ArrayReader");d.exports=function(g){var m=h.getTypeOf(g);return h.checkSupport(m),
"string"!==m||q.uint8array?"nodebuffer"===m?new k(g):q.uint8array?new l(h.transformTo("uint8array",g)):new f(h.transformTo("array",g)):new e(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(c,d,a){a.LOCAL_FILE_HEADER="PK\u0003\u0004";a.CENTRAL_FILE_HEADER="PK\u0001\u0002";a.CENTRAL_DIRECTORY_END="PK\u0005\u0006";a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\u0006\u0007";a.ZIP64_CENTRAL_DIRECTORY_END="PK\u0006\u0006";
a.DATA_DESCRIPTOR="PK\u0007\b"},{}],24:[function(c,d,a){function h(e){q.call(this,"ConvertWorker to "+e);this.destType=e}var q=c("./GenericWorker"),f=c("../utils");f.inherits(h,q);h.prototype.processChunk=function(e){this.push({data:f.transformTo(this.destType,e.data),meta:e.meta})};d.exports=h},{"../utils":32,"./GenericWorker":28}],25:[function(c,d,a){function h(){q.call(this,"Crc32Probe");this.withStreamInfo("crc32",0)}var q=c("./GenericWorker"),f=c("../crc32");c("../utils").inherits(h,q);h.prototype.processChunk=
function(e){this.streamInfo.crc32=f(e.data,this.streamInfo.crc32||0);this.push(e)};d.exports=h},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(c,d,a){function h(f){q.call(this,"DataLengthProbe for "+f);this.propName=f;this.withStreamInfo(f,0)}a=c("../utils");var q=c("./GenericWorker");a.inherits(h,q);h.prototype.processChunk=function(f){f&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+f.data.length);q.prototype.processChunk.call(this,f)};d.exports=h},{"../utils":32,
"./GenericWorker":28}],27:[function(c,d,a){function h(e){f.call(this,"DataWorker");var k=this;this.dataIsReady=!1;this.max=this.index=0;this.data=null;this.type="";this._tickScheduled=!1;e.then(function(l){k.dataIsReady=!0;k.data=l;k.max=l&&l.length||0;k.type=q.getTypeOf(l);k.isPaused||k._tickAndRepeat()},function(l){k.error(l)})}var q=c("../utils"),f=c("./GenericWorker");q.inherits(h,f);h.prototype.cleanUp=function(){f.prototype.cleanUp.call(this);this.data=null};h.prototype.resume=function(){return!!f.prototype.resume.call(this)&&
(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,q.delay(this._tickAndRepeat,[],this)),!0)};h.prototype._tickAndRepeat=function(){this._tickScheduled=!1;this.isPaused||this.isFinished||(this._tick(),this.isFinished||(q.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))};h.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,k=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case "string":e=this.data.substring(this.index,
k);break;case "uint8array":e=this.data.subarray(this.index,k);break;case "array":case "nodebuffer":e=this.data.slice(this.index,k)}return this.index=k,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})};d.exports=h},{"../utils":32,"./GenericWorker":28}],28:[function(c,d,a){function h(q){this.name=q||"default";this.streamInfo={};this.generatedError=null;this.extraStreamInfo={};this.isPaused=!0;this.isLocked=this.isFinished=!1;this._listeners={data:[],end:[],error:[]};this.previous=
null}h.prototype={push:function(q){this.emit("data",q)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(q){this.emit("error",q)}return!0},error:function(q){return!this.isFinished&&(this.isPaused?this.generatedError=q:(this.isFinished=!0,this.emit("error",q),this.previous&&this.previous.error(q),this.cleanUp()),!0)},on:function(q,f){return this._listeners[q].push(f),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=
null;this._listeners=[]},emit:function(q,f){if(this._listeners[q])for(var e=0;e<this._listeners[q].length;e++)this._listeners[q][e].call(this,f)},pipe:function(q){return q.registerPrevious(this)},registerPrevious:function(q){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=q.streamInfo;this.mergeStreamInfo();this.previous=q;var f=this;return q.on("data",function(e){f.processChunk(e)}),q.on("end",function(){f.end()}),q.on("error",function(e){f.error(e)}),
this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var q=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),q=!0),this.previous&&this.previous.resume(),!q},flush:function(){},processChunk:function(q){this.push(q)},withStreamInfo:function(q,f){return this.extraStreamInfo[q]=f,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var q in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,
q)&&(this.streamInfo[q]=this.extraStreamInfo[q])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0;this.previous&&this.previous.lock()},toString:function(){var q="Worker "+this.name;return this.previous?this.previous+" -> "+q:q}};d.exports=h},{}],29:[function(c,d,a){function h(m,p,n){var t=p;switch(p){case "blob":case "arraybuffer":t="uint8array";break;case "base64":t="string"}try{this._internalType=t,this._outputType=p,this._mimeType=n,
q.checkSupport(t),this._worker=m.pipe(new f(t)),m.lock()}catch(u){this._worker=new e("error"),this._worker.error(u)}}var q=c("../utils"),f=c("./ConvertWorker"),e=c("./GenericWorker"),k=c("../base64");a=c("../support");var l=c("../external"),g=null;if(a.nodestream)try{g=c("../nodejs/NodejsStreamOutputAdapter")}catch(m){}h.prototype={accumulate:function(m){var p;return p=this,new l.Promise(function(n,t){var u=[],v=p._internalType,A=p._outputType,D=p._mimeType;p.on("data",function(y,E){u.push(y);m&&
m(E)}).on("error",function(y){u=[];t(y)}).on("end",function(){try{var y=function(E,x,G){switch(E){case "blob":return q.newBlob(q.transformTo("arraybuffer",x),G);case "base64":return k.encode(x);default:return q.transformTo(E,x)}}(A,function(E,x){var G,I=0,O=0;for(G=0;G<x.length;G++)O+=x[G].length;switch(E){case "string":return x.join("");case "array":return Array.prototype.concat.apply([],x);case "uint8array":E=new Uint8Array(O);for(G=0;G<x.length;G++)E.set(x[G],I),I+=x[G].length;return E;case "nodebuffer":return oa.concat(x);
default:throw Error("concat : unsupported type '"+E+"'");}}(v,u),D);n(y)}catch(E){t(E)}u=[]}).resume()})},on:function(m,p){var n=this;return"data"===m?this._worker.on(m,function(t){p.call(n,t.data,t.meta)}):this._worker.on(m,function(){q.delay(p,arguments,n)}),this},resume:function(){return q.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(q.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+
" is not supported by this method");return new g(this,{objectMode:"nodebuffer"!==this._outputType},m)}};d.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(c,d,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer="u">typeof ArrayBuffer&&"u">typeof Uint8Array,a.nodebuffer=!0,a.uint8array="u">typeof Uint8Array,"u"<typeof ArrayBuffer)a.blob=!1;else{d=new ArrayBuffer(0);try{a.blob=
0===(new Blob([d],{type:"application/zip"})).size}catch(q){try{var h=new (self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);h.append(d);a.blob=0===h.getBlob("application/zip").size}catch(f){a.blob=!1}}}try{a.nodestream=!!c("readable-stream").Readable}catch(q){a.nodestream=!1}},{"readable-stream":16}],31:[function(c,d,a){function h(){l.call(this,"utf-8 decode");this.leftOver=null}function q(){l.call(this,"utf-8 encode")}var f=c("./utils"),e=c("./support"),k=c("./nodejsUtils"),
l=c("./stream/GenericWorker"),g=Array(256);for(c=0;c<256;c++)g[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;g[254]=g[254]=1;a.utf8encode=function(m){if(e.nodebuffer)m=k.newBufferFrom(m,"utf-8");else{var p,n,t,u,v=m.length,A=0;for(t=0;t<v;t++)55296==(64512&(p=m.charCodeAt(t)))&&t+1<v&&56320==(64512&(n=m.charCodeAt(t+1)))&&(p=65536+(p-55296<<10)+(n-56320),t++),A+=p<128?1:p<2048?2:p<65536?3:4;var D=e.uint8array?new Uint8Array(A):Array(A);for(t=u=0;u<A;t++)55296==(64512&(p=m.charCodeAt(t)))&&t+1<
v&&56320==(64512&(n=m.charCodeAt(t+1)))&&(p=65536+(p-55296<<10)+(n-56320),t++),p<128?D[u++]=p:(p<2048?D[u++]=192|p>>>6:(p<65536?D[u++]=224|p>>>12:(D[u++]=240|p>>>18,D[u++]=128|p>>>12&63),D[u++]=128|p>>>6&63),D[u++]=128|63&p);m=D}return m};a.utf8decode=function(m){if(e.nodebuffer)var p=f.transformTo("nodebuffer",m).toString("utf-8");else{p=f.transformTo(e.uint8array?"uint8array":"array",m);var n,t,u,v=p.length,A=Array(2*v);for(n=m=0;n<v;)if((t=p[n++])<128)A[m++]=t;else if(4<(u=g[t]))A[m++]=65533,n+=
u-1;else{for(t&=2===u?31:3===u?15:7;1<u&&n<v;)t=t<<6|63&p[n++],u--;1<u?A[m++]=65533:t<65536?A[m++]=t:(t-=65536,A[m++]=55296|t>>10&1023,A[m++]=56320|1023&t)}p=(A.length!==m&&(A.subarray?A=A.subarray(0,m):A.length=m),f.applyFromCharCode(A))}return p};f.inherits(h,l);h.prototype.processChunk=function(m){var p=f.transformTo(e.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(e.uint8array){var n=p;(p=new Uint8Array(n.length+this.leftOver.length)).set(this.leftOver,0);p.set(n,
this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}n=p;var t=void 0,u;(t=t||n.length)>n.length&&(t=n.length);for(u=t-1;0<=u&&128==(192&n[u]);)u--;n=u<0||0===u?t:u+g[n[u]]>t?u:t;t=p;n!==p.length&&(e.uint8array?(t=p.subarray(0,n),this.leftOver=p.subarray(n,p.length)):(t=p.slice(0,n),this.leftOver=p.slice(n,p.length)));this.push({data:a.utf8decode(t),meta:m.meta})};h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),
this.leftOver=null)};a.Utf8DecodeWorker=h;f.inherits(q,l);q.prototype.processChunk=function(m){this.push({data:a.utf8encode(m.data),meta:m.meta})};a.Utf8EncodeWorker=q},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(c,d,a){function h(v){return v}function q(v,A){for(var D=0;D<v.length;++D)A[D]=255&v.charCodeAt(D);return A}function f(v){var A=65536,D=a.getTypeOf(v),y=!0;if("uint8array"===D?y=t.applyCanBeUsed.uint8array:"nodebuffer"===D&&(y=t.applyCanBeUsed.nodebuffer),
y)for(;1<A;)try{return t.stringifyByChunk(v,D,A)}catch(E){A=Math.floor(A/2)}return t.stringifyByChar(v)}function e(v,A){for(var D=0;D<v.length;D++)A[D]=v[D];return A}var k=c("./support"),l=c("./base64"),g=c("./nodejsUtils"),m=c("./external");c("setimmediate");a.newBlob=function(v,A){a.checkSupport("blob");try{return new Blob([v],{type:A})}catch(y){try{var D=new (self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return D.append(v),D.getBlob(A)}catch(E){throw Error("Bug : can't construct the Blob.");
}}};try{var p=k.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(v){p=!1}c=p;try{var n=k.nodebuffer&&1===String.fromCharCode.apply(null,g.allocBuffer(1)).length}catch(v){n=!1}var t={stringifyByChunk:function(v,A,D){var y=[],E=0,x=v.length;if(x<=D)return String.fromCharCode.apply(null,v);for(;E<x;)"array"===A||"nodebuffer"===A?y.push(String.fromCharCode.apply(null,v.slice(E,Math.min(E+D,x)))):y.push(String.fromCharCode.apply(null,v.subarray(E,Math.min(E+D,x)))),E+=D;return y.join("")},
stringifyByChar:function(v){for(var A="",D=0;D<v.length;D++)A+=String.fromCharCode(v[D]);return A},applyCanBeUsed:{uint8array:c,nodebuffer:n}};a.applyFromCharCode=f;var u={};u.string={string:h,array:function(v){return q(v,Array(v.length))},arraybuffer:function(v){return u.string.uint8array(v).buffer},uint8array:function(v){return q(v,new Uint8Array(v.length))},nodebuffer:function(v){return q(v,g.allocBuffer(v.length))}};u.array={string:f,array:h,arraybuffer:function(v){return(new Uint8Array(v)).buffer},
uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return g.newBufferFrom(v)}};u.arraybuffer={string:function(v){return f(new Uint8Array(v))},array:function(v){return e(new Uint8Array(v),Array(v.byteLength))},arraybuffer:h,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return g.newBufferFrom(new Uint8Array(v))}};u.uint8array={string:f,array:function(v){return e(v,Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:h,nodebuffer:function(v){return g.newBufferFrom(v)}};
u.nodebuffer={string:f,array:function(v){return e(v,Array(v.length))},arraybuffer:function(v){return u.nodebuffer.uint8array(v).buffer},uint8array:function(v){return e(v,new Uint8Array(v.length))},nodebuffer:h};a.transformTo=function(v,A){return(A=A||"",v)?(a.checkSupport(v),u[a.getTypeOf(A)][v](A)):A};a.resolve=function(v){v=v.split("/");for(var A=[],D=0;D<v.length;D++){var y=v[D];"."===y||""===y&&0!==D&&D!==v.length-1||(".."===y?A.pop():A.push(y))}return A.join("/")};a.getTypeOf=function(v){return"string"==
typeof v?"string":"[object Array]"===Object.prototype.toString.call(v)?"array":k.nodebuffer&&g.isBuffer(v)?"nodebuffer":k.uint8array&&v instanceof Uint8Array?"uint8array":k.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0};a.checkSupport=function(v){if(!k[v.toLowerCase()])throw Error(v+" is not supported by this platform");};a.MAX_VALUE_16BITS=65535;a.MAX_VALUE_32BITS=-1;a.pretty=function(v){var A,D,y="";for(D=0;D<(v||"").length;D++)y+="\\x"+((A=v.charCodeAt(D))<16?"0":"")+A.toString(16).toUpperCase();
return y};a.delay=function(v,A,D){setImmediate(function(){v.apply(D||null,A||[])})};a.inherits=function(v,A){function D(){}D.prototype=A.prototype;v.prototype=new D};a.extend=function(){var v,A,D={};for(v=0;v<arguments.length;v++)for(A in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],A)&&void 0===D[A]&&(D[A]=arguments[v][A]);return D};a.prepareContent=function(v,A,D,y,E){return m.Promise.resolve(A).then(function(x){return k.blob&&(x instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x)))&&
"u">typeof FileReader?new m.Promise(function(G,I){var O=new FileReader;O.onload=function(B){G(B.target.result)};O.onerror=function(B){I(B.target.error)};O.readAsArrayBuffer(x)}):x}).then(function(x){var G,I=a.getTypeOf(x);return I?("arraybuffer"===I?x=a.transformTo("uint8array",x):"string"===I&&(E?x=l.decode(x):D&&!0!==y&&(x=q(G=x,k.uint8array?new Uint8Array(G.length):Array(G.length)))),x):m.Promise.reject(Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},
{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(c,d,a){function h(g){this.files=[];this.loadOptions=g}var q=c("./reader/readerFor"),f=c("./utils"),e=c("./signature"),k=c("./zipEntry"),l=c("./support");h.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var m=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+f.pretty(m)+", expected "+f.pretty(g)+")");}},isSignature:function(g,
m){var p=this.reader.index;this.reader.setIndex(g);g=this.reader.readString(4)===m;return this.reader.setIndex(p),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength);
g=f.transformTo(l.uint8array?"uint8array":"array",g);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.reader.skip(4);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData=
{};for(var g,m,p,n=this.zip64EndOfCentralSize-44;0<n;)g=this.reader.readInt(2),m=this.reader.readInt(4),p=this.reader.readData(m),this.zip64ExtensibleData[g]={id:g,length:m,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var g;for(g=0;g<
this.files.length;g++){var m=this.files[g];this.reader.setIndex(m.localHeaderOffset);this.checkSignature(e.LOCAL_FILE_HEADER);m.readLocalPart(this.reader);m.handleUTF8();m.processAttributes()}},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(g=new k({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&
0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length);},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);
var m=g;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");
if(this.reader.setIndex(g),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END);
this.readBlockZip64EndOfCentral()}g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);g=m-g;if(0<g)this.isSignature(m,e.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw Error("Corrupted zip: missing "+Math.abs(g)+" bytes.");},prepareReader:function(g){this.reader=q(g)},load:function(g){this.prepareReader(g);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};d.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,
"./utils":32,"./zipEntry":34}],34:[function(c,d,a){function h(p,n){this.options=p;this.loadOptions=n}var q=c("./reader/readerFor"),f=c("./utils"),e=c("./compressedObject"),k=c("./crc32"),l=c("./utf8"),g=c("./compressions"),m=c("./support");h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(p){var n;if(p.skip(22),this.fileNameLength=p.readInt(2),n=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(n),
-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");a:{n=this.compressionMethod;for(t in g)if(Object.prototype.hasOwnProperty.call(g,t)&&g[t].magic===n){var t=g[t];break a}t=null}if(null===t)throw Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=
new e(this.compressedSize,this.uncompressedSize,this.crc32,t,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2);p.skip(2);this.bitFlag=p.readInt(2);this.compressionMethod=p.readString(2);this.date=p.readDate();this.crc32=p.readInt(4);this.compressedSize=p.readInt(4);this.uncompressedSize=p.readInt(4);var n=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=
p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");p.skip(n);this.readExtraFields(p);this.parseZIP64ExtraField(p);this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.dosPermissions=this.unixPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes);0==p&&(this.dosPermissions=63&this.externalFileAttributes);3==p&&(this.unixPermissions=
this.externalFileAttributes>>16&65535);this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=q(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8));this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8));this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8));this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},
readExtraFields:function(p){var n=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<n;){var t=p.readInt(2);var u=p.readInt(2);var v=p.readData(u);this.extraFields[t]={id:t,length:u,value:v}}p.setIndex(n)},handleUTF8:function(){var p=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var n=this.findExtraFieldUnicodePath();null!==n?this.fileNameStr=n:(n=f.transformTo(p,
this.fileName),this.fileNameStr=this.loadOptions.decodeFileName(n));n=this.findExtraFieldUnicodeComment();null!==n?this.fileCommentStr=n:(p=f.transformTo(p,this.fileComment),this.fileCommentStr=this.loadOptions.decodeFileName(p))}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var n=q(p.value);return 1!==n.readInt(1)||k(this.fileName)!==n.readInt(4)?null:l.utf8decode(n.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];
if(p){var n=q(p.value);return 1!==n.readInt(1)||k(this.fileComment)!==n.readInt(4)?null:l.utf8decode(n.readData(p.length-5))}return null}};d.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(c,d,a){function h(m,p,n){this.name=m;this.dir=n.dir;this.date=n.date;this.comment=n.comment;this.unixPermissions=n.unixPermissions;this.dosPermissions=n.dosPermissions;this._data=p;this._dataBinary=n.binary;this.options=
{compression:n.compression,compressionOptions:n.compressionOptions}}var q=c("./stream/StreamHelper"),f=c("./stream/DataWorker"),e=c("./utf8"),k=c("./compressedObject"),l=c("./stream/GenericWorker");h.prototype={internalStream:function(m){var p=null,n="string";try{if(!m)throw Error("No output type specified.");var t="string"===(n=m.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string");p=this._decompressWorker();var u=!this._dataBinary;u&&!t&&(p=p.pipe(new e.Utf8EncodeWorker));!u&&
t&&(p=p.pipe(new e.Utf8DecodeWorker))}catch(v){(p=new l("error")).error(v)}return new q(p,n,"")},async:function(m,p){return this.internalStream(m).accumulate(p)},nodeStream:function(m,p){return this.internalStream(m||"nodebuffer").toNodejsStream(p)},_compressWorker:function(m,p){if(this._data instanceof k&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new e.Utf8EncodeWorker)),k.createWorkerFrom(n,m,
p)},_decompressWorker:function(){return this._data instanceof k?this._data.getContentWorker():this._data instanceof l?this._data:new f(this._data)}};c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"];a=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");};for(var g=0;g<c.length;g++)h.prototype[c[g]]=a;d.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],
36:[function(c,d,a){(function(h){function q(){var n;f=!0;for(var t=p.length;t;){var u=p;p=[];for(n=-1;++n<t;)u[n]();t=p.length}f=!1}var f,e=h.MutationObserver||h.WebKitMutationObserver;if(e){var k=0;e=new e(q);var l=h.document.createTextNode("");e.observe(l,{characterData:!0});var g=function(){l.data=k=++k%2}}else if(h.setImmediate||void 0===h.MessageChannel)g="document"in h&&"onreadystatechange"in h.document.createElement("script")?function(){var n=h.document.createElement("script");n.onreadystatechange=
function(){q();n.onreadystatechange=null;n.parentNode.removeChild(n);n=null};h.document.documentElement.appendChild(n)}:function(){setTimeout(q,0)};else{var m=new h.MessageChannel;m.port1.onmessage=q;g=function(){m.port2.postMessage(0)}}var p=[];d.exports=function(n){1!==p.push(n)||f||g()}}).call(this,void 0!==Oc?Oc:"u">typeof self?self:"u">typeof window?window:{})},{}],37:[function(c,d,a){function h(){}function q(v){if("function"!=typeof v)throw TypeError("resolver must be a function");this.state=
u;this.queue=[];this.outcome=void 0;v!==h&&l(this,v)}function f(v,A,D){this.promise=v;"function"==typeof A&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled);"function"==typeof D&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}function e(v,A,D){m(function(){try{var y=A(D)}catch(E){return p.reject(v,E)}y===v?p.reject(v,TypeError("Cannot resolve promise with itself")):p.resolve(v,y)})}function k(v){var A=v&&v.then;if(v&&("object"==typeof v||"function"==typeof v)&&"function"==
typeof A)return function(){A.apply(v,arguments)}}function l(v,A){function D(G){E||(E=!0,p.reject(v,G))}function y(G){E||(E=!0,p.resolve(v,G))}var E=!1,x=g(function(){A(y,D)});"error"===x.status&&D(x.value)}function g(v,A){var D={};try{D.value=v(A),D.status="success"}catch(y){D.status="error",D.value=y}return D}var m=c("immediate"),p={},n=["REJECTED"],t=["FULFILLED"],u=["PENDING"];(d.exports=q).prototype.finally=function(v){if("function"!=typeof v)return this;var A=this.constructor;return this.then(function(D){return A.resolve(v()).then(function(){return D})},
function(D){return A.resolve(v()).then(function(){throw D;})})};q.prototype.catch=function(v){return this.then(null,v)};q.prototype.then=function(v,A){if("function"!=typeof v&&this.state===t||"function"!=typeof A&&this.state===n)return this;var D=new this.constructor(h);return this.state!==u?e(D,this.state===t?v:A,this.outcome):this.queue.push(new f(D,v,A)),D};f.prototype.callFulfilled=function(v){p.resolve(this.promise,v)};f.prototype.otherCallFulfilled=function(v){e(this.promise,this.onFulfilled,
v)};f.prototype.callRejected=function(v){p.reject(this.promise,v)};f.prototype.otherCallRejected=function(v){e(this.promise,this.onRejected,v)};p.resolve=function(v,A){var D=g(k,A);if("error"===D.status)return p.reject(v,D.value);if(D=D.value)l(v,D);else{v.state=t;v.outcome=A;D=-1;for(var y=v.queue.length;++D<y;)v.queue[D].callFulfilled(A)}return v};p.reject=function(v,A){v.state=n;v.outcome=A;for(var D=-1,y=v.queue.length;++D<y;)v.queue[D].callRejected(A);return v};q.resolve=function(v){return v instanceof
this?v:p.resolve(new this(h),v)};q.reject=function(v){var A=new this(h);return p.reject(A,v)};q.all=function(v){var A=this;if("[object Array]"!==Object.prototype.toString.call(v))return this.reject(TypeError("must be an array"));var D=v.length,y=!1;if(!D)return this.resolve([]);for(var E=Array(D),x=0,G=-1,I=new this(h);++G<D;)!function(O,B){A.resolve(O).then(function(N){E[B]=N;++x!==D||y||(y=!0,p.resolve(I,E))},function(N){y||(y=!0,p.reject(I,N))})}(v[G],G);return I};q.race=function(v){if("[object Array]"!==
Object.prototype.toString.call(v))return this.reject(TypeError("must be an array"));var A=v.length,D=!1;if(!A)return this.resolve([]);for(var y=-1,E=new this(h);++y<A;){var x=v[y];this.resolve(x).then(function(G){D||(D=!0,p.resolve(E,G))},function(G){D||(D=!0,p.reject(E,G))})}return E}},{immediate:36}],38:[function(c,d,a){a={};(0,c("./lib/utils/common").assign)(a,c("./lib/deflate"),c("./lib/inflate"),c("./lib/zlib/constants"));d.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,
"./lib/zlib/constants":44}],39:[function(c,d,a){function h(p){if(!(this instanceof h))return new h(p);this.options=e.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},p||{});var n;p=this.options;p.raw&&0<p.windowBits?p.windowBits=-p.windowBits:p.gzip&&0<p.windowBits&&p.windowBits<16&&(p.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new g;this.strm.avail_out=0;var t=f.deflateInit2(this.strm,p.level,p.method,p.windowBits,p.memLevel,
p.strategy);if(0!==t)throw Error(l[t]);if(p.header&&f.deflateSetHeader(this.strm,p.header),p.dictionary){if(n="string"==typeof p.dictionary?k.string2buf(p.dictionary):"[object ArrayBuffer]"===m.call(p.dictionary)?new Uint8Array(p.dictionary):p.dictionary,0!==(t=f.deflateSetDictionary(this.strm,n)))throw Error(l[t]);this._dict_set=!0}}function q(p,n){n=new h(n);if(n.push(p,!0),n.err)throw n.msg||l[n.err];return n.result}var f=c("./zlib/deflate"),e=c("./utils/common"),k=c("./utils/strings"),l=c("./zlib/messages"),
g=c("./zlib/zstream"),m=Object.prototype.toString;h.prototype.push=function(p,n){var t,u=this.strm,v=this.options.chunkSize;if(this.ended)return!1;n=n===~~n?n:4*(!0===n);"string"==typeof p?u.input=k.string2buf(p):"[object ArrayBuffer]"===m.call(p)?u.input=new Uint8Array(p):u.input=p;u.next_in=0;u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new e.Buf8(v),u.next_out=0,u.avail_out=v),1!==(t=f.deflate(u,n))&&0!==t)return this.onEnd(t),this.ended=!0,!1;0!==u.avail_out&&(0!==u.avail_in||4!==
n&&2!==n)||("string"===this.options.to?this.onData(k.buf2binstring(e.shrinkBuf(u.output,u.next_out))):this.onData(e.shrinkBuf(u.output,u.next_out)))}while((0<u.avail_in||0===u.avail_out)&&1!==t);return 4===n?(t=f.deflateEnd(this.strm),this.onEnd(t),this.ended=!0,0===t):2!==n||(this.onEnd(0),u.avail_out=0,!0)};h.prototype.onData=function(p){this.chunks.push(p)};h.prototype.onEnd=function(p){0===p&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks));
this.chunks=[];this.err=p;this.msg=this.strm.msg};a.Deflate=h;a.deflate=q;a.deflateRaw=function(p,n){return(n=n||{}).raw=!0,q(p,n)};a.gzip=function(p,n){return(n=n||{}).gzip=!0,q(p,n)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(c,d,a){function h(t){if(!(this instanceof h))return new h(t);var u=this.options=e.assign({chunkSize:16384,windowBits:0,to:""},t||{});u.raw&&0<=u.windowBits&&u.windowBits<16&&(u.windowBits=-u.windowBits,
0===u.windowBits&&(u.windowBits=-15));!(0<=u.windowBits&&u.windowBits<16)||t&&t.windowBits||(u.windowBits+=32);15<u.windowBits&&u.windowBits<48&&0==(15&u.windowBits)&&(u.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new m;this.strm.avail_out=0;t=f.inflateInit2(this.strm,u.windowBits);if(t!==l.Z_OK)throw Error(g[t]);this.header=new p;f.inflateGetHeader(this.strm,this.header)}function q(t,u){u=new h(u);if(u.push(t,!0),u.err)throw u.msg||g[u.err];return u.result}var f=
c("./zlib/inflate"),e=c("./utils/common"),k=c("./utils/strings"),l=c("./zlib/constants"),g=c("./zlib/messages"),m=c("./zlib/zstream"),p=c("./zlib/gzheader"),n=Object.prototype.toString;h.prototype.push=function(t,u){var v,A,D,y,E,x=this.strm,G=this.options.chunkSize,I=this.options.dictionary,O=!1;if(this.ended)return!1;u=u===~~u?u:!0===u?l.Z_FINISH:l.Z_NO_FLUSH;"string"==typeof t?x.input=k.binstring2buf(t):"[object ArrayBuffer]"===n.call(t)?x.input=new Uint8Array(t):x.input=t;x.next_in=0;x.avail_in=
x.input.length;do{if(0===x.avail_out&&(x.output=new e.Buf8(G),x.next_out=0,x.avail_out=G),(v=f.inflate(x,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(E="string"==typeof I?k.string2buf(I):"[object ArrayBuffer]"===n.call(I)?new Uint8Array(I):I,v=f.inflateSetDictionary(this.strm,E)),v===l.Z_BUF_ERROR&&!0===O&&(v=l.Z_OK,O=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),this.ended=!0,!1;x.next_out&&(0!==x.avail_out&&v!==l.Z_STREAM_END&&(0!==x.avail_in||u!==l.Z_FINISH&&u!==l.Z_SYNC_FLUSH)||("string"===this.options.to?
(A=k.utf8border(x.output,x.next_out),D=x.next_out-A,y=k.buf2string(x.output,A),x.next_out=D,x.avail_out=G-D,D&&e.arraySet(x.output,x.output,A,D,0),this.onData(y)):this.onData(e.shrinkBuf(x.output,x.next_out))));0===x.avail_in&&0===x.avail_out&&(O=!0)}while((0<x.avail_in||0===x.avail_out)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(u=l.Z_FINISH),u===l.Z_FINISH?(v=f.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):u!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),x.avail_out=0,!0)};h.prototype.onData=
function(t){this.chunks.push(t)};h.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks));this.chunks=[];this.err=t;this.msg=this.strm.msg};a.Inflate=h;a.inflate=q;a.inflateRaw=function(t,u){return(u=u||{}).raw=!0,q(t,u)};a.ungzip=q},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(c,d,a){c="u">typeof Uint8Array&&
"u">typeof Uint16Array&&"u">typeof Int32Array;a.assign=function(f){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var k=e.shift();if(k){if("object"!=typeof k)throw TypeError(k+"must be non-object");for(var l in k)k.hasOwnProperty(l)&&(f[l]=k[l])}}return f};a.shrinkBuf=function(f,e){return f.length===e?f:f.subarray?f.subarray(0,e):(f.length=e,f)};var h={arraySet:function(f,e,k,l,g){if(e.subarray&&f.subarray)f.set(e.subarray(k,k+l),g);else for(var m=0;m<l;m++)f[g+m]=e[k+m]},flattenChunks:function(f){var e,
k;var l=k=0;for(e=f.length;l<e;l++)k+=f[l].length;var g=new Uint8Array(k);l=k=0;for(e=f.length;l<e;l++){var m=f[l];g.set(m,k);k+=m.length}return g}},q={arraySet:function(f,e,k,l,g){for(var m=0;m<l;m++)f[g+m]=e[k+m]},flattenChunks:function(f){return[].concat.apply([],f)}};a.setTyped=function(f){f?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,h)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,q))};a.setTyped(c)},{}],42:[function(c,d,a){function h(l,g){if(g<65537&&(l.subarray&&
e||!l.subarray&&f))return String.fromCharCode.apply(null,q.shrinkBuf(l,g));for(var m="",p=0;p<g;p++)m+=String.fromCharCode(l[p]);return m}var q=c("./common"),f=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch(l){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){e=!1}var k=new q.Buf8(256);for(c=0;c<256;c++)k[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;k[254]=k[254]=1;a.string2buf=function(l){var g,m,p,n,t=l.length,u=0;for(p=0;p<t;p++)55296==(64512&(g=l.charCodeAt(p)))&&
p+1<t&&56320==(64512&(m=l.charCodeAt(p+1)))&&(g=65536+(g-55296<<10)+(m-56320),p++),u+=g<128?1:g<2048?2:g<65536?3:4;var v=new q.Buf8(u);for(p=n=0;n<u;p++)55296==(64512&(g=l.charCodeAt(p)))&&p+1<t&&56320==(64512&(m=l.charCodeAt(p+1)))&&(g=65536+(g-55296<<10)+(m-56320),p++),g<128?v[n++]=g:(g<2048?v[n++]=192|g>>>6:(g<65536?v[n++]=224|g>>>12:(v[n++]=240|g>>>18,v[n++]=128|g>>>12&63),v[n++]=128|g>>>6&63),v[n++]=128|63&g);return v};a.buf2binstring=function(l){return h(l,l.length)};a.binstring2buf=function(l){for(var g=
new q.Buf8(l.length),m=0,p=g.length;m<p;m++)g[m]=l.charCodeAt(m);return g};a.buf2string=function(l,g){var m,p,n,t=g||l.length,u=Array(2*t);for(g=m=0;g<t;)if((p=l[g++])<128)u[m++]=p;else if(4<(n=k[p]))u[m++]=65533,g+=n-1;else{for(p&=2===n?31:3===n?15:7;1<n&&g<t;)p=p<<6|63&l[g++],n--;1<n?u[m++]=65533:p<65536?u[m++]=p:(p-=65536,u[m++]=55296|p>>10&1023,u[m++]=56320|1023&p)}return h(u,m)};a.utf8border=function(l,g){var m;(g=g||l.length)>l.length&&(g=l.length);for(m=g-1;0<=m&&128==(192&l[m]);)m--;return m<
0||0===m?g:m+k[l[m]]>g?m:g}},{"./common":41}],43:[function(c,d,a){d.exports=function(h,q,f,e){var k=65535&h;h=h>>>16&65535;for(var l;0!==f;){for(f-=l=2E3<f?2E3:f;h=h+(k=k+q[e++]|0)|0,--l;);k%=65521;h%=65521}return k|h<<16}},{}],44:[function(c,d,a){d.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,
Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(c,d,a){var h=function(){for(var q,f=[],e=0;e<256;e++){q=e;for(var k=0;k<8;k++)q=1&q?3988292384^q>>>1:q>>>1;f[e]=q}return f}();d.exports=function(q,f,e,k){e=k+e;for(q^=-1;k<e;k++)q=q>>>8^h[255&(q^f[k])];return-1^q}},{}],46:[function(c,d,a){function h(B,N){return B.msg=I[N],N}function q(B){for(var N=B.length;0<=--N;)B[N]=0}function f(B){var N=
B.state,P=N.pending;P>B.avail_out&&(P=B.avail_out);0!==P&&(y.arraySet(B.output,N.pending_buf,N.pending_out,P,B.next_out),B.next_out+=P,N.pending_out+=P,B.total_out+=P,B.avail_out-=P,N.pending-=P,0===N.pending&&(N.pending_out=0))}function e(B,N){E._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,N);B.block_start=B.strstart;f(B.strm)}function k(B,N){B.pending_buf[B.pending++]=N}function l(B,N){B.pending_buf[B.pending++]=N>>>8&255;B.pending_buf[B.pending++]=255&N}function g(B,
N){var P,L,ia=B.max_chain_length,V=B.strstart,ma=B.prev_length,da=B.nice_match,Ca=B.strstart>B.w_size-262?B.strstart-(B.w_size-262):0,ha=B.window,sa=B.w_mask,ea=B.prev,w=B.strstart+258,H=ha[V+ma-1],U=ha[V+ma];B.prev_length>=B.good_match&&(ia>>=2);da>B.lookahead&&(da=B.lookahead);do if(ha[(P=N)+ma]===U&&ha[P+ma-1]===H&&ha[P]===ha[V]&&ha[++P]===ha[V+1]){V+=2;for(P++;ha[++V]===ha[++P]&&ha[++V]===ha[++P]&&ha[++V]===ha[++P]&&ha[++V]===ha[++P]&&ha[++V]===ha[++P]&&ha[++V]===ha[++P]&&ha[++V]===ha[++P]&&ha[++V]===
ha[++P]&&V<w;);if(L=258-(w-V),V=w-258,ma<L){if(B.match_start=N,da<=(ma=L))break;H=ha[V+ma-1];U=ha[V+ma]}}while((N=ea[N&sa])>Ca&&0!=--ia);return ma<=B.lookahead?ma:B.lookahead}function m(B){var N,P,L,ia,V,ma,da,Ca,ha,sa=B.w_size;do{if(ia=B.window_size-B.lookahead-B.strstart,B.strstart>=sa+(sa-262)){y.arraySet(B.window,B.window,sa,sa,0);B.match_start-=sa;B.strstart-=sa;B.block_start-=sa;for(N=P=B.hash_size;L=B.head[--N],B.head[N]=sa<=L?L-sa:0,--P;);for(N=P=sa;L=B.prev[--N],B.prev[N]=sa<=L?L-sa:0,--P;);
ia+=sa}if(0===B.strm.avail_in)break;if(V=B.strm,ma=B.window,da=B.strstart+B.lookahead,ha=void 0,(Ca=ia)<(ha=V.avail_in)&&(ha=Ca),P=0===ha?0:(V.avail_in-=ha,y.arraySet(ma,V.input,V.next_in,ha,da),1===V.state.wrap?V.adler=x(V.adler,ma,ha,da):2===V.state.wrap&&(V.adler=G(V.adler,ma,ha,da)),V.next_in+=ha,V.total_in+=ha,ha),B.lookahead+=P,B.lookahead+B.insert>=3)for(N=B.strstart-B.insert,B.ins_h=B.window[N],B.ins_h=(B.ins_h<<B.hash_shift^B.window[N+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^
B.window[N+3-1])&B.hash_mask,B.prev[N&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=N,N++,B.insert--,!(B.lookahead+B.insert<3)););}while(B.lookahead<262&&0!==B.strm.avail_in)}function p(B,N){for(var P,L;;){if(B.lookahead<262){if(m(B),B.lookahead<262&&0===N)return 1;if(0===B.lookahead)break}if(P=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,P=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),0!==P&&B.strstart-P<=B.w_size-262&&(B.match_length=
g(B,P)),B.match_length>=3)if(L=E._tr_tally(B,B.strstart-B.match_start,B.match_length-3),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=3){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,P=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,0!=--B.match_length;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+
1])&B.hash_mask;else L=E._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(L&&(e(B,!1),0===B.strm.avail_out))return 1}return B.insert=B.strstart<2?B.strstart:2,4===N?(e(B,!0),0===B.strm.avail_out?3:4):B.last_lit&&(e(B,!1),0===B.strm.avail_out)?1:2}function n(B,N){for(var P,L,ia;;){if(B.lookahead<262){if(m(B),B.lookahead<262&&0===N)return 1;if(0===B.lookahead)break}if(P=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,P=B.prev[B.strstart&B.w_mask]=
B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=2,0!==P&&B.prev_length<B.max_lazy_match&&B.strstart-P<=B.w_size-262&&(B.match_length=g(B,P),B.match_length<=5&&(1===B.strategy||3===B.match_length&&4096<B.strstart-B.match_start)&&(B.match_length=2)),B.prev_length>=3&&B.match_length<=B.prev_length){ia=B.strstart+B.lookahead-3;L=E._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-3);B.lookahead-=B.prev_length-1;for(B.prev_length-=2;++B.strstart<=
ia&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,P=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),0!=--B.prev_length;);if(B.match_available=0,B.match_length=2,B.strstart++,L&&(e(B,!1),0===B.strm.avail_out))return 1}else if(B.match_available){if(E._tr_tally(B,0,B.window[B.strstart-1])&&e(B,!1),B.strstart++,B.lookahead--,0===B.strm.avail_out)return 1}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(E._tr_tally(B,0,B.window[B.strstart-
1]),B.match_available=0),B.insert=B.strstart<2?B.strstart:2,4===N?(e(B,!0),0===B.strm.avail_out?3:4):B.last_lit&&(e(B,!1),0===B.strm.avail_out)?1:2}function t(B,N,P,L,ia){this.good_length=B;this.max_lazy=N;this.nice_length=P;this.max_chain=L;this.func=ia}function u(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;
this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new y.Buf16(1146);this.dyn_dtree=new y.Buf16(122);this.bl_tree=new y.Buf16(78);q(this.dyn_ltree);q(this.dyn_dtree);q(this.bl_tree);this.bl_desc=
this.d_desc=this.l_desc=null;this.bl_count=new y.Buf16(16);this.heap=new y.Buf16(573);q(this.heap);this.heap_max=this.heap_len=0;this.depth=new y.Buf16(573);q(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function v(B){var N;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=2,(N=B.state).pending=0,N.pending_out=0,N.wrap<0&&(N.wrap=-N.wrap),N.status=N.wrap?42:113,B.adler=+(2!==N.wrap),N.last_flush=
0,E._tr_init(N),0):h(B,-2)}function A(B){var N,P=v(B);return 0===P&&((N=B.state).window_size=2*N.w_size,q(N.head),N.max_lazy_match=O[N.level].max_lazy,N.good_match=O[N.level].good_length,N.nice_match=O[N.level].nice_length,N.max_chain_length=O[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=2,N.match_available=0,N.ins_h=0),P}function D(B,N,P,L,ia,V){if(!B)return-2;var ma=1;if(-1===N&&(N=6),L<0?(ma=0,L=-L):15<L&&(ma=2,L-=16),ia<1||9<ia||8!==P||
L<8||15<L||N<0||9<N||V<0||4<V)return h(B,-2);8===L&&(L=9);var da=new u;return(B.state=da).strm=B,da.wrap=ma,da.gzhead=null,da.w_bits=L,da.w_size=1<<da.w_bits,da.w_mask=da.w_size-1,da.hash_bits=ia+7,da.hash_size=1<<da.hash_bits,da.hash_mask=da.hash_size-1,da.hash_shift=~~((da.hash_bits+3-1)/3),da.window=new y.Buf8(2*da.w_size),da.head=new y.Buf16(da.hash_size),da.prev=new y.Buf16(da.w_size),da.lit_bufsize=1<<ia+6,da.pending_buf_size=4*da.lit_bufsize,da.pending_buf=new y.Buf8(da.pending_buf_size),da.d_buf=
+da.lit_bufsize,da.l_buf=3*da.lit_bufsize,da.level=N,da.strategy=V,da.method=P,A(B)}var y=c("../utils/common"),E=c("./trees"),x=c("./adler32"),G=c("./crc32"),I=c("./messages");var O=[new t(0,0,0,0,function(B,N){var P=65535;for(65535>B.pending_buf_size-5&&(P=B.pending_buf_size-5);;){if(B.lookahead<=1){if(m(B),0===B.lookahead&&0===N)return 1;if(0===B.lookahead)break}B.strstart+=B.lookahead;B.lookahead=0;var L=B.block_start+P;if((0===B.strstart||B.strstart>=L)&&(B.lookahead=B.strstart-L,B.strstart=L,
e(B,!1),0===B.strm.avail_out)||B.strstart-B.block_start>=B.w_size-262&&(e(B,!1),0===B.strm.avail_out))return 1}return B.insert=0,4===N?(e(B,!0),0===B.strm.avail_out?3:4):(B.strstart>B.block_start&&(e(B,!1),B.strm.avail_out),1)}),new t(4,4,8,4,p),new t(4,5,16,8,p),new t(4,6,32,32,p),new t(4,4,16,16,n),new t(8,16,32,32,n),new t(8,16,128,128,n),new t(8,32,128,256,n),new t(32,128,258,1024,n),new t(32,258,258,4096,n)];a.deflateInit=function(B,N){return D(B,N,8,15,8,0)};a.deflateInit2=D;a.deflateReset=
A;a.deflateResetKeep=v;a.deflateSetHeader=function(B,N){return B&&B.state?2!==B.state.wrap?-2:(B.state.gzhead=N,0):-2};a.deflate=function(B,N){var P,L;if(!B||!B.state||5<N||N<0)return B?h(B,-2):-2;if(L=B.state,!B.output||!B.input&&0!==B.avail_in||666===L.status&&4!==N)return h(B,0===B.avail_out?-5:-2);if(L.strm=B,P=L.last_flush,L.last_flush=N,42===L.status)if(2===L.wrap)B.adler=0,k(L,31),k(L,139),k(L,8),L.gzhead?(k(L,+!!L.gzhead.text+2*!!L.gzhead.hcrc+4*!!L.gzhead.extra+8*!!L.gzhead.name+16*!!L.gzhead.comment),
k(L,255&L.gzhead.time),k(L,L.gzhead.time>>8&255),k(L,L.gzhead.time>>16&255),k(L,L.gzhead.time>>24&255),k(L,9===L.level?2:4*(2<=L.strategy||L.level<2)),k(L,255&L.gzhead.os),L.gzhead.extra&&L.gzhead.extra.length&&(k(L,255&L.gzhead.extra.length),k(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(B.adler=G(B.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=69):(k(L,0),k(L,0),k(L,0),k(L,0),k(L,0),k(L,9===L.level?2:4*(2<=L.strategy||L.level<2)),k(L,3),L.status=113);else{var ia=8+(L.w_bits-8<<4)<<
8;ia|=(2<=L.strategy||L.level<2?0:L.level<6?1:6===L.level?2:3)<<6;0!==L.strstart&&(ia|=32);L.status=113;l(L,ia+(31-ia%31));0!==L.strstart&&(l(L,B.adler>>>16),l(L,65535&B.adler));B.adler=1}if(69===L.status)if(L.gzhead.extra){for(ia=L.pending;L.gzindex<(65535&L.gzhead.extra.length)&&(L.pending!==L.pending_buf_size||(L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia)),f(B),ia=L.pending,L.pending!==L.pending_buf_size));)k(L,255&L.gzhead.extra[L.gzindex]),L.gzindex++;L.gzhead.hcrc&&
L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia));L.gzindex===L.gzhead.extra.length&&(L.gzindex=0,L.status=73)}else L.status=73;if(73===L.status)if(L.gzhead.name){ia=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia)),f(B),ia=L.pending,L.pending===L.pending_buf_size)){var V=1;break}V=L.gzindex<L.gzhead.name.length?255&L.gzhead.name.charCodeAt(L.gzindex++):0;k(L,V)}while(0!==V);L.gzhead.hcrc&&L.pending>ia&&
(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia));0===V&&(L.gzindex=0,L.status=91)}else L.status=91;if(91===L.status)if(L.gzhead.comment){ia=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-ia,ia)),f(B),ia=L.pending,L.pending===L.pending_buf_size)){V=1;break}V=L.gzindex<L.gzhead.comment.length?255&L.gzhead.comment.charCodeAt(L.gzindex++):0;k(L,V)}while(0!==V);L.gzhead.hcrc&&L.pending>ia&&(B.adler=G(B.adler,L.pending_buf,L.pending-
ia,ia));0===V&&(L.status=103)}else L.status=103;if(103===L.status&&(L.gzhead.hcrc?(L.pending+2>L.pending_buf_size&&f(B),L.pending+2<=L.pending_buf_size&&(k(L,255&B.adler),k(L,B.adler>>8&255),B.adler=0,L.status=113)):L.status=113),0!==L.pending){if(f(B),0===B.avail_out)return L.last_flush=-1,0}else if(0===B.avail_in&&(N<<1)-9*(4<N)<=(P<<1)-9*(4<P)&&4!==N)return h(B,-5);if(666===L.status&&0!==B.avail_in)return h(B,-5);if(0!==B.avail_in||0!==L.lookahead||0!==N&&666!==L.status){P=2===L.strategy?function(ma,
da){for(var Ca;;){if(0===ma.lookahead&&(m(ma),0===ma.lookahead)){if(0===da)return 1;break}if(ma.match_length=0,Ca=E._tr_tally(ma,0,ma.window[ma.strstart]),ma.lookahead--,ma.strstart++,Ca&&(e(ma,!1),0===ma.strm.avail_out))return 1}return ma.insert=0,4===da?(e(ma,!0),0===ma.strm.avail_out?3:4):ma.last_lit&&(e(ma,!1),0===ma.strm.avail_out)?1:2}(L,N):3===L.strategy?function(ma,da){for(var Ca,ha,sa,ea,w=ma.window;;){if(ma.lookahead<=258){if(m(ma),ma.lookahead<=258&&0===da)return 1;if(0===ma.lookahead)break}if(ma.match_length=
0,ma.lookahead>=3&&0<ma.strstart&&(ha=w[sa=ma.strstart-1])===w[++sa]&&ha===w[++sa]&&ha===w[++sa]){for(ea=ma.strstart+258;ha===w[++sa]&&ha===w[++sa]&&ha===w[++sa]&&ha===w[++sa]&&ha===w[++sa]&&ha===w[++sa]&&ha===w[++sa]&&ha===w[++sa]&&sa<ea;);ma.match_length=258-(ea-sa);ma.match_length>ma.lookahead&&(ma.match_length=ma.lookahead)}if(ma.match_length>=3?(Ca=E._tr_tally(ma,1,ma.match_length-3),ma.lookahead-=ma.match_length,ma.strstart+=ma.match_length,ma.match_length=0):(Ca=E._tr_tally(ma,0,ma.window[ma.strstart]),
ma.lookahead--,ma.strstart++),Ca&&(e(ma,!1),0===ma.strm.avail_out))return 1}return ma.insert=0,4===da?(e(ma,!0),0===ma.strm.avail_out?3:4):ma.last_lit&&(e(ma,!1),0===ma.strm.avail_out)?1:2}(L,N):O[L.level].func(L,N);if(3!==P&&4!==P||(L.status=666),1===P||3===P)return 0===B.avail_out&&(L.last_flush=-1),0;if(2===P&&(1===N?E._tr_align(L):5!==N&&(E._tr_stored_block(L,0,0,!1),3===N&&(q(L.head),0===L.lookahead&&(L.strstart=0,L.block_start=0,L.insert=0))),f(B),0===B.avail_out))return L.last_flush=-1,0}return 4!==
N?0:L.wrap<=0?1:(2===L.wrap?(k(L,255&B.adler),k(L,B.adler>>8&255),k(L,B.adler>>16&255),k(L,B.adler>>24&255),k(L,255&B.total_in),k(L,B.total_in>>8&255),k(L,B.total_in>>16&255),k(L,B.total_in>>24&255)):(l(L,B.adler>>>16),l(L,65535&B.adler)),f(B),0<L.wrap&&(L.wrap=-L.wrap),+(0===L.pending))};a.deflateEnd=function(B){var N;return B&&B.state?42!==(N=B.state.status)&&69!==N&&73!==N&&91!==N&&103!==N&&113!==N&&666!==N?h(B,-2):(B.state=null,113===N?h(B,-3):0):-2};a.deflateSetDictionary=function(B,N){var P,
L,ia;var V=N.length;if(!B||!B.state||2===(L=(P=B.state).wrap)||1===L&&42!==P.status||P.lookahead)return-2;1===L&&(B.adler=x(B.adler,N,V,0));P.wrap=0;V>=P.w_size&&(0===L&&(q(P.head),P.strstart=0,P.block_start=0,P.insert=0),ia=new y.Buf8(P.w_size),y.arraySet(ia,N,V-P.w_size,P.w_size,0),N=ia,V=P.w_size);ia=B.avail_in;var ma=B.next_in;var da=B.input;B.avail_in=V;B.next_in=0;B.input=N;for(m(P);P.lookahead>=3;){N=P.strstart;for(V=P.lookahead-2;P.ins_h=(P.ins_h<<P.hash_shift^P.window[N+3-1])&P.hash_mask,
P.prev[N&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=N,N++,--V;);P.strstart=N;P.lookahead=2;m(P)}return P.strstart+=P.lookahead,P.block_start=P.strstart,P.insert=P.lookahead,P.lookahead=0,P.match_length=P.prev_length=2,P.match_available=0,B.next_in=ma,B.input=da,B.avail_in=ia,P.wrap=L,0};a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(c,d,a){d.exports=function(){this.os=this.xflags=this.time=this.text=
0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],48:[function(c,d,a){d.exports=function(h,q){var f,e,k,l;var g=h.state;var m=h.next_in;var p=h.input;var n=m+(h.avail_in-5);var t=h.next_out;var u=h.output;q=t-(q-h.avail_out);var v=t+(h.avail_out-257);var A=g.dmax;var D=g.wsize;var y=g.whave;var E=g.wnext;var x=g.window;var G=g.hold;var I=g.bits;var O=g.lencode;var B=g.distcode;var N=(1<<g.lenbits)-1;var P=(1<<g.distbits)-1;a:do for(I<15&&(G+=p[m++]<<I,I+=
8,G+=p[m++]<<I,I+=8),f=O[G&N];;){if(G>>>=e=f>>>24,I-=e,0==(e=f>>>16&255))u[t++]=65535&f;else{if(!(16&e)){if(0==(64&e)){f=O[(65535&f)+(G&(1<<e)-1)];continue}if(32&e){g.mode=12;break a}h.msg="invalid literal/length code";g.mode=30;break a}var L=65535&f;(e&=15)&&(I<e&&(G+=p[m++]<<I,I+=8),L+=G&(1<<e)-1,G>>>=e,I-=e);I<15&&(G+=p[m++]<<I,I+=8,G+=p[m++]<<I,I+=8);for(f=B[G&P];;){if(G>>>=e=f>>>24,I-=e,!(16&(e=f>>>16&255))){if(0==(64&e)){f=B[(65535&f)+(G&(1<<e)-1)];continue}h.msg="invalid distance code";g.mode=
30;break a}if(k=65535&f,I<(e&=15)&&(G+=p[m++]<<I,(I+=8)<e&&(G+=p[m++]<<I,I+=8)),A<(k+=G&(1<<e)-1)){h.msg="invalid distance too far back";g.mode=30;break a}if(G>>>=e,I-=e,(e=t-q)<k){if(y<(e=k-e)&&g.sane){h.msg="invalid distance too far back";g.mode=30;break a}if(l=x,(f=0)===E){if(f+=D-e,e<L){for(L-=e;u[t++]=x[f++],--e;);f=t-k;l=u}}else if(E<e){if(f+=D+E-e,(e-=E)<L){for(L-=e;u[t++]=x[f++],--e;);if(f=0,E<L){for(L-=e=E;u[t++]=x[f++],--e;);f=t-k;l=u}}}else if(f+=E-e,e<L){for(L-=e;u[t++]=x[f++],--e;);f=
t-k;l=u}for(;2<L;)u[t++]=l[f++],u[t++]=l[f++],u[t++]=l[f++],L-=3;L&&(u[t++]=l[f++],1<L&&(u[t++]=l[f++]))}else{for(f=t-k;u[t++]=u[f++],u[t++]=u[f++],u[t++]=u[f++],2<(L-=3););L&&(u[t++]=u[f++],1<L&&(u[t++]=u[f++]))}break}}break}while(m<n&&t<v);m-=L=I>>3;G&=(1<<(I-=L<<3))-1;h.next_in=m;h.next_out=t;h.avail_in=m<n?n-m+5:5-(m-n);h.avail_out=t<v?v-t+257:257-(t-v);g.hold=G;g.bits=I}},{}],49:[function(c,d,a){function h(y){return(y>>>24&255)+(y>>>8&65280)+((65280&y)<<8)+((255&y)<<24)}function q(){this.mode=
0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new m.Buf16(320);this.work=new m.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function f(y){var E;return y&&y.state?(E=y.state,
y.total_in=y.total_out=E.total=0,y.msg="",E.wrap&&(y.adler=1&E.wrap),E.mode=1,E.last=0,E.havedict=0,E.dmax=32768,E.head=null,E.hold=0,E.bits=0,E.lencode=E.lendyn=new m.Buf32(852),E.distcode=E.distdyn=new m.Buf32(592),E.sane=1,E.back=-1,0):-2}function e(y){var E;return y&&y.state?((E=y.state).wsize=0,E.whave=0,E.wnext=0,f(y)):-2}function k(y,E){var x,G;return y&&y.state?(G=y.state,E<0?(x=0,E=-E):(x=1+(E>>4),E<48&&(E&=15)),E&&(E<8||15<E)?-2:(null!==G.window&&G.wbits!==E&&(G.window=null),G.wrap=x,G.wbits=
E,e(y))):-2}function l(y,E){var x;return y?((y.state=new q).window=null,0!==(x=k(y,E))&&(y.state=null),x):-2}function g(y,E,x,G){var I;y=y.state;return null===y.window&&(y.wsize=1<<y.wbits,y.wnext=0,y.whave=0,y.window=new m.Buf8(y.wsize)),G>=y.wsize?(m.arraySet(y.window,E,x-y.wsize,y.wsize,0),y.wnext=0,y.whave=y.wsize):(G<(I=y.wsize-y.wnext)&&(I=G),m.arraySet(y.window,E,x-G,I,y.wnext),(G-=I)?(m.arraySet(y.window,E,x-G,G,0),y.wnext=G,y.whave=y.wsize):(y.wnext+=I,y.wnext===y.wsize&&(y.wnext=0),y.whave<
y.wsize&&(y.whave+=I))),0}var m=c("../utils/common"),p=c("./adler32"),n=c("./crc32"),t=c("./inffast"),u=c("./inftrees"),v,A,D=!0;a.inflateReset=e;a.inflateReset2=k;a.inflateResetKeep=f;a.inflateInit=function(y){return l(y,15)};a.inflateInit2=l;a.inflate=function(y,E){var x,G,I,O,B,N,P,L=0,ia=new m.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!y||!y.state||!y.output||!y.input&&0!==y.avail_in)return-2;12===(x=y.state).mode&&(x.mode=13);var ma=y.next_out;var da=y.output;var Ca=y.avail_out;
var ha=y.next_in;var sa=y.input;var ea=y.avail_in;var w=x.hold;var H=x.bits;var U=ea;var na=Ca;var W=0;a:for(;;)switch(x.mode){case 1:if(0===x.wrap){x.mode=13;break}for(;H<16;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(2&x.wrap&&35615===w){ia[x.check=0]=255&w;ia[1]=w>>>8&255;x.check=n(x.check,ia,2,0);H=w=0;x.mode=2;break}if(x.flags=0,x.head&&(x.head.done=!1),!(1&x.wrap)||(((255&w)<<8)+(w>>8))%31){y.msg="incorrect header check";x.mode=30;break}if(8!=(15&w)){y.msg="unknown compression method";x.mode=
30;break}if(H-=4,N=8+(15&(w>>>=4)),0===x.wbits)x.wbits=N;else if(N>x.wbits){y.msg="invalid window size";x.mode=30;break}x.dmax=1<<N;y.adler=x.check=1;x.mode=512&w?10:12;H=w=0;break;case 2:for(;H<16;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(x.flags=w,8!=(255&x.flags)){y.msg="unknown compression method";x.mode=30;break}if(57344&x.flags){y.msg="unknown header flags set";x.mode=30;break}x.head&&(x.head.text=w>>8&1);512&x.flags&&(ia[0]=255&w,ia[1]=w>>>8&255,x.check=n(x.check,ia,2,0));H=w=0;x.mode=
3;case 3:for(;H<32;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}x.head&&(x.head.time=w);512&x.flags&&(ia[0]=255&w,ia[1]=w>>>8&255,ia[2]=w>>>16&255,ia[3]=w>>>24&255,x.check=n(x.check,ia,4,0));H=w=0;x.mode=4;case 4:for(;H<16;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}x.head&&(x.head.xflags=255&w,x.head.os=w>>8);512&x.flags&&(ia[0]=255&w,ia[1]=w>>>8&255,x.check=n(x.check,ia,2,0));H=w=0;x.mode=5;case 5:if(1024&x.flags){for(;H<16;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}x.length=w;x.head&&(x.head.extra_len=
w);512&x.flags&&(ia[0]=255&w,ia[1]=w>>>8&255,x.check=n(x.check,ia,2,0));H=w=0}else x.head&&(x.head.extra=null);x.mode=6;case 6:if(1024&x.flags&&(ea<(G=x.length)&&(G=ea),G&&(x.head&&(N=x.head.extra_len-x.length,x.head.extra||(x.head.extra=Array(x.head.extra_len)),m.arraySet(x.head.extra,sa,ha,G,N)),512&x.flags&&(x.check=n(x.check,sa,G,ha)),ea-=G,ha+=G,x.length-=G),x.length))break a;x.length=0;x.mode=7;case 7:if(2048&x.flags){if(0===ea)break a;for(G=0;N=sa[ha+G++],x.head&&N&&x.length<65536&&(x.head.name+=
String.fromCharCode(N)),N&&G<ea;);if(512&x.flags&&(x.check=n(x.check,sa,G,ha)),ea-=G,ha+=G,N)break a}else x.head&&(x.head.name=null);x.length=0;x.mode=8;case 8:if(4096&x.flags){if(0===ea)break a;for(G=0;N=sa[ha+G++],x.head&&N&&x.length<65536&&(x.head.comment+=String.fromCharCode(N)),N&&G<ea;);if(512&x.flags&&(x.check=n(x.check,sa,G,ha)),ea-=G,ha+=G,N)break a}else x.head&&(x.head.comment=null);x.mode=9;case 9:if(512&x.flags){for(;H<16;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(w!==(65535&x.check)){y.msg=
"header crc mismatch";x.mode=30;break}H=w=0}x.head&&(x.head.hcrc=x.flags>>9&1,x.head.done=!0);y.adler=x.check=0;x.mode=12;break;case 10:for(;H<32;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}y.adler=x.check=h(w);H=w=0;x.mode=11;case 11:if(0===x.havedict)return y.next_out=ma,y.avail_out=Ca,y.next_in=ha,y.avail_in=ea,x.hold=w,x.bits=H,2;y.adler=x.check=1;x.mode=12;case 12:if(5===E||6===E)break a;case 13:if(x.last){w>>>=7&H;H-=7&H;x.mode=27;break}for(;H<3;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}switch(x.last=
1&w,--H,3&(w>>>=1)){case 0:x.mode=14;break;case 1:var Z=x;if(D){v=new m.Buf32(512);A=new m.Buf32(32);for(I=0;I<144;)Z.lens[I++]=8;for(;I<256;)Z.lens[I++]=9;for(;I<280;)Z.lens[I++]=7;for(;I<288;)Z.lens[I++]=8;u(1,Z.lens,0,288,v,0,Z.work,{bits:9});for(I=0;I<32;)Z.lens[I++]=5;u(2,Z.lens,0,32,A,0,Z.work,{bits:5});D=!1}Z.lencode=v;Z.lenbits=9;Z.distcode=A;Z.distbits=5;if(x.mode=20,6!==E)break;w>>>=2;H-=2;break a;case 2:x.mode=17;break;case 3:y.msg="invalid block type",x.mode=30}w>>>=2;H-=2;break;case 14:w>>>=
7&H;for(H-=7&H;H<32;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if((65535&w)!=(w>>>16^65535)){y.msg="invalid stored block lengths";x.mode=30;break}if(x.length=65535&w,H=w=0,x.mode=15,6===E)break a;case 15:x.mode=16;case 16:if(G=x.length){if(ea<G&&(G=ea),Ca<G&&(G=Ca),0===G)break a;m.arraySet(da,sa,ha,G,ma);ea-=G;ha+=G;Ca-=G;ma+=G;x.length-=G;break}x.mode=12;break;case 17:for(;H<14;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(x.nlen=257+(31&w),H-=5,x.ndist=1+(31&(w>>>=5)),H-=5,x.ncode=4+(15&(w>>>=
5)),w>>>=4,H-=4,286<x.nlen||30<x.ndist){y.msg="too many length or distance symbols";x.mode=30;break}x.have=0;x.mode=18;case 18:for(;x.have<x.ncode;){for(;H<3;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}x.lens[V[x.have++]]=7&w;w>>>=3;H-=3}for(;x.have<19;)x.lens[V[x.have++]]=0;if(x.lencode=x.lendyn,x.lenbits=7,P={bits:x.lenbits},W=u(0,x.lens,0,19,x.lencode,0,x.work,P),x.lenbits=P.bits,W){y.msg="invalid code lengths set";x.mode=30;break}x.have=0;x.mode=19;case 19:for(;x.have<x.nlen+x.ndist;){for(;L=
x.lencode[w&(1<<x.lenbits)-1],O=65535&L,!((I=L>>>24)<=H);){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(O<16)w>>>=I,H-=I,x.lens[x.have++]=O;else{if(16===O){for(Z=I+2;H<Z;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(w>>>=I,H-=I,0===x.have){y.msg="invalid bit length repeat";x.mode=30;break}N=x.lens[x.have-1];G=3+(3&w);w>>>=2;H-=2}else if(17===O){for(Z=I+3;H<Z;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}H-=I;N=0;G=3+(7&(w>>>=I));w>>>=3;H-=3}else{for(Z=I+7;H<Z;){if(0===ea)break a;ea--;w+=sa[ha++]<<
H;H+=8}H-=I;N=0;G=11+(127&(w>>>=I));w>>>=7;H-=7}if(x.have+G>x.nlen+x.ndist){y.msg="invalid bit length repeat";x.mode=30;break}for(;G--;)x.lens[x.have++]=N}}if(30===x.mode)break;if(0===x.lens[256]){y.msg="invalid code -- missing end-of-block";x.mode=30;break}if(x.lenbits=9,P={bits:x.lenbits},W=u(1,x.lens,0,x.nlen,x.lencode,0,x.work,P),x.lenbits=P.bits,W){y.msg="invalid literal/lengths set";x.mode=30;break}if(x.distbits=6,x.distcode=x.distdyn,P={bits:x.distbits},W=u(2,x.lens,x.nlen,x.ndist,x.distcode,
0,x.work,P),x.distbits=P.bits,W){y.msg="invalid distances set";x.mode=30;break}if(x.mode=20,6===E)break a;case 20:x.mode=21;case 21:if(6<=ea&&258<=Ca){y.next_out=ma;y.avail_out=Ca;y.next_in=ha;y.avail_in=ea;x.hold=w;x.bits=H;t(y,na);ma=y.next_out;da=y.output;Ca=y.avail_out;ha=y.next_in;sa=y.input;ea=y.avail_in;w=x.hold;H=x.bits;12===x.mode&&(x.back=-1);break}for(x.back=0;Z=(L=x.lencode[w&(1<<x.lenbits)-1])>>>16&255,O=65535&L,!((I=L>>>24)<=H);){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(Z&&0==(240&
Z)){var ba=I;var la=Z;for(B=O;Z=(L=x.lencode[B+((w&(1<<ba+la)-1)>>ba)])>>>16&255,O=65535&L,!(ba+(I=L>>>24)<=H);){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}w>>>=ba;H-=ba;x.back+=ba}if(w>>>=I,H-=I,x.back+=I,x.length=O,0===Z){x.mode=26;break}if(32&Z){x.back=-1;x.mode=12;break}if(64&Z){y.msg="invalid literal/length code";x.mode=30;break}x.extra=15&Z;x.mode=22;case 22:if(x.extra){for(Z=x.extra;H<Z;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}x.length+=w&(1<<x.extra)-1;w>>>=x.extra;H-=x.extra;x.back+=
x.extra}x.was=x.length;x.mode=23;case 23:for(;Z=(L=x.distcode[w&(1<<x.distbits)-1])>>>16&255,O=65535&L,!((I=L>>>24)<=H);){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(0==(240&Z)){ba=I;la=Z;for(B=O;Z=(L=x.distcode[B+((w&(1<<ba+la)-1)>>ba)])>>>16&255,O=65535&L,!(ba+(I=L>>>24)<=H);){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}w>>>=ba;H-=ba;x.back+=ba}if(w>>>=I,H-=I,x.back+=I,64&Z){y.msg="invalid distance code";x.mode=30;break}x.offset=O;x.extra=15&Z;x.mode=24;case 24:if(x.extra){for(Z=x.extra;H<Z;){if(0===
ea)break a;ea--;w+=sa[ha++]<<H;H+=8}x.offset+=w&(1<<x.extra)-1;w>>>=x.extra;H-=x.extra;x.back+=x.extra}if(x.offset>x.dmax){y.msg="invalid distance too far back";x.mode=30;break}x.mode=25;case 25:if(0===Ca)break a;if(G=na-Ca,x.offset>G){if((G=x.offset-G)>x.whave&&x.sane){y.msg="invalid distance too far back";x.mode=30;break}I=G>x.wnext?(G-=x.wnext,x.wsize-G):x.wnext-G;G>x.length&&(G=x.length);Z=x.window}else Z=da,I=ma-x.offset,G=x.length;Ca<G&&(G=Ca);Ca-=G;for(x.length-=G;da[ma++]=Z[I++],--G;);0===
x.length&&(x.mode=21);break;case 26:if(0===Ca)break a;da[ma++]=x.length;Ca--;x.mode=21;break;case 27:if(x.wrap){for(;H<32;){if(0===ea)break a;ea--;w|=sa[ha++]<<H;H+=8}if(na-=Ca,y.total_out+=na,x.total+=na,na&&(y.adler=x.check=x.flags?n(x.check,da,na,ma-na):p(x.check,da,na,ma-na)),na=Ca,(x.flags?w:h(w))!==x.check){y.msg="incorrect data check";x.mode=30;break}H=w=0}x.mode=28;case 28:if(x.wrap&&x.flags){for(;H<32;){if(0===ea)break a;ea--;w+=sa[ha++]<<H;H+=8}if(w!==(0|x.total)){y.msg="incorrect length check";
x.mode=30;break}H=w=0}x.mode=29;case 29:W=1;break a;case 30:W=-3;break a;case 31:return-4;default:return-2}return y.next_out=ma,y.avail_out=Ca,y.next_in=ha,y.avail_in=ea,x.hold=w,x.bits=H,(x.wsize||na!==y.avail_out&&x.mode<30&&(x.mode<27||4!==E))&&g(y,y.output,y.next_out,na-y.avail_out)?(x.mode=31,-4):(U-=y.avail_in,na-=y.avail_out,y.total_in+=U,y.total_out+=na,x.total+=na,x.wrap&&na&&(y.adler=x.check=x.flags?n(x.check,da,na,y.next_out-na):p(x.check,da,na,y.next_out-na)),y.data_type=x.bits+64*!!x.last+
128*(12===x.mode)+256*(20===x.mode||15===x.mode),(0==U&&0===na||4===E)&&0===W&&(W=-5),W)};a.inflateEnd=function(y){if(!y||!y.state)return-2;var E=y.state;return E.window&&(E.window=null),y.state=null,0};a.inflateGetHeader=function(y,E){var x;return y&&y.state?0==(2&(x=y.state).wrap)?-2:((x.head=E).done=!1,0):-2};a.inflateSetDictionary=function(y,E){var x,G=E.length;return y&&y.state?0!==(x=y.state).wrap&&11!==x.mode?-2:11===x.mode&&p(1,E,G,0)!==x.check?-3:g(y,E,G,G)?(x.mode=31,-4):(x.havedict=1,0):
-2};a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(c,d,a){var h=c("../utils/common"),q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],k=[16,
16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];d.exports=function(l,g,m,p,n,t,u,v){var A,D,y,E,x,G=v.bits,I,O,B,N,P,L=0,ia,V=null,ma=0,da=new h.Buf16(16);var Ca=new h.Buf16(16);var ha=null,sa=0;for(I=0;I<=15;I++)da[I]=0;for(O=0;O<p;O++)da[g[m+O]]++;var ea=G;for(B=15;1<=B&&0===da[B];B--);if(B<ea&&(ea=B),0===B)return n[t++]=20971520,n[t++]=20971520,v.bits=1,0;for(G=1;G<B&&0===da[G];G++);ea<G&&(ea=G);for(I=A=1;I<=15;I++)if(A<<=1,(A-=da[I])<0)return-1;if(0<
A&&(0===l||1!==B))return-1;Ca[1]=0;for(I=1;I<15;I++)Ca[I+1]=Ca[I]+da[I];for(O=0;O<p;O++)0!==g[m+O]&&(u[Ca[g[m+O]]++]=O);if(E=0===l?(V=ha=u,19):1===l?(V=q,ma-=257,ha=f,sa-=257,256):(V=e,ha=k,-1),I=G,Ca=t,P=O=ia=0,y=-1,p=(L=1<<(N=ea))-1,1===l&&852<L||2===l&&592<L)return 1;for(;;){var w=I-P;var H=u[O]<E?(x=0,u[O]):u[O]>E?(x=ha[sa+u[O]],V[ma+u[O]]):(x=96,0);A=1<<I-P;for(G=D=1<<N;n[Ca+(ia>>P)+(D-=A)]=w<<24|x<<16|H,0!==D;);for(A=1<<I-1;ia&A;)A>>=1;if(0!==A?(ia&=A-1,ia+=A):ia=0,O++,0==--da[I]){if(I===B)break;
I=g[m+u[O]]}if(ea<I&&(ia&p)!==y){0===P&&(P=ea);Ca+=G;for(A=1<<(N=I-P);N+P<B&&!((A-=da[N+P])<=0);)N++,A<<=1;if(L+=1<<N,1===l&&852<L||2===l&&592<L)return 1;n[y=ia&p]=ea<<24|N<<16|Ca-t}}return 0!==ia&&(n[Ca+ia]=I-P<<24|4194304),v.bits=ea,0}},{"../utils/common":41}],51:[function(c,d,a){d.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(c,d,a){function h(w){for(var H=
w.length;0<=--H;)w[H]=0}function q(w,H,U,na,W){this.static_tree=w;this.extra_bits=H;this.extra_base=U;this.elems=na;this.max_length=W;this.has_stree=w&&w.length}function f(w,H){this.dyn_tree=w;this.max_code=0;this.stat_desc=H}function e(w){return w<256?ia[w]:ia[256+(w>>>7)]}function k(w,H){w.pending_buf[w.pending++]=255&H;w.pending_buf[w.pending++]=H>>>8&255}function l(w,H,U){w.bi_valid>16-U?(w.bi_buf|=H<<w.bi_valid&65535,k(w,w.bi_buf),w.bi_buf=H>>16-w.bi_valid,w.bi_valid+=U-16):(w.bi_buf|=H<<w.bi_valid&
65535,w.bi_valid+=U)}function g(w,H,U){l(w,U[2*H],U[2*H+1])}function m(w,H){for(var U=0;U|=1&w,w>>>=1,U<<=1,0<--H;);return U>>>1}function p(w,H,U){var na,W=Array(16),Z=0;for(na=1;na<=15;na++)W[na]=Z=Z+U[na-1]<<1;for(U=0;U<=H;U++)na=w[2*U+1],0!==na&&(w[2*U]=m(W[na]++,na))}function n(w){var H;for(H=0;H<286;H++)w.dyn_ltree[2*H]=0;for(H=0;H<30;H++)w.dyn_dtree[2*H]=0;for(H=0;H<19;H++)w.bl_tree[2*H]=0;w.dyn_ltree[512]=1;w.opt_len=w.static_len=0;w.last_lit=w.matches=0}function t(w){8<w.bi_valid?k(w,w.bi_buf):
0<w.bi_valid&&(w.pending_buf[w.pending++]=w.bi_buf);w.bi_buf=0;w.bi_valid=0}function u(w,H,U,na){var W=2*H,Z=2*U;return w[W]<w[Z]||w[W]===w[Z]&&na[H]<=na[U]}function v(w,H,U){for(var na=w.heap[U],W=U<<1;W<=w.heap_len&&(W<w.heap_len&&u(H,w.heap[W+1],w.heap[W],w.depth)&&W++,!u(H,na,w.heap[W],w.depth));)w.heap[U]=w.heap[W],U=W,W<<=1;w.heap[U]=na}function A(w,H,U){var na,W,Z,ba,la=0;if(0!==w.last_lit)for(;na=w.pending_buf[w.d_buf+2*la]<<8|w.pending_buf[w.d_buf+2*la+1],W=w.pending_buf[w.l_buf+la],la++,
0===na?g(w,W,H):(g(w,(Z=V[W])+256+1,H),0!==(ba=I[Z])&&l(w,W-=ma[Z],ba),g(w,Z=e(--na),U),0!==(ba=O[Z])&&l(w,na-=sa[Z],ba)),la<w.last_lit;);g(w,256,H)}function D(w,H){var U,na,W,Z=H.dyn_tree,ba=H.stat_desc.static_tree,la=H.stat_desc.has_stree,Ga=H.stat_desc.elems,pa=-1;w.heap_len=0;w.heap_max=573;for(U=0;U<Ga;U++)0!==Z[2*U]?(w.heap[++w.heap_len]=pa=U,w.depth[U]=0):Z[2*U+1]=0;for(;w.heap_len<2;)Z[2*(W=w.heap[++w.heap_len]=pa<2?++pa:0)]=1,w.depth[W]=0,w.opt_len--,la&&(w.static_len-=ba[2*W+1]);H.max_code=
pa;for(U=w.heap_len>>1;1<=U;U--)v(w,Z,U);for(W=Ga;U=w.heap[1],w.heap[1]=w.heap[w.heap_len--],v(w,Z,1),na=w.heap[1],w.heap[--w.heap_max]=U,w.heap[--w.heap_max]=na,Z[2*W]=Z[2*U]+Z[2*na],w.depth[W]=(w.depth[U]>=w.depth[na]?w.depth[U]:w.depth[na])+1,Z[2*U+1]=Z[2*na+1]=W,w.heap[1]=W++,v(w,Z,1),2<=w.heap_len;);w.heap[--w.heap_max]=w.heap[1];var ya,rb,bb,Qb,Ia;U=H.dyn_tree;na=H.max_code;W=H.stat_desc.static_tree;ba=H.stat_desc.has_stree;la=H.stat_desc.extra_bits;Ga=H.stat_desc.extra_base;var ob=H.stat_desc.max_length,
hb=0;for(bb=0;bb<=15;bb++)w.bl_count[bb]=0;U[2*w.heap[w.heap_max]+1]=0;for(H=w.heap_max+1;H<573;H++)ob<(bb=U[2*U[2*(ya=w.heap[H])+1]+1]+1)&&(bb=ob,hb++),U[2*ya+1]=bb,na<ya||(w.bl_count[bb]++,Qb=0,Ga<=ya&&(Qb=la[ya-Ga]),Ia=U[2*ya],w.opt_len+=Ia*(bb+Qb),ba&&(w.static_len+=Ia*(W[2*ya+1]+Qb)));if(0!==hb){do{for(bb=ob-1;0===w.bl_count[bb];)bb--;w.bl_count[bb]--;w.bl_count[bb+1]+=2;w.bl_count[ob]--;hb-=2}while(0<hb);for(bb=ob;0!==bb;bb--)for(ya=w.bl_count[bb];0!==ya;)na<(rb=w.heap[--H])||(U[2*rb+1]!==bb&&
(w.opt_len+=(bb-U[2*rb+1])*U[2*rb],U[2*rb+1]=bb),ya--)}p(Z,pa,w.bl_count)}function y(w,H,U){var na,W=-1,Z=H[1],ba=0,la=7,Ga=4;0===Z&&(la=138,Ga=3);H[2*(U+1)+1]=65535;for(na=0;na<=U;na++){var pa=Z;Z=H[2*(na+1)+1];++ba<la&&pa===Z||(ba<Ga?w.bl_tree[2*pa]+=ba:0!==pa?(pa!==W&&w.bl_tree[2*pa]++,w.bl_tree[32]++):ba<=10?w.bl_tree[34]++:w.bl_tree[36]++,W=pa,Ga=(ba=0)===Z?(la=138,3):pa===Z?(la=6,3):(la=7,4))}}function E(w,H,U){var na,W,Z=-1,ba=H[1],la=0,Ga=7,pa=4;0===ba&&(Ga=138,pa=3);for(na=0;na<=U;na++)if(W=
ba,ba=H[2*(na+1)+1],!(++la<Ga&&W===ba)){if(la<pa)for(;g(w,W,w.bl_tree),0!=--la;);else 0!==W?(W!==Z&&(g(w,W,w.bl_tree),la--),g(w,16,w.bl_tree),l(w,la-3,2)):la<=10?(g(w,17,w.bl_tree),l(w,la-3,3)):(g(w,18,w.bl_tree),l(w,la-11,7));Z=W;pa=(la=0)===ba?(Ga=138,3):W===ba?(Ga=6,3):(Ga=7,4)}}function x(w,H,U,na){l(w,+!!na,3);t(w);k(w,U);k(w,~U);G.arraySet(w.pending_buf,w.window,H,U,w.pending);w.pending+=U}var G=c("../utils/common"),I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,
1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=Array(576);h(P);var L=Array(60);h(L);var ia=Array(512);h(ia);var V=Array(256);h(V);var ma=Array(29);h(ma);var da,Ca,ha,sa=Array(30);h(sa);var ea=!1;a._tr_init=function(w){if(!ea){var H,U,na,W=Array(16);for(na=U=0;na<28;na++)for(ma[na]=U,H=0;H<1<<I[na];H++)V[U++]=na;V[U-1]=na;for(na=U=0;na<16;na++)for(sa[na]=U,H=0;H<1<<O[na];H++)ia[U++]=na;for(U>>=
7;na<30;na++)for(sa[na]=U<<7,H=0;H<1<<O[na]-7;H++)ia[256+U++]=na;for(H=0;H<=15;H++)W[H]=0;for(H=0;H<=143;)P[2*H+1]=8,H++,W[8]++;for(;H<=255;)P[2*H+1]=9,H++,W[9]++;for(;H<=279;)P[2*H+1]=7,H++,W[7]++;for(;H<=287;)P[2*H+1]=8,H++,W[8]++;p(P,287,W);for(H=0;H<30;H++)L[2*H+1]=5,L[2*H]=m(H,5);da=new q(P,I,257,286,15);Ca=new q(L,O,0,30,15);ha=new q([],B,0,19,7);ea=!0}w.l_desc=new f(w.dyn_ltree,da);w.d_desc=new f(w.dyn_dtree,Ca);w.bl_desc=new f(w.bl_tree,ha);w.bi_buf=0;w.bi_valid=0;n(w)};a._tr_stored_block=
x;a._tr_flush_block=function(w,H,U,na){var W,Z,ba=0;0<w.level?(2===w.strm.data_type&&(w.strm.data_type=function(la){var Ga,pa=4093624447;for(Ga=0;Ga<=31;Ga++,pa>>>=1)if(1&pa&&0!==la.dyn_ltree[2*Ga])return 0;if(0!==la.dyn_ltree[18]||0!==la.dyn_ltree[20]||0!==la.dyn_ltree[26])return 1;for(Ga=32;Ga<256;Ga++)if(0!==la.dyn_ltree[2*Ga])return 1;return 0}(w)),D(w,w.l_desc),D(w,w.d_desc),ba=function(la){var Ga;y(la,la.dyn_ltree,la.l_desc.max_code);y(la,la.dyn_dtree,la.d_desc.max_code);D(la,la.bl_desc);for(Ga=
18;3<=Ga&&0===la.bl_tree[2*N[Ga]+1];Ga--);return la.opt_len+=3*(Ga+1)+5+5+4,Ga}(w),W=w.opt_len+3+7>>>3,(Z=w.static_len+3+7>>>3)<=W&&(W=Z)):W=Z=U+5;U+4<=W&&-1!==H?x(w,H,U,na):4===w.strategy||Z===W?(l(w,2+ +!!na,3),A(w,P,L)):(l(w,4+ +!!na,3),function(la,Ga,pa,ya){var rb;l(la,Ga-257,5);l(la,pa-1,5);l(la,ya-4,4);for(rb=0;rb<ya;rb++)l(la,la.bl_tree[2*N[rb]+1],3);E(la,la.dyn_ltree,Ga-1);E(la,la.dyn_dtree,pa-1)}(w,w.l_desc.max_code+1,w.d_desc.max_code+1,ba+1),A(w,w.dyn_ltree,w.dyn_dtree));n(w);na&&t(w)};
a._tr_tally=function(w,H,U){return w.pending_buf[w.d_buf+2*w.last_lit]=H>>>8&255,w.pending_buf[w.d_buf+2*w.last_lit+1]=255&H,w.pending_buf[w.l_buf+w.last_lit]=255&U,w.last_lit++,0===H?w.dyn_ltree[2*U]++:(w.matches++,H--,w.dyn_ltree[2*(V[U]+256+1)]++,w.dyn_dtree[2*e(H)]++),w.last_lit===w.lit_bufsize-1};a._tr_align=function(w){l(w,2,3);g(w,256,P);16===w.bi_valid?(k(w,w.bi_buf),w.bi_buf=0,w.bi_valid=0):8<=w.bi_valid&&(w.pending_buf[w.pending++]=255&w.bi_buf,w.bi_buf>>=8,w.bi_valid-=8)}},{"../utils/common":41}],
53:[function(c,d,a){d.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],54:[function(c,d,a){(function(h){!function(q,f){function e(y){delete t[y]}function k(y){if(u)setTimeout(k,0,y);else{var E=t[y];if(E){u=!0;try{var x=E.callback,G=E.args;switch(G.length){case 0:x();break;case 1:x(G[0]);break;case 2:x(G[0],G[1]);break;case 3:x(G[0],G[1],G[2]);
break;default:x.apply(f,G)}}finally{e(y),u=!1}}}}function l(y){y.source===q&&"string"==typeof y.data&&0===y.data.indexOf(p)&&k(+y.data.slice(p.length))}if(!q.setImmediate){var g,m,p,n=1,t={},u=!1,v=q.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(q);A=A&&A.setTimeout?A:q;var D="[object process]"==={}.toString.call(q.process)?function(y){Qf.nextTick(function(){k(y)})}:function(){if(q.postMessage&&!q.importScripts){var y=!0,E=q.onmessage;return q.onmessage=function(){y=!1},q.postMessage("",
"*"),q.onmessage=E,y}}()?(p="setImmediate$"+Math.random()+"$",q.addEventListener?q.addEventListener("message",l,!1):q.attachEvent("onmessage",l),function(y){q.postMessage(p+y,"*")}):q.MessageChannel?((m=new MessageChannel).port1.onmessage=function(y){k(y.data)},function(y){m.port2.postMessage(y)}):v&&"onreadystatechange"in v.createElement("script")?(g=v.documentElement,function(y){var E=v.createElement("script");E.onreadystatechange=function(){k(y);E.onreadystatechange=null;g.removeChild(E);E=null};
g.appendChild(E)}):function(y){setTimeout(k,0,y)};A.setImmediate=function(y){"function"!=typeof y&&(y=Function(""+y));for(var E=Array(arguments.length-1),x=0;x<E.length;x++)E[x]=arguments[x+1];return t[n]={callback:y,args:E},D(n),n++};A.clearImmediate=e}}("u"<typeof self?void 0===h?this:h:self)}).call(this,void 0!==Oc?Oc:"u">typeof self?self:"u">typeof window?window:{})},{}]},{},[10])(10);var Md={};Md=JSON.parse('{"Dodge (tool)":"Dodge","Burn (tool)":"Burn","Color (picker)":"Color","Color swatches (shorter)":"Swatches"}');
let we={ja:JSON.parse('{"File":"\u30d5\u30a1\u30a4\u30eb","Export as png":"PNG\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9","Save the PNG image, CHI project file, and swatches file together as a ZIP package.":"\u753b\u50cf\u3068\u56fa\u6709\u5f62\u5f0f\u30d5\u30a1\u30a4\u30eb\u3092ZIP\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002","Export as zip":"ZIP\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9","Backup to browser storage":"\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58","Saved to your browser\'s storage.":"\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002","Save the current drawing to the browser\'s local database.":"\u73fe\u5728\u306e\u753b\u50cf\u3092\u30d6\u30e9\u30a6\u30b6\u306e\u30ed\u30fc\u30ab\u30eb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002","Post Oekaki":"\u6295\u7a3f\u3059\u308b","Finish drawing and post to the server.":"\u4f5c\u753b\u3092\u7d42\u4e86\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u307e\u3059\u3002","Edit":"\u7de8\u96c6","Undo":"\u53d6\u308a\u6d88\u3057","Redo":"\u3084\u308a\u76f4\u3057","Cut":"\u5207\u308a\u53d6\u308a","Copy":"\u30b3\u30d4\u30fc","Clear history":"\u5c65\u6b74\u6d88\u53bb","Copy merged":"\u7d50\u5408\u30b3\u30d4\u30fc","Paste":"\u8cbc\u308a\u4ed8\u3051","Select all":"\u3059\u3079\u3066\u9078\u629e","Deselect":"\u9078\u629e\u89e3\u9664","Transform":"\u5909\u5f62","Selection":"\u9078\u629e\u7bc4\u56f2","Constrain":"\u7e26\u6a2a\u6bd4\u3092\u7dad\u6301","Layers":"\u30ec\u30a4\u30e4\u30fc","Duplicate":"\u8907\u88fd","Merge down":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3068\u7d50\u5408","Merge group":"\u30b0\u30eb\u30fc\u30d7\u7d50\u5408","Merge all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u7d50\u5408","Create merged layer":"\u7d50\u5408\u30ec\u30a4\u30e4\u30fc\u3092\u8ffd\u52a0","Add layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Delete mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Delete layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Apply mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Apply layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Disable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u7121\u52b9\u5316","Enable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u6709\u52b9\u5316","Clip to the layer below":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3067\u30af\u30ea\u30c3\u30d4\u30f3\u30b0","Unclip from the layer below":"\u30af\u30ea\u30c3\u30d4\u30f3\u30b0\u89e3\u9664","Effects":"\u52b9\u679c","Clear":"\u6d88\u53bb","Clear with texture":"\u30c6\u30af\u30b9\u30c1\u30e3\u3067\u6d88\u53bb","Fill":"\u5857\u308a\u6f70\u3057","Flip horizontal":"\u5de6\u53f3\u53cd\u8ee2","Flip vertical":"\u4e0a\u4e0b\u53cd\u8ee2","Invert":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Convert brightness to opacity":"\u8f1d\u5ea6\u3092\u900f\u660e\u5ea6\u306b\u5909\u63db","Convert brightness to opacity and change to drawing color.":"\u8f1d\u5ea6\u3092\u900f\u660e\u5ea6\u306b\u5909\u63db\u3057\u3066\u63cf\u753b\u8272\u306b\u3057\u307e\u3059\u3002","Box blur...":"\u307c\u304b\u3057","Box blur":"\u307c\u304b\u3057","Blur amount":"\u307c\u304b\u3057\u91cf","Iterations (1~8, larger gives smoother blur)":"\u53cd\u5fa9 (1~8,\u5927\u304d\u3044\u307b\u3069\u307c\u304b\u3057\u304c\u6ed1\u3089\u304b)","Mosaic":"\u30e2\u30b6\u30a4\u30af","Block size":"\u30d6\u30ed\u30c3\u30af\u30b5\u30a4\u30ba","Color halftone":"\u30ab\u30e9\u30fc\u30cf\u30fc\u30d5\u30c8\u30fc\u30f3","Mono halftone":"\u5358\u8272\u30cf\u30fc\u30d5\u30c8\u30fc\u30f3","Dot size":"\u30c9\u30c3\u30c8\u30b5\u30a4\u30ba","Chromatic aberration":"\u8272\u53ce\u5dee (RGB\u305a\u3089\u3057)","Offset X":"\u6a2a\u65b9\u5411 X","Offset Y":"\u7e26\u65b9\u5411 Y","Apply to all (create merged layer)":"\u5168\u4f53\u306b\u9069\u7528 (\u7d50\u5408\u30ec\u30a4\u30e4\u30fc\u3092\u8ffd\u52a0)","Edge expand":"\u7e01\u53d6\u308a","Edge expand width":"\u7e01\u306e\u5e45","Fill Inside with edge color":"\u7e01\u306e\u8272\u3067\u5185\u5074\u3092\u5857\u308a\u6f70\u3059","Convert to drawing color":"\u63cf\u753b\u8272\u306b\u5909\u63db","Monochromatic noise":"\u5358\u8272\u30ce\u30a4\u30ba","Color noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba","View":"\u8868\u793a","Full-screen mode":"\u30d5\u30eb\u30b9\u30af\u30ea\u30fc\u30f3\u30e2\u30fc\u30c9","Zoom in":"\u62e1\u5927","Zoom out":"\u7e2e\u5c0f","Zoom 100%":"100%","Reset Rotation":"\u56de\u8ee2\u3092\u30ea\u30bb\u30c3\u30c8","Smooth-out zoomed canvas":"\u30ba\u30fc\u30e0\u3092\u306a\u3081\u3089\u304b\u306b\u8868\u793a\u3059\u308b","Show grid":"\u30b0\u30ea\u30c3\u30c9\u3092\u8868\u793a","Grid options...":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Palettes":"\u30d1\u30ec\u30c3\u30c8","Rearrange":"\u521d\u671f\u5316","Toggle palettes":"\u8868\u793a\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Mobile mode":"\u30e2\u30d0\u30a4\u30eb\u30e2\u30fc\u30c9","PC mode":"PC\u30e2\u30fc\u30c9","Use old icons":"\u53e4\u3044\u30a2\u30a4\u30b3\u30f3","Show tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Show color":"\u30ab\u30e9\u30fc","Show layers":"\u30ec\u30a4\u30e4\u30fc","Show misc":"\u64cd\u4f5c","Show stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Show swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Show textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Show tools":"\u30c4\u30fc\u30eb","Help":"\u30d8\u30eb\u30d7","Tablet support":"\u30bf\u30d6\u30ec\u30c3\u30c8\u30b5\u30dd\u30fc\u30c8","Shortcuts":"\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8","About":"litaChix\u306b\u3064\u3044\u3066","Removes all undo/redo information to regain memory":"\u5c65\u6b74\u3092\u30af\u30ea\u30a2\u3057\u3066\u30e1\u30e2\u30ea\u3092\u958b\u653e\u3057\u307e\u3059","Clears the selected area":"\u6d88\u53bb","Invert the image colors":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Blur effect":"\u307c\u304b\u3057\u30d5\u30a3\u30eb\u30bf","Fills the selection with noise":"\u5358\u8272\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Fills the selection with colored noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Linear interpolation is used to give a smoothed looked to the picture when zoomed in.":"\u753b\u50cf\u306e\u62e1\u5927\u6642\u306b\u88dc\u5b8c\u3057\u3066\u6ed1\u3089\u304b\u306b\u8868\u793a\u3057\u307e\u3059\u3002","Rearrange the palette windows":"\u30d1\u30ec\u30c3\u30c8\u3092\u518d\u914d\u7f6e","Hides or shows all palettes":"\u30d1\u30ec\u30c3\u30c8\u306e\u8868\u793a/\u975e\u8868\u793a","You\'re about to clear the current Undo/Redo history.\\nThis operation cannot be undone, are you sure you want to do that?":"\u30a2\u30f3\u30c9\u30a5\u30fb\u30ea\u30c9\u30a5\u306e\u5c65\u6b74\u3092\u6d88\u53bb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\\n\u3053\u306e\u64cd\u4f5c\u306f\u5143\u306b\u623b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b?","Misc":"\u64cd\u4f5c","Round Pixelated":"\u5186\u30d4\u30af\u30bb\u30eb","Round Hard Edge":"\u5186\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Round Soft":"\u5186\u30bd\u30d5\u30c8","Square Pixelated":"\u89d2\u30d4\u30af\u30bb\u30eb","Square Hard Edge":"\u89d2\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Color (picker)":"\u30ab\u30e9\u30fc","Tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Opacity":"\u4e0d\u900f\u660e\u5ea6","Color":"\u8272\u88dc\u5145","Blend":"\u6df7\u8272","Spacing":"\u9593\u9694","Scattering":"\u6563\u4e71","Smoothing":"\u624b\u3076\u308c\u88dc\u6b63","Rotation":"\u89d2\u5ea6","Color swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Color swatches (shorter)":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Remove":"\u524a\u9664","Replace with current color":"\u9078\u629e\u4e2d\u306e\u8272\u306b\u7f6e\u304d\u63db\u3048","Save swatches to your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u306b\u4fdd\u5b58","Load swatches from your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u304b\u3089\u8aad\u307f\u8fbc\u307f","Add the current brush color as a new swatch":"\u9078\u629e\u4e2d\u306e\u8272\u3092\u8ffd\u52a0","Refer all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u53c2\u7167","Blend all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u6df7\u5408","Lock transparency":"\u900f\u660e\u90e8\u5206\u3092\u4fdd\u8b77","Textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Customize":"\u30ab\u30b9\u30bf\u30de\u30a4\u30ba","Inverse":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Mirror":"\u5de6\u53f3\u53cd\u8ee2","Brightness":"\u8f1d\u5ea6","Contrast":"\u30b3\u30f3\u30c8\u30e9\u30b9\u30c8","Scale":"\u62e1\u5927\u7387","Reset":"\u30ea\u30bb\u30c3\u30c8","Layer blending mode":"\u5408\u6210\u30e2\u30fc\u30c9","Normal":"\u901a\u5e38","Multiply":"\u4e57\u7b97","Add":"\u52a0\u7b97","Screen":"\u30b9\u30af\u30ea\u30fc\u30f3","Lighten":"\u6bd4\u8f03(\u660e)","Darken":"\u6bd4\u8f03(\u6697)","Subtract":"\u6e1b\u7b97","Dodge":"\u8986\u3044\u713c\u304d","Burn":"\u713c\u304d\u8fbc\u307f","Overlay":"\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4","Hard Light":"\u30cf\u30fc\u30c9\u30e9\u30a4\u30c8","Soft Light":"\u30bd\u30d5\u30c8\u30e9\u30a4\u30c8","Vivid Light":"\u30d3\u30d3\u30c3\u30c9\u30e9\u30a4\u30c8","Linear Light":"\u30ea\u30cb\u30a2\u30e9\u30a4\u30c8","Pin Light":"\u30d4\u30f3\u30e9\u30a4\u30c8","Passthrough":"\u901a\u904e","Stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Free-hand":"\u30d5\u30ea\u30fc\u30cf\u30f3\u30c9","Straight line":"\u76f4\u7dda","Bezier curve":"Bz\uff08\u30d9\u30b8\u30a7\uff09\u66f2\u7dda","Tools":"\u30c4\u30fc\u30eb","Marquee":"\u9078\u629e\u7bc4\u56f2","Move tool":"\u79fb\u52d5","Flood fill":"\u30d0\u30b1\u30c4\u5857\u308a","Grow fill area":"\u9818\u57df\u62e1\u5f35","Gradient fill":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3","Color picker":"\u30b9\u30dd\u30a4\u30c8","Rotate canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Grab canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u4f4d\u7f6e","Pencil":"\u925b\u7b46","Pen":"\u30da\u30f3","Airbrush":"\u30a8\u30a2\u30d6\u30e9\u30b7","Waterpaint":"\u6c34\u5f69","Eraser":"\u6d88\u3057\u30b4\u30e0","Soft eraser":"\u8584\u6d88\u3057","Smudge":"\u6307\u5148","Blender":"\u6df7\u8272","Dodge (tool)":"\u8986\u3044\u713c\u304d","Burn (tool)":"\u713c\u304d\u8fbc\u307f","Blur":"\u307c\u304b\u3057","Grid options":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Grid size":"\u30b0\u30ea\u30c3\u30c9\u30b5\u30a4\u30ba","Rename...":"\u540d\u524d\u3092\u5909\u66f4","Add layer":"\u65b0\u898f\u30ec\u30a4\u30e4\u30fc","Delete layer":"\u30ec\u30a4\u30e4\u30fc\u524a\u9664","Add group":"\u65b0\u898f\u30b0\u30eb\u30fc\u30d7","Delete group":"\u30b0\u30eb\u30fc\u30d7\u524a\u9664","Add mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Gradient":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210","Zoom and Rotate":"\u30ba\u30fc\u30e0\u3068\u56de\u8ee2","Reset View":"\u8868\u793a\u3092\u521d\u671f\u5316","Transform style":"\u5909\u5f62\u30b9\u30bf\u30a4\u30eb","Apply transform":"\u5909\u5f62\u78ba\u5b9a","Complete transform":"\u5909\u5f62\u3092\u5b8c\u4e86","Undo transform":"\u53d6\u308a\u6d88\u3057","You need to finish transforming this layer before you can do that. What would you like to do with the transform?":"\u7d9a\u884c\u3059\u308b\u305f\u3081\u306b\u5909\u5f62\u3092\u5b8c\u4e86\u3057\u307e\u3059\u3002","Smooth":"\u30b9\u30e0\u30fc\u30ba","Sharp":"\u30b7\u30e3\u30fc\u30d7","Opacity: ":"\u4e0d\u900f\u660e\u5ea6:","Please enter a color in hex format":"16\u9032\u5f62\u5f0f\u3067\u8272\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff08#xxxxxx\u306e\u5f62\uff09","Cancel":"\u30ad\u30e3\u30f3\u30bb\u30eb","Ok":"OK","Okay":"OK","OK":"OK","Whoops! This layer is currently hidden.":"\u975e\u8868\u793a\u30ec\u30a4\u30e4\u30fc\u3067\u3059\u3002","Whoops! This layer\'s opacity is currently 0%.":"\u30ec\u30a4\u30e4\u30fc\u306e\u4e0d\u900f\u660e\u5ea6\u304c0%\u3067\u3059\u3002","Whoops! You can\'t draw on a group.":"\u30b0\u30eb\u30fc\u30d7\u30d5\u30a9\u30eb\u30c0\u306b\u306f\u63cf\u3051\u307e\u305b\u3093\u3002","Whoops! All of the selected pixels are transparent!":"\u30ec\u30a4\u30e4\u30fc\u304c\u7a7a\u3067\u3059\u3002","Image":"\u753b\u50cf","Layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af","Sorry, you can\'t remove the last remaining layer in the drawing.":"\u6700\u5f8c\u306e1\u3064\u306a\u306e\u3067\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3002","Are you sure you want to send your drawing to the server and finish drawing now?":"\u753b\u50cf\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Your drawing has unsaved changes! Are you sure to want to navigate away?":"\u753b\u50cf\u306b\u672a\u4fdd\u5b58\u306e\u5909\u66f4\u304c\u3042\u308a\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.":"\u5229\u7528\u53ef\u80fd\u306a\u30ad\u30fc\u30dc\u30fc\u30c9\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u306e\u3044\u304f\u3064\u304b\u306f\u30e1\u30cb\u30e5\u30fc\u306e\u6a2a\u3084\u30c4\u30fc\u30eb\u30c1\u30c3\u30d7\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002","Here are some other shortcuts which are not as obvious!":"\u3053\u306e\u4e00\u89a7\u306f\u305d\u308c\u4ee5\u5916\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\u3067\u3059\u3002","Right":"\u53f3","Left":"\u5de6","Middle":"\u4e2d","or":"\u307e\u305f\u306f","Double click":"\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af","Color swatches palette":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Use as the drawing color":"\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u53d6\u5f97","Remove or replace a color swatch":"\u30d1\u30ec\u30c3\u30c8\u306e\u5909\u66f4\uff65\u524a\u9664","Line drawing mode":"\u76f4\u7dda\u30e2\u30fc\u30c9","Snap line to nearest 45 degrees":"45\u00b0\u5358\u4f4d\u3067\u30b9\u30ca\u30c3\u30d7","Painting tools":"\u30c4\u30fc\u30eb","Change brush opacity":"\u30d6\u30e9\u30b7\u306e\u4e0d\u900f\u660e\u5ea6","Change brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Brush palette":"\u30d6\u30e9\u30b7\u30d1\u30ec\u30c3\u30c8","Adjust brush sliders more precisely":"\u30d6\u30e9\u30b7\u30b9\u30e9\u30a4\u30c0\u30fc\u3092\u3088\u308a\u7d30\u304b\u304f\u8abf\u6574","Drawing canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9","Move the canvas around":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u79fb\u52d5","Rotate the canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Zoom":"\u30ba\u30fc\u30e0","Zoom the canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u62e1\u5927\u7e2e\u5c0f","Sample the color under the cursor":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u8272\u3092\u30b9\u30dd\u30a4\u30c8","Flip View Horizontal":"\u8868\u793a\u306e\u5de6\u53f3\u53cd\u8ee2","Layers palette":"\u30ec\u30a4\u30e4\u30fc\u30d1\u30ec\u30c3\u30c8","Rename layer":"\u30ec\u30a4\u30e4\u30fc\u540d\u5909\u66f4","Toggle mask enable/disable":"\u30de\u30b9\u30af\u306e\u6709\u52b9/\u7121\u52b9\u5207\u308a\u66ff\u3048","Toggle mask View":"\u30de\u30b9\u30af\u306e\u8868\u793a/\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Save Oekaki":"\u4fdd\u5b58","Saving drawing...":"\u753b\u50cf\u3092\u4fdd\u5b58\u4e2d\u2026","Preparing... This may take a few seconds.":"\u6e96\u5099\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u51e6\u7406\u306f\u6570\u79d2\u304b\u304b\u308b\u4e8b\u304c\u3042\u308a\u307e\u3059\u3002","Drawing saved!":"\u753b\u50cf\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\uff01","Saving ...":"\u4fdd\u5b58\u4e2d\u2026","Drawing saved to browser storage!":"\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3057\u307e\u3057\u305f\uff01","Your drawing has been saved to your browser storage.":"\u30d6\u30e9\u30a6\u30b6\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u307e\u3057\u305f\u3002","Saving cancelled.":"\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u307e\u3057\u305f\u3002","Your drawing has been saved, would you like to post it to the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, post it now":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059","No, keep drawing":"\u307e\u3060\u63cf\u304d\u307e\u3059","No, quit and I\'ll finish it later":"\u30a2\u30d7\u30ea\u3092\u7d42\u4e86\u3057\u3066\u7d9a\u304d\u3092\u5f8c\u3067\u63cf\u304f","Your drawing has been saved, would you like to view it on the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, view the post":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059\u3002","Your drawing has been saved, redirecting you to view your new post now...":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u6295\u7a3f\u5148\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002","Sorry, your drawing could not be saved, Please see the error message.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002","Sorry, your drawing could not be saved, please try again later.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u6642\u9593\u3092\u7f6e\u3044\u3066\u518d\u5ea6\u6295\u7a3f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002","The error returned from the server was":"\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u8fd4\u3063\u3066\u6765\u305f\u30a8\u30e9\u30fc","The file size exceeds the server limit.":"\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u304c\u30b5\u30fc\u30d0\u30fc\u306e\u4e0a\u9650\u3092\u8d85\u3048\u3066\u3044\u307e\u3059\u3002","The total size of FormData is within the acceptable range.":"FormData\u306e\u5408\u8a08\u30b5\u30a4\u30ba\u306f\u5236\u9650\u7bc4\u56f2\u5185\u3067\u3059\u3002","Limit size":"\u4e0a\u9650\u30b5\u30a4\u30ba","Current size":"\u73fe\u5728\u306e\u30b5\u30a4\u30ba","Network response was not OK":"\u901a\u4fe1\u30a8\u30e9\u30fc","HTTP status code":"HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9","Unsaved data was detected.\\nInterrupt image loading and restore it?":"\u672a\u4fdd\u5b58\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u3059\u3002\\n\u753b\u50cf\u306e\u8aad\u307f\u8fbc\u307f\u3092\u4e2d\u65ad\u3057\u3066\u5fa9\u5143\u3057\u307e\u3059\u304b\uff1f","Unsaved data was detected. Would you like to restore it?":"\u672a\u4fdd\u5b58\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u3059\u3002\u5fa9\u5143\u3057\u307e\u3059\u304b\uff1f"}'),
en:Md},Ld=Md,xe="en";wd.prototype=Object.create(Ja(Hb).prototype);wd.prototype.constructor=wd;var zb={};zb=function(){function c(r,z){return z&&`${z}::${Hc++}`||r.uidEvent||Hc++}function d(r){let z=c(r);return r.uidEvent=z,oc[z]=oc[z]||{},oc[z]}function a(r,z,K=null){return Object.values(r).find(R=>R.callable===z&&R.delegationSelector===K)}function h(r,z,K){let R="string"==typeof z,fa=e(r);return ec.has(fa)||(fa=r),[R,R?K:z||K,fa]}function q(r,z,K,R,fa){var ra,Aa;if("string"==typeof z&&r){var [Da,
Ra,Xa]=h(z,K,R);if(z in Wc){let Sa;Sa=Ra;Ra=function(Ea){if(!Ea.relatedTarget||Ea.relatedTarget!==Ea.delegateTarget&&!Ea.delegateTarget.contains(Ea.relatedTarget))return Sa.call(this,Ea)}}R=d(r);R=R[Xa]||(R[Xa]={});var ua=a(R,Ra,Da?K:null);if(ua)return void(ua.oneOff=ua.oneOff&&fa);z=c(Ra,z.replace(wc,""));ua=Da?(ra=Ra,function Ya(Ea){let Wa=r.querySelectorAll(K);for(let {target:Ta}=Ea;Ta&&Ta!==this;Ta=Ta.parentNode)for(let Ua of Wa)if(Ua===Ta)return k(Ea,{delegateTarget:Ta}),Ya.oneOff&&qa.off(r,
Ea.type,K,ra),ra.apply(Ta,[Ea])}):(Aa=Ra,function Wa(Ya){return k(Ya,{delegateTarget:r}),Wa.oneOff&&qa.off(r,Ya.type,Aa),Aa.apply(r,[Ya])});ua.delegationSelector=Da?K:null;ua.callable=Ra;ua.oneOff=fa;ua.uidEvent=z;R[z]=ua;r.addEventListener(Xa,ua,Da)}}function f(r,z,K,R,fa){(R=a(z[K],R,fa))&&(r.removeEventListener(K,R,!!fa),delete z[K][R.uidEvent])}function e(r){return Wc[r=r.replace(kb,"")]||r}function k(r,z={}){for(let [K,R]of Object.entries(z))try{r[K]=R}catch(fa){Object.defineProperty(r,K,{configurable:!0,
get:()=>R})}return r}function l(r){if("true"===r)return!0;if("false"===r)return!1;if(r===Number(r).toString())return Number(r);if(""===r||"null"===r)return null;if("string"!=typeof r)return r;try{return JSON.parse(decodeURIComponent(r))}catch(z){return r}}function g(r){return r.replace(/[A-Z]/g,z=>`-${z.toLowerCase()}`)}function m(r){return r?(r.nodeName||"").toLowerCase():null}function p(r){return null==r?window:"[object Window]"!==r.toString()?(r=r.ownerDocument)&&r.defaultView||window:r}function n(r){return r instanceof
p(r).Element||r instanceof Element}function t(r){return r instanceof p(r).HTMLElement||r instanceof HTMLElement}function u(r){return"u">typeof ShadowRoot&&(r instanceof p(r).ShadowRoot||r instanceof ShadowRoot)}function v(r){return r.split("-")[0]}function A(){var r=navigator.userAgentData;return null!=r&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(z){return z.brand+"/"+z.version}).join(" "):navigator.userAgent}function D(){return!/^((?!chrome|android).)*safari/i.test(A())}function y(r,
z,K){void 0===z&&(z=!1);void 0===K&&(K=!1);var R=r.getBoundingClientRect(),fa=1,ra=1;z&&t(r)&&(fa=r.offsetWidth>0&&uc(R.width)/r.offsetWidth||1,ra=r.offsetHeight>0&&uc(R.height)/r.offsetHeight||1);r=(n(r)?p(r):window).visualViewport;z=!D()&&K;K=(R.left+(z&&r?r.offsetLeft:0))/fa;r=(R.top+(z&&r?r.offsetTop:0))/ra;fa=R.width/fa;R=R.height/ra;return{width:fa,height:R,top:r,right:K+fa,bottom:r+R,left:K,x:K,y:r}}function E(r){var z=y(r),K=r.offsetWidth,R=r.offsetHeight;return 1>=Math.abs(z.width-K)&&(K=
z.width),1>=Math.abs(z.height-R)&&(R=z.height),{x:r.offsetLeft,y:r.offsetTop,width:K,height:R}}function x(r,z){var K=z.getRootNode&&z.getRootNode();if(r.contains(z))return!0;if(K&&u(K)){do{if(z&&r.isSameNode(z))return!0;z=z.parentNode||z.host}while(z)}return!1}function G(r){return p(r).getComputedStyle(r)}function I(r){return((n(r)?r.ownerDocument:r.document)||window.document).documentElement}function O(r){return"html"===m(r)?r:r.assignedSlot||r.parentNode||(u(r)?r.host:null)||I(r)}function B(r){return t(r)&&
"fixed"!==G(r).position?r.offsetParent:null}function N(r){for(var z=p(r),K=B(r);K&&["table","td","th"].indexOf(m(K))>=0&&"static"===G(K).position;)K=B(K);if(!K||"html"!==m(K)&&("body"!==m(K)||"static"!==G(K).position)){if(!K)a:{K=/firefox/i.test(A());if(!/Trident/i.test(A())||!t(r)||"fixed"!==G(r).position)for(r=O(r),u(r)&&(r=r.host);t(r)&&0>["html","body"].indexOf(m(r));){var R=G(r);if("none"!==R.transform||"none"!==R.perspective||"paint"===R.contain||-1!==["transform","perspective"].indexOf(R.willChange)||
K&&"filter"===R.willChange||K&&R.filter&&"none"!==R.filter){K=r;break a}r=r.parentNode}K=null}z=K||z}return z}function P(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function L(r){return Object.assign({},{top:0,right:0,bottom:0,left:0},r)}function ia(r,z){return z.reduce(function(K,R){return K[R]=r,K},{})}function V(r){return r.split("-")[1]}function ma(r){var z,K=r.popper,R=r.popperRect,fa=r.placement,ra=r.variation,Aa=r.offsets,Da=r.position,Ra=r.gpuAcceleration,Xa=r.adaptive,ua=r.roundOffsets,
Sa=r.isFixed;r=Aa.x;r=void 0===r?0:r;var Ea=Aa.y;Ea=void 0===Ea?0:Ea;Ea="function"==typeof ua?ua({x:r,y:Ea}):{x:r,y:Ea};r=Ea.x;Ea=Ea.y;var Ya=Aa.hasOwnProperty("x");Aa=Aa.hasOwnProperty("y");var Wa="left",Ta="top",Ua=window;if(Xa){var Za=N(K),Db="clientHeight",cb="clientWidth";Za===p(K)&&"static"!==G(Za=I(K)).position&&"absolute"===Da&&(Db="scrollHeight",cb="scrollWidth");("top"===fa||(fa==="left"||fa==="right")&&"end"===ra)&&(Ta="bottom",Ea-=(Sa&&Za===Ua&&Ua.visualViewport?Ua.visualViewport.height:
Za[Db])-R.height,Ea*=Ra?1:-1);fa!=="left"&&("top"!==fa&&fa!=="bottom"||"end"!==ra)||(Wa="right",r-=(Sa&&Za===Ua&&Ua.visualViewport?Ua.visualViewport.width:Za[cb])-R.width,r*=Ra?1:-1)}var Oa,sb,tb,Eb,ub,pb;R=Object.assign({position:Da},Xa&&yd);ua=!0===ua?(Oa={x:r,y:Ea},sb=p(K),tb=Oa.x,Eb=Oa.y,{x:uc(tb*(ub=sb.devicePixelRatio||1))/ub||0,y:uc(Eb*ub)/ub||0}):{x:r,y:Ea};return r=ua.x,Ea=ua.y,Ra?Object.assign({},R,((pb={})[Ta]=Aa?"0":"",pb[Wa]=Ya?"0":"",pb.transform=1>=(Ua.devicePixelRatio||1)?"translate("+
r+"px, "+Ea+"px)":"translate3d("+r+"px, "+Ea+"px, 0)",pb)):Object.assign({},R,((z={})[Ta]=Aa?Ea+"px":"",z[Wa]=Ya?r+"px":"",z.transform="",z))}function da(r){return r.replace(/left|right|bottom|top/g,function(z){return Rd[z]})}function Ca(r){return r.replace(/start|end/g,function(z){return Mc[z]})}function ha(r){r=p(r);return{scrollLeft:r.pageXOffset,scrollTop:r.pageYOffset}}function sa(r){return y(I(r)).left+ha(r).scrollLeft}function ea(r){r=G(r);return/auto|scroll|overlay|hidden/.test(r.overflow+
r.overflowY+r.overflowX)}function w(r,z){void 0===z&&(z=[]);var K,R=function Aa(ra){return["html","body","#document"].indexOf(m(ra))>=0?ra.ownerDocument.body:t(ra)&&ea(ra)?ra:Aa(O(ra))}(r);r=R===(null==(K=r.ownerDocument)?void 0:K.body);K=p(R);R=r?[K].concat(K.visualViewport||[],ea(R)?R:[]):R;z=z.concat(R);return r?z:z.concat(w(O(R)))}function H(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function U(r,z,K){var R,fa,ra,Aa,Da,Ra,Xa;if(z==="viewport"){z=p(r);
var ua=I(r);z=z.visualViewport;var Sa=ua.clientWidth;ua=ua.clientHeight;var Ea=R=0;z&&(Sa=z.width,ua=z.height,((fa=D())||!fa&&"fixed"===K)&&(R=z.offsetLeft,Ea=z.offsetTop));r={width:Sa,height:ua,x:R+sa(r),y:Ea};K=H(r)}else K=n(z)?((Sa=y(z,!1,"fixed"===K)).top=Sa.top+z.clientTop,Sa.left+=z.clientLeft,Sa.bottom=Sa.top+z.clientHeight,Sa.right=Sa.left+z.clientWidth,Sa.width=z.clientWidth,Sa.height=z.clientHeight,Sa.x=Sa.left,Sa.y=Sa.top,Sa):H((ua=I(r),Ea=I(ua),fa=ha(ua),ra=null==(R=ua.ownerDocument)?
void 0:R.body,Aa=Nb(Ea.scrollWidth,Ea.clientWidth,ra?ra.scrollWidth:0,ra?ra.clientWidth:0),Da=Nb(Ea.scrollHeight,Ea.clientHeight,ra?ra.scrollHeight:0,ra?ra.clientHeight:0),Ra=-fa.scrollLeft+sa(ua),Xa=-fa.scrollTop,"rtl"===G(ra||Ea).direction&&(Ra+=Nb(Ea.clientWidth,ra?ra.clientWidth:0)-Aa),{width:Aa,height:Da,x:Ra,y:Xa}));return K}function na(r){var z=r.reference,K=r.element,R=(r=r.placement)?v(r):null;r=r?V(r):null;var fa=z.x+z.width/2-K.width/2;var ra=z.y+z.height/2-K.height/2;switch(R){case "top":fa=
{x:fa,y:z.y-K.height};break;case "bottom":fa={x:fa,y:z.y+z.height};break;case "right":fa={x:z.x+z.width,y:ra};break;case "left":fa={x:z.x-K.width,y:ra};break;default:fa={x:z.x,y:z.y}}R=R?P(R):null;if(null!=R)switch(ra="y"===R?"height":"width",r){case "start":fa[R]-=z[ra]/2-K[ra]/2;break;case "end":fa[R]+=z[ra]/2-K[ra]/2}return fa}function W(r,z){void 0===z&&(z={});var K,R,fa,ra,Aa,Da,Ra,Xa,ua=z;z=ua.placement;z=void 0===z?r.placement:z;var Sa=ua.strategy,Ea=void 0===Sa?r.strategy:Sa,Ya=ua.boundary,
Wa=ua.rootBoundary;Sa=ua.elementContext;Sa=void 0===Sa?"popper":Sa;var Ta=ua.altBoundary;ua=ua.padding;ua=void 0===ua?0:ua;ua=L("number"!=typeof ua?ua:ia(ua,Pb));var Ua=r.rects.popper;Ta=r.elements[void 0!==Ta&&Ta?Sa==="popper"?"reference":"popper":Sa];Ta=(K=n(Ta)?Ta:Ta.contextElement||I(r.elements.popper),R=void 0===Ya?"clippingParents":Ya,fa=void 0===Wa?"viewport":Wa,Ra=(Da=[].concat("clippingParents"===R?(ra=w(O(K)),n(Aa=["absolute","fixed"].indexOf(G(K).position)>=0&&t(K)?N(K):K)?ra.filter(function(cb){return n(cb)&&
x(cb,Aa)&&"body"!==m(cb)}):[]):[].concat(R),[fa]))[0],(Xa=Da.reduce(function(cb,Oa){Oa=U(K,Oa,Ea);return cb.top=Nb(Oa.top,cb.top),cb.right=mc(Oa.right,cb.right),cb.bottom=mc(Oa.bottom,cb.bottom),cb.left=Nb(Oa.left,cb.left),cb},U(K,Ra,Ea))).width=Xa.right-Xa.left,Xa.height=Xa.bottom-Xa.top,Xa.x=Xa.left,Xa.y=Xa.top,Xa);R=y(r.elements.reference);fa=na({reference:R,element:Ua,placement:z});fa=H(Object.assign({},Ua,fa));R=Sa==="popper"?fa:R;var Za={top:Ta.top-R.top+ua.top,bottom:R.bottom-Ta.bottom+ua.bottom,
left:Ta.left-R.left+ua.left,right:R.right-Ta.right+ua.right};r=r.modifiersData.offset;if(Sa==="popper"&&r){var Db=r[z];Object.keys(Za).forEach(function(cb){var Oa=["right","bottom"].indexOf(cb)>=0?1:-1,sb=["top","bottom"].indexOf(cb)>=0?"y":"x";Za[cb]+=Db[sb]*Oa})}return Za}function Z(r,z,K){return void 0===K&&(K={x:0,y:0}),{top:r.top-z.height-K.y,right:r.right-z.width+K.x,bottom:r.bottom-z.height+K.y,left:r.left-z.width-K.x}}function ba(r){return["top","right","bottom","left"].some(function(z){return r[z]>=
0})}function la(){for(var r=arguments.length,z=Array(r),K=0;K<r;K++)z[K]=arguments[K];return!z.some(function(R){return!(R&&"function"==typeof R.getBoundingClientRect)})}function Ga(r){void 0===r&&(r={});var z=r.defaultModifiers,K=void 0===z?[]:z;r=r.defaultOptions;var R=void 0===r?F:r;return function(fa,ra,Aa){function Da(){Sa.forEach(function(Wa){return Wa()});Sa=[]}void 0===Aa&&(Aa=R);var Ra,Xa,ua={placement:"bottom",orderedModifiers:[],options:Object.assign({},F,R),modifiersData:{},elements:{reference:fa,
popper:ra},attributes:{},styles:{}},Sa=[],Ea=!1,Ya={state:ua,setOptions:function(Wa){Wa="function"==typeof Wa?Wa(ua.options):Wa;Da();ua.options=Object.assign({},R,ua.options,Wa);ua.scrollParents={reference:n(fa)?w(fa):fa.contextElement?w(fa.contextElement):[],popper:w(ra)};var Ta,Ua,Za,Db,cb;Wa=(Ta=Object.keys(cb=[].concat(K,ua.options.modifiers).reduce(function(Oa,sb){var tb=Oa[sb.name];return Oa[sb.name]=tb?Object.assign({},tb,sb,{options:Object.assign({},tb.options,sb.options),data:Object.assign({},
tb.data,sb.data)}):sb,Oa},{})).map(function(Oa){return cb[Oa]}),Ua=new Map,Za=new Set,Db=[],Ta.forEach(function(Oa){Ua.set(Oa.name,Oa)}),Ta.forEach(function(Oa){Za.has(Oa.name)||function Eb(tb){Za.add(tb.name);[].concat(tb.requires||[],tb.requiresIfExists||[]).forEach(function(ub){Za.has(ub)||(ub=Ua.get(ub))&&Eb(ub)});Db.push(tb)}(Oa)}),Vb.reduce(function(Oa,sb){return Oa.concat(Db.filter(function(tb){return tb.phase===sb}))},[]));return ua.orderedModifiers=Wa.filter(function(Oa){return Oa.enabled}),
ua.orderedModifiers.forEach(function(Oa){var sb=Oa.name,tb=Oa.options;Oa=Oa.effect;"function"==typeof Oa&&(sb=Oa({state:ua,name:sb,instance:Ya,options:void 0===tb?{}:tb}),Sa.push(sb||function(){}))}),Ya.update()},forceUpdate:function(){if(!Ea){var Wa=ua.elements,Ta=Wa.reference;Wa=Wa.popper;if(la(Ta,Wa)){ua.rects={reference:(Ua=N(Wa),Za="fixed"===ua.options.strategy,sb=t(Ua),tb=t(Ua)&&(cb=uc((Db=Ua.getBoundingClientRect()).width)/Ua.offsetWidth||1,Oa=uc(Db.height)/Ua.offsetHeight||1,1!==cb||1!==Oa),
Eb=I(Ua),ub=y(Ta,tb,Za),pb={scrollLeft:0,scrollTop:0},cc={x:0,y:0},(sb||!sb&&!Za)&&(("body"!==m(Ua)||ea(Eb))&&(pb=Ua!==p(Ua)&&t(Ua)?{scrollLeft:Ua.scrollLeft,scrollTop:Ua.scrollTop}:ha(Ua)),t(Ua)?((cc=y(Ua,!0)).x+=Ua.clientLeft,cc.y+=Ua.clientTop):Eb&&(cc.x=sa(Eb))),{x:ub.left+pb.scrollLeft-cc.x,y:ub.top+pb.scrollTop-cc.y,width:ub.width,height:ub.height}),popper:E(Wa)};ua.reset=!1;ua.placement=ua.options.placement;ua.orderedModifiers.forEach(function(Qc){return ua.modifiersData[Qc.name]=Object.assign({},
Qc.data)});var Ua,Za,Db,cb,Oa,sb,tb,Eb,ub,pb,cc;for(Ta=0;Ta<ua.orderedModifiers.length;Ta++)!0!==ua.reset?(Za=ua.orderedModifiers[Ta],Ua=Za.fn,Db=Za.options,Db=void 0===Db?{}:Db,Za=Za.name,"function"==typeof Ua&&(ua=Ua({state:ua,options:Db,name:Za,instance:Ya})||ua)):(ua.reset=!1,Ta=-1)}}},update:(Ra=function(){return new Promise(function(Wa){Ya.forceUpdate();Wa(ua)})},function(){return Xa||=new Promise(function(Wa){Promise.resolve().then(function(){Xa=void 0;Wa(Ra())})}),Xa}),destroy:function(){Da();
Ea=!0}};return la(fa,ra)?(Ya.setOptions(Aa).then(function(Wa){!Ea&&Aa.onFirstUpdate&&Aa.onFirstUpdate(Wa)}),Ya):Ya}}let pa=new Map,ya={set(r,z,K){pa.has(r)||pa.set(r,new Map);r=pa.get(r);r.has(z)||0===r.size?r.set(z,K):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`)},get:(r,z)=>pa.has(r)&&pa.get(r).get(z)||null,remove(r,z){if(pa.has(r)){var K=pa.get(r);K.delete(z);0===K.size&&pa.delete(r)}}},rb=r=>(r&&window.CSS&&window.CSS.escape&&
(r=r.replace(/#([^\s"#']+)/g,(z,K)=>`#${CSS.escape(K)}`)),r),bb=r=>!(!r||"object"!=typeof r)&&(void 0!==r.jquery&&(r=r[0]),void 0!==r.nodeType),Qb=r=>bb(r)?r.jquery?r[0]:r:"string"==typeof r&&r.length>0?document.querySelector(rb(r)):null,Ia=r=>{if(!bb(r)||0===r.getClientRects().length)return!1;let z="visible"===getComputedStyle(r).getPropertyValue("visibility"),K=r.closest("details:not([open])");return K?K!==r&&((r=r.closest("summary"))&&r.parentNode!==K||null===r)?!1:z:z},ob=r=>!r||r.nodeType!==
Node.ELEMENT_NODE||!!r.classList.contains("disabled")||(void 0!==r.disabled?r.disabled:r.hasAttribute("disabled")&&"false"!==r.getAttribute("disabled")),hb=r=>document.documentElement.attachShadow?"function"==typeof r.getRootNode?(r=r.getRootNode(),r instanceof ShadowRoot?r:null):r instanceof ShadowRoot?r:r.parentNode?hb(r.parentNode):null:null,Fb=()=>{},lb=r=>{r.offsetHeight},wb=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,sc=[],Lb=r=>{var z=()=>{let K=wb();
if(K){let R=r.NAME,fa=K.fn[R];K.fn[R]=r.jQueryInterface;K.fn[R].Constructor=r;K.fn[R].noConflict=()=>(K.fn[R]=fa,r.jQueryInterface)}};"loading"===document.readyState?(sc.length||document.addEventListener("DOMContentLoaded",()=>{for(let K of sc)K()}),sc.push(z)):z()},yb=(r,z=[],K=r)=>"function"==typeof r?r.call(...z):K,mb=(r,z,K=!0)=>{if(!K)return void yb(r);K=(ra=>{if(!ra)return 0;let {transitionDuration:Aa,transitionDelay:Da}=window.getComputedStyle(ra);ra=Number.parseFloat(Aa);let Ra=Number.parseFloat(Da);
return ra||Ra?(Aa=Aa.split(",")[0],Da=Da.split(",")[0],1E3*(Number.parseFloat(Aa)+Number.parseFloat(Da))):0})(z)+5;let R=!1,fa=({target:ra})=>{ra===z&&(R=!0,z.removeEventListener("transitionend",fa),yb(r))};z.addEventListener("transitionend",fa);setTimeout(()=>{R||z.dispatchEvent(new Event("transitionend"))},K)},nb=(r,z,K,R)=>{let fa=r.length;z=r.indexOf(z);return-1===z?!K&&R?r[fa-1]:r[0]:(z+=K?1:-1,R&&(z=(z+fa)%fa),r[Math.max(0,Math.min(z,fa-1))])},wc=/[^.]*(?=\..*)\.|.*/,kb=/\..*/,Mb=/::\d+$/,oc=
{},Hc=1,Wc={mouseenter:"mouseover",mouseleave:"mouseout"},ec=new Set("click dblclick mouseup mousedown contextmenu mousewheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange touchstart touchmove touchend touchcancel pointerdown pointermove pointerup pointerleave pointercancel gesturestart gesturechange gestureend focus blur change reset select submit focusin focusout load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll".split(" ")),
qa={on(r,z,K,R){q(r,z,K,R,!1)},one(r,z,K,R){q(r,z,K,R,!0)},off(r,z,K,R){if("string"==typeof z&&r){var [fa,ra,Aa]=h(z,K,R);R=Aa!==z;var Da=d(r),Ra=Da[Aa]||{},Xa=z.startsWith(".");if(void 0===ra){if(Xa)for(var ua of Object.keys(Da)){K=z.slice(1);for(let [Sa,Ea]of Object.entries(Da[ua]||{}))Sa.includes(K)&&f(r,Da,ua,Ea.callable,Ea.delegationSelector)}for(let [Sa,Ea]of Object.entries(Ra))ua=Sa.replace(Mb,""),R&&!z.includes(ua)||f(r,Da,Aa,Ea.callable,Ea.delegationSelector)}else Object.keys(Ra).length&&
f(r,Da,Aa,ra,fa?K:null)}},trigger(r,z,K){if("string"!=typeof z||!r)return null;let R=wb(),fa=null,ra=!0,Aa=!0,Da=!1;z!==e(z)&&R&&(fa=R.Event(z,K),R(r).trigger(fa),ra=!fa.isPropagationStopped(),Aa=!fa.isImmediatePropagationStopped(),Da=fa.isDefaultPrevented());z=k(new Event(z,{bubbles:ra,cancelable:!0}),K);return Da&&z.preventDefault(),Aa&&r.dispatchEvent(z),z.defaultPrevented&&fa&&fa.preventDefault(),z}},ac={setDataAttribute(r,z,K){r.setAttribute(`data-bs-${g(z)}`,K)},removeDataAttribute(r,z){r.removeAttribute(`data-bs-${g(z)}`)},
getDataAttributes(r){if(!r)return{};let z={};for(let K of Object.keys(r.dataset).filter(R=>R.startsWith("bs")&&!R.startsWith("bsConfig"))){let R=K.replace(/^bs/,"");z[R=R.charAt(0).toLowerCase()+R.slice(1)]=l(r.dataset[K])}return z},getDataAttribute:(r,z)=>l(r.getAttribute(`data-bs-${g(z)}`))};class fc{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw Error('You have to implement the static method "NAME", for each component!');}_getConfig(r){return r=this._mergeConfigObj(r),
r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r}_mergeConfigObj(r,z){let K=bb(z)?ac.getDataAttribute(z,"config"):{};return{...this.constructor.Default,...("object"==typeof K?K:{}),...(bb(z)?ac.getDataAttributes(z):{}),...("object"==typeof r?r:{})}}_typeCheckConfig(r,z=this.constructor.DefaultType){for(let [K,R]of Object.entries(z))if(z=r[K],z=bb(z)?"element":null==z?`${z}`:Object.prototype.toString.call(z).match(/\s([a-z]+)/i)[1].toLowerCase(),!(new RegExp(R)).test(z))throw TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${K}" provided type "${z}" but expected type "${R}".`);
}}class $b extends fc{dispose(){for(let r of(ya.remove(this._element,this.constructor.DATA_KEY),qa.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this)))this[r]=null}_queueCallback(r,z,K=!0){mb(r,z,K)}_getConfig(r){return r=this._mergeConfigObj(r,this._element),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}static getInstance(r){return ya.get(Qb(r),this.DATA_KEY)}static getOrCreateInstance(r,z={}){return this.getInstance(r)||new this(r,"object"==typeof z?z:null)}static get VERSION(){return"5.3.8"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(r){return`${r}${this.EVENT_KEY}`}constructor(r,
z){super();(r=Qb(r))&&(this._element=r,this._config=this._getConfig(z),ya.set(this._element,this.constructor.DATA_KEY,this))}}let xc=r=>{let z=r.getAttribute("data-bs-target");if(!z||"#"===z){r=r.getAttribute("href");if(!r||!r.includes("#")&&!r.startsWith("."))return null;r.includes("#")&&!r.startsWith("#")&&(r=`#${r.split("#")[1]}`);z=r&&"#"!==r?r.trim():null}return z?z.split(",").map(K=>rb(K)).join(","):null},La={find:(r,z=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(z,
r)),findOne:(r,z=document.documentElement)=>Element.prototype.querySelector.call(z,r),children:(r,z)=>[].concat(...r.children).filter(K=>K.matches(z)),parents(r,z){let K=[];for(r=r.parentNode.closest(z);r;)K.push(r),r=r.parentNode.closest(z);return K},prev(r,z){for(r=r.previousElementSibling;r;){if(r.matches(z))return[r];r=r.previousElementSibling}return[]},next(r,z){for(r=r.nextElementSibling;r;){if(r.matches(z))return[r];r=r.nextElementSibling}return[]},focusableChildren(r){let z='a button input textarea select details [tabindex] [contenteditable="true"]'.split(" ").map(K=>
`${K}:not([tabindex^="-"])`).join(",");return this.find(z,r).filter(K=>!ob(K)&&Ia(K))},getSelectorFromElement(r){return(r=xc(r))&&La.findOne(r)?r:null},getElementFromSelector(r){return(r=xc(r))?La.findOne(r):null},getMultipleElementsFromSelector(r){return(r=xc(r))?La.find(r):[]}},Rb=(r,z="hide")=>{let K=r.NAME;qa.on(document,`click.dismiss${r.EVENT_KEY}`,`[data-bs-dismiss="${K}"]`,function(R){(["A","AREA"].includes(this.tagName)&&R.preventDefault(),ob(this))||(R=La.getElementFromSelector(this)||this.closest(`.${K}`),
r.getOrCreateInstance(R)[z]())})};class tc extends $b{static get NAME(){return"alert"}close(){if(!qa.trigger(this._element,"close.bs.alert").defaultPrevented){this._element.classList.remove("show");var r=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,r)}}_destroyElement(){this._element.remove();qa.trigger(this._element,"closed.bs.alert");this.dispose()}static jQueryInterface(r){return this.each(function(){let z=tc.getOrCreateInstance(this);if("string"==
typeof r){if(void 0===z[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);z[r](this)}})}}Rb(tc,"close");Lb(tc);class C extends $b{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(r){return this.each(function(){let z=C.getOrCreateInstance(this);"toggle"===r&&z[r]()})}}qa.on(document,"click.bs.button.data-api",'[data-bs-toggle="button"]',r=>{r.preventDefault();r=r.target.closest('[data-bs-toggle="button"]');
C.getOrCreateInstance(r).toggle()});Lb(C);let M={endCallback:null,leftCallback:null,rightCallback:null},X={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Y extends fc{static get Default(){return M}static get DefaultType(){return X}static get NAME(){return"swipe"}dispose(){qa.off(this._element,".bs.swipe")}_start(r){this._supportPointerEvents?this._eventIsPointerPenTouch(r)&&(this._deltaX=r.clientX):this._deltaX=r.touches[0].clientX}_end(r){this._eventIsPointerPenTouch(r)&&
(this._deltaX=r.clientX-this._deltaX);this._handleSwipe();yb(this._config.endCallback)}_move(r){this._deltaX=r.touches&&r.touches.length>1?0:r.touches[0].clientX-this._deltaX}_handleSwipe(){var r=Math.abs(this._deltaX);r<=40||(r/=this._deltaX,this._deltaX=0,r&&yb(r>0?this._config.rightCallback:this._config.leftCallback))}_initEvents(){this._supportPointerEvents?(qa.on(this._element,"pointerdown.bs.swipe",r=>this._start(r)),qa.on(this._element,"pointerup.bs.swipe",r=>this._end(r)),this._element.classList.add("pointer-event")):
(qa.on(this._element,"touchstart.bs.swipe",r=>this._start(r)),qa.on(this._element,"touchmove.bs.swipe",r=>this._move(r)),qa.on(this._element,"touchend.bs.swipe",r=>this._end(r)))}_eventIsPointerPenTouch(r){return this._supportPointerEvents&&("pen"===r.pointerType||"touch"===r.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}constructor(r,z){super();(this._element=r)&&Y.isSupported()&&(this._config=this._getConfig(z),this._deltaX=0,this._supportPointerEvents=
!!window.PointerEvent,this._initEvents())}}let ca={ArrowLeft:"right",ArrowRight:"left"},aa={interval:5E3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},va={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ma extends $b{static get Default(){return aa}static get DefaultType(){return va}static get NAME(){return"carousel"}next(){this._slide("next")}nextWhenVisible(){!document.hidden&&Ia(this._element)&&this.next()}prev(){this._slide("prev")}pause(){this._isSliding&&
this._element.dispatchEvent(new Event("transitionend"));this._clearInterval()}cycle(){this._clearInterval();this._updateInterval();this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?qa.one(this._element,"slid.bs.carousel",()=>this.cycle()):this.cycle())}to(r){let z=this._getItems();if(!(r>z.length-1||r<0)){if(this._isSliding)return void qa.one(this._element,"slid.bs.carousel",()=>this.to(r));var K=this._getItemIndex(this._getActive());
K===r||this._slide(r>K?"next":"prev",z[r])}}dispose(){this._swipeHelper&&this._swipeHelper.dispose();super.dispose()}_configAfterMerge(r){return r.defaultInterval=r.interval,r}_addEventListeners(){this._config.keyboard&&qa.on(this._element,"keydown.bs.carousel",r=>this._keydown(r));"hover"===this._config.pause&&(qa.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),qa.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle()));this._config.touch&&Y.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(let r of La.find(".carousel-item img",
this._element))qa.on(r,"dragstart.bs.carousel",z=>z.preventDefault());this._swipeHelper=new Y(this._element,{leftCallback:()=>this._slide(this._directionToOrder("left")),rightCallback:()=>this._slide(this._directionToOrder("right")),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}})}_keydown(r){if(!/input|textarea/i.test(r.target.tagName)){var z=ca[r.key];
z&&(r.preventDefault(),this._slide(this._directionToOrder(z)))}}_getItemIndex(r){return this._getItems().indexOf(r)}_setActiveIndicatorElement(r){if(this._indicatorsElement){var z=La.findOne(".active",this._indicatorsElement);z.classList.remove("active");z.removeAttribute("aria-current");(r=La.findOne(`[data-bs-slide-to="${r}"]`,this._indicatorsElement))&&(r.classList.add("active"),r.setAttribute("aria-current","true"))}}_updateInterval(){var r=this._activeElement||this._getActive();r&&(r=Number.parseInt(r.getAttribute("data-bs-interval"),
10),this._config.interval=r||this._config.defaultInterval)}_slide(r,z=null){if(!this._isSliding){var K=this._getActive(),R=r==="next",fa=z||nb(this._getItems(),K,R,this._config.wrap);if(fa!==K){var ra=this._getItemIndex(fa),Aa=Xa=>qa.trigger(this._element,Xa,{relatedTarget:fa,direction:this._orderToDirection(r),from:this._getItemIndex(K),to:ra});if(!Aa("slide.bs.carousel").defaultPrevented&&K&&fa){z=!!this._interval;this.pause();this._isSliding=!0;this._setActiveIndicatorElement(ra);this._activeElement=
fa;var Da=R?"carousel-item-start":"carousel-item-end",Ra=R?"carousel-item-next":"carousel-item-prev";fa.classList.add(Ra);fa.offsetHeight;K.classList.add(Da);fa.classList.add(Da);this._queueCallback(()=>{fa.classList.remove(Da,Ra);fa.classList.add("active");K.classList.remove("active",Ra,Da);this._isSliding=!1;Aa("slid.bs.carousel")},K,this._isAnimated());z&&this.cycle()}}}}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return La.findOne(".active.carousel-item",this._element)}_getItems(){return La.find(".carousel-item",
this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(r){return"rtl"===document.documentElement.dir?r==="left"?"prev":"next":r==="left"?"next":"prev"}_orderToDirection(r){return"rtl"===document.documentElement.dir?r==="prev"?"left":"right":r==="prev"?"right":"left"}static jQueryInterface(r){return this.each(function(){let z=Ma.getOrCreateInstance(this,r);if("number"!=typeof r){if("string"==typeof r){if(void 0===z[r]||r.startsWith("_")||
"constructor"===r)throw TypeError(`No method named "${r}"`);z[r]()}}else z.to(r)})}constructor(r,z){super(r,z);this._activeElement=this._interval=null;this._isSliding=!1;this._swipeHelper=this.touchTimeout=null;this._indicatorsElement=La.findOne(".carousel-indicators",this._element);this._addEventListeners();this._config.ride==="carousel"&&this.cycle()}}qa.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(r){var z=La.getElementFromSelector(this);if(z&&z.classList.contains("carousel"))return r.preventDefault(),
r=Ma.getOrCreateInstance(z),z=this.getAttribute("data-bs-slide-to"),z?r.to(z):"next"===ac.getDataAttribute(this,"slide")?r.next():r.prev(),void r._maybeEnableCycle()});qa.on(window,"load.bs.carousel.data-api",()=>{for(let r of La.find('[data-bs-ride="carousel"]'))Ma.getOrCreateInstance(r)});Lb(Ma);let ab={parent:null,toggle:!0},Yb={parent:"(null|element)",toggle:"boolean"};class Ub extends $b{static get Default(){return ab}static get DefaultType(){return Yb}static get NAME(){return"collapse"}toggle(){this._isShown()?
this.hide():this.show()}show(){if(!this._isTransitioning&&!this._isShown()){var r=[];if(!(this._config.parent&&(r=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(K=>K!==this._element).map(K=>Ub.getOrCreateInstance(K,{toggle:!1}))),r.length&&r[0]._isTransitioning||qa.trigger(this._element,"show.bs.collapse").defaultPrevented)){for(let K of r)K.hide();var z=this._getDimension();this._element.classList.remove("collapse");this._element.classList.add("collapsing");this._element.style[z]=
0;this._addAriaAndCollapsedClass(this._triggerArray,!0);this._isTransitioning=!0;r=`scroll${z[0].toUpperCase()+z.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse","show");this._element.style[z]="";qa.trigger(this._element,"shown.bs.collapse")},this._element,!0);this._element.style[z]=`${this._element[r]}px`}}}hide(){if(!this._isTransitioning&&this._isShown()&&!qa.trigger(this._element,"hide.bs.collapse").defaultPrevented){var r=
this._getDimension();for(let z of(this._element.style[r]=`${this._element.getBoundingClientRect()[r]}px`,lb(this._element),this._element.classList.add("collapsing"),this._element.classList.remove("collapse","show"),this._triggerArray)){let K=La.getElementFromSelector(z);K&&!this._isShown(K)&&this._addAriaAndCollapsedClass([z],!1)}this._isTransitioning=!0;this._element.style[r]="";this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse");
qa.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}}_isShown(r=this._element){return r.classList.contains("show")}_configAfterMerge(r){return r.toggle=!!r.toggle,r.parent=Qb(r.parent),r}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(this._config.parent)for(let r of this._getFirstLevelChildren('[data-bs-toggle="collapse"]')){let z=La.getElementFromSelector(r);z&&this._addAriaAndCollapsedClass([r],this._isShown(z))}}_getFirstLevelChildren(r){let z=
La.find(":scope .collapse .collapse",this._config.parent);return La.find(r,this._config.parent).filter(K=>!z.includes(K))}_addAriaAndCollapsedClass(r,z){if(r.length)for(let K of r)K.classList.toggle("collapsed",!z),K.setAttribute("aria-expanded",z)}static jQueryInterface(r){let z={};return"string"==typeof r&&/show|hide/.test(r)&&(z.toggle=!1),this.each(function(){let K=Ub.getOrCreateInstance(this,z);if("string"==typeof r){if(void 0===K[r])throw TypeError(`No method named "${r}"`);K[r]()}})}constructor(r,
z){for(const K of(super(r,z),this._isTransitioning=!1,this._triggerArray=[],La.find('[data-bs-toggle="collapse"]')))r=La.getSelectorFromElement(K),z=La.find(r).filter(R=>R===this._element),null!==r&&z.length&&this._triggerArray.push(K);this._initializeChildren();this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown());this._config.toggle&&this.toggle()}}qa.on(document,"click.bs.collapse.data-api",'[data-bs-toggle="collapse"]',function(r){for(let z of(("A"===r.target.tagName||
r.delegateTarget&&"A"===r.delegateTarget.tagName)&&r.preventDefault(),La.getMultipleElementsFromSelector(this)))Ub.getOrCreateInstance(z,{toggle:!1}).toggle()});Lb(Ub);var Pb=["top","bottom","right","left"],Kb=Pb.reduce(function(r,z){return r.concat([z+"-start",z+"-end"])},[]),vb=[].concat(Pb,["auto"]).reduce(function(r,z){return r.concat([z,z+"-start",z+"-end"])},[]),Vb="beforeRead read afterRead beforeMain main afterMain beforeWrite write afterWrite".split(" ");let Ic={name:"applyStyles",enabled:!0,
phase:"write",fn:function(r){var z=r.state;Object.keys(z.elements).forEach(function(K){var R=z.styles[K]||{},fa=z.attributes[K]||{},ra=z.elements[K];t(ra)&&m(ra)&&(Object.assign(ra.style,R),Object.keys(fa).forEach(function(Aa){var Da=fa[Aa];!1===Da?ra.removeAttribute(Aa):ra.setAttribute(Aa,!0===Da?"":Da)}))})},effect:function(r){var z=r.state,K={popper:{position:z.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(z.elements.popper.style,K.popper),
z.styles=K,z.elements.arrow&&Object.assign(z.elements.arrow.style,K.arrow),function(){Object.keys(z.elements).forEach(function(R){var fa=z.elements[R],ra=z.attributes[R]||{};R=Object.keys(z.styles.hasOwnProperty(R)?z.styles[R]:K[R]).reduce(function(Aa,Da){return Aa[Da]="",Aa},{});t(fa)&&m(fa)&&(Object.assign(fa.style,R),Object.keys(ra).forEach(function(Aa){fa.removeAttribute(Aa)}))})}},requires:["computeStyles"]};var Nb=Math.max,mc=Math.min,uc=Math.round;let lc={name:"arrow",enabled:!0,phase:"main",
fn:function(r){var z,K=r.state,R=r.name,fa=r.options,ra=K.elements.arrow,Aa=K.modifiersData.popperOffsets,Da=v(K.placement);r=P(Da);Da=["left","right"].indexOf(Da)>=0?"height":"width";if(ra&&Aa){var Ra;fa=(Ra=fa.padding,L("number"!=typeof(Ra="function"==typeof Ra?Ra(Object.assign({},K.rects,{placement:K.placement})):Ra)?Ra:ia(Ra,Pb)));Ra=E(ra);var Xa="y"===r?"top":"left",ua="y"===r?"bottom":"right",Sa=K.rects.reference[Da]+K.rects.reference[r]-Aa[r]-K.rects.popper[Da];Aa=Aa[r]-K.rects.reference[r];
ra=(ra=N(ra))?"y"===r?ra.clientHeight||0:ra.clientWidth||0:0;Aa=ra/2-Ra[Da]/2+(Sa/2-Aa/2);Da=Nb(fa[Xa],mc(Aa,ra-Ra[Da]-fa[ua]));K.modifiersData[R]=((z={})[r]=Da,z.centerOffset=Da-Aa,z)}},effect:function(r){var z=r.state;r=r.options.element;r=void 0===r?"[data-popper-arrow]":r;null!=r&&("string"!=typeof r||(r=z.elements.popper.querySelector(r)))&&x(z.elements.popper,r)&&(z.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};var yd={top:"auto",right:"auto",bottom:"auto",
left:"auto"};let $c={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(r){var z=r.state,K=r.options,R=K.gpuAcceleration;r=K.adaptive;K=K.roundOffsets;K=void 0===K||K;R={placement:v(z.placement),variation:V(z.placement),popper:z.elements.popper,popperRect:z.rects.popper,gpuAcceleration:void 0===R||R,isFixed:"fixed"===z.options.strategy};null!=z.modifiersData.popperOffsets&&(z.styles.popper=Object.assign({},z.styles.popper,ma(Object.assign({},R,{offsets:z.modifiersData.popperOffsets,position:z.options.strategy,
adaptive:void 0===r||r,roundOffsets:K}))));null!=z.modifiersData.arrow&&(z.styles.arrow=Object.assign({},z.styles.arrow,ma(Object.assign({},R,{offsets:z.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:K}))));z.attributes.popper=Object.assign({},z.attributes.popper,{"data-popper-placement":z.placement})},data:{}};var Nc={passive:!0};let id={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(r){var z=r.state,K=r.instance;r=r.options;var R=r.scroll,fa=void 0===
R||R;r=r.resize;var ra=void 0===r||r,Aa=p(z.elements.popper),Da=[].concat(z.scrollParents.reference,z.scrollParents.popper);return fa&&Da.forEach(function(Ra){Ra.addEventListener("scroll",K.update,Nc)}),ra&&Aa.addEventListener("resize",K.update,Nc),function(){fa&&Da.forEach(function(Ra){Ra.removeEventListener("scroll",K.update,Nc)});ra&&Aa.removeEventListener("resize",K.update,Nc)}},data:{}};var Rd={left:"right",right:"left",bottom:"top",top:"bottom"},Mc={start:"end",end:"start"};let jd={name:"flip",
enabled:!0,phase:"main",fn:function(r){var z=r.state,K=r.options;r=r.name;if(!z.modifiersData[r]._skip){var R=K.mainAxis;R=void 0===R||R;var fa=K.altAxis;fa=void 0===fa||fa;var ra=K.fallbackPlacements,Aa=K.padding,Da=K.boundary,Ra=K.rootBoundary,Xa=K.altBoundary,ua=K.flipVariations,Sa=void 0===ua||ua,Ea=K.allowedAutoPlacements;K=z.options.placement;ua=v(K);ra=ra||(ua!==K&&Sa?function(Eb){if(v(Eb)==="auto")return[];var ub=da(Eb);return[Ca(Eb),ub,Ca(ub)]}(K):[da(K)]);var Ya=[K].concat(ra).reduce(function(Eb,
ub){var pb,cc,Qc,Rc,Rf,Sf,Tf,Uf,Vf,Wf,Ne,Oe;return Eb.concat(v(ub)==="auto"?(cc=(pb={placement:ub,boundary:Da,rootBoundary:Ra,padding:Aa,flipVariations:Sa,allowedAutoPlacements:Ea}).placement,Qc=pb.boundary,Rc=pb.rootBoundary,Rf=pb.padding,Sf=pb.flipVariations,Uf=void 0===(Tf=pb.allowedAutoPlacements)?vb:Tf,0===(Ne=(Wf=(Vf=V(cc))?Sf?Kb:Kb.filter(function(Sc){return V(Sc)===Vf}):Pb).filter(function(Sc){return Uf.indexOf(Sc)>=0})).length&&(Ne=Wf),Object.keys(Oe=Ne.reduce(function(Sc,Ed){return Sc[Ed]=
W(z,{placement:Ed,boundary:Qc,rootBoundary:Rc,padding:Rf})[v(Ed)],Sc},{})).sort(function(Sc,Ed){return Oe[Sc]-Oe[Ed]})):ub)},[]);K=z.rects.reference;ra=z.rects.popper;var Wa=new Map;ua=!0;for(var Ta=Ya[0],Ua=0;Ua<Ya.length;Ua++){var Za=Ya[Ua],Db=v(Za),cb=V(Za)==="start",Oa=["top","bottom"].indexOf(Db)>=0,sb=Oa?"width":"height",tb=W(z,{placement:Za,boundary:Da,rootBoundary:Ra,altBoundary:Xa,padding:Aa});cb=Oa?cb?"right":"left":cb?"bottom":"top";K[sb]>ra[sb]&&(cb=da(cb));sb=da(cb);Oa=[];if(R&&Oa.push(tb[Db]<=
0),fa&&Oa.push(tb[cb]<=0,tb[sb]<=0),Oa.every(function(Eb){return Eb})){Ta=Za;ua=!1;break}Wa.set(Za,Oa)}if(ua)for(R=function(Eb){var ub=Ya.find(function(pb){if(pb=Wa.get(pb))return pb.slice(0,Eb).every(function(cc){return cc})});if(ub)return Ta=ub,"break"},fa=Sa?3:1;fa>0&&"break"!==R(fa);fa--);z.placement!==Ta&&(z.modifiersData[r]._skip=!0,z.placement=Ta,z.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},kd={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(r){var z=
r.state;r=r.name;var K=z.rects.reference,R=z.rects.popper,fa=z.modifiersData.preventOverflow,ra=W(z,{elementContext:"reference"}),Aa=W(z,{altBoundary:!0});K=Z(ra,K);R=Z(Aa,R,fa);fa=ba(K);Aa=ba(R);z.modifiersData[r]={referenceClippingOffsets:K,popperEscapeOffsets:R,isReferenceHidden:fa,hasPopperEscaped:Aa};z.attributes.popper=Object.assign({},z.attributes.popper,{"data-popper-reference-hidden":fa,"data-popper-escaped":Aa})}},ad={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(r){var z=
r.state,K=r.name;r=r.options.offset;var R=void 0===r?[0,0]:r;r=vb.reduce(function(Aa,Da){var Ra,Xa,ua,Sa,Ea,Ya;return Aa[Da]=(Ra=z.rects,ua=["left","top"].indexOf(Xa=v(Da))>=0?-1:1,Ea=(Sa="function"==typeof R?R(Object.assign({},Ra,{placement:Da})):R)[0],Ya=Sa[1],Ea=Ea||0,Ya=(Ya||0)*ua,["left","right"].indexOf(Xa)>=0?{x:Ya,y:Ea}:{x:Ea,y:Ya}),Aa},{});var fa=r[z.placement],ra=fa.x;fa=fa.y;null!=z.modifiersData.popperOffsets&&(z.modifiersData.popperOffsets.x+=ra,z.modifiersData.popperOffsets.y+=fa);z.modifiersData[K]=
r}},bd={name:"popperOffsets",enabled:!0,phase:"read",fn:function(r){var z=r.state;z.modifiersData[r.name]=na({reference:z.rects.reference,element:z.rects.popper,placement:z.placement})},data:{}},ld={name:"preventOverflow",enabled:!0,phase:"main",fn:function(r){var z=r.state,K=r.options;r=r.name;var R=K.mainAxis,fa=K.altAxis,ra=K.tether;ra=void 0===ra||ra;var Aa=K.tetherOffset,Da=void 0===Aa?0:Aa,Ra=W(z,{boundary:K.boundary,rootBoundary:K.rootBoundary,padding:K.padding,altBoundary:K.altBoundary}),
Xa=v(z.placement),ua=V(z.placement),Sa=!ua,Ea=P(Xa);K="x"===Ea?"y":"x";Aa=z.modifiersData.popperOffsets;var Ya=z.rects.reference,Wa=z.rects.popper;Da="function"==typeof Da?Da(Object.assign({},z.rects,{placement:z.placement})):Da;var Ta="number"==typeof Da?{mainAxis:Da,altAxis:Da}:Object.assign({mainAxis:0,altAxis:0},Da),Ua=z.modifiersData.offset?z.modifiersData.offset[z.placement]:null;Da={x:0,y:0};if(Aa){if(void 0===R||R){var Za,Db="y"===Ea?"top":"left",cb="y"===Ea?"bottom":"right",Oa="y"===Ea?"height":
"width";R=Aa[Ea];var sb=R+Ra[Db],tb=R-Ra[cb],Eb=ra?-Wa[Oa]/2:0,ub=ua==="start"?Ya[Oa]:Wa[Oa];ua=ua==="start"?-Wa[Oa]:-Ya[Oa];var pb=z.elements.arrow;pb=ra&&pb?E(pb):{width:0,height:0};var cc=z.modifiersData["arrow#persistent"]?z.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0};Db=cc[Db];cb=cc[cb];pb=Nb(0,mc(Ya[Oa],pb[Oa]));ub=Sa?Ya[Oa]/2-Eb-pb-Db-Ta.mainAxis:ub-pb-Db-Ta.mainAxis;Sa=Sa?-Ya[Oa]/2+Eb+pb+cb+Ta.mainAxis:ua+pb+cb+Ta.mainAxis;Eb=(Oa=z.elements.arrow&&N(z.elements.arrow))?
"y"===Ea?Oa.clientTop||0:Oa.clientLeft||0:0;Oa=null!=(Za=null==Ua?void 0:Ua[Ea])?Za:0;Za=ra?mc(sb,R+ub-Oa-Eb):sb;tb=ra?Nb(tb,R+Sa-Oa):tb;Za=Nb(Za,mc(R,tb));Aa[Ea]=Za;Da[Ea]=Za-R}if(void 0!==fa&&fa){var Qc,Rc;fa=Aa[K];R="y"===K?"height":"width";Za=fa+Ra["x"===Ea?"top":"left"];Ra=fa-Ra["x"===Ea?"bottom":"right"];Xa=-1!==["top","left"].indexOf(Xa);Ea=null!=(Rc=null==Ua?void 0:Ua[K])?Rc:0;Rc=Xa?Za:fa-Ya[R]-Wa[R]-Ea+Ta.altAxis;Ya=Xa?fa+Ya[R]+Wa[R]-Ea-Ta.altAxis:Ra;Wa=ra&&Xa?(Qc=Nb(Rc,mc(fa,Ya)))>Ya?Ya:
Qc:Nb(ra?Rc:Za,mc(fa,ra?Ya:Ra));Aa[K]=Wa;Da[K]=Wa-fa}z.modifiersData[r]=Da}},requiresIfExists:["offset"]};var F={placement:"bottom",modifiers:[],strategy:"absolute"},S=Ga(),ja=Ga({defaultModifiers:[id,bd,$c,Ic]}),xa=Ga({defaultModifiers:[id,bd,$c,Ic,ad,jd,ld,lc,kd]});let Ha=Object.freeze(Object.defineProperty({__proto__:null,afterMain:"afterMain",afterRead:"afterRead",afterWrite:"afterWrite",applyStyles:Ic,arrow:lc,auto:"auto",basePlacements:Pb,beforeMain:"beforeMain",beforeRead:"beforeRead",beforeWrite:"beforeWrite",
bottom:"bottom",clippingParents:"clippingParents",computeStyles:$c,createPopper:xa,createPopperBase:S,createPopperLite:ja,detectOverflow:W,end:"end",eventListeners:id,flip:jd,hide:kd,left:"left",main:"main",modifierPhases:Vb,offset:ad,placements:vb,popper:"popper",popperGenerator:Ga,popperOffsets:bd,preventOverflow:ld,read:"read",reference:"reference",right:"right",start:"start",top:"top",variationPlacements:Kb,viewport:"viewport",write:"write"},Symbol.toStringTag,{value:"Module"})),ta="rtl"===document.documentElement.dir?
"top-end":"top-start",Na="rtl"===document.documentElement.dir?"top-start":"top-end",eb="rtl"===document.documentElement.dir?"bottom-end":"bottom-start",Gb="rtl"===document.documentElement.dir?"bottom-start":"bottom-end",kc="rtl"===document.documentElement.dir?"left-start":"right-start",Ec="rtl"===document.documentElement.dir?"right-start":"left-start",ic={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Qd={autoClose:"(boolean|string)",boundary:"(string|element)",
display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class za extends $b{static get Default(){return ic}static get DefaultType(){return Qd}static get NAME(){return"dropdown"}toggle(){return this._isShown()?this.hide():this.show()}show(){if(!ob(this._element)&&!this._isShown()){var r={relatedTarget:this._element};if(!qa.trigger(this._element,"show.bs.dropdown",r).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&
!this._parent.closest(".navbar-nav"))for(let z of[].concat(...document.body.children))qa.on(z,"mouseover",Fb);this._element.focus();this._element.setAttribute("aria-expanded",!0);this._menu.classList.add("show");this._element.classList.add("show");qa.trigger(this._element,"shown.bs.dropdown",r)}}}hide(){!ob(this._element)&&this._isShown()&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy();super.dispose()}update(){this._inNavbar=this._detectNavbar();this._popper&&
this._popper.update()}_completeHide(r){if(!qa.trigger(this._element,"hide.bs.dropdown",r).defaultPrevented){if("ontouchstart"in document.documentElement)for(let z of[].concat(...document.body.children))qa.off(z,"mouseover",Fb);this._popper&&this._popper.destroy();this._menu.classList.remove("show");this._element.classList.remove("show");this._element.setAttribute("aria-expanded","false");ac.removeDataAttribute(this._menu,"popper");qa.trigger(this._element,"hidden.bs.dropdown",r)}}_getConfig(r){if("object"==
typeof(r=super._getConfig(r)).reference&&!bb(r.reference)&&"function"!=typeof r.reference.getBoundingClientRect)throw TypeError('DROPDOWN: Option "reference" provided type "object" without a required "getBoundingClientRect" method.');return r}_createPopper(){if(void 0===Ha)throw TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let r=this._element;"parent"===this._config.reference?r=this._parent:bb(this._config.reference)?r=Qb(this._config.reference):"object"==typeof this._config.reference&&
(r=this._config.reference);let z=this._getPopperConfig();this._popper=xa(r,this._menu,z)}_isShown(){return this._menu.classList.contains("show")}_getPlacement(){let r=this._parent;if(r.classList.contains("dropend"))return kc;if(r.classList.contains("dropstart"))return Ec;if(r.classList.contains("dropup-center"))return"top";if(r.classList.contains("dropdown-center"))return"bottom";let z="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return r.classList.contains("dropup")?
z?Na:ta:z?Gb:eb}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){let {offset:r}=this._config;return"string"==typeof r?r.split(",").map(z=>Number.parseInt(z,10)):"function"==typeof r?z=>r(z,this._element):r}_getPopperConfig(){let r={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(ac.setDataAttribute(this._menu,
"popper","static"),r.modifiers=[{name:"applyStyles",enabled:!1}]),{...r,...yb(this._config.popperConfig,[void 0,r])}}_selectMenuItem({key:r,target:z}){let K=La.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(R=>Ia(R));K.length&&nb(K,z,r==="ArrowDown",!K.includes(z)).focus()}static jQueryInterface(r){return this.each(function(){let z=za.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===z[r])throw TypeError(`No method named "${r}"`);z[r]()}})}static clearMenus(r){if(2!==
r.button&&("keyup"!==r.type||"Tab"===r.key))for(let K of La.find('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled).show')){let R=za.getInstance(K);if(!R||!1===R._config.autoClose)continue;var z=r.composedPath();let fa=z.includes(R._menu);z.includes(R._element)||"inside"===R._config.autoClose&&!fa||"outside"===R._config.autoClose&&fa||R._menu.contains(r.target)&&("keyup"===r.type&&"Tab"===r.key||/input|select|option|textarea|form/i.test(r.target.tagName))||(z={relatedTarget:R._element},"click"===
r.type&&(z.clickEvent=r),R._completeHide(z))}}static dataApiKeydownHandler(r){var z=/input|textarea/i.test(r.target.tagName),K="Escape"===r.key;let R=["ArrowUp","ArrowDown"].includes(r.key);!R&&!K||z&&!K||(r.preventDefault(),z=this.matches('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')?this:La.prev(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||La.next(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||La.findOne('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',
r.delegateTarget.parentNode),K=za.getOrCreateInstance(z),R?(r.stopPropagation(),K.show(),K._selectMenuItem(r)):K._isShown()&&(r.stopPropagation(),K.hide(),z.focus()))}constructor(r,z){super(r,z);this._popper=null;this._parent=this._element.parentNode;this._menu=La.next(this._element,".dropdown-menu")[0]||La.prev(this._element,".dropdown-menu")[0]||La.findOne(".dropdown-menu",this._parent);this._inNavbar=this._detectNavbar()}}qa.on(document,"keydown.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',
za.dataApiKeydownHandler);qa.on(document,"keydown.bs.dropdown.data-api",".dropdown-menu",za.dataApiKeydownHandler);qa.on(document,"click.bs.dropdown.data-api",za.clearMenus);qa.on(document,"keyup.bs.dropdown.data-api",za.clearMenus);qa.on(document,"click.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',function(r){r.preventDefault();za.getOrCreateInstance(this).toggle()});Lb(za);let Ka={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},
Qa={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class fb extends fc{static get Default(){return Ka}static get DefaultType(){return Qa}static get NAME(){return"backdrop"}show(r){if(!this._config.isVisible)return void yb(r);this._append();let z=this._getElement();this._config.isAnimated&&z.offsetHeight;z.classList.add("show");this._emulateAnimation(()=>{yb(r)})}hide(r){this._config.isVisible?(this._getElement().classList.remove("show"),
this._emulateAnimation(()=>{this.dispose();yb(r)})):yb(r)}dispose(){this._isAppended&&(qa.off(this._element,"mousedown.bs.backdrop"),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){let r=document.createElement("div");r.className=this._config.className;this._config.isAnimated&&r.classList.add("fade");this._element=r}return this._element}_configAfterMerge(r){return r.rootElement=Qb(r.rootElement),r}_append(){if(!this._isAppended){var r=this._getElement();this._config.rootElement.append(r);
qa.on(r,"mousedown.bs.backdrop",()=>{yb(this._config.clickCallback)});this._isAppended=!0}}_emulateAnimation(r){mb(r,this._getElement(),this._config.isAnimated)}constructor(r){super();this._config=this._getConfig(r);this._isAppended=!1;this._element=null}}let ib={autofocus:!0,trapElement:null},qc={autofocus:"boolean",trapElement:"element"};class Lc extends fc{static get Default(){return ib}static get DefaultType(){return qc}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&
this._config.trapElement.focus(),qa.off(document,".bs.focustrap"),qa.on(document,"focusin.bs.focustrap",r=>this._handleFocusin(r)),qa.on(document,"keydown.tab.bs.focustrap",r=>this._handleKeydown(r)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,qa.off(document,".bs.focustrap"))}_handleFocusin(r){let {trapElement:z}=this._config;r.target===document||r.target===z||z.contains(r.target)||(r=La.focusableChildren(z),0===r.length?z.focus():this._lastTabNavDirection==="backward"?r[r.length-
1].focus():r[0].focus())}_handleKeydown(r){"Tab"===r.key&&(this._lastTabNavDirection=r.shiftKey?"backward":"forward")}constructor(r){super();this._config=this._getConfig(r);this._isActive=!1;this._lastTabNavDirection=null}}class Pe{getWidth(){return Math.abs(window.innerWidth-document.documentElement.clientWidth)}hide(){let r=this.getWidth();this._disableOverFlow();this._setElementAttributes(this._element,"padding-right",z=>z+r);this._setElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",
"padding-right",z=>z+r);this._setElementAttributes(".sticky-top","margin-right",z=>z-r)}reset(){this._resetElementAttributes(this._element,"overflow");this._resetElementAttributes(this._element,"padding-right");this._resetElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top","padding-right");this._resetElementAttributes(".sticky-top","margin-right")}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow");this._element.style.overflow=
"hidden"}_setElementAttributes(r,z,K){let R=this.getWidth();this._applyManipulationCallback(r,fa=>{if(!(fa!==this._element&&window.innerWidth>fa.clientWidth+R)){this._saveInitialAttribute(fa,z);var ra=window.getComputedStyle(fa).getPropertyValue(z);fa.style.setProperty(z,`${K(Number.parseFloat(ra))}px`)}})}_saveInitialAttribute(r,z){let K=r.style.getPropertyValue(z);K&&ac.setDataAttribute(r,z,K)}_resetElementAttributes(r,z){this._applyManipulationCallback(r,K=>{let R=ac.getDataAttribute(K,z);null!==
R?(ac.removeDataAttribute(K,z),K.style.setProperty(z,R)):K.style.removeProperty(z)})}_applyManipulationCallback(r,z){if(bb(r))z(r);else for(let K of La.find(r,this._element))z(K)}constructor(){this._element=document.body}}let $g={backdrop:!0,focus:!0,keyboard:!0},ah={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class qd extends $b{static get Default(){return $g}static get DefaultType(){return ah}static get NAME(){return"modal"}toggle(r){return this._isShown?this.hide():this.show(r)}show(r){this._isShown||
this._isTransitioning||qa.trigger(this._element,"show.bs.modal",{relatedTarget:r}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add("modal-open"),this._adjustDialog(),this._backdrop.show(()=>this._showElement(r)))}hide(){this._isShown&&!this._isTransitioning&&(qa.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove("show"),this._queueCallback(()=>
this._hideModal(),this._element,this._isAnimated())))}dispose(){qa.off(window,".bs.modal");qa.off(this._dialog,".bs.modal");this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new fb({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Lc({trapElement:this._element})}_showElement(r){document.body.contains(this._element)||document.body.append(this._element);this._element.style.display=
"block";this._element.removeAttribute("aria-hidden");this._element.setAttribute("aria-modal",!0);this._element.setAttribute("role","dialog");this._element.scrollTop=0;let z=La.findOne(".modal-body",this._dialog);z&&(z.scrollTop=0);this._element.offsetHeight;this._element.classList.add("show");this._queueCallback(()=>{this._config.focus&&this._focustrap.activate();this._isTransitioning=!1;qa.trigger(this._element,"shown.bs.modal",{relatedTarget:r})},this._dialog,this._isAnimated())}_addEventListeners(){qa.on(this._element,
"keydown.dismiss.bs.modal",r=>{"Escape"===r.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())});qa.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()});qa.on(this._element,"mousedown.dismiss.bs.modal",r=>{qa.one(this._element,"click.dismiss.bs.modal",z=>{this._element===r.target&&this._element===z.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display=
"none";this._element.setAttribute("aria-hidden",!0);this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._isTransitioning=!1;this._backdrop.hide(()=>{document.body.classList.remove("modal-open");this._resetAdjustments();this._scrollBar.reset();qa.trigger(this._element,"hidden.bs.modal")})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(!qa.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented){var r=this._element.scrollHeight>
document.documentElement.clientHeight,z=this._element.style.overflowY;"hidden"===z||this._element.classList.contains("modal-static")||(r||(this._element.style.overflowY="hidden"),this._element.classList.add("modal-static"),this._queueCallback(()=>{this._element.classList.remove("modal-static");this._queueCallback(()=>{this._element.style.overflowY=z},this._dialog)},this._dialog),this._element.focus())}}_adjustDialog(){let r=this._element.scrollHeight>document.documentElement.clientHeight,z=this._scrollBar.getWidth(),
K=z>0;K&&!r&&(this._element.style["rtl"===document.documentElement.dir?"paddingLeft":"paddingRight"]=`${z}px`);!K&&r&&(this._element.style["rtl"===document.documentElement.dir?"paddingRight":"paddingLeft"]=`${z}px`)}_resetAdjustments(){this._element.style.paddingLeft="";this._element.style.paddingRight=""}static jQueryInterface(r,z){return this.each(function(){let K=qd.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===K[r])throw TypeError(`No method named "${r}"`);K[r](z)}})}constructor(r,
z){super(r,z);this._dialog=La.findOne(".modal-dialog",this._element);this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._isTransitioning=this._isShown=!1;this._scrollBar=new Pe;this._addEventListeners()}}qa.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(r){let z=La.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&r.preventDefault();qa.one(z,"show.bs.modal",K=>{K.defaultPrevented||qa.one(z,"hidden.bs.modal",()=>{Ia(this)&&
this.focus()})});(r=La.findOne(".modal.show"))&&qd.getInstance(r).hide();qd.getOrCreateInstance(z).toggle(this)});Rb(qd);Lb(qd);let bh={backdrop:!0,keyboard:!0,scroll:!1},ch={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Tc extends $b{static get Default(){return bh}static get DefaultType(){return ch}static get NAME(){return"offcanvas"}toggle(r){return this._isShown?this.hide():this.show(r)}show(r){this._isShown||qa.trigger(this._element,"show.bs.offcanvas",{relatedTarget:r}).defaultPrevented||
(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new Pe).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add("showing"),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate();this._element.classList.add("show");this._element.classList.remove("showing");qa.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:r})},this._element,!0))}hide(){this._isShown&&(qa.trigger(this._element,
"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding");this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._config.scroll||(new Pe).reset();qa.trigger(this._element,"hidden.bs.offcanvas")},this._element,!0)))}dispose(){this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}_initializeBackDrop(){let r=
!!this._config.backdrop;return new fb({className:"offcanvas-backdrop",isVisible:r,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:r?()=>{"static"!==this._config.backdrop?this.hide():qa.trigger(this._element,"hidePrevented.bs.offcanvas")}:null})}_initializeFocusTrap(){return new Lc({trapElement:this._element})}_addEventListeners(){qa.on(this._element,"keydown.dismiss.bs.offcanvas",r=>{"Escape"===r.key&&(this._config.keyboard?this.hide():qa.trigger(this._element,"hidePrevented.bs.offcanvas"))})}static jQueryInterface(r){return this.each(function(){let z=
Tc.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===z[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);z[r](this)}})}constructor(r,z){super(r,z);this._isShown=!1;this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._addEventListeners()}}qa.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(r){let z=La.getElementFromSelector(this);(["A","AREA"].includes(this.tagName)&&r.preventDefault(),
ob(this))||(qa.one(z,"hidden.bs.offcanvas",()=>{Ia(this)&&this.focus()}),(r=La.findOne(".offcanvas.show"))&&r!==z&&Tc.getInstance(r).hide(),Tc.getOrCreateInstance(z).toggle(this))});qa.on(window,"load.bs.offcanvas.data-api",()=>{for(let r of La.find(".offcanvas.show"))Tc.getOrCreateInstance(r).show()});qa.on(window,"resize.bs.offcanvas",()=>{for(let r of La.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(r).position&&Tc.getOrCreateInstance(r).hide()});Rb(Tc);Lb(Tc);
let Xf={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:"src srcset alt title width height".split(" "),li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},dh=new Set("background cite href itemtype longdesc poster src xlink:href".split(" ")),eh=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,fh=(r,z)=>{let K=
r.nodeName.toLowerCase();return z.includes(K)?!dh.has(K)||!!eh.test(r.nodeValue):z.filter(R=>R instanceof RegExp).some(R=>R.test(K))},gh={allowList:Xf,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},hh={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},ih={entry:"(string|element|function|null)",selector:"(string|element)"};class jh extends fc{static get Default(){return gh}static get DefaultType(){return hh}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(r=>
this._resolvePossibleFunction(r)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(r){return this._checkContent(r),this._config.content={...this._config.content,...r},this}toHtml(){var r=document.createElement("div");for(let [K,R]of(r.innerHTML=this._maybeSanitize(this._config.template),Object.entries(this._config.content)))this._setContent(r,R,K);r=r.children[0];let z=this._resolvePossibleFunction(this._config.extraClass);return z&&r.classList.add(...z.split(" ")),r}_typeCheckConfig(r){super._typeCheckConfig(r);
this._checkContent(r.content)}_checkContent(r){for(let [z,K]of Object.entries(r))super._typeCheckConfig({selector:z,entry:K},ih)}_setContent(r,z,K){(r=La.findOne(K,r))&&((z=this._resolvePossibleFunction(z))?bb(z)?this._putElementInTemplate(Qb(z),r):this._config.html?r.innerHTML=this._maybeSanitize(z):r.textContent=z:r.remove())}_maybeSanitize(r){if(this._config.sanitize){var z=this._config.allowList;var K=this._config.sanitizeFn;if(r.length)if(K&&"function"==typeof K)z=K(r);else{r=(new window.DOMParser).parseFromString(r,
"text/html");for(let fa of[].concat(...r.body.querySelectorAll("*"))){var R=fa.nodeName.toLowerCase();if(Object.keys(z).includes(R)){K=[].concat(...fa.attributes);R=[].concat(z["*"]||[],z[R]||[]);for(let ra of K)fh(ra,R)||fa.removeAttribute(ra.nodeName)}else fa.remove()}z=r.body.innerHTML}else z=r}else z=r;return z}_resolvePossibleFunction(r){return yb(r,[void 0,this])}_putElementInTemplate(r,z){this._config.html?(z.innerHTML="",z.append(r)):z.textContent=r.textContent}constructor(r){super();this._config=
this._getConfig(r)}}let kh=new Set(["sanitize","allowList","sanitizeFn"]),lh={AUTO:"auto",TOP:"top",RIGHT:"rtl"===document.documentElement.dir?"left":"right",BOTTOM:"bottom",LEFT:"rtl"===document.documentElement.dir?"right":"left"},mh={allowList:Xf,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
title:"",trigger:"hover focus"},nh={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class rd extends $b{static get Default(){return mh}static get DefaultType(){return nh}static get NAME(){return"tooltip"}enable(){this._isEnabled=
!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout);qa.off(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler);this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title"));this._disposePopper();super.dispose()}show(){if("none"===this._element.style.display)throw Error("Please use show on visible elements");
if(this._isWithContent()&&this._isEnabled){var r=qa.trigger(this._element,this.constructor.eventName("show")),z=(hb(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(!r.defaultPrevented&&z){this._disposePopper();r=this._getTipElement();this._element.setAttribute("aria-describedby",r.getAttribute("id"));({container:z}=this._config);if(this._element.ownerDocument.documentElement.contains(this.tip)||(z.append(r),qa.trigger(this._element,this.constructor.eventName("inserted"))),
this._popper=this._createPopper(r),r.classList.add("show"),"ontouchstart"in document.documentElement)for(let K of[].concat(...document.body.children))qa.on(K,"mouseover",Fb);this._queueCallback(()=>{qa.trigger(this._element,this.constructor.eventName("shown"));!1===this._isHovered&&this._leave();this._isHovered=!1},this.tip,this._isAnimated())}}}hide(){if(this._isShown()&&!qa.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove("show"),
"ontouchstart"in document.documentElement)for(let r of[].concat(...document.body.children))qa.off(r,"mouseover",Fb);this._activeTrigger.click=!1;this._activeTrigger.focus=!1;this._activeTrigger.hover=!1;this._isHovered=null;this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),qa.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||
(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(r){r=this._getTemplateFactory(r).toHtml();if(!r)return null;r.classList.remove("fade","show");r.classList.add(`bs-${this.constructor.NAME}-auto`);var z=this.constructor.NAME;do z+=Math.floor(1E6*Math.random());while(document.getElementById(z));return r.setAttribute("id",z.toString()),this._isAnimated()&&r.classList.add("fade"),r}setContent(r){this._newContent=r;this._isShown()&&(this._disposePopper(),
this.show())}_getTemplateFactory(r){return this._templateFactory?this._templateFactory.changeContent(r):this._templateFactory=new jh({...this._config,content:r,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(r){return this.constructor.getOrCreateInstance(r.delegateTarget,
this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains("fade")}_isShown(){return this.tip&&this.tip.classList.contains("show")}_createPopper(r){let z=lh[yb(this._config.placement,[this,r,this._element]).toUpperCase()];return xa(this._element,r,this._getPopperConfig(z))}_getOffset(){let {offset:r}=this._config;return"string"==typeof r?r.split(",").map(z=>Number.parseInt(z,10)):"function"==typeof r?z=>r(z,this._element):r}_resolvePossibleFunction(r){return yb(r,
[this._element,this._element])}_getPopperConfig(r){r={placement:r,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:z=>{this._getTipElement().setAttribute("data-popper-placement",z.state.placement)}}]};return{...r,...yb(this._config.popperConfig,
[void 0,r])}}_setListeners(){for(let r of this._config.trigger.split(" "))if("click"===r)qa.on(this._element,this.constructor.eventName("click"),this._config.selector,z=>{z=this._initializeOnDelegatedTarget(z);z._activeTrigger.click=!(z._isShown()&&z._activeTrigger.click);z.toggle()});else if("manual"!==r){let z=r==="hover"?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),K=r==="hover"?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");qa.on(this._element,
z,this._config.selector,R=>{let fa=this._initializeOnDelegatedTarget(R);fa._activeTrigger["focusin"===R.type?"focus":"hover"]=!0;fa._enter()});qa.on(this._element,K,this._config.selector,R=>{let fa=this._initializeOnDelegatedTarget(R);fa._activeTrigger["focusout"===R.type?"focus":"hover"]=fa._element.contains(R.relatedTarget);fa._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()};qa.on(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler)}_fixTitle(){let r=this._element.getAttribute("title");
r&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",r),this._element.setAttribute("data-bs-original-title",r),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(r,
z){clearTimeout(this._timeout);this._timeout=setTimeout(r,z)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(r){let z=ac.getDataAttributes(this._element);for(let K of Object.keys(z))kh.has(K)&&delete z[K];return r={...z,...("object"==typeof r&&r?r:{})},r=this._mergeConfigObj(r),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r.container=!1===r.container?document.body:Qb(r.container),"number"==typeof r.delay&&(r.delay={show:r.delay,
hide:r.delay}),"number"==typeof r.title&&(r.title=r.title.toString()),"number"==typeof r.content&&(r.content=r.content.toString()),r}_getDelegateConfig(){let r={};for(let [z,K]of Object.entries(this._config))this.constructor.Default[z]!==K&&(r[z]=K);return r.selector=!1,r.trigger="manual",r}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null);this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(r){return this.each(function(){let z=rd.getOrCreateInstance(this,r);
if("string"==typeof r){if(void 0===z[r])throw TypeError(`No method named "${r}"`);z[r]()}})}constructor(r,z){if(void 0===Ha)throw TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(r,z);this._isEnabled=!0;this._timeout=0;this._isHovered=null;this._activeTrigger={};this.tip=this._newContent=this._templateFactory=this._popper=null;this._setListeners();this._config.selector||this._fixTitle()}}Lb(rd);let oh={...rd.Default,content:"",offset:[0,8],placement:"right",
template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ph={...rd.DefaultType,content:"(null|string|element|function)"};class Qe extends rd{static get Default(){return oh}static get DefaultType(){return ph}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(r){return this.each(function(){let z=
Qe.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===z[r])throw TypeError(`No method named "${r}"`);z[r]()}})}}Lb(Qe);let qh={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},rh={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class fe extends $b{static get Default(){return qh}static get DefaultType(){return rh}static get NAME(){return"scrollspy"}refresh(){for(let r of(this._initializeTargetsAndObservables(),
this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver(),this._observableSections.values()))this._observer.observe(r)}dispose(){this._observer.disconnect();super.dispose()}_configAfterMerge(r){return r.target=Qb(r.target)||document.body,r.rootMargin=r.offset?`${r.offset}px 0px -30%`:r.rootMargin,"string"==typeof r.threshold&&(r.threshold=r.threshold.split(",").map(z=>Number.parseFloat(z))),r}_maybeEnableSmoothScroll(){this._config.smoothScroll&&
(qa.off(this._config.target,"click.bs.scrollspy"),qa.on(this._config.target,"click.bs.scrollspy","[href]",r=>{var z=this._observableSections.get(r.target.hash);if(z){r.preventDefault();r=this._rootElement||window;z=z.offsetTop-this._element.offsetTop;if(r.scrollTo)return void r.scrollTo({top:z,behavior:"smooth"});r.scrollTop=z}}))}_getNewObserver(){return new IntersectionObserver(r=>this._observerCallback(r),{root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin})}_observerCallback(r){let z=
ra=>this._targetLinks.get(`#${ra.target.id}`),K=ra=>{this._previousScrollData.visibleEntryTop=ra.target.offsetTop;this._process(z(ra))},R=(this._rootElement||document.documentElement).scrollTop,fa=R>=this._previousScrollData.parentScrollTop;for(let ra of(this._previousScrollData.parentScrollTop=R,r))if(ra.isIntersecting)if(r=ra.target.offsetTop>=this._previousScrollData.visibleEntryTop,fa&&r){if(K(ra),!R)break}else fa||r||K(ra);else this._activeTarget=null,this._clearActiveClass(z(ra))}_initializeTargetsAndObservables(){for(let r of(this._targetLinks=
new Map,this._observableSections=new Map,La.find("[href]",this._config.target))){if(!r.hash||ob(r))continue;let z=La.findOne(decodeURI(r.hash),this._element);Ia(z)&&(this._targetLinks.set(decodeURI(r.hash),r),this._observableSections.set(r.hash,z))}}_process(r){this._activeTarget!==r&&(this._clearActiveClass(this._config.target),this._activeTarget=r,r.classList.add("active"),this._activateParents(r),qa.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:r}))}_activateParents(r){if(r.classList.contains("dropdown-item"))La.findOne(".dropdown-toggle",
r.closest(".dropdown")).classList.add("active");else for(let z of La.parents(r,".nav, .list-group"))for(let K of La.prev(z,".nav-link, .nav-item > .nav-link, .list-group-item"))K.classList.add("active")}_clearActiveClass(r){for(let z of(r.classList.remove("active"),La.find("[href].active",r)))z.classList.remove("active")}static jQueryInterface(r){return this.each(function(){let z=fe.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===z[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);
z[r]()}})}constructor(r,z){super(r,z);this._targetLinks=new Map;this._observableSections=new Map;this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element;this._observer=this._activeTarget=null;this._previousScrollData={visibleEntryTop:0,parentScrollTop:0};this.refresh()}}qa.on(window,"load.bs.scrollspy.data-api",()=>{for(let r of La.find('[data-bs-spy="scroll"]'))fe.getOrCreateInstance(r)});Lb(fe);class sd extends $b{static get NAME(){return"tab"}show(){let r=this._element;
if(!this._elemIsActive(r)){var z=this._getActiveElem(),K=z?qa.trigger(z,"hide.bs.tab",{relatedTarget:r}):null;qa.trigger(r,"show.bs.tab",{relatedTarget:z}).defaultPrevented||K&&K.defaultPrevented||(this._deactivate(z,r),this._activate(r,z))}}_activate(r,z){r&&(r.classList.add("active"),this._activate(La.getElementFromSelector(r)),this._queueCallback(()=>{"tab"===r.getAttribute("role")?(r.removeAttribute("tabindex"),r.setAttribute("aria-selected",!0),this._toggleDropDown(r,!0),qa.trigger(r,"shown.bs.tab",
{relatedTarget:z})):r.classList.add("show")},r,r.classList.contains("fade")))}_deactivate(r,z){r&&(r.classList.remove("active"),r.blur(),this._deactivate(La.getElementFromSelector(r)),this._queueCallback(()=>{"tab"===r.getAttribute("role")?(r.setAttribute("aria-selected",!1),r.setAttribute("tabindex","-1"),this._toggleDropDown(r,!1),qa.trigger(r,"hidden.bs.tab",{relatedTarget:z})):r.classList.remove("show")},r,r.classList.contains("fade")))}_keydown(r){if("ArrowLeft ArrowRight ArrowUp ArrowDown Home End".split(" ").includes(r.key)){r.stopPropagation();
r.preventDefault();var z=this._getChildren().filter(K=>!ob(K));if(["Home","End"].includes(r.key))r=z[r.key==="Home"?0:z.length-1];else{let K=["ArrowRight","ArrowDown"].includes(r.key);r=nb(z,r.target,K,!0)}r&&(r.focus({preventScroll:!0}),sd.getOrCreateInstance(r).show())}}_getChildren(){return La.find('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',this._parent)}_getActiveElem(){return this._getChildren().find(r=>
this._elemIsActive(r))||null}_setInitialAttributes(r,z){for(let K of(this._setAttributeIfNotExists(r,"role","tablist"),z))this._setInitialAttributesOnChild(K)}_setInitialAttributesOnChild(r){r=this._getInnerElement(r);let z=this._elemIsActive(r),K=this._getOuterElement(r);r.setAttribute("aria-selected",z);K!==r&&this._setAttributeIfNotExists(K,"role","presentation");z||r.setAttribute("tabindex","-1");this._setAttributeIfNotExists(r,"role","tab");this._setInitialAttributesOnTargetPanel(r)}_setInitialAttributesOnTargetPanel(r){let z=
La.getElementFromSelector(r);z&&(this._setAttributeIfNotExists(z,"role","tabpanel"),r.id&&this._setAttributeIfNotExists(z,"aria-labelledby",`${r.id}`))}_toggleDropDown(r,z){r=this._getOuterElement(r);if(r.classList.contains("dropdown")){var K=La.findOne(".dropdown-toggle",r);K&&K.classList.toggle("active",z);(K=La.findOne(".dropdown-menu",r))&&K.classList.toggle("show",z);r.setAttribute("aria-expanded",z)}}_setAttributeIfNotExists(r,z,K){r.hasAttribute(z)||r.setAttribute(z,K)}_elemIsActive(r){return r.classList.contains("active")}_getInnerElement(r){return r.matches('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]')?
r:La.findOne('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',r)}_getOuterElement(r){return r.closest(".nav-item, .list-group-item")||r}static jQueryInterface(r){return this.each(function(){let z=sd.getOrCreateInstance(this);if("string"==typeof r){if(void 0===z[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);z[r]()}})}constructor(r){super(r);
(this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'))&&(this._setInitialAttributes(this._parent,this._getChildren()),qa.on(this._element,"keydown.bs.tab",z=>this._keydown(z)))}}qa.on(document,"click.bs.tab",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',function(r){["A","AREA"].includes(this.tagName)&&r.preventDefault();ob(this)||sd.getOrCreateInstance(this).show()});qa.on(window,"load.bs.tab",()=>{for(let r of La.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))sd.getOrCreateInstance(r)});
Lb(sd);let sh={animation:"boolean",autohide:"boolean",delay:"number"},th={animation:!0,autohide:!0,delay:5E3};class ge extends $b{static get Default(){return th}static get DefaultType(){return sh}static get NAME(){return"toast"}show(){qa.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.offsetHeight,this._element.classList.add("show","showing"),this._queueCallback(()=>
{this._element.classList.remove("showing");qa.trigger(this._element,"shown.bs.toast");this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(qa.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add("showing"),this._queueCallback(()=>{this._element.classList.add("hide");this._element.classList.remove("showing","show");qa.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout();
this.isShown()&&this._element.classList.remove("show");super.dispose()}isShown(){return this._element.classList.contains("show")}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(r,z){switch(r.type){case "mouseover":case "mouseout":this._hasMouseInteraction=z;break;case "focusin":case "focusout":this._hasKeyboardInteraction=z}if(z)return void this._clearTimeout();r=
r.relatedTarget;this._element===r||this._element.contains(r)||this._maybeScheduleHide()}_setListeners(){qa.on(this._element,"mouseover.bs.toast",r=>this._onInteraction(r,!0));qa.on(this._element,"mouseout.bs.toast",r=>this._onInteraction(r,!1));qa.on(this._element,"focusin.bs.toast",r=>this._onInteraction(r,!0));qa.on(this._element,"focusout.bs.toast",r=>this._onInteraction(r,!1))}_clearTimeout(){clearTimeout(this._timeout);this._timeout=null}static jQueryInterface(r){return this.each(function(){let z=
ge.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===z[r])throw TypeError(`No method named "${r}"`);z[r](this)}})}constructor(r,z){super(r,z);this._timeout=null;this._hasKeyboardInteraction=this._hasMouseInteraction=!1;this._setListeners()}}return Rb(ge),Lb(ge),{Alert:tc,Button:C,Carousel:Ma,Collapse:Ub,Dropdown:za,Modal:qd,Offcanvas:Tc,Popover:Qe,ScrollSpy:fe,Tab:sd,Toast:ge,Tooltip:rd}}();var Va={};for(let c of(!function(d){function a(y,E){for(var x=y.length;x--;)if(y[x]===E)return x;
return-1}function h(y,E,x){var G=f(y);void 0===x&&(x=E,E="all");for(var I=0;I<G.length;I++){var O=[];(y=G[I].split("+")).length>1&&(O=e(y),y=[y[y.length-1]]);(y=u(y=y[0]))in g||(g[y]=[]);g[y].push({shortcut:G[I],scope:E,method:x,key:G[I],mods:O})}}function q(){return p||"all"}function f(y){var E;return""==(E=y.replace(/\s/g,"").split(","))[E.length-1]&&(E[E.length-2]+=","),E}function e(y){y=y.slice(0,y.length-1);for(var E=0;E<y.length;E++)y[E]=n[y[E]];return y}function k(y,E,x){y.addEventListener&&
y.addEventListener(E,x,!1)}var l,g={},m={16:!1,18:!1,17:!1,91:!1},p="all",n={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},t={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},u=function(y){y=t[y]||y.toUpperCase().charCodeAt(0);return"function"==
typeof y?y():y},v=[];for(l=1;l<20;l++)t["f"+l]=111+l;var A={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(l in n)h[l]=!1;k(document,"keydown",function(y){!function(E){var x,G,I,O,B;if(-1==a(v,x=rf(E.key))&&v.push(x),x in m)for(I in m[x]=!0,n)n[I]==x&&(h[I]=!0);else{for(l in m)m[l]=E[A[l]];if(h.filter.call(this,E)&&x in g){var N=0;for(B=q();N<g[x].length;N++)if((G=g[x][N]).scope==B||"all"==G.scope){for(I in O=G.mods.length>0,m)(!m[I]&&a(G.mods,+I)>-1||m[I]&&-1==a(G.mods,+I))&&(O=!1);(0!=
G.mods.length||m[16]||m[18]||m[17]||m[91])&&!O||!1!==G.method(E,G)||(E.preventDefault?E.preventDefault():E.returnValue=!1,E.stopPropagation&&E.stopPropagation(),E.cancelBubble&&(E.cancelBubble=!0))}}}}(y)});k(document,"keyup",function(y){var E;y=rf(y.key);var x=a(v,y);if(x>=0&&v.splice(x,1),y in m)for(E in m[y]=!1,n)n[E]==y&&(h[E]=!1)});k(window,"focus",function(){for(l in m)m[l]=!1;for(l in n)h[l]=!1});var D=d.key;d.key=h;d.key.setScope=function(y){p=y||"all"};d.key.getScope=q;d.key.deleteScope=
function(y){var E,x;for(E in g){var G=0;for(x=g[E];G<x.length;)x[G].scope===y?x.splice(G,1):G++}};d.key.filter=function(y){y=(y.target||y.srcElement).tagName;return"INPUT"!=y&&"SELECT"!=y&&"TEXTAREA"!=y};d.key.isPressed=function(y){return"string"==typeof y&&(y=u(y)),-1!=a(v,y)};d.key.getPressedKeyCodes=function(){return v.slice(0)};d.key.noConflict=function(){var y=d.key;return d.key=D,y};d.key.unbind=function(y,E){var x,G,I,O,B=[];var N=0;for(x=f(y);N<x.length&&((G=x[N].split("+")).length>1&&(B=
e(G)),y=u(y=G[G.length-1]),void 0===E&&(E=q()),g[y]);N++)for(I=0;I<g[y].length;I++){var P;if(P=(O=g[y][I]).scope===E)a:if(O=O.mods,O.length!=B.length)P=!1;else{for(P=0;P<O.length;P++)if(O[P]!==B[P]){P=!1;break a}P=!0}P&&(g[y][I]={})}};Va=h}(Va||{}),Zc.prototype.clone=function(){for(var d=new Zc(Array(this.points.length)),a=0;a<this.points.length;a++)d.points[a]={x:this.points[a].x,y:this.points[a].y};return d},Zc.prototype.getTransformed=function(d){for(var a=new Zc(Array(this.points.length)),h=0;h<
this.points.length;h++)a.points[h]=d.getTransformedPoint(this.points[h]);return a},Zc.prototype.getCenter=function(){for(var d=this.points[0].x,a=this.points[0].y,h=1;h<this.points.length;h++)d+=this.points[h].x,a+=this.points[h].y;return{x:d/this.points.length,y:a/this.points.length}},Zc.prototype.containsPoint=function(d){var a,h=!1;var q=0;for(a=this.points.length-1;q<this.points.length;a=q++)this.points[q].y>d.y!=this.points[a].y>d.y&&d.x<(this.points[a].x-this.points[q].x)*(d.y-this.points[q].y)/
(this.points[a].y-this.points[q].y)+this.points[q].x&&(h=!h);return h},xb.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},xb.prototype.normalize=function(){var d=this.getLength();return this.x/=d,this.y/=d,this},xb.prototype.getDotProduct=function(d){return this.x*d.x+this.y*d.y},xb.prototype.scale=function(d){return this.x*=d,this.y*=d,this},xb.prototype.getScaled=function(d){var a=new xb(this.x,this.y);return a.scale(d),a},xb.prototype.getRounded=function(){return new xb(Math.round(this.x),
Math.round(this.y))},xb.prototype.getTruncated=function(){return new xb(~~this.x,~~this.y)},xb.prototype.getPerpendicular=function(){return new xb(-this.y,this.x)},xb.prototype.add=function(d){return this.x+=d.x,this.y+=d.y,this},xb.prototype.subtract=function(d){return this.x-=d.x,this.y-=d.y,this},xb.prototype.getSum=function(d){return new xb(this.x+d.x,this.y+d.y)},xb.subtractPoints=function(d,a){return new xb(d.x-a.x,d.y-a.y)},xd.prototype=Object.create(Ja(Hb).prototype),xd.prototype.constructor=
xd,Xb.MODE_INDEX_DEFAULT=0,Xb.MODE_INDEX_USER=1,Xb.prototype.setMode=function(d,a){var h=this.modes[d];h!=a&&(h&&h.leave(),this.modes[d]=a,a.enter())},Xb.prototype.setDefaultMode=function(d){d.transient=!1;d.capture=!1;this.setMode(Xb.MODE_INDEX_DEFAULT,d)},Xb.prototype.setUserMode=function(d){for(var a=this.modes.length-1;a>Xb.MODE_INDEX_USER;a--)this.modes[a].leave(),this.modes.splice(a,1);d.transient=!1;d.capture=!1;this.setMode(Xb.MODE_INDEX_USER,d)},Xb.prototype.deliverEvent=function(d,a){for(var h=
this.modes.length-1;h>=0;h--){var q=this.modes[h];if(q[d].apply(q,a)||q.capture&&"paint"!=d)return!0}return!1},["mouseDown","mouseUp"]))Xb.prototype[c]=function(d,a,h){this.deliverEvent(c,[d,a,h])};for(let c of["mouseDrag","mouseMove"])Xb.prototype[c]=function(d,a){this.deliverEvent(c,[d,a])};for(let c of["keyDown","keyUp"])Xb.prototype[c]=function(d){this.deliverEvent(c,[d])&&d.preventDefault()};Xb.prototype.paint=function(c){this.deliverEvent("paint",[c])};Xb.prototype.push=function(c,d){var a=
this.peek();a&&a.suspend();c.transient=d;c.capture=!1;c.enter();this.modes.push(c)};Xb.prototype.peek=function(){return this.modes.length>0?this.modes[this.modes.length-1]:null};Xb.prototype.pop=function(){var c=this.modes.pop(),d=this.peek();return c&&c.leave(),d&&d.resume(),d};Pd.prototype=Object.create(Ja(Hb).prototype);Pd.prototype.constructor=Pd;Tb.prototype=Object.create(Ja(Hb).prototype);Tb.prototype.constructor=Ja(Hb);Sd.prototype=Object.create(Tb.prototype);Sd.prototype.constructor=Sd;Td.prototype=
Object.create(Tb.prototype);Td.prototype.constructor=Td;Ud.prototype=Object.create(Tb.prototype);Ud.prototype.constructor=Ud;let he=window.devicePixelRatio||1,dd=Math.round(128*he),ed=Math.round(128*he);class vf{_makeBitmap(){if(this._bitmapInvalid){var c=0,d=this._imageData.data;if(this._greyscale)for(var a=0;a<ed;a++){var h=255-Math.round(a/(ed-1)*255);for(var q=0;q<dd;q++)d[c+J.RED_BYTE_OFFSET]=h,d[c+J.GREEN_BYTE_OFFSET]=h,d[c+J.BLUE_BYTE_OFFSET]=h,d[c+J.ALPHA_BYTE_OFFSET]=255,c+=J.BYTES_PER_PIXEL}else for(a=
this.color.clone(),h=0;h<ed;h++)for(a.setValue(255-~~(h/(ed-1)*255)),q=0;q<dd;q++)a.setSaturation(Math.round(q/(dd-1)*255)),d[c+J.RED_BYTE_OFFSET]=a.rgb>>16&255,d[c+J.GREEN_BYTE_OFFSET]=a.rgb>>8&255,d[c+J.BLUE_BYTE_OFFSET]=255&a.rgb,d[c+J.ALPHA_BYTE_OFFSET]=255,c+=J.BYTES_PER_PIXEL;this._bitmapInvalid=!1}}paint(){this._makeBitmap();this._canvasContext.putImageData(this._imageData,0,0);let c=this.color.getSaturation()/255*(dd-1),d=(255-this.color.getValue())/255*(ed-1);Od(this._canvasContext,"stroke");
this._canvasContext.lineWidth=1.5*he;this._canvasContext.beginPath();this._greyscale?(this._canvasContext.moveTo(0,d),this._canvasContext.lineTo(dd,d)):this._canvasContext.arc(c,d,5*he,0,2*Math.PI);this._canvasContext.stroke();this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(c){let d=this._canvas.getBoundingClientRect();var a=c.pageX-window.scrollX-d.left;c=Math.max(Math.min(255-~~(255*(c.pageY-window.scrollY-d.top)/127),255),0);this._greyscale?this.color.setGreyscale(c):
(a=Math.max(Math.min(~~(255*a/127),255),0),this.color.setHsv(this.color.getHue(),a,c));this.paint();this._controller.setCurColor(this.color)}_endDrag(c){this._canvas.releasePointerCapture(c.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",this._handleEndDrag);this._canvas.removeEventListener("pointermove",this._handleMousePickColor)}_startDrag(c){this._capturedMouse||(this._capturedMouse=!0,this._canvas.setPointerCapture(c.pointerId),this._canvas.addEventListener("pointerup",
this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(c)}setHue(c){this.color.getHue()!=c&&(this.color.setHue(c),this._controller.setCurColor(this.color))}getElement(){return this._canvas}constructor(c,d){bc(this,"_controller",void 0);bc(this,"_canvas",void 0);bc(this,"_canvasContext",void 0);bc(this,"_imageData",void 0);bc(this,"_bitmapInvalid",!0);bc(this,"_capturedMouse",!1);bc(this,"_greyscale",!1);bc(this,"color",new jb(0));this._controller=
c;let a=document.createElement("canvas");this._canvas=a;a.className="chickenpaint-colorpicker-select";a.setAttribute("touch-action","none");a.width=dd;a.height=ed;a.style.width="128px";a.style.height="128px";this._canvasContext=a.getContext("2d");this._imageData=this._canvasContext.createImageData(dd,ed);this._canvasContext.getImageData(0,0,1,1);this._handleEndDrag=this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);a.addEventListener("pointerdown",h=>this._startDrag(h));
d&&this.color.copyFrom(d);c.on("colorChange",h=>{this.color.copyFrom(h);this._bitmapInvalid=!0;this.paint()});c.on("colorModeChange",h=>{this._greyscale="greyscale"==h;this._bitmapInvalid=!0;this.paint()});this.paint()}}class wf{paint(){this._canvasContext.putImageData(this._imageData,0,0);let c=128*this.hue/360;Od(this._canvasContext,"stroke");this._canvasContext.lineWidth=1.5;this._canvasContext.beginPath();this._canvasContext.moveTo(0,c);this._canvasContext.lineTo(24,c);this._canvasContext.stroke();
this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(c){let d=this._canvas.getBoundingClientRect();this.hue=Math.max(0,Math.min(359,~~(360*(c.pageY-d.top)/128)));this.paint();this.selecter&&this.selecter.setHue(this.hue)}_endDrag(c){this._canvas.releasePointerCapture(c.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",this._handleEndDrag);this._canvas.removeEventListener("pointermove",this._handleMousePickColor)}_startDrag(c){this._capturedMouse||
(this._capturedMouse=!0,this._canvas.setPointerCapture(c.pointerId),this._canvas.addEventListener("pointerup",this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(c)}getElement(){return this._canvas}setHue(c){this.hue=c;this.paint()}constructor(c,d,a){bc(this,"hue",void 0);bc(this,"selecter",void 0);bc(this,"_canvas",void 0);bc(this,"_canvasContext",void 0);bc(this,"_imageData",void 0);bc(this,"_capturedMouse",!1);this.selecter=d;
this.hue=a||0;let h=document.createElement("canvas");this._canvas=h;c.on("colorChange",q=>{this.setHue(q.getHue())});c.on("colorModeChange",q=>{h.style.display="greyscale"==q?"none":"block"});h.setAttribute("touch-action","none");h.addEventListener("pointerdown",q=>this._startDrag(q));h.width=24;h.height=128;h.className="chickenpaint-colorpicker-slider";this._canvasContext=h.getContext("2d");this._imageData=this._canvasContext.createImageData(24,128);this._canvasContext.getImageData(0,0,1,1);this._handleEndDrag=
this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);(function(q){let f=new jb(65535),e=0,k=q.data;for(let l=0;l<q.height;l++){f.setHue(359*l/q.height);for(let g=0;g<q.width;g++)k[e+J.RED_BYTE_OFFSET]=f.rgb>>16&255,k[e+J.GREEN_BYTE_OFFSET]=f.rgb>>8&255,k[e+J.BLUE_BYTE_OFFSET]=255&f.rgb,k[e+J.ALPHA_BYTE_OFFSET]=255,e+=J.BYTES_PER_PIXEL}})(this._imageData);this.paint()}}Vd.prototype=Object.create(Tb.prototype);Vd.prototype.constructor=Vd;md.prototype=Object.create(Ja(Hb).prototype);
md.prototype.constructor=md;Ob.prototype=Object.create(Ja(Hb).prototype);Ob.prototype.constructor=Ob;zd.prototype=Object.create(Ja(Hb).prototype);zd.prototype.constructor=zd;nd.prototype=Object.create(Tb.prototype);nd.prototype.constructor=nd;nd.CPBrushPreview=function(c){function d(){e.clearRect(0,0,f.width,f.height);e.beginPath();e.arc(f.width/2,f.height/2,q/2*window.devicePixelRatio,0,2*Math.PI);e.stroke()}function a(l){let g=f.getBoundingClientRect();var m=l.clientX-g.left-f.clientWidth/2;l=l.clientY-
g.top-f.clientHeight/2;m=Math.max(1,Math.min(200,Math.round(2*Math.sqrt(m*m+l*l))));d();c.setBrushSize(m)}function h(l){k&&(k=!1,document.removeEventListener("pointerup",h,{capture:!1}),document.removeEventListener("pointermove",a,{capture:!1}))}let q=16,f=document.createElement("canvas"),e=f.getContext("2d"),k=!1;f.addEventListener("pointerdown",function(l){k||(k=!0,document.addEventListener("pointerup",h,{passive:!0,capture:!1}),document.addEventListener("pointermove",a,{passive:!0,capture:!1}),
a(l))});this.getElement=function(){return f};c.on("toolChange",function(l,g){g.size!=q&&(q=g.size,d())});f.width=64;f.height=64;window.devicePixelRatio>1&&(f.style.width=f.width+"px",f.style.height=f.height+"px",f.width*=window.devicePixelRatio,f.height*=window.devicePixelRatio);f.className="chickenpaint-brush-preview";e.strokeStyle="black";e.lineWidth=+window.devicePixelRatio;d()};Wd.prototype=Object.create(Tb.prototype);Wd.prototype.constructor=Wd;Xd.prototype=Object.create(Tb.prototype);Xd.prototype.constructor=
Xd;Yd.prototype=Object.create(Tb.prototype);Yd.prototype.constructor=Yd;Zd.prototype=Object.create(Ja(Hb).prototype);Zd.prototype.constructor=Zd;let Af=[{name:"File",mnemonic:"F",children:[{name:"Export as png",action:"CPExportAsPNG",mnemonic:"S",shortcut:"ctrl+s"},{name:"Export as zip",action:"CPExportAsZIP",title:T("Save the PNG image, CHI project file, and swatches file together as a ZIP package."),mnemonic:"S",shortcut:"shift+alt+s"},{name:"-"},{name:"Backup to browser storage",action:"CPSaveDBFromMenu",
title:T("Save the current drawing to the browser's local database."),mnemonic:"S"},{name:"Save Oekaki",action:"CPSend",title:T("Finish drawing and post to the server."),mnemonic:"S",shortcut:"ctrl+s"}]},{name:"Edit",mnemonic:"E",children:[{name:"Undo",action:"CPUndo",mnemonic:"U",shortcut:"ctrl+z"},{name:"Redo",action:"CPRedo",mnemonic:"R",shortcut:"ctrl+y"},{name:"Clear history",action:"CPClearHistory",mnemonic:"H",title:T("Removes all undo/redo information to regain memory")},{name:"-"},{name:"Cut",
action:"CPCut",mnemonic:"T",shortcut:"ctrl+x"},{name:"Copy",action:"CPCopy",mnemonic:"C",shortcut:"ctrl+c"},{name:"Copy merged",action:"CPCopyMerged",mnemonic:"Y",shortcut:"shift+ctrl+c"},{name:"Paste",action:"CPPaste",mnemonic:"P",shortcut:"ctrl+v"},{name:"-"},{name:"Select all",action:"CPSelectAll",mnemonic:"A",shortcut:"ctrl+a"},{name:"Deselect",action:"CPDeselectAll",mnemonic:"D",shortcut:"ctrl+d"},{name:"-"},{name:"Transform",action:"CPTransform",mnemonic:"T",shortcut:"ctrl+h"}]},{name:"Layers",
mnemonic:"L",children:[{name:"Duplicate",action:"CPLayerDuplicate",mnemonic:"D",shortcut:"shift+ctrl+d"},{name:"-"},{name:"Merge down",action:"CPLayerMergeDown",mnemonic:"E",shortcut:"ctrl+e"},{name:"Merge group",action:"CPGroupMerge",mnemonic:"G",shortcut:"shift+ctrl+g"},{name:"Merge all layers",action:"CPLayerMergeAll",shortcut:"shift+ctrl+e",mnemonic:"A"},{name:"Create merged layer",action:"CPCreateMergedLayer",shortcut:"shift+alt+e"},{name:"-"},{hideIfNotAvailable:!0,name:"Add layer mask",action:"CPAddLayerMask"},
{hideIfNotAvailable:!0,name:"Delete layer mask",action:"CPRemoveLayerMask",shortcut:"shift+m"},{hideIfNotAvailable:!0,name:"Apply layer mask",action:"CPApplyLayerMask",shortcut:"ctrl+m"},{name:"-"},{hideIfNotAvailable:!0,name:"Clip to the layer below",action:"CPCreateClippingMask"},{hideIfNotAvailable:!0,name:"Unclip from the layer below",action:"CPReleaseClippingMask"}]},{name:"Effects",mnemonic:"E",children:[{name:"Clear",action:"CPClear",mnemonic:"D",shortcut:"del,backspace"},{name:"Clear with texture",
action:"CPClearWithTexture",mnemonic:"T",shortcut:"shift+x"},{name:"Fill",action:"CPFill",mnemonic:"F",shortcut:"ctrl+f"},{name:"-"},{name:"Box blur...",action:"CPFXBoxBlur",mnemonic:"B"},{name:"Mosaic",action:"CPFXMosaic",mnemonic:"M"},{name:"Chromatic aberration",action:"CPChromaticAberration",mnemonic:"C"},{name:"-"},{name:"Edge expand",action:"CPEdgeExpand",mnemonic:"E"},{name:"Convert to drawing color",action:"CPConvertToDrawingColor",mnemonic:"F"},{name:"-"},{name:"Mono halftone",action:"CPMonoHalftone",
mnemonic:"M"},{name:"Color halftone",action:"CPColorHalftone",mnemonic:"C"},{name:"-"},{name:"Monochromatic noise",action:"CPMNoise",mnemonic:"M",title:T("Fills the selection with noise")},{name:"Color noise",action:"CPCNoise",mnemonic:"C",title:T("Fills the selection with colored noise")},{name:"-"},{name:"Flip horizontal",action:"CPHFlip",mnemonic:"Q",shortcut:"q"},{name:"Flip vertical",action:"CPVFlip",mnemonic:"V"},{name:"Invert",action:"CPFXInvert",mnemonic:"I",shortcut:"ctrl+i",title:T("Invert the image colors")},
{name:"-"},{name:"Convert brightness to opacity",action:"CPBrightnessToOpacity",mnemonic:"B",title:T("Convert brightness to opacity and change to drawing color.")}]},{name:"View",mnemonic:"V",children:[{name:"Full-screen mode",action:"CPFullScreen",mnemonic:"F",checkbox:!0,checked:!1},{name:"-"},{name:"Zoom in",action:"CPZoomIn",mnemonic:"I",shortcut:"="},{name:"Zoom out",action:"CPZoomOut",mnemonic:"O",shortcut:"-"},{name:"Zoom 100%",action:"CPZoom100",mnemonic:"1",shortcut:"ctrl+0"},{name:"-"},
{name:"Reset Rotation",action:"CPResetCanvasRotation",mnemonic:"R",shortcut:"alt+0"},{name:"-"},{name:"Flip View Horizontal",action:"CPViewHFlip",mnemonic:"H",shortcut:"h"},{name:"-"},{name:"Smooth-out zoomed canvas",action:"CPLinearInterpolation",mnemonic:"L",title:T("Linear interpolation is used to give a smoothed looked to the picture when zoomed in."),checkbox:!0,checked:!0},{name:"-"},{name:"Show grid",action:"CPToggleGrid",mnemonic:"G",shortcut:"ctrl+g",checkbox:!0,checked:!1},{name:"Grid options...",
action:"CPGridOptions",mnemonic:"D"}]},{name:"Palettes",mnemonic:"P",children:[{name:"Rearrange",action:"CPArrangePalettes",title:T("Rearrange the palette windows")},{name:"Toggle palettes",action:"CPTogglePalettes",mnemonic:"P",shortcut:"tab",title:T("Hides or shows all palettes")},{name:"-"},{name:"Mobile mode",action:"CPToggleSetSmallScreenMode"},{name:"-"},{name:"Show tools",action:"CPPalTool",mnemonic:"T",checkbox:!0,checked:!0},{name:"Show color",action:"CPPalColor",mnemonic:"C",checkbox:!0,
checked:!0},{name:"Show stroke",action:"CPPalStroke",mnemonic:"S",checkbox:!0,checked:!0},{name:"Show misc",action:"CPPalMisc",mnemonic:"M",checkbox:!0,checked:!0},{name:"Show swatches",action:"CPPalSwatches",mnemonic:"W",checkbox:!0,checked:!0},{name:"Show textures",action:"CPPalTextures",mnemonic:"X",checkbox:!0,checked:!0},{name:"Show tool options",action:"CPPalBrush",mnemonic:"B",checkbox:!0,checked:!0},{name:"Show layers",action:"CPPalLayers",mnemonic:"L",checkbox:!0,checked:!0}]},{name:"Help",
mnemonic:"H",children:[{name:"Tablet support",mnemonic:"T",action:"CPTabletSupport"},{name:"Shortcuts",mnemonic:"S",action:"CPShortcuts"},{name:"-"},{name:"About",mnemonic:"A",action:"CPAbout"}]}];$d.prototype=Object.create(Ja(Hb).prototype);$d.prototype.constructor=$d;ae.prototype=Object.create(Ja(Hb).prototype);ae.prototype.constructor=ae;let Re=navigator.userAgent.toLowerCase().includes("mac os"),Be=Re?"\u2318":"Ctrl",Ce=Re?"\u2325":"Alt",Fg=Re?"\u2303":"Ctrl";be.prototype=Object.create(Ja(Hb).prototype);
be.prototype.constructor=be;let Gc={toolbarStyle:"new"};class Og extends Ja(Hb){setDefaults(){for(let c in Gc)Gc.hasOwnProperty(c)&&this.set(c,Gc[c])}load(){let c={};try{c=JSON.parse(localStorage.getItem("chickenpaint-prefs"))}catch(d){console.error(d)}for(let d in c&&"object"==typeof c||(c={}),Gc)if(Gc.hasOwnProperty(d))try{this.set(d,c.hasOwnProperty(d)?c[d]:Gc[d])}catch(a){console.error(a)}}save(){try{let c=!1;for(let d in Gc)if(Gc.hasOwnProperty(d)&&this[d]!=Gc[d]){c=!0;break}c?localStorage.setItem("chickenpaint-prefs",
JSON.stringify({toolbarStyle:this.toolbarStyle})):localStorage.removeItem("chickenpaint-prefs")}catch(c){console.error(c)}}set(c,d){this[c]=d;this.emitEvent(c,[d])}get(c){return this[c]}constructor(){super();bc(this,"toolbarStyle",void 0);this.setDefaults()}}ka.prototype=Object.create(Ja(Hb).prototype);ka.prototype.constructor=ka;ka.UnsupportedBrowserException=function(c){this.message=c};ka.UnsupportedBrowserException.prototype.toString=function(){let c="Sorry, your web browser does not support ChickenPaint.";
return this.message?c+=" "+this.message:c+=" Please try a modern browser like Chrome, Safari, Firefox, or Edge.",c};ka.M_DRAW=0;ka.M_FLOODFILL=1;ka.M_RECT_SELECTION=2;ka.M_MOVE_TOOL=3;ka.M_ROTATE_CANVAS=4;ka.M_COLOR_PICKER=5;ka.M_GRADIENTFILL=6;ka.M_TRANSFORM=7;ka.M_PAN_CANVAS=8;ka.T_PENCIL=0;ka.T_ERASER=1;ka.T_PEN=2;ka.T_SOFTERASER=3;ka.T_AIRBRUSH=4;ka.T_DODGE=5;ka.T_BURN=6;ka.T_WATER=7;ka.T_BLUR=8;ka.T_SMUDGE=9;ka.T_BLENDER=10;ka.T_MAX=11;ka.COLOR_MODE_RGB=0;ka.COLOR_MODE_GREYSCALE=1;window.ChickenPaint=
ka}();
